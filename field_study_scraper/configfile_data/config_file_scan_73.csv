,commit_hash,file_path,filename,action,changes
0,96578e280a028dce51df756193ddb5d88ba3f04d,cachecloud-web/src/main/resources/static/wiki/troubleshooting/cachecloud.md,cachecloud.md,5,"{'added': [(11, ''), (13, ''), (21, ''), (23, ''), (34, ''), (36, ''), (40, ''), (42, ''), (45, 'CacheCloud版本2.1 新提供“应用导入功能”，实现全方位的redis实例托管，可参考：[""应用导入""](../../wiki/function/operation-import)。')], 'deleted': [(37, 'CacheCloud版本2.1 新提供“应用导入功能”，实现全方位的redis实例托管，可参考：[""应用导入""](../../wiki/function/operation-import)。')]}"
1,234c44b96099edc1e7dcea397c713fa80dbab45d,cachecloud-web/src/main/resources/static/wiki/quickstart/index.md,index.md,5,"{'added': [(74, '系统已有默认配置，如需更改，请参考 [系统配置说明](../access/config.md)。'), (146, '\tc.通过：等待应用部署成功后，在审批页点击”通过“，就此应用开通成功。用户接入使用可参考：[客户端接入文档](../access/client.md)。'), (156, '\t该功能支持将外部redis实例导入Cachecloud平台进行运维管理。具体操作参考：[应用导入](../../wiki/function/operation-import.md)')], 'deleted': [(74, '系统已有默认配置，如需更改，请参考 [系统配置说明](../access/config)。'), (146, '\tc.通过：等待应用部署成功后，在审批页点击”通过“，就此应用开通成功。用户接入使用可参考：[客户端接入文档](../access/client)。'), (156, '\t该功能支持将外部redis实例导入Cachecloud平台进行运维管理。具体操作参考：[应用导入](../../wiki/function/operation-import)')]}"
2,ae07c40316aedf3ec24e87498aad8c4c3b99b6b1,cachecloud-web/src/main/resources/static/wiki/quickstart/index.md,index.md,5,"{'added': [(21, 'a.下载war包：[cachecloud-web.war](http://122.9.1.235/redis-ecs/cachecloud-web.war)'), (74, '系统已有默认配置，如需更改，请参考 [系统配置说明](../access/config)。'), (146, '\tc.通过：等待应用部署成功后，在审批页点击”通过“，就此应用开通成功。用户接入使用可参考：[客户端接入文档](../access/client)。'), (156, '\t该功能支持将外部redis实例导入Cachecloud平台进行运维管理。具体操作参考：[应用导入](../../wiki/function/operation-import)')], 'deleted': [(21, 'a.下载war包：[cachecloud-web.war](http://47.97.112.178/redis-ecs/cachecloud-web.war)'), (74, '系统已有默认配置，如需更改，请参考 [系统配置说明](../access/config.md)。'), (146, '\tc.通过：等待应用部署成功后，在审批页点击”通过“，就此应用开通成功。用户接入使用可参考：[客户端接入文档](../access/client.md)。'), (156, '\t该功能支持将外部redis实例导入Cachecloud平台进行运维管理。具体操作参考：[应用导入](../../wiki/function/operations#cc1-3.md)')]}"
3,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/mapper/AppDataMigrateStatusDao.xml,AppDataMigrateStatusDao.xml,5,"{'added': [(76, '        <choose>'), (77, '            <when test=""appDataMigrateSearch.migrateId != null and appDataMigrateSearch.migrateId > 0"">'), (78, '                and migrate_id = #{appDataMigrateSearch.migrateId}'), (79, '            </when>'), (80, '        </choose>'), (149, ''), (150, '    <select id=""getByMigrateId"" resultType=""AppDataMigrateStatus"">'), (151, '        select id,'), (152, '        <include refid=""migrate_data_status_fields""/>'), (153, '        from app_data_migrate_status where migrate_id = #{migrateId}'), (154, '    </select>'), (155, '')], 'deleted': []}"
4,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/mapper/AppImportDao.xml,AppImportDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppImportDao"">'), (6, '    <sql id=""columns"">'), (7, '    \tid,app_id,mem_size,source_type,redis_version_name,instance_info,redis_password,status,step,app_build_task_id,migrate_id'), (8, '    </sql>'), (9, ''), (10, '    <select id=""get"" resultType=""com.sohu.cache.entity.AppImport"">'), (11, '        select id,'), (12, '        <include refid=""columns""/>,create_time,update_time'), (13, '        from app_import'), (14, '        where id=#{id}'), (15, '    </select>'), (16, ''), (17, '    <insert id=""save"" parameterType=""AppImport"" keyProperty=""id"" useGeneratedKeys=""true"">'), (18, '        insert into app_import'), (19, '        (<include refid=""columns""/>)'), (20, '        values'), (21, '        (#{id},#{appId},#{memSize},#{sourceType},#{redisVersionName},#{instanceInfo},#{redisPassword},#{status},#{step},#{appBuildTaskId},#{migrateId})'), (22, '    </insert>'), (23, ''), (24, '    <update id=""update"" parameterType=""AppImport"">'), (25, '    \tupdate app_import'), (26, '    \t\tset app_id=#{appId},mem_size=#{memSize},source_type=#{sourceType}, redis_version_name=#{redisVersionName},instance_info=#{instanceInfo}, redis_password=#{redisPassword}, status=#{status}, step=#{step},app_build_task_id=#{appBuildTaskId}, migrate_id=#{migrateId}'), (27, '    \twhere id=#{id}'), (28, '    </update>'), (29, ''), (30, '    <select id=""getAppImports"" resultType=""AppImport"" parameterType=""int"">'), (31, '        select id,'), (32, '        <include refid=""columns""/>,create_time,update_time'), (33, '        from app_import where 1=1'), (34, '        <choose>'), (35, '            <when test=""status != null and status > -1"">'), (36, '                and status = #{status}'), (37, '            </when>'), (38, '        </choose>'), (39, '    </select>'), (40, '</mapper>')], 'deleted': []}"
5,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/spring/spring-quartz.xml,spring-quartz.xml,5,"{'added': [(275, '        <!-- 每小时执行一次 -->'), (276, '        <property name=""cronExpression"" value=""0 0 0/1 ? * *""/>')], 'deleted': [(275, '        <!-- 每天执行一次 -->'), (276, '        <property name=""cronExpression"" value=""0 0 12 * * ?""/>')]}"
6,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/appTool/idle-res.png,idle-res.png,1,"{'added': [], 'deleted': []}"
7,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/appTool/idle.png,idle.png,1,"{'added': [], 'deleted': []}"
8,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/appTool/index.png,index.png,1,"{'added': [], 'deleted': []}"
9,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/appTool/memory-res.png,memory-res.png,1,"{'added': [], 'deleted': []}"
10,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/appTool/memory.png,memory.png,1,"{'added': [], 'deleted': []}"
11,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/appTool/scan-res.png,scan-res.png,1,"{'added': [], 'deleted': []}"
12,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/appTool/scan.png,scan.png,1,"{'added': [], 'deleted': []}"
13,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/appTool/slot-res1.png,slot-res1.png,1,"{'added': [], 'deleted': []}"
14,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/appTool/slot.png,slot.png,1,"{'added': [], 'deleted': []}"
15,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/client/app-analysis-application.png,app-analysis-application.png,5,"{'added': [], 'deleted': []}"
16,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/client/app-daily.png,app-daily.png,1,"{'added': [], 'deleted': []}"
17,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/client/client-instancelist.png,client-instancelist.png,4,"{'added': [], 'deleted': []}"
18,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/client/client-instancelists.png,client-instancelists.png,1,"{'added': [], 'deleted': []}"
19,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/client/client-topology.png,client-topology.png,5,"{'added': [], 'deleted': []}"
20,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/client/instance-connInfo.png,instance-connInfo.png,5,"{'added': [], 'deleted': []}"
21,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/client/instance-latency.png,instance-latency.png,1,"{'added': [], 'deleted': []}"
22,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/client/instance-latency1.png,instance-latency1.png,1,"{'added': [], 'deleted': []}"
23,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/job/appImport.png,appImport.png,1,"{'added': [], 'deleted': []}"
24,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/job/appMigrate.png,appMigrate.png,1,"{'added': [], 'deleted': []}"
25,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/operation/operation-app.png,operation-app.png,1,"{'added': [], 'deleted': []}"
26,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/app-operation-sentinel.png,app-operation-sentinel.png,4,"{'added': [], 'deleted': []}"
27,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/app-operation-sentinel1.png,app-operation-sentinel1.png,1,"{'added': [], 'deleted': []}"
28,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/import-list.png,import-list.png,1,"{'added': [], 'deleted': []}"
29,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/import-step1.png,import-step1.png,1,"{'added': [], 'deleted': []}"
30,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/import-step3.png,import-step3.png,1,"{'added': [], 'deleted': []}"
31,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/import-step3err.png,import-step3err.png,1,"{'added': [], 'deleted': []}"
32,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/import-step4.png,import-step4.png,1,"{'added': [], 'deleted': []}"
33,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/import-step4err.png,import-step4err.png,1,"{'added': [], 'deleted': []}"
34,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/import-step5.png,import-step5.png,1,"{'added': [], 'deleted': []}"
35,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/server-machine-add.png,server-machine-add.png,5,"{'added': [], 'deleted': []}"
36,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/server-machine.png,server-machine.png,5,"{'added': [], 'deleted': []}"
37,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/server-room-add.png,server-room-add.png,1,"{'added': [], 'deleted': []}"
38,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/server-room.png,server-room.png,1,"{'added': [], 'deleted': []}"
39,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/system-alter.png,system-alter.png,1,"{'added': [], 'deleted': []}"
40,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/function/server/topology.png,topology.png,1,"{'added': [], 'deleted': []}"
41,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate1.png,app-migrate1.png,5,"{'added': [], 'deleted': []}"
42,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate2.png,app-migrate2.png,5,"{'added': [], 'deleted': []}"
43,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate3.png,app-migrate3.png,5,"{'added': [], 'deleted': []}"
44,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate4.png,app-migrate4.png,5,"{'added': [], 'deleted': []}"
45,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate5.png,app-migrate5.png,5,"{'added': [], 'deleted': []}"
46,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate6.png,app-migrate6.png,5,"{'added': [], 'deleted': []}"
47,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate7.png,app-migrate7.png,5,"{'added': [], 'deleted': []}"
48,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate8.png,app-migrate8.png,5,"{'added': [], 'deleted': []}"
49,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/operate/index.png,index.png,1,"{'added': [], 'deleted': []}"
50,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/img/readme/CacheCloud-structure.png,CacheCloud-structure.png,1,"{'added': [], 'deleted': []}"
51,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/access/client.md,client.md,5,"{'added': [(1, '# 客户端接入'), (2, '')], 'deleted': []}"
52,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/access/config.md,config.md,5,"{'added': [(1, '## 系统配置说明'), (85, '- redis-migrate-tool安装路径；'), (86, '- redis-shake安装路径；'), (87, '- redis-full-check安装路径。'), (94, '系统配置的初始化值，需要导入2.0.sql(目录:cachecloud-web/sql)中的相关表和数据：')], 'deleted': [(1, '## 系统全局配置说明'), (85, '- nmon安装目录:'), (86, '- redis-migrate-tool安装路径:'), (87, '- redis-shake安装路径:'), (88, '- redis-full-check安装路径:'), (95, '系统配置的初始化值,需要导入2.0.sql(目录:cachecloud-web/sql)中的相关表和数据：')]}"
53,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/access/resource.md,resource.md,5,"{'added': [(16, '<a name=""cc2""/>'), (17, ''), (28, '<a name=""cc3""/>'), (29, ''), (36, '<a name=""cc4""/>'), (37, ''), (44, '<a name=""cc5""/>'), (45, ''), (77, '<a name=""cc6""/>'), (78, '')], 'deleted': []}"
54,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/access/resource.toc.md,resource.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* [一、目的](#cc1)'), (4, '* [二、仓库配置](#cc2)'), (5, '* [三、目录管理](#cc3)'), (6, '* [四、脚本管理](#cc4)'), (7, '* [五、Redis资源管理](#cc5)'), (8, '* [六、迁移工具资源管理](#cc6)')], 'deleted': []}"
55,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/architecture/index.md,index.md,5,"{'added': [(5, '+ 1.[服务架构](service)'), (8, '+ 2.[技术架构](tech)')], 'deleted': [(5, '+ 1.[服务架构](service.md)'), (8, '+ 2.[技术架构](tech.md)')]}"
56,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-analysis.md,client-analysis.md,1,"{'added': [(1, '## 键值分析'), (2, ''), (3, '键值分析主要用来分析应用BigKey/过期键/键值分布等情况。'), (4, ''), (5, '<img src=""../../img/function/client/app-analysis.png"" width=""100%"">'), (6, ''), (7, '点击”键值分析“，提交分析申请。'), (8, ''), (9, '<img src=""../../img/function/client/app-analysis-application.png"" width=""100%"">')], 'deleted': []}"
57,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-appStats.md,client-appStats.md,1,"{'added': [(1, '## 应用统计信息'), (2, ''), (3, '当您的应用开始使用后，您可以按照如下步骤查看应用统计数据和各实例统计数据。'), (4, ''), (5, '### 一、全局统计'), (6, ''), (7, '- 在页面详情页，默认展示应用统计信息，可以看到全局信息、命令统计、各命令峰值信息，全命令统计、命中统计、网络流量等全天统计曲线。按照顺序，'), (8, '  + 全局信息：展示应用的全局信息，包括内存使用率、当前连接数、应用redis版本、应用类型、主从节点数、命中率、当前对象数、当前状态及分布的机器数；'), (9, '  + 命令统计：展示当前应用执行最频繁的5个命令的分布情况；'), (10, '  + 各命令峰值信息：展示当前应用执行最频繁的5个命令的峰值统计；'), (11, '  + 全命令统计：展示当前应用的命令执行次数趋势图；'), (12, '  + 命中统计：展示当前应用的命中次数趋势图；'), (13, '  + 网络流量：展示应用的输入输出流量趋势图，亦可查看应用下各实例的网络输入输出流量；'), (14, '  + CPU消耗：展示应用的CPU消耗情况趋势图，亦可查看应用下各实例的CPU消耗情况趋势；'), (15, '  + 内存使用量：展示应用的内存使用情况趋势图，亦可查看应用下各实例的内存碎片率情况；'), (16, '  + 客户端连接统计：展示该应用下客户端连接数趋势图；'), (17, '  + 键个数统计：展示该应用下键个数趋势图。'), (18, ''), (19, '![](../../img/function/client/client-statsInfo.jpg)'), (20, ''), (21, '![](../../img/function/client/client-statsInfo1.jpg)'), (22, ''), (23, '![](../../img/function/client/client-statsInfo2.jpg)'), (24, ''), (25, '    - 扩容/缩容，在应用统计信息页面，点击申请扩容，弹出如图弹框，按照要求填写对应信息，提交。提交成功后，将收到进度邮件。'), (26, ''), (27, '   ![](../../img/function/client/client-capacity.png)'), (28, ''), (29, '    - 客户端统计'), (30, ''), (31, '- 命令曲线，命令曲线展示了该应用下执行最频繁的5个命令的执行次数趋势比较图，可以点击不同命令查看个命令的趋势图。'), (32, ''), (33, '![](../../img/function/client/client-codeImg.jpg)[]()'), (34, ''), (35, '### 二、客户端统计'), (36, ''), (37, '应用首页查看客户端统计，主要客户命令调用，异常统计情况。'), (38, '某个客户端调用/流量/耗时'), (39, '具体命令调用/流量/耗时'), (40, ''), (41, '<img width=""100%"" src=""../../img/function/client/client-statistic.png""/>'), (42, ''), (43, '- 客户命令调用统计，展示应用下命令调用全局统计情况，包括命令调用次数、命令平均耗时、输入/输出流量趋势。'), (44, ''), (45, '![](../../img/function/client/command-statistic.png)'), (46, '![](../../img/function/client/command-statistic1.png)'), (47, '![](../../img/function/client/command-statistic2.png)'), (48, ''), (49, '**点击“客户端详情”，查看不同客户端下各命令的调用情况。**'), (50, ''), (51, '![](../../img/function/client/command-statistic-client.png)'), (52, ''), (53, ''), (54, '![](../../img/function/client/command-statistic-all.png)'), (55, ''), (56, '- 客户端异常情况统计：展示应用下异常情况全局统计情况，包括异常次数、异常平均耗时趋势。'), (57, ''), (58, '![](../../img/function/client/exception-statistic.png)'), (59, ''), (60, '**异常分为客户端连接异常及命令调用超时异常，可分别点击“客户端连接异常详情”和“客户端命令超时详情”查看不同客户端下对应的异常情况。**'), (61, ''), (62, '**1.客户端连接异常详情**'), (63, ''), (64, '![](../../img/function/client/exception-statistic-client-conn.png)'), (65, ''), (66, '**2.客户端命令超时详情**'), (67, ''), (68, '![](../../img/function/client/exception-statistic-client.png)'), (69, ''), (70, '![](../../img/function/client/exception-statistic-client1.png)'), (71, ''), (72, '    点击图中点查看超时命令详情，包括命令的执行时间，命令明文，参数明文和字节数信息，如下图：'), (73, ''), (74, '![](../../img/function/client/exception-statistic-client-cmd.png)'), (75, ''), (76, '')], 'deleted': []}"
58,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-cmd.md,client-cmd.md,1,"{'added': [(1, '## 命令曲线'), (2, ''), (3, '命令曲线展示了该应用下执行最频繁的5个命令的执行次数趋势比较图，可以点击不同命令查看个命令的趋势图。'), (4, ''), (5, '![](../../img/function/client/client-codeImg.jpg)')], 'deleted': []}"
59,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-cmdexe.md,client-cmdexe.md,1,"{'added': [(1, '## 命令执行'), (2, ''), (3, '在应用或实例页面，点击命令执行，打开命令执行页面，支持在console中执行只读命令。'), (4, ''), (5, '![](../../img/function/client/client-appCmd.png)')], 'deleted': []}"
60,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-conn.md,client-conn.md,1,"{'added': [(1, '## 连接信息'), (2, ''), (3, '支持查看当前客户端连接信息，包括客户端ip、连接数、客户端类型，点击”查看实例连接信息“可查看具体redis实例下的连接信息。'), (4, ''), (5, '<img src=""../../img/function/client/instance-connInfo.png"" width=""100%"">'), (6, ''), (7, '- 应用客户端：该分类下展示用户端连接信息，可通过查看此连接确认是否有用户使用该应用，为应用迁移/下线提供极大便利；'), (8, '- cc客户端：该分类下展示CacheCloud客户端的连接信息；'), (9, '- redis客户端：该分类下展示redis实例连接信息；'), (10, '- 所有客户端：该分类下展示所有客户端连接信息。')], 'deleted': []}"
61,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-daily.md,client-daily.md,1,"{'added': [(1, '## 日报统计'), (2, ''), (3, '日报统计汇总了全天的应用使用情况，分为客户端相关和服务端相关指标统计，帮助用户了解应用的使用情况，发现问题等。'), (4, ''), (5, '<img src=""../../img/function/client/app-daily.png"" width=100%>')], 'deleted': []}"
62,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-desc.md,client-desc.md,1,"{'added': [(1, '## 应用详情&权限管理'), (2, ''), (3, '应用详情可以运维应用详情，配置应用报警，管理应用下的用户。'), (4, ''), (5, '![](../../img/function/client/client-appDetail.png)'), (6, ''), (7, '- 该界面展示应用的基本信息，'), (8, '- 修改应用信息：支持修改应用名、应用描述信息及项目负责人；'), (9, '-  添加用户：负责人有权限为应用添加用户。')], 'deleted': []}"
63,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-instances.md,client-instances.md,1,"{'added': [(1, '## 实例列表&应用拓扑'), (2, ''), (3, '### 一、实例列表'), (4, ''), (5, '- 实例列表，展示应用下各实例的具体情况，可以看到该应用的具体实例分布情况，包括ip、端口，实例状态，角色以及关联实例的id，根据应用类型的不同，可能会有区别。'), (6, ''), (7, '<img src=""../../img/function/client/client-instancelists.png"" width=""100%"">'), (8, ''), (9, ''), (10, '### 二、应用拓扑'), (11, ''), (12, '- 应用拓扑，展示应用实例在各机器上的分布情况。'), (13, ''), (14, '<img src=""../../img/function/client/client-topology.png"" width=""100%"">')], 'deleted': []}"
64,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-latency.md,client-latency.md,1,"{'added': [(1, '## 延迟监控'), (2, ''), (3, '延迟监控统计了应用下发生的”延迟事件“。根据发生事件点，将”延迟事件“和”慢查询命令“对应，更好的辅助用户发现、定位redis的使用问题。'), (4, ''), (5, '![](../../img/function/client/instance-latency.png)'), (6, ''), (7, '- 延迟事件统计：统计了各延迟事件数量的趋势图，点击图中点可查看延迟事件详情，如下图：查看某个时间点下某个redis实例发生的延迟事件，关联的慢查询情况等。'), (8, '![](../../img/function/client/instance-latency1.png)'), (9, ''), (10, '- redis实例延迟&慢查询统计：统计每个redis实例下发生的延迟事件数和慢查询数。'), (11, '- 各实例慢查询情况：展示详细的实例下慢查询情况。'), (12, '')], 'deleted': []}"
65,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client-register.md,client-register.md,1,"{'added': [(1, '## 账户申请'), (2, ''), (3, '用户首次使用CacheCloud执行所有操作之前，用户首先需要申请一个系统账号。当需要开通账户时，填写相关信息。管理员收到申请邮件时确认开通。'), (4, ''), (5, '- 进入CacheCloud首页，点击注册按钮'), (6, ''), (7, '![](../../img/function/client/client-login.png)'), (8, ''), (9, '- 填写用户相关信息并提交申请'), (10, ''), (11, '![](../../img/function/client/client-register.png)')], 'deleted': []}"
66,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client.md,client.md,5,"{'added': [(3, '客户端模块介绍普通用户使用CacheCloud平台功能，包括账户申请、应用管理和我的申请三大模块。'), (5, '- 账户申请：用户首次使用CacheCloud执行所有操作之前，用户首先需要注册一个系统账号；'), (6, '- 应用管理：用户可以查看、管理自己名下的redis应用，包括应用的统计信息、应用详情、实例列表、连接信息、命令曲线、延迟监控和日报统计等；'), (7, '- 我的申请： 用户可以查询、申请对自己名下redis应用的相关操作，保留申请应用、导入应用、数据清理、诊断应用等操作。'), (9, '用户使用CacheCloud平台总体流程如下：'), (11, '![总体使用流程](../../img/function/client/client-process.png)')], 'deleted': [(3, '客户端模块介绍用户使用CacheCloud平台功能，包括客户端接入、应用/实例监控数据曲线展示、shell命令执行平台及报警权限设置等功能。'), (5, '## 一、总体使用流程'), (6, '用户使用CacheCloud平台总体流程如下：'), (7, ''), (8, '![总体使用流程](../../img/function/client/client-process.png)'), (9, ''), (10, '<a name=""cc2""/>'), (11, ''), (12, '## 二、账户申请'), (13, ''), (14, '在执行所有操作之前，用户首先需要申请一个系统账号。当需要开通账户时，填写相关信息，管理员收到申请邮件时确认开通。'), (15, ''), (16, '- 进入CacheCloud首页，点击注册按钮'), (17, ''), (18, '![](../../img/function/client/client-login.png)'), (19, ''), (20, '- 填写用户相关信息'), (21, ''), (22, '![](../../img/function/client/client-register.png)'), (23, ''), (24, '<a name=""cc3""/>'), (25, ''), (26, '## 三、应用申请'), (27, '- 首次登录系统，如下图所示，点击右上角自己的姓名，在弹出的下拉框中选择应用申请。'), (28, ''), (29, '![](../../img/function/client/client-application-tag.png)'), (30, ''), (31, '- 弹出应用申请界面，如下图所示，按要求填写应用需求，提交申请即可。提交申请后，您将收到应用申请的邮件提醒及处理进度。'), (32, ''), (33, '![](../../img/function/client/client-application.png)'), (34, ''), (35, '<a name=""cc4""/>'), (36, ''), (37, '## 四、应用接入Demo'), (38, '- 当您的应用申请流程全部完成后(收到应用已经开通的邮件)，您可以开始使用您的应用。登录系统后，您会看到您申请及负责的应用列表，例如登录后，可以看到一个id为998的应用。如下图所示，点击应用id或应用名，进入应用详情页面。'), (39, ''), (40, '![](../../img/function/client/client-apps.png)'), (41, ''), (42, ''), (43, '- 点击接入代码tab页，如下图所示，查看使用[代码demo](#access)，参考demo代码进行测试和使用。'), (44, ''), (45, '![](../../img/function/client/client-code.png)'), (46, ''), (47, ''), (48, '<a name=""cc5""/>'), (49, ''), (50, '## 五、统计信息'), (51, '当您的应用开始使用后，您可以按照如下步骤查看应用统计数据和各实例统计数据。如第四章中所述，进入应用详情页面后，可以看到应用统计信息、拓扑结构、应用详情、命令分析，命令执行、接入代码、慢查询等。接入代码已经在上一节中做过阐述，本章中，我们将依次查看应用统计信息等其他功能。'), (52, ''), (53, '- 在页面详情页，默认展示应用统计信息，可以看到全局信息、命令统计、各命令峰值信息，全命令统计、命中统计、网络流量等全天统计曲线。按照顺序，'), (54, '  + 全局信息：展示应用的全局信息，包括内存使用率、当前连接数、应用redis版本、应用类型、主从节点数、命中率、当前对象数、当前状态及分布的机器数；'), (55, '  + 命令统计：展示当前应用执行最频繁的5个命令的分布情况；'), (56, '  + 各命令峰值信息：展示当前应用执行最频繁的5个命令的峰值统计；'), (57, '  + 全命令统计：展示当前应用的命令执行次数趋势图；'), (58, '  + 命中统计：展示当前应用的命中次数趋势图；'), (59, '  + 网络流量：展示应用的输入输出流量趋势图，亦可查看应用下各实例的网络输入输出流量；'), (60, '  + CPU消耗：展示应用的CPU消耗情况趋势图，亦可查看应用下各实例的CPU消耗情况趋势；'), (61, '  + 内存使用量：展示应用的内存使用情况趋势图，亦可查看应用下各实例的内存碎片率情况；'), (62, '  + 客户端连接统计：展示该应用下客户端连接数趋势图；'), (63, '  + 键个数统计：展示该应用下键个数趋势图。'), (64, ''), (65, '![](../../img/function/client/client-statsInfo.jpg)'), (66, ''), (67, '![](../../img/function/client/client-statsInfo1.jpg)'), (68, ''), (69, '![](../../img/function/client/client-statsInfo2.jpg)'), (70, ''), (71, '    - 扩容/缩容，在应用统计信息页面，点击申请扩容，弹出如图弹框，按照要求填写对应信息，提交。提交成功后，将收到进度邮件。'), (72, ''), (73, '   ![](../../img/function/client/client-capacity.png)'), (74, ''), (75, '    - 客户端统计'), (76, ''), (77, '- 命令曲线，命令曲线展示了该应用下执行最频繁的5个命令的执行次数趋势比较图，可以点击不同命令查看个命令的趋势图。'), (78, ''), (79, '![](../../img/function/client/client-codeImg.jpg)'), (80, ''), (81, '<a name=""cc6""/>'), (82, ''), (83, '## 六、应用详情、拓扑、扩容/缩容、命令执行'), (84, ''), (85, '在应用详情页面，还剩下实例列表、应用详情、命令执行、应用拓扑页面，本节中将描述这部分功能。'), (86, ''), (87, '- 实例列表，展示应用下各实例的具体情况，可以看到该应用的具体实例分布情况，包括ip、端口，实例状态，角色以及关联实例的id，根据应用类型的不同，可能会有区别。'), (88, ''), (89, '![](../../img/function/client/client-instancelist.png)'), (90, ''), (91, '- 应用拓扑，展示应用实例在各机器上的分布情况。'), (92, ''), (93, '![](../../img/function/client/client-topology.png)'), (94, ''), (95, '- 应用详情，运维应用详情，配置应用报警，管理用户下的用户。'), (96, ''), (97, '![](../../img/function/client/client-appDetail.png)'), (98, ''), (99, '- 接入代码，参考[“应用接入Demo”](#cc4)'), (100, ''), (101, '<a name=""cc7""/>'), (102, ''), (103, '## 七、实例信息查看及配置修改'), (104, ''), (105, '- 实例统计信息：在实例列表界面中，点击实例id可以跳转到实例信息页面，默认展示实例的统计信息，在实例页面可以看到菜单。'), (107, '![](../../img/function/client/instance-stats.png)'), (108, ''), (109, '- 其中拓扑结构，命令曲线，命令执行参考应用相关操作。'), (110, ''), (111, '- 慢查询分析：Redis实例中，可以对慢查询进行查看分析，点击慢查询分析，如下图，可以看到实例的慢查询操作。'), (112, ''), (113, '![](../../img/function/client/instance-slowlog.png)'), (114, ''), (115, '- 配置查询：点击配置查询可以对当前配置信息进行查询，如下图，根据应用需求，可以对配置信息进行修改，点击申请修改配置，如下图，按照要求填写信息，提交后会收到处理进度邮件。'), (116, ''), (117, '![](../../img/function/client/instance-config.png)'), (118, ''), (119, '![](../../img/function/client/instance-configEdit.png)'), (120, ''), (121, '- 连接信息：查看当前客户端连接信息。'), (122, ''), (123, '![](../../img/function/client/instance-connInfo.png)'), (124, ''), (125, '- 故障警报：展示当前实例故障情况。'), (126, ''), (127, '<a name=""cc8""/>'), (128, ''), (129, '## 八、CacheCloud Shell Console'), (130, ''), (131, '在应用或实例页面，点击命令执行，如下图，打开命令执行tab页面，可以在console中执行只读命令。'), (132, ''), (133, '![](../../img/function/client/client-appCmd.png)'), (134, ''), (135, '<a name=""cc9""/>'), (136, ''), (137, '## 九、权限管理及报警阀值设置'), (138, ''), (139, '在应用对应页面，点击应用详情，打开本应用的详情页面，可以看到应用详情，报警指标，用户管理。如下图，'), (140, '- 对应用信息进行修改；'), (141, '- 对需要接收该appId报警信息的人员进行管理；'), (142, '- 对报警指标进行设置和管理。'), (143, ''), (144, '![](../../img/function/client/client-appDetail.png)'), (145, ''), (146, ''), (147, '<a name=""cc10""/>'), (148, ''), (149, '## 十、客户端使用统计'), (150, ''), (151, '应用首页查看客户端统计，主要客户命令调用，异常统计情况。'), (152, '某个客户端调用/流量/耗时'), (153, '具体命令调用/流量/耗时'), (154, ''), (155, '<img width=""100%"" src=""../../img/function/client/client-statistic.png""/>'), (156, ''), (157, '- 客户命令调用统计，展示应用下命令调用全局统计情况，包括命令调用次数、命令平均耗时、输入/输出流量趋势。'), (158, ''), (159, '![](../../img/function/client/command-statistic.png)'), (160, '![](../../img/function/client/command-statistic1.png)'), (161, '![](../../img/function/client/command-statistic2.png)'), (162, ''), (163, '**点击“客户端详情”，查看不同客户端下各命令的调用情况。**'), (164, ''), (165, '![](../../img/function/client/command-statistic-client.png)'), (166, ''), (167, ''), (168, '![](../../img/function/client/command-statistic-all.png)'), (169, ''), (170, '- 客户端异常情况统计：展示应用下异常情况全局统计情况，包括异常次数、异常平均耗时趋势。'), (171, ''), (172, '![](../../img/function/client/exception-statistic.png)'), (173, ''), (174, '**异常分为客户端连接异常及命令调用超时异常，可分别点击“客户端连接异常详情”和“客户端命令超时详情”查看不同客户端下对应的异常情况。**'), (175, ''), (176, '**1.客户端连接异常详情**'), (177, ''), (178, '![](../../img/function/client/exception-statistic-client-conn.png)'), (179, ''), (180, '**2.客户端命令超时详情**'), (181, ''), (182, '![](../../img/function/client/exception-statistic-client.png)'), (183, ''), (184, '![](../../img/function/client/exception-statistic-client1.png)'), (185, ''), (186, '    点击图中点查看超时命令详情，包括命令的执行时间，命令明文，参数明文和字节数信息，如下图：'), (187, ''), (188, '![](../../img/function/client/exception-statistic-client-cmd.png)'), (189, ''), (190, '<a name=""cc11""/>'), (191, ''), (192, '## 十一、应用分析'), (193, ''), (194, '键值分析主要用来分析应用BigKey/过期键/键值分布等情况。'), (195, ''), (196, '![](../../img/function/client/app-analysis.png)'), (198, '![](../../img/function/client/app-analysis-application.png)')]}"
67,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/client.toc.md,client.toc.md,4,"{'added': [], 'deleted': [(1, '##### 目录'), (2, ''), (3, '* [一、总体使用流程](#cc1)'), (4, '* [二、账户申请](#cc2)'), (5, '* [三、应用申请](#cc3)'), (6, '* [四、应用接入demo](#cc4)'), (7, '* [五、统计信息](#cc5)'), (8, '* [六、应用详情查询、扩容](#cc6)'), (9, '* [七、实例信息查看及配置修改](#cc7)'), (10, '* [八、CacheCloud Shell Console](#cc8)'), (11, '* [九、权限管理及报警阀值设置](#cc9)'), (12, '* [<span style=""color:green"">十、客户端使用统计(new)</span>](#cc10)'), (13, '* [<span style=""color:green"">十一、应用分析(new)</span>](#cc11)')]}"
68,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/index.md,index.md,5,"{'added': [(3, '### CacheCloud平台提供以下五个功能模块:'), (10, ''), (11, '根据用户类型可分为：前台-客户端功能（普通用户），后台-运维端功能（管理员）。'), (12, ''), (13, '<img src=""../../img/readme/CacheCloud-structure.png"" width=""100%"">')], 'deleted': [(3, '### 主要功能分以下五个模块:'), (10, '![cachecloud功能架构](cachecloud-web/src/main/resources/static/img/readme/CacheCloud功能架构.png)')]}"
69,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/job.md,job.md,5,"{'added': [(1, '## 我的申请'), (2, 'Cacheloud系统提供完善的工单申请-审批流程。用户可以提交自己名下相关应用的工单申请，由管理员驳回/处理、通过后，一条完整的工单流程执行完毕。'), (3, ''), (4, '### 我的工单'), (5, ''), (14, '### 创建工单'), (15, ''), (16, '- ""创建工单""按不同类型分为：申请应用，应用导入，数据清理（全库清理/删除数据），下线应用，数据迁移，诊断应用，键值分析，扩容/缩容，修改应用配置和修改报警等。'), (21, ''), (22, '    b.导入应用：用户将现有redis实例导入cachecloud平台，进行集中管理。'), (23, ''), (24, '\t<img src=""../../img/function/job/appImport.png"" width=""80%"">'), (26, '    c.数据清理：分为全库清理和删除数据'), (32, '    d.下线应用：'), (35, ''), (36, '    e.数据迁移：将redis数据迁移到新的应用下'), (37, ''), (38, '\t<img src=""../../img/function/job/appMigrate.png"" width=""80%"">'), (40, '    f.诊断应用:'), (44, '    g.键值分析:'), (48, '    h.扩容/缩容:'), (52, '    i.修改应用配置:'), (56, '    g.修改报警:'), (59, '')], 'deleted': [(1, '## 工单流程'), (2, 'Cacheloud系统提供完善的工单申请-审批流程。用户可以提交自己名下相关应用的工单申请，由管理员驳回/处理、通过后，一条完整的工单流程执行完毕。'), (3, '### 1.工单申请'), (12, '- ""创建工单""按不同类型分为：申请应用，数据清理（全库清理/删除数据），下线应用，诊断应用，键值分析，扩容/缩容，修改应用配置和修改报警。'), (18, '    b.数据清理：分为全库清理和删除数据'), (24, '    c.下线应用：'), (28, '    d.诊断应用:'), (32, '    e.键值分析:'), (36, '    f.扩容/缩容:'), (40, '    g.修改应用配置:'), (44, '    h.修改报警:'), (47, ''), (48, ''), (49, '### 2.工单审批'), (50, ''), (51, '- 工单审批界面展示了""工单处理汇总情况""和""审批列表""：'), (52, ''), (53, '   工单状态分为：待审、处理中、通过、驳回，工单受理后显示处理人。'), (54, ''), (55, '   <img src=""../../img/function/job/auditList.png"" width=""100%"">')]}"
70,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-alert.md,operation-alert.md,1,"{'added': [(1, '## 报警配置'), (2, ''), (3, '管理redis报警阈值，支持对应用整体/单个实例进行报警配置。'), (4, ''), (5, '<img width=""100%"" src=""../../img/function/server/cc-alter.png""/>'), (6, ''), (7, '<img width=""100%"" src=""../../img/function/server/cc-alter-special.png""/>'), (8, ''), (9, '<img width=""100%"" src=""../../img/function/server/cc-alter-app.png""/>'), (10, '')], 'deleted': []}"
71,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-app.md,operation-app.md,1,"{'added': [(1, '###### 目录'), (2, '* [1. 应用运维](#cc1)'), (3, '\t- [管理应用实例](#cc1-1)'), (4, '\t- [应用机器列表](#cc1-2)'), (5, '\t- [应用详情和审批列表](#cc1-3)'), (6, '\t- [应用密码修改](#cc1-4)'), (7, '\t- [应用拓扑诊断](#cc1-5)'), (8, '* [2. 应用迁移](#cc2)'), (9, '* [3. 应用下线](#cc3)'), (10, '* [4. 版本升级](#cc4)'), (11, ''), (12, '## 应用运维'), (13, ''), (14, '管理员在应用运维中可查看应用列表，了解各应用的使用情况，如版本、类型、内存详细、碎片率等，并对应用进行一系列的管理操作。'), (15, ''), (16, '<img src=""../../img/function/operation/operation-app.png"" width=""100%"">'), (17, ''), (18, '<a name=""cc1""/>'), (19, '### 应用运维'), (20, '点击”应用运维“操作，可管理应用实例、查看应用机器列表，应用详情和审批列表，修改应用密码等。'), (21, ''), (22, '<a name=""cc1-1""/>'), (23, '#### 管理应用实例'), (24, ''), (25, '**1. Redis Sentinel类型应用**'), (26, ''), (27, 'a. 一键添加sentinel节点'), (28, 'b. 一键Failover'), (29, 'c. 上下线实例'), (30, 'd. 添加slave节点'), (31, 'e. 查看操作日志'), (32, ''), (33, '<img src=""../../img/function/server/app-operation-sentinel1.png"" width=""100%"">'), (34, ''), (35, '<a name=""cc2-1-cluster""/>'), (36, ''), (37, '**2. Redis Cluster应用类型**'), (38, ''), (39, 'a. 添加Slave'), (40, 'b.一键Failover'), (41, 'c.上下线实例'), (42, 'd. 查看操作日志'), (43, ''), (44, '<img src=""../../img/function/server/app-operation-cluster.png"" width=""100%"">'), (45, ''), (46, '<a name=""cc1-2""/>'), (47, '#### 应用机器列表'), (48, ''), (49, '查看该应用分布机器的使用情况，包括内存使用率、已分配内存、cpu使用率等信息。'), (50, ''), (51, '<img src=""../../img/function/server/app-machines.png"" width=""100%"">'), (52, ''), (53, ''), (54, '<a name=""cc1-3""/>'), (55, '#### 应用详情和审批列表'), (56, ''), (57, '<img src=""../../img/function/server/app-detail.png"" width=""100%"">'), (58, ''), (59, '<a name=""cc1-4""/>'), (60, '#### 应用密码修改'), (61, ''), (62, '<img src=""../../img/function/server/app-redisPassword.png"" width=""100%"">'), (63, ''), (64, '<a name=""cc1-5""/>'), (65, '#### 应用拓扑诊断'), (66, ''), (67, '提供对应用拓扑分布规范的检查功能，便于发现问题，做出调整。'), (68, ''), (69, '<img src=""../../img/function/server/topology.png"" width=""100%""/>'), (70, ''), (71, '<a name=""cc2""/>'), (72, '#### 2.应用迁移'), (73, ''), (74, '在CacheCloud后台的“应用运维”页面，选择要进行迁移的应用，点击“应用迁移”。 这种迁移方式不会更换应用的appId，通过主从节点的failover实现，是对客户端无感知迁移。注意：此操作通过failover实现节点切换，仅支持同redis版本/小版本应用的迁移升级。'), (75, ''), (76, '<img src=""../../img/operate/appMigrate/app-migrate0.png"" width=""100%""/>'), (77, ''), (78, '应用迁移整体包含八个主要步骤：'), (79, ''), (80, '+ (1) 应用信息：查看源应用的实例IP，角色和Redis版本等信息，选择迁移的目标机房和迁移机器；'), (81, ''), (82, '<img src=""../../img/operate/appMigrate/app-migrate1.png"" width=""100%""/>'), (83, ''), (84, '+ (2) 应用迁移计划：这一步主要查看节点的变更信息，新增实例（Slave）的IP和端口号，点击继续进行新老Salve节点的替换；'), (85, ''), (86, '<img src=""../../img/operate/appMigrate/app-migrate2.png"" width=""100%""/>'), (87, ''), (88, '+ (3) 新老Salve节点替换: 替换完成之后查看最新实例信息，点击继续，进行主从切换；'), (89, ''), (90, '<img src=""../../img/operate/appMigrate/app-migrate3.png"" width=""100%""/>'), (91, ''), (92, '+ (4) 主从Failover: 完成主从节点切换，点击继续，添加新的Slave；'), (93, ''), (94, '<img src=""../../img/operate/appMigrate/app-migrate4.png"" width=""100%""/>'), (95, ''), (96, '+ (5) 添加Slave: 添加新的Slave；'), (97, ''), (98, '<img src=""../../img/operate/appMigrate/app-migrate5.png"" width=""100%""/>'), (99, ''), (100, '+ (6) 新实例状态检测：检查新实例的连接状态，是否异常，点击继续，下线老的Slave；'), (101, ''), (102, '<img src=""../../img/operate/appMigrate/app-migrate6.png"" width=""100%""/>'), (103, ''), (104, '+ (7) 下线Slave: 下线老的Slave；'), (105, ''), (106, '<img src=""../../img/operate/appMigrate/app-migrate7.png"" width=""100%""/>'), (107, ''), (108, '+ (8) 迁移完成: 完成迁移。'), (109, ''), (110, '<img src=""../../img/operate/appMigrate/app-migrate8.png"" width=""100%""/>'), (111, ''), (112, '<a name=""cc3""/>'), (113, '#### 3.应用下线'), (114, ''), (115, '下线当前应用，销毁所有存活节点。点击“应用下线”，跳转到应用下线任务流，可查看下线情况。'), (116, ''), (117, '<a name=""cc4""/>'), (118, '#### 4.版本升级'), (119, ''), (120, '升级应用的redis版本。详细操作可参考：[运维手册-Redis版本管理.应用版本升级](../access/redisVersion.md)。')], 'deleted': []}"
72,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-diagnostic.md,operation-diagnostic.md,1,"{'added': [(1, '## 应用诊断工具'), (2, ''), (3, '提供给应用诊断的便捷工具，方便管理员排查应用的问题。'), (4, ''), (5, '### redis-cli工具'), (6, ''), (7, '集成redis-cli工具，选择应用和实例，可执行redis-cli命令。'), (8, ''), (9, '<img width=""100%"" src=""../../img/function/appTool/index.png""/>'), (10, ''), (11, '### scan检测'), (12, ''), (13, '提交scan诊断，选择应用、实例等，扫描匹配的key：'), (14, ''), (15, '<img width=""100%"" src=""../../img/function/appTool/scan.png""/>'), (16, ''), (17, '扫描完成后，可查看结果：'), (18, ''), (19, '<img width=""60%"" src=""../../img/function/appTool/scan-res.png""/>'), (20, ''), (21, '### memoryUsed诊断'), (22, ''), (23, '提交memoryUsed诊断，选择应用、实例、内存占用量，扫描出大key：'), (24, ''), (25, '<img width=""100%"" src=""../../img/function/appTool/memory.png""/>'), (26, ''), (27, '执行完成后，可查看结果：'), (28, ''), (29, '<img width=""60%"" src=""../../img/function/appTool/memory-res.png""/>'), (30, ''), (31, '### idlekey诊断'), (32, ''), (33, '提交idlekey诊断，选择应用、实例、空闲天数，扫描出key：'), (34, ''), (35, '<img width=""100%"" src=""../../img/function/appTool/idle.png""/>'), (36, ''), (37, '执行完成后，可查看结果：'), (38, ''), (39, '<img width=""60%"" src=""../../img/function/appTool/idle-res.png""/>'), (40, ''), (41, '### hotkeys/bigkeys/memkeys诊断'), (42, ''), (43, '采样诊断应用的hotkeys/bigkeys/memkeys，并给出统计结果。'), (44, ''), (45, '### 删除任务'), (46, ''), (47, '执行匹配key的删除任务，并统计删除数量。'), (48, ''), (49, '### 集群slot分析'), (50, ''), (51, '提交redis集群的slot分布，选择应用、实例，分析出slot上key分布：'), (52, ''), (53, '<img width=""100%"" src=""../../img/function/appTool/slot.png""/>'), (54, ''), (55, '分析完成后，可查看结果：slot分布和误差较大的slot'), (56, ''), (57, '<img width=""60%"" src=""../../img/function/appTool/slot-res1.png""/>')], 'deleted': []}"
73,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-import.md,operation-import.md,1,"{'added': [(1, '## 应用导入'), (2, ''), (3, '在使用Cachecloud平台前，用户已有自己部署的redis实例，该功能支持将redis实例导入Cachecloud平台进行运维管理。用户提交的“导入应用”工单信息会记录在此，管理员点击“导入”或者""查看""可以追踪redis实例导入应用的情况。'), (4, ''), (5, '<img src=""../../img/function/server/import-list.png"" width=""100%""/>'), (6, ''), (7, '应用导入共5个步骤，引导用户完成redis实例到Cachecloud应用的导入。'), (8, ''), (9, '1. 确认导入配置：应用导入前的准备工作，确认源redis实例信息和目标应用信息无误后，点击“开始导入”。'), (10, '<img src=""../../img/function/server/import-step1.png"" width=""100%""/>'), (11, ''), (12, '2. 创建Redis版本：系统自动检测平台中是否有满足用户需求的版本号，如果没有，会提示“redis-x.x.x存在”，管理员先“【创建版本】”；如果有满足的版本，直接进入下一步“新建应用”。'), (13, ''), (14, '3. 新建应用：管理员“部署应用”。'), (15, '<img src=""../../img/function/server/import-step3.png"" width=""100%""/>'), (16, '系统自动检测应用部署状态，如果部署出错，会提示管理员“【修复】 或 【重新部署】”应用。当应用部署成功，会进行到下一步“数据迁移”。'), (17, '<img src=""../../img/function/server/import-step3err.png"" width=""100%""/>'), (18, ''), (19, '4. 数据迁移：进行源redis实例到目标应用间的数据迁移。'), (20, '<img src=""../../img/function/server/import-step4.png"" width=""100%""/>'), (21, '系统自动检测数据迁移状态，如果迁移出错，会提示管理员“【修复】 或 【重新迁移】”。当应用数据迁移完毕，会跳转到“应用导入完成提示”。'), (22, '<img src=""../../img/function/server/import-step4err.png"" width=""100%""/>'), (23, ''), (24, '5. 应用导入完成：应用导入成功，用户可以通过Cachecloud平台管理该应用，旧的redis实例可做下线处理。'), (25, '<img src=""../../img/function/server/import-step5.png"" width=""100%""/>')], 'deleted': []}"
74,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-job.md,operation-job.md,1,"{'added': [(1, '## 工单审批'), (2, ''), (3, '##### 目录'), (4, ''), (5, '* [1. 工单类型](#cc1-1)'), (6, '* [2. 开通应用](#cc1-2)'), (7, '* [3. 应用导入](#cc1-3)'), (8, '* [4. 扩容申请](#cc1-4)'), (9, '* [5. 数据迁移](#cc1-5)'), (10, '* [6. 数据清理](#cc1-6)'), (11, '* [7. 应用诊断](#cc1-7)'), (12, '* [8. 配置修改申请](#cc1-8)'), (13, '* [9. 注册用户申请](#cc1-9)'), (14, '* [10. 键值分析](#cc1-10)'), (15, ''), (16, ''), (17, ''), (18, 'Cacheloud系统提供完善的工单申请-审批流程。用户可以提交自己名下相关应用的工单申请，由管理员驳回/处理、通过后，一条完整的工单流程执行完毕。'), (19, ''), (20, '工单审批界面展示了""工单处理汇总情况""和""审批列表""，用户提交的申请在此进行审批处理。工单状态分为：待审、处理中、通过、驳回，工单受理后显示处理人。'), (21, ''), (22, '<img src=""../../img/function/job/auditList.png"" width=""100%"">'), (23, ''), (24, '<a name=""cc1-1""/>'), (25, ''), (26, '### 1. 工单类型'), (27, ''), (28, '如下图所示，来自用户的工单有以下几种：'), (29, ''), (30, '+ 应用申请：用户需要申请开通redis standalone、redis sentinel和redis cluster；'), (31, '+ 导入应用：用户将现有redis实例导入cachecloud平台，进行集中管理；'), (32, '+ 应用扩容：用户需要对当前的应用进行内存容量扩容；'), (33, '+  应用数据迁移：新老应用间数据迁移；'), (34, '+  清理数据：删除固定前缀的key；'), (35, '+  应用诊断：诊断应用问题，包括扫描key，诊断bigkey/hotkey等，集群slot分析；'), (36, '+  应用下线：对无用应用进行下线处理，回收资源；'), (37, '+ 应用配置修改：用户希望对当前的redis配置做调整；'), (38, '+ 键值分析：用户申请分析应用BigKey/过期键/键值分布等情况；'), (39, '+ 注册用户申请：管理员只需要开通或驳回就可以了。'), (40, ''), (41, '<a name=""cc1-2""/>'), (42, ''), (43, '### 2. 开通应用'), (44, ''), (45, '\t(1). 不同类型的redis，开通使用不同的格式。'), (46, '\t(2). 一键开通中唯一需要的就是机器的IP。'), (47, '\t添加机器时，要综合考虑，用户提交关于客户端的基本信息：QPS、容量、机房、主从等信息，决定选用的什么配置、什么机房的机器。'), (48, ''), (49, '#### (1) redis-standalone开通'), (50, '- 如下图，按照步骤填选：'), (51, ''), (52, '<img src=""../../img/function/server/server-standalone.png"" width=""100%""/>'), (53, ''), (54, '- 点击自动生成“部署预览”，确认部署信息后，点击“开始部署”：'), (55, ''), (56, '<img src=""../../img/function/server/server-standalone-deploy.png"" width=""100%""/>'), (57, ''), (58, '#### (2) redis-sentinel开通'), (59, ''), (60, '步骤同上'), (61, ''), (62, '![](../../img/function/server/server-sentinel.png)'), (63, ''), (64, '#### (3) redis-cluster开通'), (65, ''), (66, '步骤同上'), (67, ''), (68, '![](../../img/function/server/server-cluster.png)'), (69, ''), (70, '详细操作可参考：[运维手册-应用部署](../../wiki/operate/appDeploy.md)。'), (71, ''), (72, '待应用导入开通，点击”通过“，该工单审批完成。'), (73, ''), (74, '<a name=""cc1-3""/>'), (75, ''), (76, '### 3. 应用导入'), (77, ''), (78, '在使用Cachecloud平台前，用户已有自己部署的redis实例，该功能支持将redis实例导入Cachecloud平台进行运维管理。用户提交的“导入应用”工单信息会记录在此，管理员点击“导入”或者""查看""可以追踪redis实例导入应用的情况。'), (79, ''), (80, '<img src=""../../img/function/server/import-list.png"" width=""100%""/>'), (81, ''), (82, '应用导入共5个步骤，引导用户完成redis实例到Cachecloud应用的导入，具体操作请参考：[运维功能-应用导入](../../wiki/function/operation-import.md)。'), (83, ''), (84, '待应用导入完毕，点击”通过“，该工单审批完成。'), (85, ''), (86, ''), (87, '<a name=""cc1-4""/>'), (88, '### 4. 扩容申请'), (89, ''), (90, '- 垂直扩容'), (91, '在“扩容配置”一栏填写扩容后单实例最大内存即可'), (92, ''), (93, '<img src=""../../img/function/server/server-expand.png"" width=""100%""/>'), (94, ''), (95, '- 水平扩容'), (96, ''), (97, '水平扩容相对麻烦且费时一些，在开通时候管理员尽量根据用户提交的信息(QPS，容量等)，尽量提前预支一些实例，如果还是抗不住，就可做水平扩容。'), (98, ''), (99, 'a. 添加一个redis-cluster节点，格式为masterIp:memSize:slaveIp，并meet到集群中；'), (100, ''), (101, 'b. 迁移slot: 迁移slot速度较慢，CacheCloud支持slot断点续传的功能。'), (102, ''), (103, '<img src=""../../img/function/server/server-expand-hor.png"" width=""100%""/>'), (104, ''), (105, '<a name=""cc1-5""/>'), (106, ''), (107, '### 5. 数据迁移'), (108, ''), (109, '支持redis数据同步工作，点击”审批处理“跳转到数据迁移界面，具体操作请参考：[运维功能-数据迁移](../../wiki/operate/migrateTool.md)。'), (110, '待数据迁移完毕，点击”通过“，该工单审批完成。'), (111, ''), (112, '<a name=""cc1-6""/>'), (113, ''), (114, '### 6. 数据清理'), (115, ''), (116, '待数据清理完毕，点击”通过“，该工单审批完成。'), (117, ''), (118, '<a name=""cc1-7""/>'), (119, ''), (120, '### 7. 应用诊断'), (121, ''), (122, '待应用诊断完毕，点击”通过“，该工单审批完成。'), (123, ''), (124, '<a name=""cc1-8""/>'), (125, ''), (126, '### 8. 配置修改申请'), (127, '填写需要修改的配置项和配置值。'), (128, ''), (129, '<img src=""http://i1.itc.cn/20160125/3084_25e4c289_a9d6_ee95_6fd9_032effce7b8d_1.jpg""  width=""100%""/>'), (130, ''), (131, '<a name=""cc1-9""/>'), (132, ''), (133, '### 9. 键值分析'), (134, '点击“分析”，进行键值分析'), (135, ''), (136, '<img src=""../../img/function/server/key-analysis.png"" width=""100%""/>'), (137, ''), (138, '跳转到键值分析任务流'), (139, ''), (140, '<img src=""../../img/function/server/key-analysis-taskflow.png"" width=""100%""/>'), (141, ''), (142, '<a name=""cc1-10""/>'), (143, ''), (144, '### 10. 注册用户申请'), (145, '直接点击通过或者驳回即可。')], 'deleted': []}"
75,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-machine.md,operation-machine.md,1,"{'added': [(1, '## 机器管理'), (2, ''), (3, '提供对机器机房的管理运维操作。'), (4, ''), (5, '### 机器管理'), (6, ''), (7, '新机器除了要用脚本进行初始化安装CacheCloud的环境以外，还要统一进行管理，CacheCloud后台提供了机器的增删改查功能，还有一些指标的(cpu，网络，负载)监控功能。'), (8, ''), (9, '<img src=""../../img/function/server/server-machine.png"" width=""100%""/>'), (10, ''), (11, '支持批量添加、管理机器。'), (12, ''), (13, '<img src=""../../img/function/server/server-machine-add.png"" width=""60%""/>'), (14, ''), (15, ''), (16, '注：CacheCloud之所以没有提供完整的机器监控功能，是因为各个公司一般都有自己专门的机器运维和监控工具，其中或自己开发或使用像ganglia、nagios等软件搭建。'), (17, ''), (18, '### 机房管理'), (19, ''), (20, '同时支持添加管理机器。'), (21, ''), (22, '<img src=""../../img/function/server/server-room.png"" width=""100%""/>'), (23, ''), (24, '支持批量添加、管理机器。'), (25, ''), (26, '<img src=""../../img/function/server/server-room-add.png"" width=""60%""/>')], 'deleted': []}"
76,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-migrate.md,operation-migrate.md,1,"{'added': [(1, '## 数据迁移'), (2, ''), (3, '”数据迁移“帮助完成应用间的数据迁移、同步功能。'), (4, ''), (5, '### 一、CacheCloud数据迁移工具能做什么？'), (6, ''), (7, 'Cachecloud数据迁移工具支持redis数据同步工作，可以完成如下功能：'), (8, ''), (9, '+ 支持任意两种类型的source和target进行数据迁移，如RDB文件、Redis Standalone、Redis Sentinel、Redis Cluster、CacheCloud应用；'), (10, '+ 迁移过程中，源集群不影响对外提供服务；'), (11, '+ 高效性，多线程并发迁移；'), (12, '+ 迁移过程便捷，流程可视化；'), (13, '+ 集成redis-migrate-tool、redis-shake redis数据同步的工具。'), (14, '+ 数据迁移具有实时性，所以使用合理可以基本保证数据一致性(原理可以参考第二小节)；'), (15, '+ 数据校验功能。'), (16, ''), (17, '<img width=""100%"" src=""../../img/operate/migrate/migratetool.png""/>'), (18, ''), (19, '### 二、CacheCloud数据迁移工具是如何实现的？'), (20, ''), (21, 'CacheCloud数据迁移工具底层使用了redis-migrate-tool和redis-shake两种主流redis数据同步的工具。所以这里有必要对这两种数据迁移工具做简单说明。'), (22, ''), (23, '+ [redis-migrate-tool](https://github.com/vipshop/redis-migrate-tool)'), (24, ''), (25, '    redis-migrate-tool是用c语言开发的Redis数据迁移工具，可以做到在stadalone、sentinel、cluster、rdb(不支持做为target)彼此迁移数据，'), (26, '服务于唯品会公司数千个Redis节点，从数据迁移的准确性、稳定性、高效性等方面都能满足的生产环境的需求。'), (27, '使用文档：[https://github.com/vipshop/redis-migrate-tool](https://github.com/vipshop/redis-migrate-tool)'), (28, ''), (29, '+ [redis-shake](https://github.com/alibaba/RedisShake)'), (30, ''), (31, '    redis-migrate-tool仅支持Redis3-4的迁移，不支持redis5-5/4/3 版本数据同步(rdb文件解析异常)，而且已经不在维护，故升级为阿里云开源的redis-shake工具。'), (32, '    该工具友好地支持2.8-5.0版本的数据同步/解析、恢复、备份，支持多种部署结构迁移场景，后续会支持断点续传、多活等，且由Redis&MongoDB团队持续优化和维护。'), (33, '    使用文档： [https://github.com/alibaba/RedisShake](https://github.com/alibaba/RedisShake)'), (34, ''), (35, ''), (36, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;迁移工具是基于复制的原理，所以是实时迁移的，这点比起redis自带的redis-trib.rb的import 功能要方便很多。'), (37, '故CacheCloud选择它们作为数据迁移的基础组件，通过可视化的方式完成参数配置、节点数据迁移、进度查询、日志查询、配置查询和历史记录等一系列功能，使得数据迁移更简单、便捷。'), (38, ''), (39, '<img width=""100%"" src=""../../img/operate/migrate/cc-migrate-tool.png""/>'), (40, ''), (41, '### 三、CacheCloud数据迁移工具如何部署和使用'), (42, ''), (43, '1. 准备迁移工具机器'), (44, '    + 初始化机器，在“管理后台-机器管理”页面点击“添加新机器”，请参考相关文档；'), (45, '    + 添加机器时候，选择机器类型为“Redis迁移工具机器”，建议单独使用一台机器做迁移，因为迁移的过程可能会占用机器的很多资源。'), (46, '![](../../img/operate/migrate/cc-migrate-machine.png)'), (47, ''), (48, '2. 安装部署redis-migrate-tool/redis-shake'), (49, '    + redis-migrate-tool'), (50, '在“管理后台-系统配置管理”中配置安装目录，'), (51, '![](../../img/operate/migrate/cc-migrate-redis-migtool-dir.png)'), (52, '    安装方法可以参考redis-migrate-tool主页或者按照如下安装:'), (53, '        ```'), (54, '        $ cd /opt/cachecloud/'), (55, '        $ wget https://github.com/vipshop/redis-migrate-tool/archive/master.zip'), (56, '        $ mv master master.zip'), (57, '        $ unzip master.zip'), (58, '        $ mv redis-migrate-tool-master redis-migrate-tool'), (59, '        $ cd redis-migrate-tool'), (60, '        $ mkdir data'), (61, '        $ autoreconf -fvi'), (62, '        $ ./configure'), (63, '        $ make'), (64, '        $ src/redis-migrate-tool -h'), (65, '        ```'), (66, '      最为重要的一步是, 注意这里的cachecloud-open是ssh的用户名'), (67, '      ```'), (68, '      $ chown -R ${cachecloud-ssh-username}.${cachecloud-ssh-username} /opt/cachecloud/redis-migrate-tool'), (69, '      ```'), (70, '    + redis-shake'), (71, '    在“管理后台-系统配置管理”中配置安装目录：'), (72, '    ![](../../img/operate/migrate/cc-migrate-redis-shake-dir.png)'), (73, '    安装方法可以参考redis-shake主页或者按照如下安装：'), (74, '        ```'), (75, '        1.下载redis-shake安装包，下载地址 https://github.com/alibaba/RedisShake/releases'), (76, '        2.解压到/opt/cachecloud/redis-shake目录下'), (77, '        3.创建文件夹conf（存放配置文件）、 logs（存放日志）和pid（存放进程信息）'), (78, '        4.下载redis-full-check安装包，下载地址 https://github.com/alibaba/RedisFullCheck/releases'), (79, '        5.解压到/opt/cachecloud/redis-full-shake目录下'), (80, '        6.创建文件夹data（存放比对数据结果）'), (81, '        ```'), (82, '3. 添加迁移任务'), (83, '    a. 点击“迁移数据工具”进入迁移数据记录列表页面。'), (84, '    <img width=""100%"" src=""../../img/operate/migrate/cc-enter-migtool.png""/>'), (85, '    b. 在移数据记录列表中可以查看历史迁移任务信息，任务的配置文件、迁移状态、迁移日志，停止任务，进行数据校验等运维操作。'), (86, '    <img width=""100%"" src=""../../img/operate/migrate/cc-migrate-tasklist.png""/>'), (87, '    c. 点击“点击添加新的迁移按钮”，选择迁移工具，迁移机器，配置源和目标信息，点击验证按钮，按照通过后就开启了一个迁移的任务，回到迁移列表，就可以观察迁移日志、关闭迁移任务、迁移状态查询等。'), (88, '    <img width=""100%"" src=""../../img/operate/migrate/cc-migrate-addtask.png""/>'), (89, ''), (90, '4. 数据校验'), (91, '  - 数据迁移完毕后，点击“数据校验”按钮，跳转到如下界面，说明校验程序已经启动：'), (92, '    <img width=""100%"" src=""../../img/operate/migrate/cc-migrate-start-check.png""/>'), (93, '  - 可通过点击“校验日志”，查看log（默认log 5s刷新）：'), (94, '    <img width=""100%"" src=""../../img/operate/migrate/cc-migrate-checklog.png""/>'), (95, '  - 查看数据校验结果'), (96, '    校验数据报错在校验机器的/opt/cachecloud/redis-full-check/data目录下：'), (97, '    ![](../../img/operate/migrate/cc-migrate-checkres.png)'), (98, '    查看不一致结果记录到result文件：'), (99, '    ![](../../img/operate/migrate/cc-migrate-checkres2.png)'), (100, ''), (101, '### 四、客户端怎么迁移'), (102, '1. 当迁移工作基本完成后，我们就需要迁移客户端了，为了方便演示我们假设只有两个客户端。'), (103, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client1.png""/>'), (104, '2. 迁移第一个客户端，观察客户端是否出现异常。'), (105, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client2.png""/>'), (106, '3. 迁移第二个客户端，继续观察。'), (107, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client3.png""/>'), (108, '4. 检查source应用是否还有调用。'), (109, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client4.png""/>'), (110, '5. 下线source应用和迁移工具。'), (111, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client5.png""/>'), (112, ''), (113, '### 五、一些建议'), (114, '- 尽可能单独找一台机器作为迁移机器，因为迁移的过程可能会占用机器的很多资源；'), (115, '- redis-migrate-tool/redis-shake很具体的原理问题和细节可以到社区或CacheCloud群里找作者提问；'), (116, '- redis-shake使用或迁移日志中的问题可以参考：'), (117, '    [https://github.com/alibaba/RedisShake/wiki/FAQ](https://github.com/alibaba/RedisShake/wiki/FAQ)'), (118, '    [https://github.com/alibaba/RedisShake/issues](https://github.com/alibaba/RedisShake/issues)'), (119, '- 迁移工具页面还有很多要优化的地方，后期会听取大家意见逐渐改善。'), (120, '')], 'deleted': []}"
77,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-resource.md,operation-resource.md,1,"{'added': [(1, '## 系统资源管理'), (2, ''), (3, '##### 目录'), (4, ''), (5, '* [一、目的](#cc1)'), (6, '* [二、仓库配置](#cc2)'), (7, '* [三、目录管理](#cc3)'), (8, '* [四、脚本管理](#cc4)'), (9, '* [五、Redis资源管理](#cc5)'), (10, '* [六、迁移工具资源管理](#cc6)'), (11, ''), (12, ''), (13, '<a name=""cc1""/>'), (14, ''), (15, '### 一、目的'), (16, ''), (17, 'CacheCloud系统需要依赖一些脚本，Redis资源包，迁移工具，公钥/私钥等资源，由于比较零碎，此项功能用于对资源及其版本同一管理控制，简化运维提升效率。'), (18, '主要分以下几大类：'), (19, ''), (20, '- 仓库配置：配置资源的仓库地址，可用于推送和下载资源；'), (21, '- 目录管理：区分各类资源的目录结构，便于管理资源；'), (22, '- 脚本管理：管理系统依赖资源的脚本；'), (23, '- Redis资源管理： 管理redis资源包不同版本及推送下载；'), (24, '- 迁移工具资源管理：管理迁移工具不同资源包版本及推送下载；'), (25, ''), (26, '<a name=""cc2""/>'), (27, ''), (28, '### 二、仓库配置'), (29, ''), (30, '<img src=""../../img/operate/version/respo.png"" width=""100%""/>'), (31, ''), (32, '远程仓库地址：可访问的仓库ip地址；例如:10.%.%.%'), (33, ''), (34, '根目录：仓库资源的根目录；例如:/opt/download/software/cachecloud/resource'), (35, ''), (36, '资源下载地址：可访问资源地址；例如:http://%.%.sohuno.com/software/cachecloud/resource'), (37, ''), (38, '<a name=""cc3""/>'), (39, ''), (40, '### 三、目录管理'), (41, ''), (42, '<img src=""../../img/operate/version/dir.png"" width=""100%""/>'), (43, ''), (44, '对不同类型资源创建不同目录，需要做推送后及在远程仓库创建对应资源目录(格式:/${dir})；'), (45, ''), (46, '<a name=""cc4""/>'), (47, ''), (48, '### 四、脚本管理'), (49, ''), (50, '<img src=""../../img/operate/version/script.png"" width=""100%""/>'), (51, ''), (52, '对系统依赖脚本进行版本管理，可在编译内容和推送脚本到仓库上；'), (53, ''), (54, '<a name=""cc5""/>'), (55, ''), (56, '### 五、Redis资源管理'), (57, ''), (58, '<img src=""../../img/operate/version/redis.png"" width=""100%""/>'), (59, ''), (60, 'Redis资源管理支持对Redis大小版本做统一管理和版本控制(3.0.x -> 3.2.x -> 4.0.x -> 5.0.x -> 6.0.0-rc)的不断迭代更新，项目也需要用到不同版本和新特性。'), (61, ''), (62, '#### 5.1.新增资源包'), (63, ''), (64, '- 1).Redis版本格式规范，验证格式：redis-主.子.增量版本'), (65, '- 2).安装目录规范：/opt/cachecloud/redis-主.子.增量版本'), (66, '- 3).是否备份：可直接继承之前版本配置模板，进行增量修改配置'), (67, ''), (68, '#### 5.2.修改配置'), (69, ''), (70, '点击`修改配置`，可新增配置项：'), (71, ''), (72, '<img src=""../../img/operate/version/versionConfig.png"" width=""60%""/>'), (73, ''), (74, '#### 5.3、应用版本升级'), (75, ''), (76, '只支持小版本增量升级(Redis-3.2.x/Redis-4.0.x/Redis-5.0.x):'), (77, '例如:Redis-5.0.6 升级到 Redis-5.0.7'), (78, ''), (79, '<img src=""../../img/operate/version/upgrade.png"" width=""100%""/>'), (80, ''), (81, '点击`版本升级`，可升级当前应用版本:'), (82, ''), (83, '<img src=""../../img/operate/version/upgrade-process.png"" width=""60%""/>'), (84, ''), (85, '升级完后，若为升级版本5.0.7为当前管理的最终小版本号，则应用按钮会显示为`最新版本`。'), (86, ''), (87, '<a name=""cc6""/>'), (88, ''), (89, '### 六、迁移工具资源管理'), (90, ''), (91, '<img src=""../../img/operate/version/tool.png"" width=""100%""/>'), (92, ''), (93, '对系统迁移工具版本管理，方便对资源的可控和管理；')], 'deleted': []}"
78,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-schedule.md,operation-schedule.md,1,"{'added': [(1, '## 调度任务'), (2, ''), (3, '对CacheCloud平台的定时任务进行管理，可开启/暂停/删除某个定时任务。'), (4, ''), (5, '<img width=""100%"" src=""../../img/function/server/cc-trigger.png""/>')], 'deleted': []}"
79,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-systemalert.md,operation-systemalert.md,1,"{'added': [(1, '## 系统配置管理'), (2, ''), (3, '对CacheCloud平台的基本配置信息进行管理。具体配置模板信息如下：'), (4, ''), (5, '<img width=""100%"" src=""../../img/function/server/cc-redisConfiguration.png""/>')], 'deleted': []}"
80,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-task.md,operation-task.md,1,"{'added': [(1, '## Redis任务流管理'), (2, ''), (3, 'CacheCloud平台引入任务流机制，将用户操作提交为异步任务，复杂任务拆分为多个子任务，每个子任务又按照步骤依次执行，每个任务/步骤直接是相互独立，可查看任务关系、任务信息、执行状态、运行日志等信息。'), (4, ''), (5, '<img width=""100%"" src=""../../img/function/server/taskmanage.png""/>'), (6, ''), (7, '- 下面以“RedisClusterAppDeployTask”任务为例进行使用讲解。'), (8, ''), (9, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy.png""/>'), (10, ''), (11, '1. 管理员提交“redis-cluster开通”任务（参考[应用运维-Redis Cluster](#cc2-1-cluster)）；'), (12, '2. 系统自动生成“RedisClusterAppDeployTask”*（部署redis-cluster应用）父任务及多个“RedisServerInstallTask”（在机器上安装redis server）子任务，可查看各任务的基本信息、状态、进度等信息；'), (13, '3. 点击“执行步骤”可查看任务的具体执行步骤，包括任务的基本信息（各种参数），任务流/步骤列表，任务详细日志（帮助问题排查）；'), (14, '4. 对运行中的任务可以暂停，对暂停/失败的任务亦可提交“重试任务”。'), (15, ''), (16, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy-detail1.png""/>'), (17, ''), (18, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy-detail2.png""/>'), (19, ''), (20, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy-detail3.png""/>'), (21, ''), (22, '<img width=""100%"" src=""../../img/function/server/cc-taskflow.png""/>')], 'deleted': []}"
81,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-template.md,operation-template.md,1,"{'added': [(1, '## Redis配置模板管理'), (2, ''), (3, '此功能是Redis全局配置模板(每次开启应用时用到)，并非用于修改线上配置。可对redis的不同版本不同配置项进行增删改查操作，请谨慎修改。'), (4, ''), (5, '<img width=""100%"" src=""../../img/function/server/cc-configuration.png""/>')], 'deleted': []}"
82,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operation-user.md,operation-user.md,1,"{'added': [(1, '## 用户管理'), (2, ''), (3, '管理CacheCloud平台用户信息。'), (4, ''), (5, '<img src=""../../img/function/server/cc-user.png"" width=""100%""/>')], 'deleted': []}"
83,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operations.md,operations.md,5,"{'added': [(1, 'CacheCloud除了有面向用户的界面，还有面向管理员的运维界面，帮助管理员做一些如工单处理、日常运维管理等工作。'), (2, '按照功能可分为一下六大块功能：'), (3, ''), (4, '- 数据统计'), (5, '- 运维功能'), (6, '- 配置管理'), (7, '- 任务管理'), (8, '- 用户管理'), (9, '- 系统通知')], 'deleted': [(1, ''), (2, ''), (3, ''), (4, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CacheCloud除了有面向用户的界面，还有面向管理员的运维界面，帮助管理员做一些如工单处理、日常运维管理等工作。'), (5, ''), (6, ''), (7, '<a name=""cc1""/>'), (8, ''), (9, '## 一、用户工单运维'), (10, ''), (11, '<a name=""cc1-1""/>'), (12, ''), (13, '### 1. 工单类型'), (14, ''), (15, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如下图所示，来自用户的工单有以下几种：'), (16, ''), (17, '+ 应用申请：用户需要申请开通redis standalone、redis sentinel和redis cluster；'), (18, '+ 应用扩容：用户需要对当前的应用进行内存容量扩容；'), (19, '+ 应用配置修改：用户希望对当前的redis配置做调整；'), (20, '+ 键值分析：用户申请分析应用BigKey/过期键/键值分布等情况；'), (21, '+ 注册用户申请：管理员只需要开通或驳回就可以了。'), (22, ''), (23, '<img src=""../../img/function/server/server-operation.png"" width=""100%""/>'), (24, ''), (25, '<a name=""cc1-2""/>'), (26, ''), (27, '### 2. 开通应用'), (28, '\t(1). 不同类型的redis，开通使用不同的格式。'), (29, '\t(2). 一键开通中唯一需要的就是机器的IP。'), (30, '\t添加机器时，要综合考虑，用户提交关于客户端的基本信息：QPS、容量、机房、主从等信息，决定选用的什么配置、什么机房的机器。'), (31, ''), (32, '#### (1) redis-standalone开通'), (33, '- 如下图，按照步骤填选：'), (34, ''), (35, '<img src=""../../img/function/server/server-standalone.png"" width=""100%""/>'), (36, ''), (37, '- 点击自动生成“部署预览”，确认部署信息后，点击“开始部署”：'), (38, ''), (39, '<img src=""../../img/function/server/server-standalone-deploy.png"" width=""100%""/>'), (40, ''), (41, '#### (2) redis-sentinel开通'), (42, ''), (43, '步骤同上'), (44, ''), (45, '![](../../img/function/server/server-sentinel.png)'), (46, ''), (47, '#### (3) redis-cluster开通'), (48, ''), (49, '步骤同上'), (50, ''), (51, '![](../../img/function/server/server-cluster.png)'), (52, ''), (53, '详细操作可参考：[运维手册-应用部署](../../wiki/operate/appDeploy.md)。'), (54, ''), (55, '<a name=""cc1-3""/>'), (56, ''), (57, '### 3. 扩容申请'), (58, '- 垂直扩容'), (59, '在“扩容配置”一栏填写扩容后单实例最大内存即可'), (60, ''), (61, '<img src=""../../img/function/server/server-expand.png"" width=""100%""/>'), (62, ''), (63, '- 水平扩容'), (64, ''), (65, '水平扩容相对麻烦且费时一些，在开通时候管理员尽量根据用户提交的信息(QPS，容量等)，尽量提前预支一些实例，如果还是抗不住，就可做水平扩容。'), (66, ''), (67, 'a. 添加一个redis-cluster节点，格式为masterIp:memSize:slaveIp，并meet到集群中；'), (68, ''), (69, 'b. 迁移slot: 迁移slot速度较慢，CacheCloud支持slot断点续传的功能。'), (70, ''), (71, '<img src=""../../img/function/server/server-expand-hor.png"" width=""100%""/>'), (72, ''), (73, '<a name=""cc1-4""/>'), (74, ''), (75, '### 4. 配置修改申请'), (76, '填写需要修改的配置项和配置值。'), (77, ''), (78, '<img src=""http://i1.itc.cn/20160125/3084_25e4c289_a9d6_ee95_6fd9_032effce7b8d_1.jpg""  width=""100%""/>'), (79, ''), (80, '<a name=""cc1-5""/>'), (81, ''), (82, '### 5. 键值分析'), (83, '点击“分析”，进行键值分析'), (84, ''), (85, '<img src=""../../img/function/server/key-analysis.png"" width=""100%""/>'), (86, ''), (87, '跳转到键值分析任务流'), (88, ''), (89, '<img src=""../../img/function/server/key-analysis-taskflow.png"" width=""100%""/>'), (90, ''), (91, '<a name=""cc1-6""/>'), (92, ''), (93, '### 6. 注册用户申请'), (94, '直接点击通过或者驳回即可。'), (95, ''), (96, '<a name=""cc2""/>'), (97, ''), (98, '## 二、管理员运维'), (99, ''), (100, '<img src=""../../img/function/server/server-operate.png"" width=""100%""/>'), (101, ''), (102, '<a name=""cc2-1""/>'), (103, ''), (104, '### 1. 应用运维'), (105, ''), (106, '在应用运维中可管理应用实例，查看应用机器列表，应用详情和审批列表，修改应用密码，并提供了应用诊断工具。'), (107, ''), (108, '- 管理应用实例'), (109, ''), (110, '**Redis Sentinel**'), (111, ''), (112, 'a. 一键添加sentinel节点'), (113, 'b. 一键Failover'), (114, 'c. 上下线实例'), (115, 'd. 添加slave节点'), (116, 'e. 查看操作日志'), (117, ''), (118, '![](../../img/function/server/app-operation-sentinel.png)'), (119, ''), (120, '<a name=""cc2-1-cluster""/>'), (121, ''), (122, '**Redis Cluster**'), (123, ''), (124, 'a. 添加Slave'), (125, 'b.一键Failover'), (126, 'c.上下线实例'), (127, 'd. 查看操作日志'), (128, ''), (129, '![](../../img/function/server/app-operation-cluster.png)'), (130, ''), (131, '- 应用机器列表'), (132, ''), (133, '查看该应用分布机器的使用情况，包括内存使用率、已分配内存、cpu使用率等信息。'), (134, ''), (135, '![](../../img/function/server/app-machines.png)'), (136, ''), (137, '- 应用详情和审批列表'), (138, ''), (139, '![](../../img/function/server/app-detail.png)'), (140, ''), (141, '- 应用密码修改'), (142, ''), (143, '![](../../img/function/server/app-redisPassword.png)'), (144, ''), (145, '- 应用诊断工具'), (146, ''), (147, '目前提供对应用拓扑规范检查的功能，提交任务流处理。'), (148, ''), (149, '![](../../img/function/server/app-topologyExam.png)'), (150, ''), (151, ''), (152, '<a name=""cc2-2""/>'), (153, ''), (154, '### 2. 应用迁移'), (155, ''), (156, '应用一键迁移，对当前应用所有节点进行failover，迁移到其他机器。详细操作可参考：[运维手册-应用迁移](../../wiki/operate/appMigrate.md)。'), (157, ''), (158, '![](../../img/function/server/app-migrate.png)'), (159, ''), (160, '<a name=""cc2-3""/>'), (161, ''), (162, '### 3. 应用下线'), (163, ''), (164, '下线当前应用，销毁所有存活节点。点击“应用下线”，跳转到应用下线任务流，可查看下线情况。'), (165, ''), (166, '<a name=""cc2-4""/>'), (167, ''), (168, '### 4. Redis版本更新'), (169, ''), (170, '升级应用的redis版本。详细操作可参考：[运维手册-Redis版本管理.应用版本升级](../access/redisVersion.md)。'), (171, ''), (172, '<a name=""cc3""/>'), (173, ''), (174, '## 三、 机器管理'), (175, '新机器除了要用脚本进行初始化安装CacheCloud的环境以外，还要统一进行管理，CacheCloud后台提供了机器的增删改查功能，还有一些简单的(cpu，网络，负载)监控功能。'), (176, ''), (177, 'CacheCloud之所以没有提供完整的机器监控功能，是因为各个公司一般都有自己专门的机器运维和监控工具，其中或自己开发或使用像ganglia、nagios等软件搭建。'), (178, ''), (179, '<img src=""../../img/function/server/server-machine.png"" width=""100%""/>'), (180, ''), (181, '![](../../img/function/server/server-machine-add.png)'), (182, ''), (183, '<a name=""cc4""/>'), (184, ''), (185, '## 四、 用户管理'), (186, ''), (187, '管理CacheCloud平台用户信息。'), (188, ''), (189, '<img src=""../../img/function/server/cc-user.png"" width=""100%""/>'), (190, ''), (191, '<a name=""cc5""/>'), (192, ''), (193, '## 五、Redis版本管理'), (194, ''), (195, '统一管理redis版本，提供查看安装各redis版本的机器信息，修改版本信息，一键安装等功能。'), (196, '详细操作可参考：[运维手册-版本管理](../access/redisVersion.md)。'), (197, ''), (198, '<img width=""100%"" src=""../../img/function/server/redisversion.png""/>'), (199, ''), (200, '<a name=""cc6""/>'), (201, ''), (202, '## 六、Redis任务流管理'), (203, ''), (204, 'CacheCloud平台引入任务流机制，将用户操作提交为异步任务，复杂任务拆分为多个子任务，每个子任务又按照步骤依次执行，每个任务/步骤直接是相互独立，可查看任务关系、任务信息、执行状态、运行日志等信息。'), (205, ''), (206, '<img width=""100%"" src=""../../img/function/server/taskmanage.png""/>'), (207, ''), (208, '- 下面以“RedisClusterAppDeployTask”任务为例进行使用讲解。'), (209, ''), (210, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy.png""/>'), (211, ''), (212, '1. 管理员提交“redis-cluster开通”任务（参考[应用运维-Redis Cluster](#cc2-1-cluster)）；'), (213, '2. 系统自动生成“RedisClusterAppDeployTask”*（部署redis-cluster应用）父任务及多个“RedisServerInstallTask”（在机器上安装redis server）子任务，可查看各任务的基本信息、状态、进度等信息；'), (214, '3. 点击“执行步骤”可查看任务的具体执行步骤，包括任务的基本信息（各种参数），任务流/步骤列表，任务详细日志（帮助问题排查）；'), (215, '4. 对运行中的任务可以暂停，对暂停/失败的任务亦可提交“重试任务”。'), (216, ''), (217, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy-detail1.png""/>'), (218, ''), (219, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy-detail1.png""/>'), (220, ''), (221, '<img width=""100%"" src="".../../img/function/server/cc-taskflow-appDeplogy-detail3.png""/>'), (222, ''), (223, '<img width=""100%"" src=""../../img/function/server/cc-taskflow.png""/>'), (224, ''), (225, ''), (226, '<a name=""cc7""/>'), (227, ''), (228, '## 七、Redis报警阈值管理'), (229, ''), (230, '管理redis报警阈值，支持对应用整体/单个实例进行报警配置。'), (231, ''), (232, '<img width=""100%"" src=""../../img/function/server/cc-alter.png""/>'), (233, ''), (234, '<img width=""100%"" src=""../../img/function/server/cc-alter-special.png""/>'), (235, ''), (236, '![](../../img/function/server/cc-alter-app.png)'), (237, ''), (238, '<a name=""cc8""/>'), (239, ''), (240, '## 八、Redis配置模板管理'), (241, ''), (242, '此功能是Redis全局配置模板(每次开启应用时用到)，并非用于修改线上配置。可对redis的不同版本不同配置项进行增删改查操作，请谨慎修改。'), (243, ''), (244, '<img width=""100%"" src=""../../img/function/server/cc-configuration.png""/>'), (245, ''), (246, ''), (247, '<a name=""cc9""/>'), (248, ''), (249, '## 九、调度任务'), (250, ''), (251, '对CacheCloud平台的定时任务进行管理，可开启/暂停/删除某个定时任务。'), (252, ''), (253, '<img width=""100%"" src=""../../img/function/server/cc-trigger.png""/>'), (254, ''), (255, '<a name=""cc10""/>'), (256, ''), (257, '## 十、系统配置管理'), (258, ''), (259, '对CacheCloud平台的基本配置信息进行管理。具体配置模板信息如下：'), (260, ''), (261, '<img width=""100%"" src=""../../img/function/server/cc-redisConfiguration.png""/>'), (262, ''), (263, '-----')]}"
84,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/operations.toc.md,operations.toc.md,4,"{'added': [], 'deleted': [(1, '##### 目录'), (2, ''), (3, '* [一、用户工单运维](#cc1)'), (4, '    * [1. 工单类型](#cc1-1)'), (5, '    * [2. 开通应用](#cc1-2)'), (6, '    * [3. 扩容申请](#cc1-3)'), (7, '    * [4. 配置修改申请](#cc1-4)'), (8, '    * [5. 注册用户申请](#cc1-5)'), (9, '    * [5. 键值分析](#cc1-6)'), (10, '* [二、管理员运维](#cc2)'), (11, '    * [1. 应用运维](#cc2-1)'), (12, '    * [2. 应用迁移](#cc2-2)'), (13, '    * [3. 应用下线](#cc2-3)'), (14, '    * [4. Redis版本更新](#cc2-4)'), (15, '* [三、机器管理](#cc3)'), (16, '* [四、用户管理](#cc4)'), (17, '* [<span style=""color:green"">五、Redis版本管理(new)</span>](#cc5)'), (18, '* [<span style=""color:green"">六、Redis任务流管理(new)</span>](#cc6)'), (19, '* [七、Redis报警阈值管理](#cc7)'), (20, '* [八、Redis配置模板管理](#cc8)'), (21, '* [九、调度任务](#cc9)'), (22, '* [十、系统配置管理](#cc10)')]}"
85,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/statistics.md,statistics.md,5,"{'added': [(2, '## 服务端全局统计')], 'deleted': [(2, '## 一、服务端全局统计')]}"
86,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/function/system-alert.md,system-alert.md,1,"{'added': [(1, '## 系统通知'), (2, ''), (3, '支持发布CacheCloud平台系统通知。'), (4, ''), (5, '<img src=""../../img/function/server/system-alter.png"" width=""100%""/>')], 'deleted': []}"
87,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/intro/index.md,index.md,5,"{'added': [(3, '* [二、CacheCloud快速接入](#cc2)'), (4, '* [三、CacheCloud功能架构](#cc3)'), (5, '* [四、CacheCloud使用规模](#cc4)'), (6, '* [五、阿里云ecs试用版本](#cc5)'), (14, 'CacheCloud是一个Redis云管理平台：支持Redis多种架构(Standalone、Sentinel、Cluster)高效管理，有效降低大规模redis运维成本，提升资源管控能力和利用率。平台提供redis快速搭建、迁移，运维管理，弹性伸缩，统计监控，客户端整合接入等功能。'), (15, ''), (19, '## 二、CacheCloud快速接入'), (20, ''), (21, '+ [快速开始](../../wiki/quickstart/index.md)'), (22, '+ [客户端接入](../../wiki/access/client.md)'), (23, ''), (24, '<a name=""cc3""/>'), (25, '## 三、CacheCloud功能架构'), (35, '<a name=""cc4""/>'), (36, '## 四、CacheCloud使用规模'), (43, '<a name=""cc5""/>'), (44, '## 五、阿里云ecs试用版本')], 'deleted': [(3, '* [二、CacheCloud功能架构](#cc2)'), (4, '* [三、CacheCloud使用规模](#cc3)'), (5, '* [四、阿里云ecs试用版本](#cc4)'), (6, '* [五、FAQ快速接入](#cc5)'), (14, 'CacheCloud是一个Redis云管理平台：支持Redis多种架构(Standalone、Sentinel、Cluster)高效管理、有效降低大规模redis运维成本，提升资源管控能力和利用率。平台提供快速搭建/迁移，运维管理，弹性伸缩，统计监控，客户端整合接入等功能。'), (18, '## 二、CacheCloud功能架构'), (28, '<a name=""cc3""/>'), (29, '## 三、CacheCloud使用规模'), (36, '<a name=""cc4""/>'), (37, '## 四、阿里云ecs试用版本'), (43, '<a name=""cc5""/>'), (44, '## 五、FAQ快速接入'), (45, ''), (46, '+ [快速开始](../../wiki/quickstart/index.md)'), (47, '+ [客户端接入](../../wiki/access/client.md)'), (48, '')]}"
88,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/operate/appUpgrade.md,appUpgrade.md,1,"{'added': [(1, '## 应用升级'), (2, ''), (3, '应用升级即对应用的redis版本进行升级，小版本和大版本采取不同升级方式。'), (4, ''), (5, '### 1. 应用小版本升级'), (6, ''), (7, '使用“应用迁移工具”，逐步替换节点。'), (8, ''), (9, '#### 1）进入CacheCloud后台'), (10, ''), (11, '在CacheCloud后台的“应用运维”页面，选择要进行迁移的应用，点击“应用迁移”。 这种迁移方式不会更换应用的appId，通过主从节点的failover实现，是对客户端无感知迁移。'), (12, ''), (13, '<img src=""../../img/operate/appMigrate/app-migrate0.png"" width=""100%""/>'), (14, ''), (15, ''), (16, '#### 2）使用迁移工具进行迁移'), (17, ''), (18, '应用迁移整体包含八个主要步骤，具体可参考：[应用迁移文档](../../wiki/function/operation-app#cc2)'), (19, ''), (20, '+ (1) 应用信息：查看源应用的实例IP，角色和Redis版本等信息，选择迁移的目标机房和迁移机器；'), (21, '+ (2) 应用迁移计划：这一步主要查看节点的变更信息，新增实例（Slave）的IP和端口号，点击继续进行新老Salve节点的替换；'), (22, '+ (3) 新老Salve节点替换: 替换完成之后查看最新实例信息，点击继续，进行主从切换；'), (23, '+ (4) 主从Failover: 完成主从节点切换，点击继续，添加新的Slave；'), (24, '+ (5) 添加Slave: 添加新的Slave；'), (25, '+ (6) 新实例状态检测：检查新实例的连接状态，是否异常，点击继续，下线老的Slave；'), (26, '+ (7) 下线Slave: 下线老的Slave；'), (27, '+ (8) 迁移完成: 完成迁移。'), (28, ''), (29, '### 2. 应用大版本升级'), (30, ''), (31, 'redis大版本间由于各版本配置不兼容的问题，无法使用“应用迁移工具”进行应用升级，我们推荐使用“应用迁移工具”实现大版本的升级工作。'), (32, ''), (33, '#### 1）创建新的redis应用'), (34, '+ 用户申请redis应用，参考[“系统功能-我的申请-创建工单-应用申请”](../../wiki/function/job)。'), (35, '+ 管理员审批、开通应用，参考[“开通应用”](../../wiki/function/operation-job#cc1-2)。'), (36, ''), (37, '#### 2）进行新老redis应用数据迁移'), (38, '+ 新老应用数据迁移，参考[“数据迁移”](../../wiki/function/operation-migrate)。'), (39, '+ 数据迁移完毕，通知客户端更新到新应用。')], 'deleted': []}"
89,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/operate/index.md,index.md,5,"{'added': [(3, '本节主要从管理员运维角度，介绍CacheCloud平台的常用运维及系统优化。CacheCloud平台的运维主要分为三大部分：应用运维、机器运维和系统运维，如下图：'), (5, '<img width=""90%"" src=""../../img/operate/index.png""/>'), (7, '下面的章节我们将对每个部分涉及到的运维功能和技巧展开阐述。')], 'deleted': [(3, '本节主要介绍常用运维及系统优化，分以下方面：'), (4, ''), (5, '+ 1.[基础概念](baseConcept.md)：应用、实例、机器等运维'), (6, '+ 2.常用运维'), (7, '    + 2.1 [基础运维](baseOperate.md)'), (8, '    + 2.2 [应用部署](appDeploy.md)'), (9, '    + 2.3 [迁移工具](migrateTool.md)'), (10, '    + 2.4 [应用迁移](appMigrate.md)'), (11, '    + 2.5 [版本管理](../access/redisVersion.md)'), (12, '    + 2.6 [报警指标](appAlert.md)'), (13, '    + 2.7 [CacheCloud支持密码方案](rediscode.md)'), (14, '+ 3.[系统运维优化](baseOptimize.md)')]}"
90,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/quickstart/index.md,index.md,5,"{'added': [(1, '##### 目录'), (2, '* [一、准备war包](#cc1)'), (3, '* [二、初始化数据](#cc2)'), (4, '* [三、启动工程](#cc3)'), (5, '* [四、系统初始配置](#cc4)'), (6, '* [五、创建一个用户](#cc5)'), (7, '* [六、准备资源](#cc6)'), (8, '* [七、创建一个应用](#cc7)'), (9, ''), (10, ''), (11, '<a name=""cc1""/>'), (12, ''), (52, '\t#配置访问端口,默认8080'), (53, '\tserver:'), (54, '\t  port: 8080'), (61, ''), (150, '\t<img src=""../../img/quickstart/apptask.png"" width=""80%""/>'), (151, ''), (152, '<a name=""cc73""/>'), (153, ''), (154, '* 3.导入应用'), (155, ''), (156, '\t该功能支持将外部redis实例导入Cachecloud平台进行运维管理。具体操作参考：[应用导入](../../wiki/function/operations#cc1-3.md)')], 'deleted': [(46, '\t  redis: #配置cachecloud-web需要的redis，用户存储任务流日志，可稍后配置'), (47, '\t    main:'), (48, '\t      host: 127.0.0.1'), (49, '\t      port: 6379'), (50, '\t      password:'), (51, '\t#配置访问端口,默认8080'), (52, '\tserver:'), (53, '\t  port: 8080'), (142, '\t<img src=""../../img/quickstart/apptask.png"" width=""80%""/>')]}"
91,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/quickstart/index.toc.md,index.toc.md,5,"{'added': [(13, '    * [2.部署应用](#cc72)'), (14, '    * [3.导入应用](#cc73)')], 'deleted': [(13, '    * [2.部署应用](#cc72)')]}"
92,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/troubleshooting/cachecloud.md,cachecloud.md,1,"{'added': [(1, '## 关于Cachecloud平台使用问题'), (2, ''), (3, '##### 目录'), (4, ''), (5, '1. [数据库时间问题](#Q1)'), (6, '2. [平台本身需要的redis问题](#Q2)'), (7, '3. [用户登录注册问题](#Q3)'), (8, '4. [现有redis导入问题](#Q4)'), (9, ''), (10, '<a name=""Q1""/>'), (11, '### 1.数据库时间问题'), (12, 'CacheCloud版本2 使用mysql-connector-java 8, 与数据库版本不匹配时，时区显示可能有问题。建议在配置jdbcUrl时指定时区serverTimezone=Asia/Shanghai，如下：'), (13, ''), (14, '    cachecloud:'), (15, '\t  primary:'), (16, '\t    url: jdbc:mysql://129.0.0.1:3306/redis_open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000&serverTimezone=Asia/Shanghai'), (17, ''), (18, '<a name=""Q2""/>'), (19, '### 2.平台本身需要的redis问题'), (20, 'cachecloud-web工程配置文件中可为平台配置一个redis实例信息，用于存储任务流的日志。这一项不是必须的，可在项目启动后再创建配置。'), (21, ''), (22, '\tcachecloud:'), (23, '\t  redis: #配置cachecloud-web需要的redis，用户存储任务流log，可稍后配置'), (24, '\t    main:'), (25, '\t      host: ${ip}'), (26, '\t      port: ${port}'), (27, '\t      password: ${pwd}'), (28, ''), (29, '<a name=""Q3""/>'), (30, '### 3.用户登录注册问题'), (31, 'CacheCloud版本2.2 将支持用户自主提交&修改密码功能。'), (32, ''), (33, '<a name=""Q4""/>'), (34, '### 4.现有redis导入问题'), (35, 'CacheCloud版本1 支持简单的原生redis导入功能，但仅限制于导入redis的应用信息查询，节点监控等功能。'), (36, ''), (37, 'CacheCloud版本2.1 新提供“应用导入功能”，实现全方位的redis实例托管，可参考：[""应用导入""](../../wiki/function/operation-import)。')], 'deleted': []}"
93,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/static/wiki/troubleshooting/index.md,index.md,5,"{'added': [(1, '## FAQ常见问题'), (3, '关于CacheCloud的一些问题，分为CacheCloud中台的使用问题和Redis运维的问题。'), (5, '我们将大家关心的常见问题，和github issue上提到的问题，会在这里做说明，并持续更新...')], 'deleted': [(1, '## 运维常见问题'), (3, '+ 1.[常见jedis异常类](exception.md)'), (4, '+ 2.[JedisPool优化](jedispoolconfig.md)'), (5, '+ 3.[bigkey问题](bigkey.md)'), (6, '+ 4.[hotkey问题](hotkey.md)'), (7, '+ 5.[Redis内存优化](memory.md)'), (8, '+ 6.[activeDefrag引起redis周期性延迟](activefrag.md)')]}"
94,20913a5f7a262a1fc834e4b0e8ee4f7e3ffe2f77,cachecloud-web/src/main/resources/templates/expAppsDaily.ftl,expAppsDaily.ftl,5,"{'added': [(229, '            <ul>'), (230, '                <li>'), (231, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (232, '                    宿主环境检测'), (233, '                        <a target=""_blank""'), (234, '                           href=""${ccDomain}/manage/app/stat/list/server?tabId=5&searchDate=${searchDate}"">【查看更多--后台】</a>'), (235, '                    </span>'), (236, '                </li>'), (237, '            </ul>'), (238, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (239, '                <tr>'), (240, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 70px;"">'), (241, '                        宿主机ip'), (242, '                    </td>'), (243, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 70px;"">'), (244, '                        cachecloud_nprocs'), (245, '                    </td>'), (246, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (247, '                        fsync_slow_times'), (248, '                    </td>'), (249, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (250, '                        somaxconn'), (251, '                    </td>'), (252, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (253, '                        redis实例数'), (254, '                    </td>'), (255, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (256, '                        文件句柄used/total'), (257, '                    </td>'), (258, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (259, '                        disk used'), (260, '                    </td>'), (261, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (262, '                        诊断结果'), (263, '                    </td>'), (264, '                </tr>'), (265, '            <#assign machineEnvs=exceptionMachineEnv[""host""]>'), (266, '            <#list machineEnvs as machine>'), (267, '                <tr>'), (268, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 70px;"">'), (269, '                        ${machine.ip}'), (270, '                    </td>'), (271, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 70px;"">'), (272, '                       ${machine.envs.nproc_threads}'), (273, '                    </td>'), (274, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (275, '                        ${machine.envs.fsync_delay_times}'), (276, '                    </td>'), (277, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (278, '                        ${machine.envs.somaxconn}'), (279, '                    </td>'), (280, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (281, '                        ${machine.envs.instanceNum}'), (282, '                    </td>'), (283, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (284, '                        ${machine.envs.unlimit_used}/${machine.envs.unlimit}'), (285, '                    </td>'), (286, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (287, '                        ${machine.envs.diskUsed}'), (288, '                    </td>'), (289, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (290, '                        <span style=""color:red"">异常</span>'), (291, '                    </td>'), (292, '                </tr>'), (293, '            </#list>'), (294, '            </table>'), (295, ''), (296, '            <ul>'), (297, '                <li>'), (298, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (299, '                    容器环境检测'), (300, '                        <a target=""_blank""'), (301, '                           href=""${ccDomain}/manage/app/stat/list/server?tabId=4&searchDate=${searchDate}"">【查看更多--后台】</a>'), (302, '                    </span>'), (303, '                </li>'), (304, '            </ul>'), (305, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (306, '                <tr>'), (307, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 70px;"">'), (308, '                        容器ip'), (309, '                    </td>'), (310, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 70px;"">'), (311, '                        overcommit_memory'), (312, '                    </td>'), (313, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 120px;/"">'), (314, '                        thp_enabled'), (315, '                    </td>'), (316, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 120px;/"">'), (317, '                        thp_defrag'), (318, '                    </td>'), (319, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (320, '                        swappiness'), (321, '                    </td>'), (322, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (323, '                        nproc'), (324, '                    </td>'), (325, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (326, '                        诊断结果'), (327, '                    </td>'), (328, '                </tr>'), (329, '            <#assign machineEnvs=exceptionMachineEnv[""container""]>'), (330, '            <#list machineEnvs as container>'), (331, '                <tr>'), (332, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 70px;"">'), (333, '                        ${container.ip}'), (334, '                    </td>'), (335, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (336, '                        ${container.envs.overcommit_memory}'), (337, '                    </td>'), (338, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (339, '                        ${container.envs.transparent_hugepage_enable}'), (340, '                    </td>'), (341, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (342, '                        ${container.envs.transparent_hugepage_defrag}'), (343, '                    </td>'), (344, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (345, '                        ${container.envs.swappines}'), (346, '                    </td>'), (347, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (348, '                        ${container.envs.nproc}'), (349, '                    </td>'), (350, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (351, '                        <span style=""color:red"">异常</span>'), (352, '                    </td>'), (353, '                </tr>'), (354, '            </#list>'), (355, '            </table>'), (356, '')], 'deleted': []}"
95,9b020b884daffadc3bd4d4d80f63f86d74d6630c,cachecloud-web/src/main/resources/application-local.yml,application-local.yml,5,"{'added': [(16, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud_open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000&serverTimezone=Asia/Shanghai')], 'deleted': [(16, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud-open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000')]}"
96,9b020b884daffadc3bd4d4d80f63f86d74d6630c,cachecloud-web/src/main/resources/application-online.yml,application-online.yml,5,"{'added': [(11, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud-open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000&serverTimezone=Asia/Shanghai')], 'deleted': [(11, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud-open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000')]}"
97,9b020b884daffadc3bd4d4d80f63f86d74d6630c,cachecloud-web/src/main/resources/application-test.yml,application-test.yml,5,"{'added': [(11, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud-open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000&serverTimezone=Asia/Shanghai')], 'deleted': [(11, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud-open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000')]}"
98,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/mapper/DbPoolStatDao.xml,DbPoolStatDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.DbPoolStatDao"">'), (6, '    <sql id=""db_pool_columns"">'), (7, '        db_pool_name, ip, port, collect_time, collect_date, max_size,'), (8, '        min_size, busy_size, idle_size, total_size, create_time, update_time'), (9, '    </sql>'), (10, ''), (11, '    <sql id=""db_pool_fields"">'), (12, '        #{dbPoolName}, #{ip}, #{port}, #{collectTime}, #{collectDate}, #{maxSize},'), (13, '        #{minSize}, #{busySize}, #{idleSize}, #{totalSize}, #{createTime}, #{updateTime}'), (14, '    </sql>'), (15, ''), (16, '    <insert id=""save"" parameterType=""DbPoolStat"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (17, '        insert into db_pool_stat (<include refid=""db_pool_columns""/>)'), (18, '        value(<include refid=""db_pool_fields""/>);'), (19, '    </insert>'), (20, ''), (21, '</mapper>'), (22, ''), (23, '')]}"
99,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/mapper/ThreadPoolStatDao.xml,ThreadPoolStatDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.ThreadPoolStatDao"">'), (6, '    <sql id=""thread_pool_columns"">'), (7, '        thread_pool_name, ip, port, collect_time, collect_date, maximum_pool_size,'), (8, '        core_pool_size, active_count, diff_task_count, task_count,'), (9, '        completed_task_count, queue_size, create_time, update_time'), (10, '    </sql>'), (11, ''), (12, '    <sql id=""thread_pool_fields"">'), (13, '        #{threadPoolName}, #{ip}, #{port}, #{collectTime}, #{collectDate}, #{maximumPoolSize},'), (14, '        #{corePoolSize}, #{activeCount}, #{diffTaskCount}, #{taskCount},'), (15, '        #{completedTaskCount},#{queueSize}, #{createTime}, #{updateTime}'), (16, '    </sql>'), (17, ''), (18, '    <insert id=""save"" parameterType=""ThreadPoolStat"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (19, '        insert into thread_pool_stat (<include refid=""thread_pool_columns""/>)'), (20, '        value(<include refid=""thread_pool_fields""/>);'), (21, '    </insert>'), (22, ''), (23, '    <select id=""getLastTaskCount"" resultType=""Long"">'), (24, '    \tselect task_count from thread_pool_stat'), (25, '    \twhere ip=#{ip} and port=#{port} and thread_pool_name=#{threadPoolName} order by id desc limit 1'), (26, '    </select>'), (27, ''), (28, '</mapper>'), (29, ''), (30, '')]}"
100,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/templates/OperationAlert.vm,OperationAlert.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud运维操作通知</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '            <ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">运维操作机器通知：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        机器ip'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        宿主机ip'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        机器详情'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        操作'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                        Status'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (37, '                        Message'), (38, '                    </td>'), (39, '                </tr>'), (40, '                #foreach($!item in $!operationAlertValueResultList)'), (41, '                    <tr>'), (42, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (43, '                            $!item.ip'), (44, '                        </td>'), (45, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (46, '                            $!item.machineInfo.realIp'), (47, '                        </td>'), (48, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, '                            #if($!item.machineInfo)'), (50, '                                内存：$!item.machineInfo.mem G<br/>'), (51, '                                cpu：$!item.machineInfo.cpu<br/>'), (52, '                                备注说明：$!item.machineInfo.extraDesc'), (53, '                            #end'), (54, '                        </td>'), (55, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (56, '                            $!item.type'), (57, '                        </td>'), (58, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (59, '                            $!item.status'), (60, '                        </td>'), (61, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (62, '                            $!item.message'), (63, '                        </td>'), (64, '                    </tr>'), (65, '                #end'), (66, '            </table>'), (67, '        </td>'), (68, '    </tr>'), (69, ''), (70, '</table>'), (71, '</p>'), (72, '</body>'), (73, '</html>')]}"
101,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/templates/appAlert.vm,appAlert.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>应用Redis分钟报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用Redis分钟报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        \t负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        \tip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                    \t\tport'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                    \t\t属性值'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                    \t\t说明'), (41, '                    </td>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (43, '                    \t\t其他信息'), (44, '                    </td>'), (45, '                </tr>'), (46, '                #foreach($!item in $!instanceAlertValueResultList)'), (47, '                \t<tr>'), (48, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.appId'>${item.appId}</a>""), (50, '\t                    </td>'), (51, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (52, '\t                        \t$!item.appDesc.name'), (53, '\t                    </td>'), (54, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (55, '\t                        \t$!item.appDesc.officer'), (56, '\t                    </td>'), (57, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (58, '\t                        \t$!item.instanceInfo.ip'), (59, '\t                    </td>'), (60, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (61, '\t                    \t\t$!item.instanceInfo.port'), (62, '\t                    </td>'), (63, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (64, '\t                    \t\t$!item.instanceAlertConfig.alertConfig'), (65, '\t                    </td>'), (66, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (67, '\t                    \t\t$!item.alertMessage'), (68, '\t                    </td>'), (69, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (70, '\t                    \t\t$!item.otherInfo'), (71, '\t                    </td>'), (72, '\t                </tr>'), (73, '                #end'), (74, '            </table>'), (75, '        </td>'), (76, '    </tr>'), (77, ''), (78, '</table>'), (79, '</p>'), (80, '</body>'), (81, '</html>')]}"
102,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/templates/appAudit.vm,appAudit.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud审核邮件</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td style=""width:5px;""></td>'), (15, '        <td style=""color:#3f3f3f; font-weight: bold;font-size:12px; font-family: \'宋体\'; padding: 5px 0 15px 0"">'), (16, '            $appAudit.userName，您好，欢迎使用CacheCloud平台，您的申请处理进度如下：'), (17, '        </td>'), (18, '    </tr>'), (19, '    <tr>'), (20, '        <td></td>'), (21, '        <td style=""padding-top:20px; padding-left:27px;"">'), (22, '            <ul>'), (23, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">申请处理信息：</span></li>'), (24, '            </ul>'), (25, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (26, '                <tr>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (28, '                        申请类型：'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                        ##1:申请应用,2:应用扩容,3:修改配置'), (32, '                        $appAudit.typeDesc'), (33, '                    </td>'), (34, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (35, '                        申请描述：'), (36, '                    </td>'), (37, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (38, '                        $!appAudit.info'), (39, '                    </td>'), (40, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (41, '                        申请时间：'), (42, '                    </td>'), (43, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (44, '                        $!appAudit.createTimeFormat'), (45, '                    </td>'), (46, ''), (47, '                </tr>'), (48, '##                <tr>'), (49, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (50, '##                        预留参数1：'), (51, '##                    </td>'), (52, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (53, '##                        $!appAudit.param1'), (54, '##                    </td>'), (55, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (56, '##                        预留参数2：'), (57, '##                    </td>'), (58, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (59, '##                        $!appAudit.param2'), (60, '##                    </td>'), (61, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (62, '##                        预留参数3：'), (63, '##                    </td>'), (64, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (65, '##                        $!appAudit.param3'), (66, '##                    </td>'), (67, '##                </tr>'), (68, '                <tr>'), (69, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (70, '                        处理状态：'), (71, '                    </td>'), (72, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (73, '                        $!appAudit.statusDesc'), (74, '                    </td>'), (75, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (76, '                        处理描述：'), (77, '                    </td>'), (78, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (79, '                        $!appAudit.refuseReason'), (80, '                    </td>'), (81, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (82, '                        处理时间：'), (83, '                    </td>'), (84, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (85, '                        $!appAudit.modifyTimeFormat'), (86, '                    </td>'), (87, '                </tr>'), (88, '            </table>'), (89, '            <br/>'), (90, '            <ul>'), (91, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用详细信息：</span></li>'), (92, '            </ul>'), (93, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (94, '                <tr>'), (95, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (96, '                        应用名称：'), (97, '                    </td>'), (98, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (99, '                        $!appDesc.name'), (100, '                    </td>'), (101, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (102, '                        应用类型：'), (103, '                    </td>'), (104, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (105, '                        $!appDesc.typeDesc'), (106, '                    </td>'), (107, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (108, '                        应用状态：'), (109, '                    </td>'), (110, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (111, '                        $!appDesc.statusDesc'), (112, '                    </td>'), (113, '                </tr>'), (114, '                <tr>'), (115, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (116, '                        是否测试：'), (117, '                    </td>'), (118, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (119, '                        #if($appDesc.isTest == 1)'), (120, '                            是'), (121, '                        #else'), (122, '                            否'), (123, '                        #end'), (124, '                    </td>'), (125, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (126, '                        是否持久化：'), (127, '                    </td>'), (128, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (129, '                        #if($appDesc.needPersistence == 1)'), (130, '                            是'), (131, '                        #else'), (132, '                            否'), (133, '                        #end'), (134, '                    </td>'), (135, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (136, '                        是否有后端数据源：'), (137, '                    </td>'), (138, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (139, '                        #if($appDesc.hasBackStore == 1)'), (140, '                            是'), (141, '                        #else'), (142, '                            否'), (143, '                        #end'), (144, '                    </td>'), (145, '                </tr>'), (146, '                <tr>'), (147, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (148, '                        应用描述：'), (149, '                    </td>'), (150, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (151, '                        $!appDesc.intro'), (152, '                    </td>'), (153, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (154, '                        应用负责人：'), (155, '                    </td>'), (156, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (157, '                        $!appDesc.officer'), (158, '                    </td>'), (159, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (160, '                        应用申请时间：'), (161, '                    </td>'), (162, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (163, '                        $!appDesc.createTimeFormat'), (164, '                    </td>'), (165, '                </tr>'), (166, '            </table>'), (167, '        </td>'), (168, '    </tr>'), (169, ''), (170, '</table>'), (171, '</p>'), (172, '</body>'), (173, '</html>')]}"
103,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/templates/appDaily.vm,appDaily.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud应用日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用详细信息：$!appDesc.appId</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (22, '                        应用名称：'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (25, '                        $!appDesc.name'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (28, '                        应用类型：'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                        $!appDesc.typeDesc'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (34, '                        应用状态：'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                        $!appDesc.statusDesc'), (38, '                    </td>'), (39, '                </tr>'), (40, '                <tr>'), (41, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (42, '                        应用描述：'), (43, '                    </td>'), (44, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (45, '                        $!appDesc.intro'), (46, '                    </td>'), (47, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (48, '                        应用负责人：'), (49, '                    </td>'), (50, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (51, '                        $!appDesc.officer'), (52, '                    </td>'), (53, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (54, '                        应用申请时间：'), (55, '                    </td>'), (56, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (57, '                        $!appDesc.createTime'), (58, '                    </td>'), (59, '                </tr>'), (60, '            </table>'), (61, ''), (62, '            <ul>'), (63, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">客户端相关(确保使用有客户端统计的版本):</span></li>'), (64, '            </ul>'), (65, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (66, '                <tr>'), (67, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (68, '                        客户端值分布(全天):'), (69, '                    </td>'), (70, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (71, '\t\t\t\t\t\t$!appDailyData.valueSizeDistributeCountDesc'), (72, '                    </td>'), (73, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (74, '                        客户端连接数(每分钟)：'), (75, '                    </td>'), (76, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (77, '                        最大值:$!appDailyData.maxMinuteClientCount <br/>'), (78, '                        平均值:$!appDailyData.avgMinuteClientCount'), (79, '                    </td>'), (80, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (81, '                        客户端延迟事件数(全天)：'), (82, '                    </td>'), (83, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (84, '                        $!appDailyData.latencyCount'), (85, '                    </td>'), (86, '                </tr>'), (87, '                <tr>'), (88, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (89, '                        命令调用统计(全天):'), (90, '                    </td>'), (91, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (92, '                        次数:$!appDailyData.clientCmdCount<br/>'), (93, '                        平均耗时(ms):$!appDailyData.clientAvgCmdCost'), (94, '                    </td>'), (95, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (96, '                        连接异常统计(全天)：'), (97, '                    </td>'), (98, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (99, '                        次数:$!appDailyData.clientConnExpCount<br/>'), (100, '                        平均耗时(ms):$!appDailyData.clientAvgConnExpCost'), (101, '                    </td>'), (102, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (103, '                        命令超时统计(全天)：'), (104, '                    </td>'), (105, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (106, '                        次数:$!appDailyData.clientCmdExpCount <br/>'), (107, '                        平均耗时(ms):$!appDailyData.clientAvgCmdExpCost'), (108, '                    </td>'), (109, '                </tr>'), (110, '            </table>'), (111, '            <br/>'), (112, ''), (113, '            <ul>'), (114, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">服务端相关:</span></li>'), (115, '            </ul>'), (116, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (117, '                <tr>'), (118, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (119, '                        慢查询个数(全天)：'), (120, '                    </td>'), (121, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (122, '                        $!appDailyData.slowLogCount'), (123, '                    </td>'), (124, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (125, '                        命令次数(每分钟)：'), (126, '                    </td>'), (127, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (128, '                       \t 最大值:$!appDailyData.maxMinuteCommandCount <br/>'), (129, '                       \t 平均值:$!appDailyData.avgMinuteCommandCount'), (130, '                    </td>'), (131, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (132, '                        命中率(每分钟)：'), (133, '                    </td>'), (134, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (135, '                       \t 最大值:$!appDailyData.maxMinuteHitRatio% <br/>'), (136, '                       \t 最小值:$!appDailyData.minMinuteHitRatio% <br/>'), (137, '                       \t 平均值:$!appDailyData.avgHitRatio%'), (138, '                    </td>'), (139, '                </tr>'), (140, ''), (141, '                <tr>'), (142, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (143, '                        内存使用量(全天)：'), (144, '                    </td>'), (145, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (146, '                        平均使用量:$!appDailyData.avgUsedMemory M<br/>'), (147, '                        最大使用量:$!appDailyData.maxUsedMemory M'), (148, '                    </td>'), (149, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (150, '                        过期键数(全天)：'), (151, '                    </td>'), (152, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (153, '                       \t $!appDailyData.expiredKeysCount'), (154, '                    </td>'), (155, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (156, '                        剔除键数(全天)：'), (157, '                    </td>'), (158, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (159, '                       \t $!appDailyData.evictedKeysCount'), (160, '                    </td>'), (161, '                </tr>'), (162, ''), (163, '                <tr>'), (164, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (165, '                       键个数(全天)：'), (166, '                    </td>'), (167, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (168, '                        平均值:$!appDailyData.avgObjectSize<br/>'), (169, '                        最大值:$!appDailyData.maxObjectSize'), (170, '                    </td>'), (171, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (172, '         input流量(每分钟)：'), (173, '                    </td>'), (174, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (175, '                       \t 平均值:$!appDailyData.avgMinuteNetInputByte M<br/>'), (176, '                       \t 最大值:$!appDailyData.maxMinuteNetInputByte M<br/>'), (177, '                    </td>'), (178, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (179, '        output流量(每分钟)：'), (180, '                    </td>'), (181, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (182, '                       \t 平均:$!appDailyData.avgMinuteNetOutputByte M<br/>'), (183, '                       \t 最大:$!appDailyData.maxMinuteNetOutputByte M<br/>'), (184, '                    </td>'), (185, '                </tr>'), (186, '            </table>'), (187, '            <br/>'), (188, ''), (189, '        </td>'), (190, '    </tr>'), (191, ''), (192, '</table>'), (193, '</p>'), (194, '</body>'), (195, '</html>')]}"
104,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/templates/expAppsDaily.vm,expAppsDaily.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>应用日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, ''), (10, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (11, '    <colgroup>'), (12, '        <col style=""width: 5px;"">'), (13, '    </colgroup>'), (14, ''), (15, '    <tr>'), (16, '        <td>'), (17, '        </td>'), (18, '        <td style=""padding-top:20px; padding-left:27px;"">'), (19, '            <ul>'), (20, '                <li>'), (21, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (22, '                        应用异常情况'), (23, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list?tabId=0&searchDate=$!searchDate"">【查看更多--后台】</a>'), (24, '                    </span>'), (25, '                </li>'), (26, '            </ul>'), (27, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (28, '                <tr>'), (29, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (30, '                        应用id'), (31, '                    </td>'), (32, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (33, '                        应用名'), (34, '                    </td>'), (35, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (36, '                        应用负责人'), (37, '                    </td>'), (38, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (39, '                        异常总量(全天)'), (40, '                    </td>'), (41, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (42, '                        连接异常(全天)'), (43, '                    </td>'), (44, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (45, '                        命令超时(全天)'), (46, '                    </td>'), (47, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (48, '                        延迟事件(全天)'), (49, '                    </td>'), (50, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (51, '                        慢查询(全天)'), (52, '                    </td>'), (53, '                </tr>'), (54, '                #foreach($!item in $!appClientGatherStatGroup.get(""expAppStats""))'), (55, '                    <tr>'), (56, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (57, '                            <a target=""_blank""'), (58, '                               href=""/admin/app/index?appId=$!item.get(""app_id"")"">'), (59, '                                $!item.get(""app_id"")'), (60, '                            </a>'), (61, '                        </td>'), (62, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (63, '                            $!appDescMap.get($!item.get(""app_id"")).name'), (64, '                        </td>'), (65, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (66, '                            $!appDescMap.get($!item.get(""app_id"")).officer'), (67, '                        </td>'), (68, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (69, '                            <a target=""_blank""'), (70, '                               href=""${ccDomain}/client/show/index?searchDate=$!searchDate&appId=$!item.get('), (71, '                                   ""app_id"")&tabTag=app_client_exception_statistics"">'), (72, '                                $!item.get(""exp_count"")'), (73, '                            </a>'), (74, '                        </td>'), (75, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (76, '                            <a target=""_blank""'), (77, '                               href=""${ccDomain}/client/show/exceptionStatistics/client?searchDate=$!searchDate&appId=$!item.get('), (78, '                                   ""app_id"")&exceptionType=0"">'), (79, '                                次数:$!item.get(""conn_exp_count"")'), (80, '                            </a>'), (81, '                            <br/>'), (82, '                            平均耗时(ms):$!item.get(""avg_conn_exp_cost"")'), (83, '                        </td>'), (84, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (85, '                            <a target=""_blank""'), (86, '                               href=""${ccDomain}/client/show/exceptionStatistics/client?searchDate=$!searchDate&appId=$!item.get('), (87, '                                   ""app_id"")&exceptionType=1"">'), (88, '                                次数:$!item.get(""cmd_exp_count"")'), (89, '                            </a>'), (90, '                            <br/>'), (91, '                            平均耗时(ms):$!item.get(""avg_cmd_exp_cost"")'), (92, '                        </td>'), (93, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (94, '                            <a target=""_blank""'), (95, '                               href=""${ccDomain}/admin/app/index?searchDate=$!searchDate&appId=$!item.get('), (96, '                                   ""app_id"")&tabTag=app_latency"">'), (97, '                                $!item.get(""latency_count"")'), (98, '                            </a>'), (99, '                        </td>'), (100, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (101, '                            <a target=""_blank""'), (102, '                               href=""${ccDomain}/admin/app/index?searchDate=$!searchDate&appId=$!item.get('), (103, '                                   ""app_id"")&tabTag=app_latency"">'), (104, '                                $!item.get(""slow_log_count"")'), (105, '                            </a>'), (106, '                        </td>'), (107, '                    </tr>'), (108, '                #end'), (109, '            </table>'), (110, ''), (111, ''), (112, '            <ul>'), (113, '                <li>'), (114, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (115, '                    应用延迟事件（top 10）'), (116, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list?tabId=0&searchDate=$!searchDate"">【查看更多--后台】</a>'), (117, '                    </span>'), (118, '                </li>'), (119, '            </ul>'), (120, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (121, '                <tr>'), (122, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (123, '                        应用id'), (124, '                    </td>'), (125, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (126, '                        应用名'), (127, '                    </td>'), (128, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (129, '                        应用负责人'), (130, '                    </td>'), (131, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (132, '                        延迟事件(全天)'), (133, '                    </td>'), (134, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (135, '                        慢查询(全天)'), (136, '                    </td>'), (137, '                </tr>'), (138, '                #foreach($!item in $!appClientGatherStatGroup.get(""latencyAppStats""))'), (139, '                    <tr>'), (140, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (141, '                            <a target=""_blank""'), (142, '                               href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")"">'), (143, '                                $!item.get(""app_id"")'), (144, '                            </a>'), (145, '                        </td>'), (146, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (147, '                            $!appDescMap.get($!item.get(""app_id"")).name'), (148, '                        </td>'), (149, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (150, '                            $!appDescMap.get($!item.get(""app_id"")).officer'), (151, '                        </td>'), (152, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (153, '                            <a target=""_blank""'), (154, '                               href=""${ccDomain}/admin/app/index?searchDate=$!searchDate&appId=$!item.get('), (155, '                                   ""app_id"")&tabTag=app_latency"">'), (156, '                                $!item.get(""latency_count"")'), (157, '                            </a>'), (158, '                        </td>'), (159, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (160, '                            <a target=""_blank""'), (161, '                               href=""${ccDomain}/admin/app/index?searchDate=$!searchDate&appId=$!item.get('), (162, '                                   ""app_id"")&tabTag=app_latency"">'), (163, '                                $!item.get(""slow_log_count"")'), (164, '                            </a>'), (165, '                        </td>'), (166, '                    </tr>'), (167, '                #end'), (168, '            </table>'), (169, ''), (170, ''), (171, '            <ul>'), (172, '                <li>'), (173, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (174, '                    应用拓扑诊断'), (175, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list/server?tabId=3&searchDate=$!searchDate"">【查看更多--后台】</a>'), (176, '                    </span>'), (177, '                </li>'), (178, '            </ul>'), (179, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (180, '                <tr>'), (181, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (182, '                        应用id'), (183, '                    </td>'), (184, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (185, '                        应用名'), (186, '                    </td>'), (187, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (188, '                        应用负责人'), (189, '                    </td>'), (190, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (191, '                        redis类型'), (192, '                    </td>'), (193, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (194, '                        redis版本'), (195, '                    </td>'), (196, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (197, '                        拓扑诊断结果'), (198, '                    </td>'), (199, '                </tr>'), (200, '                #foreach($!item in $!appClientGatherStatGroup.get(""topologyAppStats""))'), (201, '                    <tr>'), (202, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (203, '                            <a target=""_blank""'), (204, '                               href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")"">'), (205, '                                $!item.get(""app_id"")'), (206, '                            </a>'), (207, '                        </td>'), (208, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (209, '                            $!appDescMap.get($!item.get(""app_id"")).name'), (210, '                        </td>'), (211, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (212, '                            $!appDescMap.get($!item.get(""app_id"")).officer'), (213, '                        </td>'), (214, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (215, '                            $!appDescMap.get($!item.get(""app_id"")).typeDesc'), (216, '                        </td>'), (217, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (218, '                            $!appDescMap.get($!item.get(""app_id"")).versionName'), (219, '                        </td>'), (220, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (221, '                            <span style=""color:red"">异常</span>'), (222, '                            [<a target=""_blank"" href=""${ccDomain}/manage/app/index.do?appId=$!item.get(""app_id"")&tabTag=app_ops_tool"">查看诊断</a>]'), (223, '                        </td>'), (224, '                    </tr>'), (225, '                #end'), (226, '            </table>'), (227, ''), (228, ''), (229, '            <ul>'), (230, '                <li>'), (231, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (232, '                        应用内存使用情况（bottom 10）'), (233, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list/server?tabId=1&searchDate=$!searchDate"">【查看更多--后台】</a>'), (234, '                </span>'), (235, '                </li>'), (236, '            </ul>'), (237, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (238, '                <tr>'), (239, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (240, '                        应用id'), (241, '                    </td>'), (242, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (243, '                        应用名'), (244, '                    </td>'), (245, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (246, '                        应用负责人'), (247, '                    </td>'), (248, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (249, '                        redis类型'), (250, '                    </td>'), (251, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (252, '                        内存'), (253, '                    </td>'), (254, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (255, '                        使用内存'), (256, '                    </td>'), (257, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (258, '                        内存使用率'), (259, '                    </td>'), (260, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (261, '                        应用客户端连接'), (262, '                    </td>'), (263, '                </tr>'), (264, '                #foreach($!item in $!appClientGatherStatGroup.get(""memAlterAppStats""))'), (265, '                        <tr>'), (266, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (267, '                                <a target=""_blank""'), (268, '                                   href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")"">'), (269, '                                    $!item.get(""app_id"")'), (270, '                                </a>'), (271, '                            </td>'), (272, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (273, '                                $!appDescMap.get($!item.get(""app_id"")).name'), (274, '                            </td>'), (275, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (276, '                                $!appDescMap.get($!item.get(""app_id"")).officer'), (277, '                            </td>'), (278, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (279, '                                $!appDescMap.get($!item.get(""app_id"")).typeDesc'), (280, '                            </td>'), (281, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (282, '                                $!item.get(""format_mem"") G'), (283, '                            </td>'), (284, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (285, '                                $!item.get(""format_used_memory"") G'), (286, '                            </td>'), (287, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (288, '                                $!item.get(""mem_used_ratio"") %'), (289, '                            </td>'), (290, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (291, '                                <a href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")&tabTag=app_clientList""'), (292, '                                   target=""_blank"">'), (293, '                                    $!item.get(""connected_clients"")'), (294, '                                </a>'), (295, '                            </td>'), (296, '                        </tr>'), (297, '                #end'), (298, '            </table>'), (299, ''), (300, ''), (301, '            <ul>'), (302, '                <li>'), (303, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (304, '                        应用碎片率情况（top 10）'), (305, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list/server?tabId=2&searchDate=$!searchDate"">【查看更多--后台】</a>'), (306, '                </span>'), (307, '                </li>'), (308, '            </ul>'), (309, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (310, '                <tr>'), (311, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (312, '                        应用id'), (313, '                    </td>'), (314, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (315, '                        应用名'), (316, '                    </td>'), (317, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (318, '                        应用负责人'), (319, '                    </td>'), (320, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (321, '                        redis版本'), (322, '                    </td>'), (323, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (324, '                        内存使用'), (325, '                    </td>'), (326, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (327, '                        rss内存使用'), (328, '                    </td>'), (329, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (330, '                        平均碎片率'), (331, '                    </td>'), (332, '                </tr>'), (333, '                #foreach($!item in $!appClientGatherStatGroup.get(""fragRatioAppStats""))'), (334, '                    <tr>'), (335, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (336, '                            <a target=""_blank""'), (337, '                               href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")"">'), (338, '                                $!item.get(""app_id"")'), (339, '                            </a>'), (340, '                        </td>'), (341, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (342, '                            $!appDescMap.get($!item.get(""app_id"")).name'), (343, '                        </td>'), (344, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (345, '                            $!appDescMap.get($!item.get(""app_id"")).officer'), (346, '                        </td>'), (347, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (348, '                            $!appDescMap.get($!item.get(""app_id"")).versionName'), (349, '                        </td>'), (350, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (351, '                            $!item.get(""format_used_memory"") G'), (352, '                        </td>'), (353, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (354, '                            $!item.get(""format_used_memory_rss"") G'), (355, '                        </td>'), (356, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (357, '                            $!item.get(""avg_mem_frag_ratio"")'), (358, '                        </td>'), (359, '                    </tr>'), (360, '                #end'), (361, '            </table>'), (362, ''), (363, '        </td>'), (364, '    </tr>'), (365, ''), (366, '</table>'), (367, '</p>'), (368, '</body>'), (369, '</html>')]}"
105,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/templates/instanceAlert.vm,instanceAlert.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Redis实例分钟报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例分钟报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        \t负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        \tip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                    \t\tport'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                    \t\t属性值'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                    \t\t说明'), (41, '                    </td>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (43, '                    \t\t其他信息'), (44, '                    </td>'), (45, '                </tr>'), (46, '                #foreach($!item in $!instanceAlertValueResultList)'), (47, '                \t<tr>'), (48, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.appId'>${item.appId}</a>""), (50, '\t                    </td>'), (51, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (52, '\t                        \t$!item.appDesc.name'), (53, '\t                    </td>'), (54, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (55, '\t                        \t$!item.appDesc.officer'), (56, '\t                    </td>'), (57, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (58, '\t                        \t$!item.instanceInfo.ip'), (59, '\t                    </td>'), (60, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (61, '\t                    \t\t$!item.instanceInfo.port'), (62, '\t                    </td>'), (63, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (64, '\t                    \t\t$!item.instanceAlertConfig.alertConfig'), (65, '\t                    </td>'), (66, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (67, '\t                    \t\t$!item.alertMessage'), (68, '\t                    </td>'), (69, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (70, '\t                    \t\t$!item.otherInfo'), (71, '\t                    </td>'), (72, '\t                </tr>'), (73, '                #end'), (74, '            </table>'), (75, '        </td>'), (76, '    </tr>'), (77, ''), (78, '</table>'), (79, '</p>'), (80, '</body>'), (81, '</html>')]}"
106,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/templates/instanceRecover.vm,instanceRecover.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Pod:$!item.ip Pod重启探测Redis实例</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例自动拉起列表：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t容器ip'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                    \t\tport'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                    \t\t说明'), (32, '                    </td>'), (33, '                </tr>'), (34, '                #foreach($!item in $!instanceAlertValueResultList)'), (35, '                \t<tr>'), (36, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (37, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.instanceInfo.appId'>$!item.instanceInfo.appId</a>""), (38, '\t                    </td>'), (39, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (40, '\t                        \t$!item.instanceInfo.ip'), (41, '\t                    </td>'), (42, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (43, '\t                    \t\t$!item.instanceInfo.port'), (44, '\t                    </td>'), (45, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (46, '\t                    \t\t实例恢复时间：$!item.otherInfo'), (47, '\t                    </td>'), (48, '\t                </tr>'), (49, '                #end'), (50, '            </table>'), (51, '        </td>'), (52, '    </tr>'), (53, ''), (54, '</table>'), (55, '</p>'), (56, '</body>'), (57, '</html>')]}"
107,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/templates/instanceState.vm,instanceState.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Redis实例状态监控报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例状态监控报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        \t负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        \tip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                    \t\tport'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                    \t\t状态'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                    \t\t说明'), (41, '                    </td>'), (42, '                </tr>'), (43, '                #foreach($!item in $!instanceAlertValueResultList)'), (44, '                \t<tr>'), (45, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (46, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.appId'>${item.appId}</a>""), (47, '\t                    </td>'), (48, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, '\t                        \t$!item.appDesc.name'), (50, '\t                    </td>'), (51, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (52, '\t                        \t$!item.appDesc.officer'), (53, '\t                    </td>'), (54, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (55, '\t                        \t$!item.instanceInfo.ip'), (56, '\t                    </td>'), (57, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (58, '\t                    \t\t$!item.instanceInfo.port'), (59, '\t                    </td>'), (60, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (61, '\t                    \t\t$!item.instanceInfo.status'), (62, '\t                    </td>'), (63, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (64, '\t                    \t\t$!item.otherInfo'), (65, '\t                    </td>'), (66, '\t                </tr>'), (67, '                #end'), (68, '            </table>'), (69, '        </td>'), (70, '    </tr>'), (71, ''), (72, '</table>'), (73, '</p>'), (74, '</body>'), (75, '</html>')]}"
108,32b21f69f0679346e9ffed8436d31367e02c59e1,cachecloud-web/src/main/resources/templates/topologyExam.vm,topologyExam.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>应用拓扑检查日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">online应用拓扑检查情况：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        appId'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        应用类型'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        问题'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        描述'), (32, '                    </td>'), (33, '                </tr>'), (34, '                #foreach($!item in $!examResult)'), (35, '                    <tr>'), (36, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (37, '                            $!item.get(""appId"")'), (38, '                        </td>'), (39, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (40, '                            $!item.get(""type"")'), (41, '                        </td>'), (42, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (43, '                            $!item.get(""status"")'), (44, '                        </td>'), (45, '                        <td align=""left"" style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (46, '                            #foreach( $str in $!item.get(""desc"").split(""\\n"") )'), (47, '                             $!str'), (48, '                             <br/>'), (49, '                            #end'), (50, '                        </td>'), (51, '                    </tr>'), (52, '                #end'), (53, '            </table>'), (54, ''), (55, '        </td>'), (56, '    </tr>'), (57, ''), (58, '</table>'), (59, '</p>'), (60, '</body>'), (61, '</html>')]}"
109,65d9c17248bd23f47b5d53a681ad602b590a80e6,cachecloud-web/src/main/resources/static/wiki/intro/index.md,index.md,5,"{'added': [(41, '+ 开源版本试用时间: 2021-01-18 ，如果大家有空闲公网资源可以贡献，请[联系我们](#cc8)')], 'deleted': [(41, '+ 开源版本试用时间: 2020-01-18 ，如果大家有空闲公网资源可以贡献，请[联系我们](#cc8)')]}"
110,65d9c17248bd23f47b5d53a681ad602b590a80e6,cachecloud-web/src/main/resources/static/wiki/quickstart/index.md,index.md,5,"{'added': [(3, ''), (59, '访问web：<http://localhost:8080/manage/login> 使用默认管理员账户登录：用户名 admin 密码 admin'), (60, ''), (72, ''), (91, '\t\tc.创建默认redis路径并授权;'), (92, '\t\td.默认安装""redis-3.0.7"" ""redis-3.2.12"" ""redis-4.0.14"" ""redis-5.0.9"";'), (94, '\t\te.@usage: sh cachecloud-init.sh [username]'), (113, ''), (134, '\tb.应用部署：点击”生成部署预览“，确认拓扑无误，点击”开始部署“，跳转到应用部署任务流。'), (135, '')], 'deleted': [(58, '访问web：<http://localhost:8080/manage/login> 使用默认管理员账户登录：用户名 admin 密码 admin'), (88, '\t\tc.创建公钥私钥；'), (89, '\t\td.创建默认redis路径并授权;'), (90, '\t\te.默认安装""redis-3.0.7"" ""redis-4.0.14"" ""redis-5.0.9"";'), (92, '\t\tf.@usage: sh cachecloud-init.sh [username]'), (131, '\tb.应用部署：点击”生成部署预览“，确认拓扑无误，点击”开始部署“，跳转到应用部署任务流。')]}"
111,2ebeb2c20d0080ae468c762b43fa143c710774ef,cachecloud-web/src/main/resources/static/wiki/intro/index.md,index.md,5,"{'added': [(41, '+ 开源版本试用时间: 2020-01-18 ，如果大家有空闲公网资源可以贡献，请[联系我们](#cc8)')], 'deleted': [(41, '+ 开源版本试用时间: 2020-10-18 ，如果大家有空闲公网资源可以贡献，请[联系我们](#cc8)')]}"
112,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/application-local.yml,application-local.yml,5,"{'added': [(7, '  #ip/域名地址'), (8, '  domain: http://127.0.0.1:8080'), (9, '  servlet:'), (10, '    jsp:'), (11, '      init-parameters:'), (12, '        development: true #jsp 热部署'), (16, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud-open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000'), (17, '    user: cachecloud-open'), (18, '    password: cachecloud-open'), (21, '  redis: #配置cachecloud-web需要的redis，用户存储任务流log')], 'deleted': [(4, '    import: classpath:spring/spring.xml'), (8, '  # ip/域名地址'), (9, '  domain: 127.0.0.1:8080'), (10, '  jsp-servlet:'), (11, '    init-parameters:'), (12, '      development: true #jsp 热部署'), (16, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud_open'), (17, '    user: cachecloud'), (18, '    password: cachecloud'), (21, '  redis:')]}"
113,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/application-online.yml,application-online.yml,5,"{'added': [(11, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud-open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000'), (12, '    user: cachecloud-open'), (13, '    password: cachecloud-open'), (16, '  redis:')], 'deleted': [(4, '    import: classpath:spring/spring.xml'), (12, '    url: jdbc:mysql://127.0.0.1:3306/redis_open'), (13, '    user: redis_open_rw'), (14, '    password: 67b033tE104089l'), (17, '  redis: # task redis log'), (22, '  #区分资源')]}"
114,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/application-open.yml,application-open.yml,5,"{'added': [(4, ''), (12, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud-open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000'), (13, '    user: cachecloud-open'), (14, '    password: cachecloud-open'), (17, '  redis:'), (23, '    clients: 127.0.0.1')], 'deleted': [(4, '    import: classpath:spring/spring.xml'), (12, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud_open'), (13, '    user: cachecloud'), (14, '    password: cachecloud'), (17, '  redis: # task redis log'), (22, '  #区分资源'), (24, '    clients: 127.0.0.1')]}"
115,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/application-test.yml,application-test.yml,5,"{'added': [(11, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud-open?useUnicode=true&characterEncoding=UTF8&autoReconnect=true&connectTimeout=3000&socketTimeout=10000'), (12, '    user: cachecloud-open'), (13, '    password: cachecloud-open')], 'deleted': [(4, '    import: classpath:spring/spring.xml'), (12, '    url: jdbc:mysql://127.0.0.1:3306/redis_open'), (13, '    user: redis_open_rw'), (14, '    password: 67b033tE104089l'), (22, '  #区分资源')]}"
116,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/application.yml,application.yml,5,"{'added': [(4, '  main:'), (5, '    allow-bean-definition-overriding: true'), (19, '    contentnegotiation:'), (20, '      favor-path-extension: true'), (21, '    pathmatch:'), (22, '      use-suffix-pattern: true'), (23, '      use-registered-suffix-pattern: true'), (31, '    driver: com.mysql.cj.jdbc.Driver'), (34, '  server:'), (35, '    port: 8888'), (36, '  endpoints:'), (37, '    web:'), (38, '      exposure:'), (39, ""        include: '*'""), (40, '    enabled-by-default: true'), (41, '  endpoint:'), (42, '    prometheus:'), (43, '      enabled: true'), (44, '    health:'), (45, '      show-details: always'), (46, '    shutdown: #关闭不安全控制endpoints'), (47, '      enabled: false'), (48, '    restart:'), (49, '      enabled: false'), (50, '    pause:'), (51, '      enabled: false'), (52, '    heapdump:'), (53, '      enabled: false'), (54, '    refresh:'), (55, '      enabled: false'), (56, '    auditevents:'), (57, '      enabled: false'), (58, '    jolokia:'), (59, '      enabled: false'), (60, '    env:'), (61, '      post:'), (62, '        enabled: false')], 'deleted': [(24, '    driver: com.mysql.jdbc.Driver'), (27, '  security:'), (28, '    enabled: false'), (29, '  port: 8888'), (30, '  context-path: /actuator'), (31, '#关闭不安全控制endpoints'), (32, 'endpoints:'), (33, '  shutdown:'), (34, '    enabled: false'), (35, '  restart:'), (36, '    enabled: false'), (37, '  pause:'), (38, '    enabled: false'), (39, '  heapdump:'), (40, '    enabled: false'), (41, '  refresh:'), (42, '    enabled: false'), (43, '  auditevents:'), (44, '    enabled: false'), (45, '  jolokia:'), (46, '    enabled: false'), (47, '  env:'), (48, '    post:'), (49, '      enabled: false')]}"
117,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/spring/spring-mvc.xml,spring-mvc.xml,5,"{'added': [(75, '    <bean id=""freemarkerConfig"" class=""org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer"">'), (76, '        <property name=""templateLoaderPath"" value=""classpath:/templates/""/>'), (77, '        <property name=""defaultEncoding"" value=""UTF-8""/>'), (78, '        <property name=""freemarkerSettings"">'), (79, '            <props>'), (80, '                <prop key=""tag_syntax"">auto_detect</prop>'), (81, '                <prop key=""url_escaping_charset"">UTF-8</prop>'), (82, '                <prop key=""default_encoding"">UTF-8</prop>'), (83, '                <prop key=""output_encoding"">UTF-8</prop>'), (84, '                <prop key=""locale"">zh_CN</prop>'), (85, '                <prop key=""boolean_format"">true,false</prop>'), (86, '                <prop key=""datetime_format"">yyyy-MM-dd HH:mm:ss</prop>'), (87, '                <prop key=""date_format"">yyyy-MM-dd</prop>'), (88, '                <prop key=""time_format"">HH:mm:ss</prop>'), (89, '                <prop key=""number_format"">0.##</prop>'), (90, '                <prop key=""whitespace_stripping"">true</prop>'), (91, '                <prop key=""object_wrapper"">freemarker.ext.beans.BeansWrapper</prop>'), (92, '            </props>'), (93, '        </property>'), (94, '    </bean>')], 'deleted': []}"
118,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/spring/spring-quartz.xml,spring-quartz.xml,5,"{'added': [(34, '')], 'deleted': [(34, '    <bean id=""monitorThreadPoolJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (35, '        <property name=""name"" value=""monitorThreadPoolJobDetail""></property>'), (36, '        <property name=""group"" value=""monitorThreadPoolGroup""></property>'), (37, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.MonitorThreadPoolJob""></property>'), (38, '        <property name=""durability"" value=""true""/>'), (39, '    </bean>'), (79, '                <ref bean=""monitorThreadPoolTrigger""/>'), (88, '                <ref bean=""monitorThreadPoolJobDetail""/>'), (379, '    <bean id=""monitorThreadPoolTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (380, '        <property name=""name"" value=""monitorThreadPoolTrigger""/>'), (381, '        <property name=""group"" value=""monitorThreadPoolGroup""/>'), (382, '        <property name=""jobDetail"" ref=""monitorThreadPoolJobDetail""/>'), (383, '        <property name=""cronExpression"" value=""0/10 * * ? * *""/>'), (384, '    </bean>'), (385, '')]}"
119,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/static/wiki/access/config.md,config.md,5,"{'added': [(132, ""('machine.mem.alert.ratio', '80.0', '机器内存报警阀值', '1', '10');"")], 'deleted': [(116, ""('cachecloud.app.secret.base.key', 'cachecloud-2014', 'appkey秘钥基准key', '1', '29'),""), (119, ""('cachecloud.cookie.domain', '', 'cookie登录方式所需要的域名', '1', '22'),""), (120, ""('cachecloud.documentUrl', 'http://cachecloud.github.io', '文档地址', '1', '12'),""), (122, ""('cachecloud.error.client', '0.0', '不可用客户端版本(用逗号隔开)', '1', '19'),""), (123, ""('cachecloud.good.client', '1.0-SNAPSHOT', '可用客户端版本(用逗号隔开)', '1', '17'),""), (124, ""('cachecloud.ldap.url', '', 'LDAP接口地址(例如:ldap://ldap.xx.com)', '1', '27'),""), (129, ""('cachecloud.mavenWareHouse', 'http://your_maven_house', 'maven仓库地址(客户端)', '1', '15'),""), (138, ""('cachecloud.user.login.type', '1', '用户登录状态保存方式(session或cookie)', '1', '21'),""), (139, ""('cachecloud.warn.client', '0.1', '警告客户端版本(用逗号隔开)', '1', '18'),""), (141, ""('machine.cpu.alert.ratio', '80.0', '机器cpu报警阀值', '1', '9'),""), (142, ""('machine.load.alert.ratio', '8.0', '机器负载报警阀值', '1', '11'),""), (143, ""('machine.mem.alert.ratio', '80.0', '机器内存报警阀值', '1', '10'),""), (144, ""('redis.migrate.tool.home', '/opt/cachecloud/redis-migrate-tool/', 'redis-migrate-tool安装路径', '1', '20');"")]}"
120,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/static/wiki/access/init.md,init.md,5,"{'added': [(16, '  | 序号 | sql文件名 | 说明  |'), (17, '  | 1 | 2.0.sql | CacheCloud2.0版本的sql文件 |'), (23, '项目采用springboot部署方式，通过application-${rofile}.yml来区分不同环境资源隔离,其中profile:本地(默认为local)、测试(test)、线上(online)。')], 'deleted': [(16, '  | 序号 | sql文件名 | 说明  |'), (17, '  | :-------------------------- | :-------------------------- |:----------------------------- |'), (18, '  | 1 | 1.2.sql     | CacheCloud1.2版本的sql文件 |'), (19, '  | 2 | 1.2-2.0.sql     | CacheCloud从1.2版本升级到2.0版本增量sql文件 |'), (20, '  | 3 | 2.0.sql | CacheCloud2.0版本的sql文件 |'), (26, '项目采用springboot部署方式，通过application-${profile}.yml来区分不同环境资源隔离,其中profile:本地(默认为local)、测试(test)、线上(online)。')]}"
121,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/static/wiki/access/resource.md,resource.md,5,"{'added': [(24, '资源下载地址：可访问资源地址；例如:http://%.%.%.com/software/cachecloud/resource')], 'deleted': [(24, '资源下载地址：可访问资源地址；例如:http://%.%.sohuno.com/software/cachecloud/resource')]}"
122,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/static/wiki/quickstart/index.md,index.md,5,"{'added': [(33, '准备配置文件：application-open.yml，放到war包同目录下'), (56, '\tnohup java -jar -Dspring.profiles.active=open cachecloud-web.war &'), (110, '\t将刚准备好资源的机器添加到cachecloud中台：<http://localhost:8080/manage/machine/index?tabTag=machine>')], 'deleted': [(33, '准备配置文件：application-open.yml'), (56, '\tnohup java -jar -Dspring.profiles.active=open -Dspring.config.location=${配置文件路径} cachecloud-web.war &'), (110, '\t将刚准备好资源的机器添加到cachecloud中台：<http://localhost:8080/manage/machine/list>')]}"
123,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/static/wiki/troubleshooting/activefrag.md,activefrag.md,5,"{'added': [(14, 'redis-cli -h 10.19.122.69 -p 6387 -a 5d948b734065a8f163cb931701b7ade2 --latency-history'), (190, '    - 升级到redis版本到4.0.14 或 5.0.x以上版本,新增配置对bigkey遍历键项数 active-defrag-max-scan-fields 1000(默认配置)；')], 'deleted': [(14, 'redis-cli -h 127.0.0.1 -p 6387 -a 5d948b734065a8f163cb931701b7ade2 --latency-history'), (190, '    - 升级到redis版本到4.0.14 或 5.0.x以上版本,新增配置对bigkey遍历键项数 active-defrag-max-scan-fields 1000(默认配置)；')]}"
124,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/templates/OperationAlert.ftl,OperationAlert.ftl,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud运维操作通知</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '            <ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">运维操作机器通知：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        机器ip'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        宿主机ip'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        机器详情'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        操作'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                        Status'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (37, '                        Message'), (38, '                    </td>'), (39, '                </tr>'), (40, '                <#list operationAlertValueResultList as item>'), (41, '                    <tr>'), (42, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (43, '                            ${item.ip!}'), (44, '                        </td>'), (45, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (46, '                            <#if item.machineInfo??>'), (47, '                                ${item.machineInfo.realIp!}'), (48, '                            </#if>'), (49, '                        </td>'), (50, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (51, '                            <#if item.machineInfo??>'), (52, '                                内存：${item.machineInfo.mem!} G<br/>'), (53, '                                cpu：${item.machineInfo.cpu!}<br/>'), (54, '                                备注说明：${item.machineInfo.extraDesc!}'), (55, '                            </#if>'), (56, '                        </td>'), (57, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (58, '                            ${item.type!}'), (59, '                        </td>'), (60, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (61, '                            ${item.status!}'), (62, '                        </td>'), (63, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (64, '                            ${item.message!}'), (65, '                        </td>'), (66, '                    </tr>'), (67, '                </#list>'), (68, ''), (69, '            </table>'), (70, '        </td>'), (71, '    </tr>'), (72, ''), (73, '</table>'), (74, '</p>'), (75, '</body>'), (76, '</html>')], 'deleted': []}"
125,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/templates/appAlert.ftl,appAlert.ftl,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>应用Redis分钟报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '            <ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用Redis分钟报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        ip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                        port'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                        属性值'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                        说明'), (41, '                    </td>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (43, '                        其他信息'), (44, '                    </td>'), (45, '                </tr>'), (46, ''), (47, '                <#list instanceAlertValueResultList as item>'), (48, '                    <tr>'), (49, '                        <#assign appid=item.appId?c>'), (50, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (51, ""                            <a href='${ccDomain}/admin/app/index?appId=${appid}'>${appid}</a>""), (52, '                        </td>'), (53, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (54, '                            ${item.appDesc.name!}'), (55, '                        </td>'), (56, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (57, '                            ${item.appDesc.officer!}'), (58, '                        </td>'), (59, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (60, '                            ${item.instanceInfo.ip!}'), (61, '                        </td>'), (62, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (63, '                            ${item.instanceInfo.port!}'), (64, '                        </td>'), (65, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (66, '                            ${item.instanceAlertConfig.alertConfig!}'), (67, '                        </td>'), (68, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (69, '                            ${item.alertMessage!}'), (70, '                        </td>'), (71, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (72, '                            ${item.otherInfo!}'), (73, '                        </td>'), (74, '                    </tr>'), (75, '                </#list>'), (76, ''), (77, '            </table>'), (78, '        </td>'), (79, '    </tr>'), (80, ''), (81, '</table>'), (82, '</p>'), (83, '</body>'), (84, '</html>')], 'deleted': []}"
126,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/templates/appAudit.ftl,appAudit.ftl,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud审核邮件</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td style=""width:5px;""></td>'), (15, '        <td style=""color:#3f3f3f; font-weight: bold;font-size:12px; font-family: \'宋体\'; padding: 5px 0 15px 0"">'), (16, '            ${appAudit.userName!}，您好，欢迎使用CacheCloud平台，您的申请处理进度如下：'), (17, '        </td>'), (18, '    </tr>'), (19, '    <tr>'), (20, '        <td></td>'), (21, '        <td style=""padding-top:20px; padding-left:27px;"">'), (22, '            <ul>'), (23, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">申请处理信息：</span></li>'), (24, '            </ul>'), (25, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (26, '                <tr>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (28, '                        申请类型：'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                        ${appAudit.typeDesc!}'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (34, '                        申请描述：'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                        ${appAudit.info!}'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (40, '                        申请时间：'), (41, '                    </td>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (43, '                        ${appAudit.createTimeFormat!}'), (44, '                    </td>'), (45, '                </tr>'), (46, '                <tr>'), (47, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (48, '                        处理状态：'), (49, '                    </td>'), (50, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (51, '                        ${appAudit.statusDesc!}'), (52, '                    </td>'), (53, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (54, '                        处理描述：'), (55, '                    </td>'), (56, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (57, '                        ${appAudit.refuseReason!}'), (58, '                    </td>'), (59, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (60, '                        处理时间：'), (61, '                    </td>'), (62, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (63, '                        ${appAudit.modifyTime?string(""yyyy-MM-dd HH:mm:ss"")!}'), (64, '                    </td>'), (65, '                </tr>'), (66, '            </table>'), (67, '            <br/>'), (68, '            <ul>'), (69, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用详细信息：</span></li>'), (70, '            </ul>'), (71, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (72, '                <tr>'), (73, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (74, '                        应用名称：'), (75, '                    </td>'), (76, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (77, '                        ${appDesc.name!}'), (78, '                    </td>'), (79, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (80, '                        应用类型：'), (81, '                    </td>'), (82, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (83, '                        ${appDesc.typeDesc!}'), (84, '                    </td>'), (85, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (86, '                        应用状态：'), (87, '                    </td>'), (88, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (89, '                        ${appDesc.statusDesc!}'), (90, '                    </td>'), (91, '                </tr>'), (92, '                <tr>'), (93, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (94, '                        是否测试：'), (95, '                    </td>'), (96, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (97, '                        <#if appDesc.isTest == 1>'), (98, '                            是'), (99, '                        <#else>'), (100, '                            否'), (101, '                        </#if>'), (102, '                    </td>'), (103, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (104, '                        是否持久化：'), (105, '                    </td>'), (106, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (107, '                        <#if appDesc.needPersistence == 1>'), (108, '                            是'), (109, '                        <#else>'), (110, '                            否'), (111, '                        </#if>'), (112, '                    </td>'), (113, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (114, '                        是否有后端数据源：'), (115, '                    </td>'), (116, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (117, '                        <#if appDesc.hasBackStore == 1>'), (118, '                            是'), (119, '                        <#else>'), (120, '                            否'), (121, '                        </#if>'), (122, '                    </td>'), (123, '                </tr>'), (124, '                <tr>'), (125, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (126, '                        应用描述：'), (127, '                    </td>'), (128, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (129, '                        ${appDesc.intro!}'), (130, '                    </td>'), (131, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (132, '                        应用负责人：'), (133, '                    </td>'), (134, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (135, '                        ${appDesc.officer!}'), (136, '                    </td>'), (137, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (138, '                        应用申请时间：'), (139, '                    </td>'), (140, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (141, '                        ${appDesc.createTime?string(""yyyy-MM-dd HH:mm:ss"")!}'), (142, '                    </td>'), (143, '                </tr>'), (144, '            </table>'), (145, '        </td>'), (146, '    </tr>'), (147, ''), (148, '</table>'), (149, '</p>'), (150, '</body>'), (151, '</html>')], 'deleted': []}"
127,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/templates/appDaily.ftl,appDaily.ftl,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud应用日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用详细信息：${appDesc.appId?c}</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (22, '                        应用名称：'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (25, '                        ${appDesc.name!}'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (28, '                        应用类型：'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                        ${appDesc.typeDesc!}'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (34, '                        应用状态：'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                        ${appDesc.statusDesc!}'), (38, '                    </td>'), (39, '                </tr>'), (40, '                <tr>'), (41, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (42, '                        应用描述：'), (43, '                    </td>'), (44, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (45, '                        ${appDesc.intro!}'), (46, '                    </td>'), (47, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (48, '                        应用负责人：'), (49, '                    </td>'), (50, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (51, '                        ${appDesc.officer!}'), (52, '                    </td>'), (53, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (54, '                        应用申请时间：'), (55, '                    </td>'), (56, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (57, '                        ${appDesc.createTime?string(""yyyy-MM-dd HH:mm:ss"")!}'), (58, '                    </td>'), (59, '                </tr>'), (60, '            </table>'), (61, ''), (62, '            <ul>'), (63, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">客户端相关(确保使用有客户端统计的版本):</span></li>'), (64, '            </ul>'), (65, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (66, '                <tr>'), (67, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (68, '                        客户端值分布(全天):'), (69, '                    </td>'), (70, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (71, '\t\t\t\t\t\t${appDailyData.valueSizeDistributeCountDesc!}'), (72, '                    </td>'), (73, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (74, '                        客户端连接数(每分钟)：'), (75, '                    </td>'), (76, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (77, '                        最大值:${appDailyData.maxMinuteClientCount!} <br/>'), (78, '                        平均值:${appDailyData.avgMinuteClientCount!}'), (79, '                    </td>'), (80, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (81, '                        客户端延迟事件数(全天)：'), (82, '                    </td>'), (83, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (84, '                        ${appDailyData.latencyCount!}'), (85, '                    </td>'), (86, '                </tr>'), (87, '                <tr>'), (88, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (89, '                        命令调用统计(全天):'), (90, '                    </td>'), (91, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (92, '                        次数:${appDailyData.clientCmdCount!}<br/>'), (93, '                        平均耗时(ms):${appDailyData.clientAvgCmdCost!}'), (94, '                    </td>'), (95, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (96, '                        连接异常统计(全天)：'), (97, '                    </td>'), (98, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (99, '                        次数:${appDailyData.clientConnExpCount!}<br/>'), (100, '                        平均耗时(ms):${appDailyData.clientAvgConnExpCost!}'), (101, '                    </td>'), (102, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (103, '                        命令超时统计(全天)：'), (104, '                    </td>'), (105, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (106, '                        次数:${appDailyData.clientCmdExpCount!} <br/>'), (107, '                        平均耗时(ms):${appDailyData.clientAvgCmdExpCost!}'), (108, '                    </td>'), (109, '                </tr>'), (110, '            </table>'), (111, '            <br/>'), (112, ''), (113, '            <ul>'), (114, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">服务端相关:</span></li>'), (115, '            </ul>'), (116, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (117, '                <tr>'), (118, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (119, '                        慢查询个数(全天)：'), (120, '                    </td>'), (121, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (122, '                        ${appDailyData.slowLogCount!}'), (123, '                    </td>'), (124, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (125, '                        命令次数(每分钟)：'), (126, '                    </td>'), (127, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (128, '                       \t 最大值:${appDailyData.maxMinuteCommandCount!} <br/>'), (129, '                       \t 平均值:${appDailyData.avgMinuteCommandCount!}'), (130, '                    </td>'), (131, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (132, '                        命中率(每分钟)：'), (133, '                    </td>'), (134, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (135, '                       \t 最大值:${appDailyData.maxMinuteHitRatio!}% <br/>'), (136, '                       \t 最小值:${appDailyData.minMinuteHitRatio!}% <br/>'), (137, '                       \t 平均值:${appDailyData.avgHitRatio!}%'), (138, '                    </td>'), (139, '                </tr>'), (140, ''), (141, '                <tr>'), (142, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (143, '                        内存使用量(全天)：'), (144, '                    </td>'), (145, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (146, '                        平均使用量:${appDailyData.avgUsedMemory!} M<br/>'), (147, '                        最大使用量:${appDailyData.maxUsedMemory!} M'), (148, '                    </td>'), (149, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (150, '                        过期键数(全天)：'), (151, '                    </td>'), (152, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (153, '                       \t ${appDailyData.expiredKeysCount!}'), (154, '                    </td>'), (155, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (156, '                        剔除键数(全天)：'), (157, '                    </td>'), (158, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (159, '                       \t ${appDailyData.evictedKeysCount!}'), (160, '                    </td>'), (161, '                </tr>'), (162, ''), (163, '                <tr>'), (164, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (165, '                       键个数(全天)：'), (166, '                    </td>'), (167, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (168, '                        平均值:${appDailyData.avgObjectSize!}<br/>'), (169, '                        最大值:${appDailyData.maxObjectSize!}'), (170, '                    </td>'), (171, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (172, '                        input流量(每分钟)：'), (173, '                    </td>'), (174, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (175, '                       \t 平均值:${appDailyData.avgMinuteNetInputByte!} M<br/>'), (176, '                       \t 最大值:${appDailyData.maxMinuteNetInputByte!} M<br/>'), (177, '                    </td>'), (178, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (179, '                        output流量(每分钟)：'), (180, '                    </td>'), (181, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (182, '                       \t 平均:${appDailyData.avgMinuteNetOutputByte!} M<br/>'), (183, '                       \t 最大:${appDailyData.maxMinuteNetOutputByte!} M<br/>'), (184, '                    </td>'), (185, '                </tr>'), (186, '            </table>'), (187, '            <br/>'), (188, ''), (189, '        </td>'), (190, '    </tr>'), (191, ''), (192, '</table>'), (193, '</p>'), (194, '</body>'), (195, '</html>')], 'deleted': []}"
128,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/templates/expAppsDaily.ftl,expAppsDaily.ftl,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>应用日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, ''), (10, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (11, '    <colgroup>'), (12, '        <col style=""width: 5px;"">'), (13, '    </colgroup>'), (14, ''), (15, '    <tr>'), (16, '        <td>'), (17, '        </td>'), (18, '        <td style=""padding-top:20px; padding-left:27px;"">'), (19, ''), (20, '            <ul>'), (21, '                <li>'), (22, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (23, '                        应用异常情况'), (24, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list?tabId=0&searchDate=${searchDate}"">【查看更多--后台】</a>'), (25, '                    </span>'), (26, '                </li>'), (27, '            </ul>'), (28, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (29, '                <tr>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        应用id'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                        应用名'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (37, '                        应用负责人'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (40, '                        异常总量(全天)'), (41, '                    </td>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (43, '                        连接异常(全天)'), (44, '                    </td>'), (45, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (46, '                        命令超时(全天)'), (47, '                    </td>'), (48, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, '                        延迟事件(全天)'), (50, '                    </td>'), (51, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (52, '                        慢查询(全天)'), (53, '                    </td>'), (54, '                </tr>'), (55, '                <#assign expAppStats=appClientGatherStatGroup[""expAppStats""]>'), (56, '                <#list expAppStats as item>'), (57, '                    <tr>'), (58, '                        <#assign appid=item[""app_id""]?c>'), (59, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (60, '                            <a target=""_blank"" href=""${ccDomain}/admin/app/index?appId=${appid}"">'), (61, '                                ${appid}'), (62, '                            </a>'), (63, '                        </td>'), (64, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (65, '                            ${appDescMap[appid].name!}'), (66, '                        </td>'), (67, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (68, '                            ${appDescMap[appid].officer!}'), (69, '                        </td>'), (70, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (71, '                            <a target=""_blank""'), (72, '                               href=""${ccDomain}/client/show/index?searchDate=${searchDate}&appId=${appid}""'), (73, '                               &tabTag=app_client_exception_statistics"">'), (74, '                                ${item[""exp_count""]}'), (75, '                            </a>'), (76, '                        </td>'), (77, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (78, '                            <a target=""_blank""'), (79, '                               href=""${ccDomain}/client/show/exceptionStatistics/client?searchDate=${searchDate}&appId=${appid}&exceptionType=0"">'), (80, '                                次数:${item[""conn_exp_count""]}'), (81, '                            </a>'), (82, '                            <br/>'), (83, ""                            平均耗时(ms):${item['avg_conn_exp_cost']}""), (84, '                        </td>'), (85, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (86, '                            <a target=""_blank""'), (87, '                               href=""${ccDomain}/client/show/exceptionStatistics/client?searchDate=${searchDate}&appId=${appid}&exceptionType=1"">'), (88, '                                次数:${item[""cmd_exp_count""]}'), (89, '                            </a>'), (90, '                            <br/>'), (91, '                            平均耗时(ms):${item[""avg_cmd_exp_cost""]}'), (92, '                        </td>'), (93, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (94, '                            <a target=""_blank""'), (95, '                               href=""${ccDomain}/admin/app/index?searchDate=${searchDate}&appId=${appid}&tabTag=app_latency"">'), (96, '                                ${item[""latency_count""]}'), (97, '                            </a>'), (98, '                        </td>'), (99, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (100, '                            <a target=""_blank""'), (101, '                               href=""${ccDomain}/admin/app/index?searchDate=${searchDate}&appId=${appid}&tabTag=app_latency"">'), (102, '                                ${item[""slow_log_count""]}'), (103, '                            </a>'), (104, '                        </td>'), (105, '                    </tr>'), (106, '                </#list>'), (107, '            </table>'), (108, ''), (109, ''), (110, '            <ul>'), (111, '                <li>'), (112, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (113, '                    应用延迟事件（top 10）'), (114, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list?tabId=0&searchDate=${searchDate}"">【查看更多--后台】</a>'), (115, '                    </span>'), (116, '                </li>'), (117, '            </ul>'), (118, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (119, '                <tr>'), (120, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (121, '                        应用id'), (122, '                    </td>'), (123, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (124, '                        应用名'), (125, '                    </td>'), (126, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (127, '                        应用负责人'), (128, '                    </td>'), (129, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (130, '                        延迟事件(全天)'), (131, '                    </td>'), (132, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (133, '                        慢查询(全天)'), (134, '                    </td>'), (135, '                </tr>'), (136, '                <#assign latencyAppStats=appClientGatherStatGroup[""latencyAppStats""]>'), (137, '                <#list latencyAppStats as item>'), (138, '                    <tr>'), (139, '                        <#assign appid=item[""app_id""]?c>'), (140, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (141, '                            <a target=""_blank""'), (142, '                               href=""${ccDomain}/admin/app/index?appId=${appid}"">'), (143, '                                ${appid}'), (144, '                            </a>'), (145, '                        </td>'), (146, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (147, '                            ${appDescMap[appid].name!}'), (148, '                        </td>'), (149, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (150, '                            ${appDescMap[appid].officer!}'), (151, '                        </td>'), (152, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (153, '                            <a target=""_blank""'), (154, '                               href=""${ccDomain}/admin/app/index?searchDate=${searchDate}&appId=${appid}&tabTag=app_latency"">'), (155, ""                                ${item['latency_count']}""), (156, '                            </a>'), (157, '                        </td>'), (158, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (159, '                            <a target=""_blank""'), (160, '                               href=""${ccDomain}/admin/app/index?searchDate=${searchDate}&appId=${appid}&tabTag=app_latency"">'), (161, ""                                ${item['slow_log_count']}""), (162, '                            </a>'), (163, '                        </td>'), (164, '                    </tr>'), (165, '                </#list>'), (166, '            </table>'), (167, ''), (168, '            <ul>'), (169, '                <li>'), (170, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (171, '                    应用拓扑诊断'), (172, '                        <a target=""_blank""'), (173, '                           href=""${ccDomain}/manage/app/stat/list/server?tabId=3&searchDate=${searchDate}"">【查看更多--后台】</a>'), (174, '                    </span>'), (175, '                </li>'), (176, '            </ul>'), (177, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (178, '                <tr>'), (179, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (180, '                        应用id'), (181, '                    </td>'), (182, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (183, '                        应用名'), (184, '                    </td>'), (185, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (186, '                        应用负责人'), (187, '                    </td>'), (188, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (189, '                        redis类型'), (190, '                    </td>'), (191, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (192, '                        redis版本'), (193, '                    </td>'), (194, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (195, '                        拓扑诊断结果'), (196, '                    </td>'), (197, '                </tr>'), (198, '                <#assign topologyAppStats=appClientGatherStatGroup[""topologyAppStats""]>'), (199, '                <#list topologyAppStats as item>'), (200, '                    <tr>'), (201, '                        <#assign appid=item[""app_id""]?c>'), (202, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (203, '                            <a target=""_blank""'), (204, '                               href=""${ccDomain}/admin/app/index?appId=${appid}"">'), (205, '                                ${appid}'), (206, '                            </a>'), (207, '                        </td>'), (208, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (209, '                            ${appDescMap[appid].name!}'), (210, '                        </td>'), (211, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (212, '                            ${appDescMap[appid].officer!}'), (213, '                        </td>'), (214, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (215, '                            ${appDescMap[appid].typeDesc!}'), (216, '                        </td>'), (217, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (218, '                            ${appDescMap[appid].versionName!}'), (219, '                        </td>'), (220, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (221, '                            <span style=""color:red"">异常</span>'), (222, '                            [<a target=""_blank""'), (223, '                                href=""${ccDomain}/manage/app/index?appId=${appid}&tabTag=app_ops_tool"">查看诊断</a>]'), (224, '                        </td>'), (225, '                    </tr>'), (226, '                </#list>'), (227, '            </table>'), (228, ''), (229, '            <ul>'), (230, '                <li>'), (231, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (232, '                        应用内存使用情况（bottom 10）'), (233, '                        <a target=""_blank""'), (234, '                           href=""${ccDomain}/manage/app/stat/list/server?tabId=1&searchDate=${searchDate}"">【查看更多--后台】</a>'), (235, '                </span>'), (236, '                </li>'), (237, '            </ul>'), (238, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (239, '                <tr>'), (240, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (241, '                        应用id'), (242, '                    </td>'), (243, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (244, '                        应用名'), (245, '                    </td>'), (246, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (247, '                        应用负责人'), (248, '                    </td>'), (249, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (250, '                        redis类型'), (251, '                    </td>'), (252, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (253, '                        内存'), (254, '                    </td>'), (255, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (256, '                        使用内存'), (257, '                    </td>'), (258, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (259, '                        内存使用率'), (260, '                    </td>'), (261, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (262, '                        应用客户端连接'), (263, '                    </td>'), (264, '                </tr>'), (265, '                <#assign memAlterAppStats=appClientGatherStatGroup[""memAlterAppStats""]>'), (266, '                <#list memAlterAppStats as item>'), (267, '                    <tr>'), (268, '                        <#assign appid=item[""app_id""]?c>'), (269, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (270, '                            <a target=""_blank""'), (271, '                               href=""${ccDomain}/admin/app/index?appId=${appid}"">'), (272, '                                ${appid}'), (273, '                            </a>'), (274, '                        </td>'), (275, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (276, '                            ${appDescMap[appid].name!}'), (277, '                        </td>'), (278, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (279, '                            ${appDescMap[appid].officer!}'), (280, '                        </td>'), (281, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (282, '                            ${appDescMap[appid].typeDesc!}'), (283, '                        </td>'), (284, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (285, '                            ${item[""format_mem""]} G'), (286, '                        </td>'), (287, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (288, '                            ${item[""format_used_memory""]}'), (289, '                        </td>'), (290, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (291, '                            ${item[""mem_used_ratio""]} %'), (292, '                        </td>'), (293, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (294, '                            <a href=""${ccDomain}/admin/app/index?appId=${appid}&tabTag=app_clientList""'), (295, '                               target=""_blank"">'), (296, '                                ${item[""connected_clients""]}'), (297, '                            </a>'), (298, '                        </td>'), (299, '                    </tr>'), (300, '                </#list>'), (301, '            </table>'), (302, ''), (303, ''), (304, '            <ul>'), (305, '                <li>'), (306, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (307, '                        应用碎片率情况（top 10）'), (308, '                        <a target=""_blank""'), (309, '                           href=""${ccDomain}/manage/app/stat/list/server?tabId=2&searchDate=${searchDate}"">【查看更多--后台】</a>'), (310, '                </span>'), (311, '                </li>'), (312, '            </ul>'), (313, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (314, '                <tr>'), (315, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (316, '                        应用id'), (317, '                    </td>'), (318, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (319, '                        应用名'), (320, '                    </td>'), (321, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (322, '                        应用负责人'), (323, '                    </td>'), (324, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (325, '                        redis版本'), (326, '                    </td>'), (327, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (328, '                        内存使用'), (329, '                    </td>'), (330, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (331, '                        rss内存使用'), (332, '                    </td>'), (333, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (334, '                        平均碎片率'), (335, '                    </td>'), (336, '                </tr>'), (337, '                <#assign fragRatioAppStats=appClientGatherStatGroup[""fragRatioAppStats""]>'), (338, '                <#list fragRatioAppStats as item>'), (339, '                    <tr>'), (340, '                        <#assign appid=item[""app_id""]?c>'), (341, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (342, '                            <a target=""_blank""'), (343, '                               href=""${ccDomain}/admin/app/index?appId=${appid}"">'), (344, '                                ${appid}'), (345, '                            </a>'), (346, '                        </td>'), (347, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (348, '                            ${appDescMap[appid].name!}'), (349, '                        </td>'), (350, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (351, '                            ${appDescMap[appid].officer!}'), (352, '                        </td>'), (353, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (354, '                            ${appDescMap[appid].versionName!}'), (355, '                        </td>'), (356, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (357, '                            ${item[""format_used_memory""]} G'), (358, '                        </td>'), (359, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (360, '                            ${item[""format_used_memory_rss""]} G'), (361, '                        </td>'), (362, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (363, '                            ${item[""avg_mem_frag_ratio""]}'), (364, '                        </td>'), (365, '                    </tr>'), (366, '                </#list>'), (367, '            </table>'), (368, '        </td>'), (369, '    </tr>'), (370, ''), (371, '</table>'), (372, '</p>'), (373, '</body>'), (374, '</html>')], 'deleted': []}"
129,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/templates/instanceAlert.ftl,instanceAlert.ftl,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Redis实例分钟报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例分钟报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        \t负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        \tip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                    \t\tport'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                    \t\t属性值'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                    \t\t说明'), (41, '                    </td>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (43, '                    \t\t其他信息'), (44, '                    </td>'), (45, '                </tr>'), (46, '\t\t\t\t<#list instanceAlertValueResultList as item>'), (47, '\t\t\t\t\t<tr>'), (48, '                        <#assign appid=item.appId?c>'), (49, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (50, ""\t\t\t\t\t\t\t<a href='${ccDomain}/admin/app/index?appId=${appid}'>${appid}</a>""), (51, '\t\t\t\t\t\t</td>'), (52, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (53, '\t\t\t\t\t\t\t${item.appDesc.name!}'), (54, '\t\t\t\t\t\t</td>'), (55, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (56, '\t\t\t\t\t\t\t${item.appDesc.officer!}'), (57, '\t\t\t\t\t\t</td>'), (58, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (59, '\t\t\t\t\t\t\t${item.instanceInfo.ip!}'), (60, '\t\t\t\t\t\t</td>'), (61, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (62, '\t\t\t\t\t\t\t${item.instanceInfo.port!}'), (63, '\t\t\t\t\t\t</td>'), (64, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (65, '\t\t\t\t\t\t\t${item.instanceAlertConfig.alertConfig!}'), (66, '\t\t\t\t\t\t</td>'), (67, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (68, '\t\t\t\t\t\t\t${item.alertMessage!}'), (69, '\t\t\t\t\t\t</td>'), (70, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (71, '\t\t\t\t\t\t\t${item.otherInfo!}'), (72, '\t\t\t\t\t\t</td>'), (73, '\t\t\t\t\t</tr>'), (74, '\t\t\t\t</#list>'), (75, ''), (76, '            </table>'), (77, '        </td>'), (78, '    </tr>'), (79, ''), (80, '</table>'), (81, '</p>'), (82, '</body>'), (83, '</html>')], 'deleted': []}"
130,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/templates/instanceRecover.ftl,instanceRecover.ftl,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Pod重启探测Redis实例</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例自动拉起列表：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t容器ip'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                    \t\tport'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                    \t\t说明'), (32, '                    </td>'), (33, '                </tr>'), (34, '                <#list instanceAlertValueResultList as item>'), (35, '                <tr>'), (36, '                    <#assign appid=item.instanceInfo.appId?c>'), (37, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (38, ""                        <a href='${ccDomain}/admin/app/index?appId=${appid}'>${appid}</a>""), (39, '                    </td>'), (40, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (41, '                        ${item.instanceInfo.ip!}'), (42, '                    </td>'), (43, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (44, '                        ${item.instanceInfo.port!}'), (45, '                    </td>'), (46, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (47, '                        实例恢复时间：${item.otherInfo!}'), (48, '                    </td>'), (49, '                </tr>'), (50, '                </#list>'), (51, ''), (52, '            </table>'), (53, '        </td>'), (54, '    </tr>'), (55, ''), (56, '</table>'), (57, '</p>'), (58, '</body>'), (59, '</html>')], 'deleted': []}"
131,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/templates/instanceState.ftl,instanceState.ftl,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Redis实例状态监控报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例状态监控报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        \t负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        \tip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                    \t\tport'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                    \t\t状态'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                    \t\t说明'), (41, '                    </td>'), (42, '                </tr>'), (43, '                <#list instanceAlertValueResultList as item>'), (44, '                    <tr>'), (45, '                        <#assign appid=item.appId?c>'), (46, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (47, ""                            <a href='${ccDomain}/admin/app/index?appId=${appid}'>${appid}</a>""), (48, '                        </td>'), (49, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (50, '                            ${item.appDesc.name!}'), (51, '                        </td>'), (52, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (53, '                            ${item.appDesc.officer!}'), (54, '                        </td>'), (55, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (56, '                            ${item.instanceInfo.ip!}'), (57, '                        </td>'), (58, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (59, '                            ${item.instanceInfo.port!}'), (60, '                        </td>'), (61, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (62, '                            ${item.instanceInfo.status!}'), (63, '                        </td>'), (64, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (65, '                            ${item.otherInfo!}'), (66, '                        </td>'), (67, '                    </tr>'), (68, '                </#list>'), (69, ''), (70, '            </table>'), (71, '        </td>'), (72, '    </tr>'), (73, ''), (74, '</table>'), (75, '</p>'), (76, '</body>'), (77, '</html>')], 'deleted': []}"
132,9f3f988374248e809447d9fc31a46fc39bcab005,cachecloud-web/src/main/resources/templates/topologyExam.ftl,topologyExam.ftl,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>应用拓扑检查日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">online应用拓扑检查情况：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        appId'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        应用类型'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        问题'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        描述'), (32, '                    </td>'), (33, '                </tr>'), (34, '                <#list examResult as item>'), (35, '                    <tr>'), (36, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (37, ""                            ${item['appId']?c}""), (38, '                        </td>'), (39, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (40, ""                            ${item['type']}""), (41, '                        </td>'), (42, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (43, ""                            ${item['status']}""), (44, '                        </td>'), (45, '                        <td align=""left"" style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (46, '                            <#list item[\'desc\']?split(""\\n"") as str>'), (47, '                                ${str}<br/>'), (48, '                            </#list>'), (49, '                        </td>'), (50, '                    </tr>'), (51, '                </#list>'), (52, '            </table>'), (53, ''), (54, '        </td>'), (55, '    </tr>'), (56, ''), (57, '</table>'), (58, '</p>'), (59, '</body>'), (60, '</html>')], 'deleted': []}"
133,ddc0c84588cc124e10da9293abf0800605c60d3e,cachecloud-web/src/main/resources/application-online.yml,application-online.yml,5,"{'added': [(12, '    url: jdbc:mysql://127.0.0.1:3306/redis_open')], 'deleted': [(12, '    url: jdbc:mysql://10.18.57.35:3306/redis_open')]}"
134,ddc0c84588cc124e10da9293abf0800605c60d3e,cachecloud-web/src/main/resources/application-test.yml,application-test.yml,5,"{'added': [(12, '    url: jdbc:mysql://127.0.0.1:3306/redis_open')], 'deleted': [(12, '    url: jdbc:mysql://10.18.57.35:3306/redis_open')]}"
135,ddc0c84588cc124e10da9293abf0800605c60d3e,cachecloud-web/src/main/resources/static/wiki/troubleshooting/activefrag.md,activefrag.md,5,"{'added': [(14, 'redis-cli -h 127.0.0.1 -p 6387 -a 5d948b734065a8f163cb931701b7ade2 --latency-history'), (190, '    - 升级到redis版本到4.0.14 或 5.0.x以上版本,新增配置对bigkey遍历键项数 active-defrag-max-scan-fields 1000(默认配置)；')], 'deleted': [(14, 'redis-cli -h 10.19.122.69 -p 6387 -a 5d948b734065a8f163cb931701b7ade2 --latency-history'), (190, '    - 升级到redis版本到4.0.14 或 5.0.x以上版本,新增配置对bigkey遍历键项数 active-defrag-max-scan-fields 1000(默认配置)；')]}"
136,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-client/cachecloud-client-spectator/src/main/resources/cachecloud-client.properties,cachecloud-client.properties,1,"{'added': [(1, 'cc_domain_url={your_cachecloud_domain}'), (2, 'http_conn_timeout=3000'), (3, 'http_socket_timeout=5000'), (4, 'cc_client_version=2.0.3-RELEASE')], 'deleted': []}"
137,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/application-local.yml,application-local.yml,1,"{'added': [(1, 'spring:'), (2, '  application:'), (3, '    name: cloud.cachecloud-web.local'), (4, '    import: classpath:spring/spring.xml'), (5, ''), (6, 'server:'), (7, '  port: 8080'), (8, '  # ip/域名地址'), (9, '  domain: 127.0.0.1:8080'), (10, '  jsp-servlet:'), (11, '    init-parameters:'), (12, '      development: true #jsp 热部署'), (13, ''), (14, 'cachecloud:'), (15, '  primary:'), (16, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud_open'), (17, '    user: cachecloud'), (18, '    password: cachecloud'), (19, '    initialPoolSize: 1'), (20, '    maxPoolSize: 3'), (21, '  redis:'), (22, '    main:'), (23, '      host: 127.0.0.1'), (24, '      port: 6379'), (25, '      password:'), (26, '  #区分资源'), (27, '  web:'), (28, '    clients: 127.0.0.1')], 'deleted': []}"
138,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/application-online.yml,application-online.yml,1,"{'added': [(1, 'spring:'), (2, '  application:'), (3, '    name: cloud.cachecloud-web.open.online'), (4, '    import: classpath:spring/spring.xml'), (5, ''), (6, 'server:'), (7, '  port: 8080'), (8, '  domain: 127.0.0.1:8080'), (9, ''), (10, 'cachecloud:'), (11, '  primary:'), (12, '    url: jdbc:mysql://10.18.57.35:3306/redis_open'), (13, '    user: redis_open_rw'), (14, '    password: 67b033tE104089l'), (15, '    initialPoolSize: 10'), (16, '    maxPoolSize: 50'), (17, '  redis: # task redis log'), (18, '    main:'), (19, '      host: 127.0.0.1'), (20, '      port: 6379'), (21, '      password:'), (22, '  #区分资源'), (23, '  web:'), (24, '    clients: 127.0.0.1')], 'deleted': []}"
139,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/application-open.yml,application-open.yml,1,"{'added': [(1, 'spring:'), (2, '  application:'), (3, '    name: cloud.cachecloud-web.open'), (4, '    import: classpath:spring/spring.xml'), (5, ''), (6, 'server:'), (7, '  port: 8080'), (8, '  domain: 127.0.0.1:8080'), (9, ''), (10, 'cachecloud:'), (11, '  primary:'), (12, '    url: jdbc:mysql://127.0.0.1:3306/cachecloud_open'), (13, '    user: cachecloud'), (14, '    password: cachecloud'), (15, '    initialPoolSize: 10'), (16, '    maxPoolSize: 50'), (17, '  redis: # task redis log'), (18, '    main:'), (19, '      host: 127.0.0.1'), (20, '      port: 6379'), (21, '      password:'), (22, '  #区分资源'), (23, '  web:'), (24, '    clients: 127.0.0.1')], 'deleted': []}"
140,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/application-test.yml,application-test.yml,1,"{'added': [(1, 'spring:'), (2, '  application:'), (3, '    name: cloud.cachecloud-web.open.test'), (4, '    import: classpath:spring/spring.xml'), (5, ''), (6, 'server:'), (7, '  port: 8080'), (8, '  domain: 127.0.0.1:8080'), (9, ''), (10, 'cachecloud:'), (11, '  primary:'), (12, '    url: jdbc:mysql://10.18.57.35:3306/redis_open'), (13, '    user: redis_open_rw'), (14, '    password: 67b033tE104089l'), (15, '    initialPoolSize: 3'), (16, '    maxPoolSize: 20'), (17, '  redis:'), (18, '    main:'), (19, '      host: 127.0.0.1'), (20, '      port: 6379'), (21, '      password:'), (22, '  #区分资源'), (23, '  web:'), (24, '    clients: 127.0.0.1')], 'deleted': []}"
141,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/application.yml,application.yml,1,"{'added': [(1, 'spring:'), (2, '  profiles:'), (3, '    active: local'), (4, '  mvc:'), (5, '    servlet:'), (6, '      load-on-startup: 1'), (7, '    view:'), (8, '      prefix: /WEB-INF/jsp/'), (9, '      suffix: .jsp'), (10, '    freemarker:'), (11, '      expose-request-attributes: true'), (12, '      request-context-attribute: request'), (13, '      suffix: .jsp'), (14, '      settings:'), (15, '        number_format: computer'), (16, '    log-resolved-exception: true'), (17, '  http:'), (18, '    encoding:'), (19, '      charset: UTF-8'), (20, '      enabled: true'), (21, '      force: true'), (22, 'cachecloud:'), (23, '  jdbc:'), (24, '    driver: com.mysql.jdbc.Driver'), (25, '    validationQuery: select 1 from dual'), (26, 'management:'), (27, '  security:'), (28, '    enabled: false'), (29, '  port: 8888'), (30, '  context-path: /actuator'), (31, '#关闭不安全控制endpoints'), (32, 'endpoints:'), (33, '  shutdown:'), (34, '    enabled: false'), (35, '  restart:'), (36, '    enabled: false'), (37, '  pause:'), (38, '    enabled: false'), (39, '  heapdump:'), (40, '    enabled: false'), (41, '  refresh:'), (42, '    enabled: false'), (43, '  auditevents:'), (44, '    enabled: false'), (45, '  jolokia:'), (46, '    enabled: false'), (47, '  env:'), (48, '    post:'), (49, '      enabled: false')], 'deleted': []}"
142,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/cachecloud-web.conf,cachecloud-web.conf,1,"{'added': [(1, 'PID_FOLDER=/data/cachecloud-web'), (2, 'LOG_FOLDER=/data/cachecloud-web/logs'), (3, 'LOG_FILENAME=cachecloud-web.log'), (4, 'APP_NAME=cachecloud-web'), (5, 'RUN_ARGS='), (6, 'JAVA_HOME=/usr/local/jdk'), (7, 'JAVA_OPTS=""-server -Xmx4g -Xms4g -Xss256k -XX:MaxDirectMemorySize=1G -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:G1ReservePercent=25 -XX:InitiatingHeapOccupancyPercent=40 -XX:+PrintGCDateStamps -Xloggc:/opt/cachecloud-web/logs/gc.log -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=10 -XX:GCLogFileSize=100M -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/opt/cachecloud-web/logs/java.hprof -XX:+DisableExplicitGC -XX:-OmitStackTraceInFastThrow -XX:+PrintCommandLineFlags -XX:+UnlockCommercialFeatures -XX:+FlightRecorder -Djava.awt.headless=true -Djava.net.preferIPv4Stack=true -Djava.util.Arrays.useLegacyMergeSort=true -Dfile.encoding=UTF-8 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=22099 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false""')], 'deleted': []}"
143,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/logback-spring.xml,logback-spring.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<!--'), (3, '  Example LOGBACK Configuration File'), (4, '  http://logback.qos.ch/manual/configuration.html'), (5, '  -->'), (6, '<configuration scan=""true"" scanPeriod=""30 seconds"">'), (7, '    <include resource=""org/springframework/boot/logging/logback/defaults.xml""/>'), (8, '    <jmxConfigurator/>'), (9, ''), (10, '    <springProfile name=""local,open"">'), (11, '        <appender name=""console"" class=""ch.qos.logback.core.ConsoleAppender"">'), (12, '            <encoder>'), (13, '                <pattern>${CONSOLE_LOG_PATTERN}</pattern>'), (14, '            </encoder>'), (15, '        </appender>'), (16, '        <root level=""INFO"">'), (17, '            <appender-ref ref=""console""/>'), (18, '        </root>'), (19, '    </springProfile>'), (20, ''), (21, '    <springProfile name=""test,online"">'), (22, '        <if condition=\'isDefined(""MY_POD_NAME"")\'>'), (23, '            <then>'), (24, '                <property name=""log.dir"" value=""/data/${MY_POD_NAME}/logs""/>'), (25, '            </then>'), (26, '            <else>'), (27, '                <property name=""log.dir"" value=""/data/logs""/>'), (28, '            </else>'), (29, '        </if>'), (30, ''), (31, '        <property name=""log.level"" value=""INFO""/>'), (32, '        <appender name=""stdout"" class=""ch.qos.logback.core.rolling.RollingFileAppender"">'), (33, '            <file>${log.dir}/cachecloud.log</file>'), (34, '            <encoder class=""ch.qos.logback.classic.encoder.PatternLayoutEncoder"">'), (35, '                <pattern>${FILE_LOG_PATTERN}</pattern>'), (36, '            </encoder>'), (37, ''), (38, '            <filter class=""ch.qos.logback.classic.filter.ThresholdFilter"">'), (39, '                <level>${log.level}</level>'), (40, '            </filter>'), (41, ''), (42, '            <rollingPolicy class=""ch.qos.logback.core.rolling.TimeBasedRollingPolicy"">'), (43, '                <FileNamePattern>${log.dir}/otherdays/cachecloud.%d{yyyy-MM-dd}.log</FileNamePattern>'), (44, '                <MaxHistory>30</MaxHistory>'), (45, '            </rollingPolicy>'), (46, '        </appender>'), (47, ''), (48, '        <appender name=""stderr"" class=""ch.qos.logback.core.rolling.RollingFileAppender"">'), (49, '            <file>${log.dir}/cachecloud_stderr.log</file>'), (50, '            <encoder class=""ch.qos.logback.classic.encoder.PatternLayoutEncoder"">'), (51, '                <pattern>${FILE_LOG_PATTERN}</pattern>'), (52, '            </encoder>'), (53, ''), (54, '            <filter class=""ch.qos.logback.classic.filter.ThresholdFilter"">'), (55, '                <level>WARN</level>'), (56, '            </filter>'), (57, ''), (58, '            <rollingPolicy class=""ch.qos.logback.core.rolling.TimeBasedRollingPolicy"">'), (59, '                <FileNamePattern>${log.dir}/otherdays/cachecloud_stderr.%d{yyyy-MM-dd}.log</FileNamePattern>'), (60, '                <MaxHistory>30</MaxHistory>'), (61, '            </rollingPolicy>'), (62, '        </appender>'), (63, ''), (64, '        <appender name=""managerAppender"" class=""ch.qos.logback.core.rolling.RollingFileAppender"">'), (65, '            <file>${log.dir}/manager/cachecloud_manager.log</file>'), (66, '            <rollingPolicy class=""ch.qos.logback.core.rolling.TimeBasedRollingPolicy"">'), (67, '                <fileNamePattern>${log.dir}/manager/cachecloud_manager.%d{yyyyMMddHH}.log'), (68, '                </fileNamePattern>'), (69, '                <maxHistory>30</maxHistory>'), (70, '            </rollingPolicy>'), (71, '            <encoder>'), (72, '                <pattern>${FILE_LOG_PATTERN}</pattern>'), (73, '            </encoder>'), (74, '        </appender>'), (75, ''), (76, '        <appender name=""quartzAppender"" class=""ch.qos.logback.core.rolling.RollingFileAppender"">'), (77, '            <file>${log.dir}/quartz.log</file>'), (78, '            <encoder class=""ch.qos.logback.classic.encoder.PatternLayoutEncoder"">'), (79, '                <pattern>${FILE_LOG_PATTERN}</pattern>'), (80, '            </encoder>'), (81, ''), (82, '            <rollingPolicy class=""ch.qos.logback.core.rolling.TimeBasedRollingPolicy"">'), (83, '                <FileNamePattern>${log.dir}/otherdays/quartz.%d{yyyy-MM-dd}.log</FileNamePattern>'), (84, '                <MaxHistory>30</MaxHistory>'), (85, '            </rollingPolicy>'), (86, '        </appender>'), (87, ''), (88, '        <springProperty scope=""context"" name=""appName"" source=""spring.application.name""/>'), (89, '        <appender name=""json"" class=""ch.qos.logback.core.rolling.RollingFileAppender"">'), (90, '            <file>${log.dir}/json.log</file>'), (91, '            <encoder class=""net.logstash.logback.encoder.LogstashEncoder"">'), (92, '                <customFields>'), (93, '                    {'), (94, '                    ""cluster_name"": ""${CLUSTER_NAME}"",'), (95, '                    ""my_pod_namespace"": ""${MY_POD_NAMESPACE}"",'), (96, '                    ""my_pod_name"": ""${MY_POD_NAME}"",'), (97, '                    ""my_node_name"": ""${MY_NODE_NAME}"",'), (98, '                    ""my_pod_ip"": ""${MY_POD_IP}""'), (99, '                    }'), (100, '                </customFields>'), (101, '            </encoder>'), (102, '            <rollingPolicy class=""ch.qos.logback.core.rolling.TimeBasedRollingPolicy"">'), (103, '                <FileNamePattern>${log.dir}/json.%d{yyyy-MM-dd}.log</FileNamePattern>'), (104, '                <MaxHistory>1</MaxHistory>'), (105, '            </rollingPolicy>'), (106, '        </appender>'), (107, ''), (108, '        <root level=""INFO"">'), (109, '            <appender-ref ref=""stdout""/>'), (110, '            <appender-ref ref=""stderr""/>'), (111, '            <if condition=\'isDefined(""MY_POD_NAME"")\'>'), (112, '                <then>'), (113, '                    <appender-ref ref=""json""/>'), (114, '                </then>'), (115, '            </if>'), (116, '        </root>'), (117, ''), (118, '        <logger name=""com.sohu.cache.web.controller.AppManageController"" level=""WARN"">'), (119, '            <appender-ref ref=""managerAppender""/>'), (120, '        </logger>'), (121, ''), (122, '        <logger name=""com.sohu.cache.web.controller.InstanceManageController"" level=""WARN"">'), (123, '            <appender-ref ref=""managerAppender""/>'), (124, '        </logger>'), (125, ''), (126, '        <logger name=""org.quartz"" level=""INFO"" additivity=""false"">'), (127, '            <appender-ref ref=""quartzAppender""/>'), (128, '        </logger>'), (129, ''), (130, '        <logger name=""org.quartz.core.QuartzSchedulerThread"" level=""DEBUG"" additivity=""false"">'), (131, '            <appender-ref ref=""quartzAppender""/>'), (132, '        </logger>'), (133, ''), (134, '        <logger name=""net.schmizz.sshj.transport.TransportImpl"" level=""off""/>'), (135, '        <logger name=""net.schmizz.sshj.transport.random.BouncyCastleRandom"" level=""off""/>'), (136, '    </springProfile>'), (137, ''), (138, ''), (139, '</configuration>')], 'deleted': []}"
144,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppAuditDao.xml,AppAuditDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppAuditDao"">'), (5, '    <sql id=""columns"">'), (6, '    \tapp_id,user_id,user_name,type,param1,param2,param3,info,status,modify_time'), (7, '    </sql>'), (8, ''), (9, '    <select id=""selectWaitAppAudits"" resultType=""com.sohu.cache.entity.AppAudit"">'), (10, '        select id,<include refid=""columns""/>,task_id,create_time,operate_id,refuse_reason'), (11, '        from app_audit'), (12, '        <where>'), (13, '            <choose>'), (14, '                <when test=""status != null and status!=4"">and status=#{status}</when>'), (15, '                <when test=""status == null"">and status in (0,2)</when>'), (16, '            </choose>'), (17, '            <choose>'), (18, '                <when test=""type != null"">and type=#{type}</when>'), (19, '            </choose>'), (20, '            <choose>'), (21, '                <when test=""auditId != null"">and id=#{auditId}</when>'), (22, '            </choose>'), (23, '            <choose>'), (24, '                <when test=""userId != null"">and user_id=#{userId}</when>'), (25, '            </choose>'), (26, '            <choose>'), (27, '                <when test=""operateId != null"">and operate_id=#{operateId}</when>'), (28, '            </choose>'), (29, '        </where>'), (30, '        order by create_time desc'), (31, '    </select>'), (32, ''), (33, '    <select id=""getAppAudit"" resultType=""com.sohu.cache.entity.AppAudit"">'), (34, '        select id,<include refid=""columns""/>,create_time,refuse_reason'), (35, '        from app_audit'), (36, '        where id=#{id}'), (37, '    </select>'), (38, ''), (39, '    <insert id=""insertAppAudit"" parameterType=""com.sohu.cache.entity.AppAudit"" keyProperty=""id"" useGeneratedKeys=""true"">'), (40, '        insert into app_audit(<include refid=""columns""/>)'), (41, '        values(#{appId},#{userId},#{userName},#{type},#{param1},#{param2},#{param3},#{info},#{status},#{modifyTime})'), (42, '    </insert>'), (43, ''), (44, '    <update id=""updateAppAuditUser"" parameterType=""com.sohu.cache.entity.AppAudit"">'), (45, '        update app_audit'), (46, '        set'), (47, '          status = #{status},'), (48, '          operate_id = #{operateId},'), (49, '          modify_time = current_timestamp()'), (50, '        where id=#{id}'), (51, '    </update>'), (52, ''), (53, '    <update id=""updateAppAuditOperateUser"" parameterType=""com.sohu.cache.entity.AppAudit"">'), (54, '        update app_audit'), (55, '        set'), (56, '          operate_id = #{operateId},'), (57, '          modify_time = current_timestamp()'), (58, '        where id=#{id}'), (59, '    </update>'), (60, ''), (61, '    <update id=""updateAppAudit"" parameterType=""com.sohu.cache.entity.AppAudit"">'), (62, '        update app_audit'), (63, '        set'), (64, '          status = #{status},'), (65, '          modify_time = current_timestamp()'), (66, '        where id=#{id}'), (67, '    </update>'), (68, ''), (69, '    <update id=""updateRefuseReason"" parameterType=""com.sohu.cache.entity.AppAudit"">'), (70, '        update app_audit'), (71, '        set'), (72, '          refuse_reason = #{refuseReason}, modify_time = current_timestamp()'), (73, '        where id=#{id}'), (74, '    </update>'), (75, ''), (76, '    <select id=""getAppAuditByAppId"" resultType=""com.sohu.cache.entity.AppAudit"">'), (77, '        select id,<include refid=""columns""/>,create_time,refuse_reason'), (78, '        from app_audit'), (79, '        where app_id=#{appId}'), (80, '    </select>'), (81, ''), (82, '    <select id=""getAppAuditByCondition"" resultType=""com.sohu.cache.entity.AppAudit"">'), (83, '        select id,<include refid=""columns""/>,create_time,refuse_reason'), (84, '        from app_audit'), (85, '        where app_id=#{appId} and type=#{type}'), (86, '    </select>'), (87, ''), (88, ''), (89, '    <update id=""updateTaskId"">'), (90, '        update app_audit set task_id = #{taskId}, modify_time = now() where id=#{id}'), (91, '    </update>'), (92, ''), (93, '    <select id=""getStatisticGroupByStatus"" resultType=""hashmap"">'), (94, '        select sum(1) count,status'), (95, '        from app_audit'), (96, '        <where>'), (97, '            <choose>'), (98, '                <when test=""operateId != null"">and operate_id=#{operateId}</when>'), (99, '            </choose>'), (100, '            <choose>'), (101, '                <when test=""userId != null"">and user_id=#{userId}</when>'), (102, '            </choose>'), (103, '            <choose>'), (104, '                <when test=""startTime != null and endTime != null"">and modify_time between #{startTime} and #{endTime}'), (105, '                </when>'), (106, '            </choose>'), (107, '        </where>'), (108, '        group by status;'), (109, '    </select>'), (110, ''), (111, '    <select id=""getStatisticGroupByType"" resultType=""hashmap"">'), (112, '        select sum(1) count,type'), (113, '        from app_audit'), (114, '        <where>'), (115, '            <choose>'), (116, '                <when test=""operateId != null"">and operate_id=#{operateId}</when>'), (117, '            </choose>'), (118, '            <choose>'), (119, '                <when test=""userId != null"">and user_id=#{userId}</when>'), (120, '            </choose>'), (121, '            <choose>'), (122, '                <when test=""startTime != null and endTime != null"">and modify_time between #{startTime} and #{endTime}'), (123, '                </when>'), (124, '            </choose>'), (125, '        </where>'), (126, '        group by type;'), (127, '    </select>'), (128, ''), (129, '</mapper>')], 'deleted': []}"
145,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppAuditLogDao.xml,AppAuditLogDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppAuditLogDao"">'), (6, '    <sql id=""app_audit_log_column"">'), (7, '    \tapp_id,user_id,info,create_time,type,app_audit_id'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""save"" parameterType=""AppAuditLog""  keyProperty=""id"" useGeneratedKeys=""true"" >'), (11, '    \tinsert into app_audit_log'), (12, '    \t\t(<include refid=""app_audit_log_column""/>)'), (13, '\t\tvalues'), (14, '\t\t\t(#{appId},#{userId},#{info},#{createTime},#{type},#{appAuditId})'), (15, '    </insert>'), (16, ''), (17, '    <select id=""getAuditByType"" resultType=""AppAuditLog"">'), (18, '        select id,<include refid=""app_audit_log_column""/>'), (19, '        from app_audit_log'), (20, '        where app_audit_id=#{appAuditId} and type=#{type}'), (21, '    </select>'), (22, ''), (23, '</mapper>'), (24, ''), (25, '')], 'deleted': []}"
146,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientCommandStatisticsDao.xml,AppClientCommandStatisticsDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientCommandStatisticsDao"">'), (5, '    <sql id=""columns"">'), (6, '\t\tapp_id,current_min,client_ip,command,cost,count,bytes_in,bytes_out'), (7, '\t</sql>'), (8, ''), (9, '    <insert id=""batchSave"">'), (10, '        insert ignore into app_client_command_minute_statistics (<include refid=""columns""/>)'), (11, '        values'), (12, '        <foreach collection=""list"" item=""clientException"" separator="","">'), (13, '            (#{clientException.appId},#{clientException.currentMin},#{clientException.clientIp},'), (14, '            #{clientException.command},#{clientException.cost},#{clientException.count},#{clientException.bytesIn},#{clientException.bytesOut})'), (15, '        </foreach>'), (16, '    </insert>'), (17, ''), (18, '    <select id=""getAppDistinctCommand"" resultType=""string"">'), (19, '   \t\tselect command from app_client_command_minute_statistics where app_id=#{appId} and current_min between #{startTime} and #{endTime} group by command order by sum(count) desc;'), (20, '    </select>'), (21, ''), (22, '    <select id=""getAppDistinctClients"" resultType=""string"">'), (23, '   \t\tselect distinct client_ip from app_client_command_minute_statistics where app_id=#{appId} and current_min between #{startTime} and #{endTime};'), (24, '    </select>'), (25, ''), (26, '    <select id=""getAppCommandStatistics"" resultType=""hashmap"">'), (27, '        select'), (28, '        app_id,current_min,UNIX_TIMESTAMP(current_min) timestamp,client_ip,command,sum(cost)/sum(count) cost,sum(count)'), (29, '        count,sum(bytes_in) bytes_in,sum(bytes_out) bytes_out'), (30, '        from app_client_command_minute_statistics'), (31, '        where app_id=#{appId} and current_min between #{startTime} and #{endTime}'), (32, '        <choose>'), (33, '            <when test=""command != null and command != \'\'"">'), (34, '                and command=#{command}'), (35, '            </when>'), (36, '        </choose>'), (37, '        <choose>'), (38, '            <when test=""clientIp != null and clientIp != \'\'"">'), (39, '                and client_ip=#{clientIp}'), (40, '            </when>'), (41, '        </choose>'), (42, '        group by client_ip,current_min'), (43, '        order by current_min asc'), (44, '    </select>'), (45, ''), (46, '    <select id=""getAppClientCmdStat"" resultType=""AppClientStatisticGather"">'), (47, ""        select app_id, sum(count) as cmd_count, SUM(cost)/sum(count) as avg_cmd_cost, DATE_FORMAT(current_min,'%Y-%m-%d') gather_time""), (48, '        from app_client_command_minute_statistics'), (49, '        where current_min between #{startTime} and #{endTime}'), (50, '        group by app_id'), (51, '    </select>'), (52, ''), (53, '    <select id=""getSumCmdStatByCmd"" resultType=""hashmap"">'), (54, '        select app_id,client_ip,sum(count) count,sum(cost)/sum(count) cost'), (55, '        from app_client_command_minute_statistics'), (56, '        where app_id=#{appId}'), (57, '        <choose>'), (58, '            <when test=""command != null and command != \'all\' and command != \'\'"">'), (59, '                and command=#{command}'), (60, '            </when>'), (61, '        </choose>'), (62, '        and current_min between #{startTime} and #{endTime}'), (63, '        group by client_ip'), (64, '    </select>'), (65, ''), (66, '    <select id=""getSumCmdStatByClient"" resultType=""hashmap"">'), (67, '        select app_id,command,sum(count) count,sum(cost)/sum(count) cost'), (68, '        from app_client_command_minute_statistics'), (69, '        where app_id=#{appId}'), (70, '        <choose>'), (71, '            <when test=""clientIp != null and clientIp != \'all\' and clientIp != \'\'"">'), (72, '                and client_ip=#{clientIp}'), (73, '            </when>'), (74, '        </choose>'), (75, '        and current_min between #{startTime} and #{endTime}'), (76, '        group by command'), (77, '    </select>'), (78, ''), (79, '    <delete id=""cleanCommandStatisticsBeforeCurrentMin"">'), (80, '        delete from app_client_command_minute_statistics'), (81, '        where current_min &lt;#{currentMin}'), (82, '    </delete>'), (83, ''), (84, '</mapper>')], 'deleted': []}"
147,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientCostTimeStatDao.xml,AppClientCostTimeStatDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientCostTimeStatDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,collect_time,client_ip,report_time,create_time,command,'), (7, '\t\tmedian,mean,ninety_percent_max,ninety_nine_percent_max,hundred_max,'), (8, '\t\tcount,instance_host,instance_port,instance_id'), (9, '\t</sql>'), (10, ''), (11, '\t<insert id=""save"" parameterType=""AppClientCostTimeStat""'), (12, '\t\tkeyProperty=""id"" useGeneratedKeys=""true"">'), (13, '\t\tinsert into app_client_costtime_minute_stat(<include refid=""columns""/>)'), (14, '\t\tvalues(#{appId},#{collectTime},#{clientIp},#{reportTime},#{createTime},#{command},'), (15, '\t\t       #{median},#{mean},#{ninetyPercentMax},#{ninetyNinePercentMax},#{hundredMax},'), (16, '\t\t       #{count},#{instanceHost},#{instancePort},#{instanceId})'), (17, '\t</insert>'), (18, ''), (19, '\t<insert id=""batchSave"">'), (20, '\t\tinsert into app_client_costtime_minute_stat(<include refid=""columns"" />)'), (21, '\t\tvalues'), (22, '\t\t<foreach collection=""list"" item=""clientCostTime"" separator="","">'), (23, '\t\t\t(#{clientCostTime.appId},#{clientCostTime.collectTime},#{clientCostTime.clientIp},#{clientCostTime.reportTime},#{clientCostTime.createTime},#{clientCostTime.command},'), (24, '\t\t       #{clientCostTime.median},#{clientCostTime.mean},#{clientCostTime.ninetyPercentMax},#{clientCostTime.ninetyNinePercentMax},#{clientCostTime.hundredMax},'), (25, '\t\t       #{clientCostTime.count},#{clientCostTime.instanceHost},#{clientCostTime.instancePort},#{clientCostTime.instanceId})'), (26, '\t    </foreach>'), (27, '\t</insert>'), (28, ''), (29, '    <select id=""getAppCommandClientToInstanceStat"" resultType=""AppClientCostTimeStat"">'), (30, '    \tselect id,<include refid=""columns""/>'), (31, '    \tfrom app_client_costtime_minute_stat'), (32, '    \twhere app_id=#{appId} and instance_id=#{instanceId} and client_ip=#{clientIp} and collect_time between #{startTime} and #{endTime} and command=#{command};'), (33, '    </select>'), (34, ''), (35, '    <select id=""getTableMinimumId"" resultType=""long"">'), (36, '    \tselect id from app_client_costtime_minute_stat order by id limit 1'), (37, '    </select>'), (38, ''), (39, '    <select id=""getMinimumIdByCollectTime"" resultType=""long"">'), (40, '    \tselect id from app_client_costtime_minute_stat where collect_time = #{collectTime} order by id limit 1'), (41, '    </select>'), (42, ''), (43, '    <delete id=""deleteByIds"">'), (44, '    \tdelete from app_client_costtime_minute_stat where id>=#{startId} and id &lt;#{endId}'), (45, '    </delete>'), (46, ''), (47, '</mapper>')], 'deleted': []}"
148,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientCostTimeTotalStatDao.xml,AppClientCostTimeTotalStatDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientCostTimeTotalStatDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,collect_time,create_time,command,mean,median,ninety_percent_max,ninety_nine_percent_max,'), (7, '\t\thundred_max,total_cost,total_count,max_instance_host,max_instance_port,max_instance_id,max_client_ip,accumulation'), (8, '\t</sql>'), (9, '\t<sql id=""duplicate_update"">'), (10, '        on duplicate key update'), (11, '            total_cost = total_cost + VALUES(total_cost),'), (12, '            total_count = total_count + VALUES(total_count),'), (13, '            median = if(median>VALUES(median),median,VALUES(median)),'), (14, '            ninety_percent_max = if(ninety_percent_max>VALUES(ninety_percent_max),ninety_percent_max,VALUES(ninety_percent_max)),'), (15, '            ninety_nine_percent_max = if(ninety_nine_percent_max>VALUES(ninety_nine_percent_max),ninety_nine_percent_max,VALUES(ninety_nine_percent_max)),'), (16, '            hundred_max = if(hundred_max>VALUES(hundred_max),hundred_max,VALUES(hundred_max)),'), (17, '            max_instance_host = if(hundred_max>VALUES(hundred_max),max_instance_host,VALUES(max_instance_host)),'), (18, '            max_instance_port = if(hundred_max>VALUES(hundred_max),max_instance_port,VALUES(max_instance_port)),'), (19, '            max_instance_id =   if(hundred_max>VALUES(hundred_max),max_instance_id,VALUES(max_instance_id)),'), (20, '            max_client_ip =     if(hundred_max>VALUES(hundred_max),max_client_ip,VALUES(max_client_ip)),'), (21, '            mean = format(total_cost/total_count,2),'), (22, '            create_time = now(),'), (23, '            accumulation = accumulation + 1;'), (24, '    </sql>'), (25, '\t<insert id=""save"" parameterType=""AppClientCostTimeTotalStat"" keyProperty=""id"" useGeneratedKeys=""true"">'), (26, '\t\t insert into app_client_costtime_minute_stat_total'), (27, '\t\t (<include refid=""columns""/>)'), (28, '        values'), (29, '          (#{appId},#{collectTime},#{createTime},#{command},#{mean},#{median},'), (30, '          #{ninetyPercentMax},#{ninetyNinePercentMax},#{hundredMax},#{totalCost},#{totalCount},#{maxInstanceHost},#{maxInstancePort},#{maxInstanceId},#{maxClientIp}, 1)'), (31, '        <include refid=""duplicate_update""/>'), (32, '\t</insert>'), (33, ''), (34, '\t<insert id=""batchSave"">'), (35, '\t\tinsert into app_client_costtime_minute_stat_total(<include refid=""columns""/>)'), (36, '\t\tvalues'), (37, '\t\t<foreach collection=""list"" item=""clientCostTime"" separator="","">'), (38, '\t\t\t (#{clientCostTime.appId},#{clientCostTime.collectTime},#{clientCostTime.createTime},#{clientCostTime.command},#{clientCostTime.mean},#{clientCostTime.median},'), (39, '          #{clientCostTime.ninetyPercentMax},#{clientCostTime.ninetyNinePercentMax},#{clientCostTime.hundredMax},#{clientCostTime.totalCost},#{clientCostTime.totalCount},#{clientCostTime.maxInstanceHost},#{clientCostTime.maxInstancePort},#{clientCostTime.maxInstanceId},#{clientCostTime.maxClientIp}, 1)'), (40, '\t    </foreach>'), (41, '        <include refid=""duplicate_update""/>'), (42, '\t</insert>'), (43, ''), (44, '    <select id=""getAppDistinctCommand"" resultType=""string"">'), (45, '   \t\tselect command from app_client_costtime_minute_stat_total where app_id=#{appId} and collect_time between #{startTime} and #{endTime} group by command order by sum(total_count) desc;'), (46, '    </select>'), (47, ''), (48, '    <select id=""getAppClientCommandStat"" resultType=""AppClientCostTimeTotalStat"">'), (49, '    \tselect id,<include refid=""columns""/> from app_client_costtime_minute_stat_total'), (50, '    \twhere app_id=#{appId} and collect_time between #{startTime} and #{endTime} and command=#{command}'), (51, '    </select>'), (52, ''), (53, '</mapper>')], 'deleted': []}"
149,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientExceptionStatDao.xml,AppClientExceptionStatDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientExceptionStatDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,collect_time,client_ip,report_time,create_time,exception_class,exception_count,instance_host,instance_port,instance_id,type'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""save"" parameterType=""AppClientExceptionStat""'), (10, '\t\tkeyProperty=""id"" useGeneratedKeys=""true"">'), (11, '\t\tinsert into app_client_exception_minute_stat(<include refid=""columns"" />)'), (12, '\t\tvalues(#{appId},#{collectTime},#{clientIp},#{reportTime},#{createTime},#{exceptionClass},#{exceptionCount},#{instanceHost},#{instancePort},#{instanceId},#{type})'), (13, '\t</insert>'), (14, ''), (15, '\t<insert id=""batchSave"">'), (16, '\t\tinsert into app_client_exception_minute_stat(<include refid=""columns"" />)'), (17, '\t\tvalues'), (18, '\t\t<foreach collection=""list"" item=""clientException"" separator="","">'), (19, '\t\t\t(#{clientException.appId},#{clientException.collectTime},#{clientException.clientIp},#{clientException.reportTime},#{clientException.createTime},'), (20, '\t\t\t#{clientException.exceptionClass},#{clientException.exceptionCount},#{clientException.instanceHost},#{clientException.instancePort},#{clientException.instanceId},#{clientException.type})'), (21, '\t    </foreach>'), (22, '\t</insert>'), (23, ''), (24, '\t<select id=""getAppExceptionList"" resultType=""AppClientExceptionStat"">'), (25, '    \tselect id,<include refid=""columns"" />'), (26, '    \tfrom app_client_exception_minute_stat'), (27, '    \twhere app_id=#{appId} and collect_time between #{startTime} and #{endTime}'), (28, '    \t<choose>'), (29, '        \t<when test=""type > 0"">'), (30, '        \t \tand type=#{type}'), (31, '        \t</when>'), (32, '        </choose>'), (33, '        <choose>'), (34, '        \t<when test=""clientIp != \'\' and clientIp != null"">'), (35, '        \t \tand client_ip=#{clientIp}'), (36, '        \t</when>'), (37, '        </choose>'), (38, '        order by collect_time desc'), (39, '        <choose>'), (40, '        \t<when test=""page != null"">'), (41, '        \t\t<choose>'), (42, '\t\t        \t<when test=""page.totalCount > page.pageSize"">'), (43, '            \t\t\tlimit #{page.start},#{page.pageSize};'), (44, '\t\t        \t</when>'), (45, '\t\t        \t<otherwise>'), (46, '\t\t        \t    limit #{page.totalCount}'), (47, '\t\t        \t</otherwise>'), (48, '\t\t        </choose>'), (49, '        \t</when>'), (50, '        </choose>'), (51, '    </select>'), (52, ''), (53, '    <select id=""getAppExceptionCount"" resultType=""int"">'), (54, '    \tselect count(*)'), (55, '    \tfrom app_client_exception_minute_stat'), (56, '    \twhere app_id=#{appId} and collect_time between #{startTime} and #{endTime}'), (57, '    \t<choose>'), (58, '        \t<when test=""type > 0"">'), (59, '        \t \tand type=#{type}'), (60, '        \t</when>'), (61, '        </choose>'), (62, '        <choose>'), (63, '        \t<when test=""clientIp != \'\' and clientIp != null"">'), (64, '        \t \tand client_ip=#{clientIp}'), (65, '        \t</when>'), (66, '        </choose>'), (67, '    </select>'), (68, ''), (69, ''), (70, '    <select id=""getInstanceExceptionStat"" resultType=""ClientInstanceException"">'), (71, '    \tselect app_id,instance_id,instance_host,instance_port,count(1) as exceptionCount from app_client_exception_minute_stat'), (72, '    \t<where>'), (73, '\t    \t<choose>'), (74, '\t        \t<when test=""collectTime > 0"">'), (75, '\t        \t \tand collect_time>=#{collectTime}'), (76, '\t        \t</when>'), (77, '\t        </choose>'), (78, '\t        <choose>'), (79, '\t        \t<when test=""ip != \'\' and ip != null"">'), (80, '\t        \t \tand instance_host=#{ip}'), (81, '\t        \t</when>'), (82, '\t        </choose>'), (83, '    \t</where>'), (84, '    \tgroup by instance_id order by exceptionCount desc;'), (85, '    </select>'), (86, ''), (87, ''), (88, ''), (89, '</mapper>')], 'deleted': []}"
150,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientExceptionStatisticsDao.xml,AppClientExceptionStatisticsDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientExceptionStatisticsDao"">'), (5, '    <sql id=""columns"">'), (6, '\t\tapp_id,current_min,client_ip,redis_pool_config,type,node,cost,count,latency_commands'), (7, '\t</sql>'), (8, ''), (9, '    <insert id=""batchSave"">'), (10, '        insert ignore into app_client_exception_minute_statistics (<include refid=""columns""/>)'), (11, '        values'), (12, '        <foreach collection=""list"" item=""clientException"" separator="","">'), (13, '            (#{clientException.appId},#{clientException.currentMin},#{clientException.clientIp},#{clientException.redisPoolConfig},'), (14, '            #{clientException.type},#{clientException.node},#{clientException.cost},#{clientException.count},#{clientException.latencyCommands})'), (15, '        </foreach>'), (16, '    </insert>'), (17, ''), (18, '    <select id=""getAppExceptionStatistics"" resultType=""hashmap"">'), (19, '        select app_id,type,current_min,UNIX_TIMESTAMP(current_min) timestamp,client_ip,sum(cost)/sum(count)'), (20, '        cost,sum(count) count'), (21, '        from app_client_exception_minute_statistics'), (22, '        where app_id=#{appId} and current_min between #{startTime} and #{endTime}'), (23, '        <choose>'), (24, '            <when test=""type != null and type != \'-1\'"">'), (25, '                and type=#{type}'), (26, '            </when>'), (27, '        </choose>'), (28, '        <choose>'), (29, '            <when test=""clientIp != null and clientIp != \'\'"">'), (30, '                and client_ip=#{clientIp}'), (31, '            </when>'), (32, '        </choose>'), (33, '        group by client_ip,current_min'), (34, '        order by current_min asc'), (35, '    </select>'), (36, ''), (37, '    <select id=""getDistinctClientNodeStatistics"" resultType=""hashmap"">'), (38, '        select node, sum(count) count, sum(cost)/sum(count) cost'), (39, '        from app_client_exception_minute_statistics'), (40, '        where app_id=#{appId}'), (41, '        <choose>'), (42, '            <when test=""type != null and type != \'-1\'"">'), (43, '                and type=#{type}'), (44, '            </when>'), (45, '        </choose>'), (46, '        and client_ip=#{clientIp} and current_min between #{startTime} and #{endTime}'), (47, '        group by node'), (48, '        order by count desc;'), (49, '    </select>'), (50, ''), (51, '    <select id=""getAppDistinctClientConfig"" resultType=""hashmap"">'), (52, '        select distinct client_ip, redis_pool_config'), (53, '        from app_client_exception_minute_statistics'), (54, '        where app_id=#{appId}'), (55, '        <choose>'), (56, '            <when test=""type != null and type != \'-1\'"">'), (57, '                and type=#{type}'), (58, '            </when>'), (59, '        </choose>'), (60, '        and current_min between #{startTime} and #{endTime};'), (61, '    </select>'), (62, ''), (63, '    <select id=""getAppClientConfigs"" resultType=""hashmap"">'), (64, ""        select client_ip, redis_pool_config, DATE_FORMAT(min(current_min),'%Y-%m-%d %H:%i:%s') as change_time""), (65, '        from app_client_exception_minute_statistics'), (66, '        where app_id=#{appId}'), (67, '        <choose>'), (68, '            <when test=""type != null and type != \'-1\'"">'), (69, '                and type=#{type}'), (70, '            </when>'), (71, '        </choose>'), (72, '        and current_min between #{startTime} and #{endTime}'), (73, '        group by client_ip, redis_pool_config'), (74, '        order by change_time desc;'), (75, '    </select>'), (76, ''), (77, '    <select id=""getLatencyCommandsByNode"" resultType=""string"">'), (78, '        select latency_commands, count, cost'), (79, '        from app_client_exception_minute_statistics'), (80, '        where client_ip=#{clientIp}'), (81, '        and type=1'), (82, '        and node=#{node}'), (83, '        and current_min between #{startTime} and #{endTime}'), (84, '    </select>'), (85, ''), (86, ''), (87, '    <select id=""getLatencyCommandsByNodeV2"" resultType=""string"">'), (88, '        select latency_commands'), (89, '        from app_client_exception_minute_statistics'), (90, '        where current_min=#{searchTime}'), (91, '        and node=#{node}'), (92, '        and type=1'), (93, '    </select>'), (94, ''), (95, '    <select id=""getSumCmdExpStatGroupByNode"" resultType=""hashmap"">'), (96, '        select node,sum(count) count,sum(cost)/sum(count) cost'), (97, '        from app_client_exception_minute_statistics'), (98, '        where current_min=#{searchTime} and app_id=#{appId} and type=1'), (99, '        group by node'), (100, '    </select>'), (101, ''), (102, '    <select id=""getAppClientConnExpStat"" resultType=""AppClientStatisticGather"">'), (103, ""        select app_id, sum(count) as conn_exp_count, sum(cost)/sum(count) as avg_conn_exp_cost, DATE_FORMAT(current_min,'%Y-%m-%d') gather_time""), (104, '        from app_client_exception_minute_statistics'), (105, '        where type=0 and current_min between #{startTime} and #{endTime}'), (106, '        group by app_id'), (107, '    </select>'), (108, ''), (109, '    <select id=""getAppClientCmdExpStat"" resultType=""AppClientStatisticGather"">'), (110, ""        select app_id, sum(count) as cmd_exp_count, sum(cost)/sum(count) as avg_cmd_exp_cost, DATE_FORMAT(current_min,'%Y-%m-%d') gather_time""), (111, '        from app_client_exception_minute_statistics'), (112, '        where type=1 and current_min between #{startTime} and #{endTime}'), (113, '        group by app_id'), (114, '    </select>'), (115, '</mapper>')], 'deleted': []}"
151,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientLatencyCommandDao.xml,AppClientLatencyCommandDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientLatencyCommandDao"">'), (5, '    <sql id=""columns"">'), (6, '\t\tcommand,args,size,invoke_time'), (7, '\t</sql>'), (8, ''), (9, '    <insert id=""batchSave"" parameterType=""List"" useGeneratedKeys=""true"" keyProperty=""id"">'), (10, '        insert into app_client_latency_command (id,<include refid=""columns""/>)'), (11, '        values'), (12, '        <foreach collection=""list"" item=""latencyCommand"" separator="","">'), (13, '            (#{latencyCommand.id},#{latencyCommand.command},#{latencyCommand.args},#{latencyCommand.size},#{latencyCommand.invokeTime})'), (14, '        </foreach>'), (15, '    </insert>'), (16, ''), (17, '    <select id=""getLatencyCommandByIds"" resultType=""hashmap"" parameterType=""java.util.List"">'), (18, '        SELECT id,<include refid=""columns""/>,FROM_UNIXTIME(invoke_time/1000,\'%Y-%m-%d %H:%i:%s\') as format_invoke_time'), (19, '        FROM app_client_latency_command'), (20, '        WHERE id in'), (21, '        <foreach collection=""ids"" index=""index"" item=""id"" open=""("" separator="","" close="")"">'), (22, '            #{id}'), (23, '        </foreach>'), (24, '        order by create_time desc'), (25, '    </select>'), (26, '</mapper>')], 'deleted': []}"
152,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientReportDataSizeDao.xml,AppClientReportDataSizeDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientReportDataSizeDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tcollect_time,client_ip,report_time,create_time,cost_map_size,value_map_size,exception_map_size,collect_map_size'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""save"" parameterType=""AppClientDataSizeStat""'), (10, '\t\tkeyProperty=""id"" useGeneratedKeys=""true"">'), (11, '\t\tinsert into app_client_datasize_minute_stat(<include refid=""columns"" />)'), (12, '\t\tvalues(#{collectTime},#{clientIp},#{reportTime},#{createTime},#{costMapSize},'), (13, '\t\t#{valueMapSize},#{exceptionMapSize},#{collectMapSize})'), (14, '\t</insert>'), (15, ''), (16, '</mapper>')], 'deleted': []}"
153,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientStatisticGatherDao.xml,AppClientStatisticGatherDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientStatisticGatherDao"">'), (5, '    <sql id=""columns"">'), (6, '\t\tapp_id,gather_time,'), (7, '\t\tcmd_count,avg_cmd_cost,'), (8, '\t\tconn_exp_count,avg_conn_exp_cost,'), (9, '\t\tcmd_exp_count,avg_cmd_exp_cost,'), (10, '\t\tinstance_count,avg_mem_frag_ratio,mem_used_ratio,'), (11, '\t\texception_count,'), (12, '\t\tslow_log_count,'), (13, '\t\tlatency_count,'), (14, '\t\tconnected_clients,'), (15, '\t\tobject_size,'), (16, '\t\tused_memory,'), (17, '\t\tused_memory_rss,'), (18, '\t\tmax_cpu_sys,'), (19, '\t\tmax_cpu_user,'), (20, '\t\ttopology_exam_result'), (21, '\t</sql>'), (22, ''), (23, '    <insert id=""batchSave"">'), (24, '        insert into app_client_statistic_gather (<include refid=""columns""/>)'), (25, '        values'), (26, '        <foreach collection=""list"" item=""stat"" separator="","">'), (27, '            (#{stat.appId},#{stat.gatherTime},#{stat.cmdCount},#{stat.cmdCost},#{stat.expCount},#{stat.expCost})'), (28, '        </foreach>'), (29, '    </insert>'), (30, ''), (31, '    <insert id=""batchSaveCmdStats"" parameterType=""list"">'), (32, '        insert into app_client_statistic_gather'), (33, '        (app_id,gather_time,cmd_count,avg_cmd_cost)'), (34, '        values'), (35, '        <foreach collection=""list"" item=""stat"" separator="","">'), (36, '            (#{stat.appId},#{stat.gatherTime},#{stat.cmdCount},#{stat.avgCmdCost})'), (37, '        </foreach>'), (38, '        ON DUPLICATE KEY UPDATE'), (39, '        app_id=values(app_id),'), (40, '        gather_time=values(gather_time),'), (41, '        cmd_count=values(cmd_count),'), (42, '        avg_cmd_cost=values(avg_cmd_cost)'), (43, '    </insert>'), (44, '    <insert id=""batchAddCmdStats"" parameterType=""list"">'), (45, '        insert into app_client_statistic_gather'), (46, '        (app_id,gather_time,cmd_count,avg_cmd_cost)'), (47, '        values'), (48, '        <foreach collection=""list"" item=""stat"" separator="","">'), (49, '            (#{stat.appId},#{stat.gatherTime},#{stat.cmdCount},#{stat.avgCmdCost})'), (50, '        </foreach>'), (51, '        ON DUPLICATE KEY UPDATE'), (52, '        app_id=values(app_id),'), (53, '        gather_time=values(gather_time),'), (54, '        cmd_count=cmd_count+values(cmd_count),'), (55, '        avg_cmd_cost=values(avg_cmd_cost)'), (56, '    </insert>'), (57, ''), (58, '    <insert id=""batchSaveConnExpStats"" parameterType=""list"">'), (59, '        insert into app_client_statistic_gather'), (60, '        (app_id,gather_time,conn_exp_count,avg_conn_exp_cost)'), (61, '        values'), (62, '        <foreach collection=""list"" item=""stat"" separator="","">'), (63, '            (#{stat.appId},#{stat.gatherTime},#{stat.connExpCount},#{stat.avgConnExpCost})'), (64, '        </foreach>'), (65, '        ON DUPLICATE KEY UPDATE'), (66, '        app_id=values(app_id),'), (67, '        gather_time=values(gather_time),'), (68, '        conn_exp_count=values(conn_exp_count),'), (69, '        avg_conn_exp_cost=values(avg_conn_exp_cost)'), (70, '    </insert>'), (71, '    <insert id=""batchAddConnExpStats"" parameterType=""list"">'), (72, '        insert into app_client_statistic_gather'), (73, '        (app_id,gather_time,conn_exp_count,avg_conn_exp_cost)'), (74, '        values'), (75, '        <foreach collection=""list"" item=""stat"" separator="","">'), (76, '            (#{stat.appId},#{stat.gatherTime},#{stat.connExpCount},#{stat.avgConnExpCost})'), (77, '        </foreach>'), (78, '        ON DUPLICATE KEY UPDATE'), (79, '        app_id=values(app_id),'), (80, '        gather_time=values(gather_time),'), (81, '        conn_exp_count=conn_exp_count+values(conn_exp_count),'), (82, '        avg_conn_exp_cost=values(avg_conn_exp_cost)'), (83, '    </insert>'), (84, ''), (85, '    <insert id=""batchSaveCmdExpStats"" parameterType=""list"">'), (86, '        insert into app_client_statistic_gather'), (87, '        (app_id,gather_time,cmd_exp_count,avg_cmd_exp_cost)'), (88, '        values'), (89, '        <foreach collection=""list"" item=""stat"" separator="","">'), (90, '            (#{stat.appId},#{stat.gatherTime},#{stat.cmdExpCount},#{stat.avgCmdExpCost})'), (91, '        </foreach>'), (92, '        ON DUPLICATE KEY UPDATE'), (93, '        app_id=values(app_id),'), (94, '        gather_time=values(gather_time),'), (95, '        cmd_exp_count=values(cmd_exp_count),'), (96, '        avg_cmd_exp_cost=values(avg_cmd_exp_cost)'), (97, '    </insert>'), (98, '    <insert id=""batchAddCmdExpStats"" parameterType=""list"">'), (99, '        insert into app_client_statistic_gather'), (100, '        (app_id,gather_time,cmd_exp_count,avg_cmd_exp_cost)'), (101, '        values'), (102, '        <foreach collection=""list"" item=""stat"" separator="","">'), (103, '            (#{stat.appId},#{stat.gatherTime},#{stat.cmdExpCount},#{stat.avgCmdExpCost})'), (104, '        </foreach>'), (105, '        ON DUPLICATE KEY UPDATE'), (106, '        app_id=values(app_id),'), (107, '        gather_time=values(gather_time),'), (108, '        cmd_exp_count=cmd_exp_count+values(cmd_exp_count),'), (109, '        avg_cmd_exp_cost=values(avg_cmd_exp_cost)'), (110, '    </insert>'), (111, ''), (112, '    <insert id=""batchSaveMemFragRatio"" parameterType=""list"">'), (113, '        insert into app_client_statistic_gather'), (114, '        (app_id,gather_time,instance_count,avg_mem_frag_ratio,mem_used_ratio)'), (115, '        values'), (116, '        <foreach collection=""list"" item=""stat"" separator="","">'), (117, '            (#{stat.appId},#{stat.gatherTime},#{stat.instanceCount},#{stat.avgMemFragRatio},#{stat.memUsedRatio})'), (118, '        </foreach>'), (119, '        ON DUPLICATE KEY UPDATE'), (120, '        app_id=values(app_id),'), (121, '        gather_time=values(gather_time),'), (122, '        instance_count=values(instance_count),'), (123, '        avg_mem_frag_ratio=values(avg_mem_frag_ratio),'), (124, '        mem_used_ratio=values(mem_used_ratio)'), (125, '    </insert>'), (126, ''), (127, '    <insert id=""batchSaveSlowLogCount"" parameterType=""list"">'), (128, '        insert into app_client_statistic_gather'), (129, '        (app_id,gather_time,slow_log_count)'), (130, '        values'), (131, '        <foreach collection=""list"" item=""stat"" separator="","">'), (132, '            (#{stat.appId},#{stat.gatherTime},#{stat.slowLogCount})'), (133, '        </foreach>'), (134, '        ON DUPLICATE KEY UPDATE'), (135, '        app_id=values(app_id),'), (136, '        gather_time=values(gather_time),'), (137, '        slow_log_count=values(slow_log_count)'), (138, '    </insert>'), (139, '    <insert id=""batchAddSlowLogCount"" parameterType=""list"">'), (140, '        insert into app_client_statistic_gather'), (141, '        (app_id,gather_time,slow_log_count)'), (142, '        values'), (143, '        <foreach collection=""list"" item=""stat"" separator="","">'), (144, '            (#{stat.appId},#{stat.gatherTime},#{stat.slowLogCount})'), (145, '        </foreach>'), (146, '        ON DUPLICATE KEY UPDATE'), (147, '        app_id=values(app_id),'), (148, '        gather_time=values(gather_time),'), (149, '        slow_log_count=slow_log_count+values(slow_log_count)'), (150, '    </insert>'), (151, ''), (152, '    <insert id=""batchSaveLatencyCount"" parameterType=""list"">'), (153, '        insert into app_client_statistic_gather'), (154, '        (app_id,gather_time,latency_count)'), (155, '        values'), (156, '        <foreach collection=""list"" item=""stat"" separator="","">'), (157, '            (#{stat.appId},#{stat.gatherTime},#{stat.latencyCount})'), (158, '        </foreach>'), (159, '        ON DUPLICATE KEY UPDATE'), (160, '        app_id=values(app_id),'), (161, '        gather_time=values(gather_time),'), (162, '        latency_count=values(latency_count)'), (163, '    </insert>'), (164, '    <insert id=""batchAddLatencyCount"" parameterType=""list"">'), (165, '        insert into app_client_statistic_gather'), (166, '        (app_id,gather_time,latency_count)'), (167, '        values'), (168, '        <foreach collection=""list"" item=""stat"" separator="","">'), (169, '            (#{stat.appId},#{stat.gatherTime},#{stat.latencyCount})'), (170, '        </foreach>'), (171, '        ON DUPLICATE KEY UPDATE'), (172, '        app_id=values(app_id),'), (173, '        gather_time=values(gather_time),'), (174, '        latency_count=latency_count+values(latency_count)'), (175, '    </insert>'), (176, ''), (177, ''), (178, '    <insert id=""batchSaveAppStats"" parameterType=""list"">'), (179, '        insert into app_client_statistic_gather'), (180, '        (app_id,gather_time,object_size,used_memory,used_memory_rss,avg_mem_frag_ratio,max_cpu_sys,max_cpu_user)'), (181, '        values'), (182, '        <foreach collection=""list"" item=""stat"" separator="","">'), (183, '            (#{stat.appId},#{stat.gatherTime},#{stat.objectSize},#{stat.usedMemory},#{stat.usedMemoryRss},#{stat.avgMemFragRatio},#{stat.maxCpuSys},#{stat.maxCpuUser})'), (184, '        </foreach>'), (185, '        ON DUPLICATE KEY UPDATE'), (186, '        app_id=values(app_id),'), (187, '        gather_time=values(gather_time),'), (188, '        object_size=values(object_size),'), (189, '        used_memory=values(used_memory),'), (190, '        used_memory_rss=values(used_memory_rss),'), (191, '        avg_mem_frag_ratio=values(avg_mem_frag_ratio),'), (192, '        max_cpu_sys=GREATEST(max_cpu_sys,values(max_cpu_sys)),'), (193, '        max_cpu_user=GREATEST(max_cpu_user,values(max_cpu_user))'), (194, '    </insert>'), (195, ''), (196, ''), (197, '    <insert id=""batchSaveConnClients"" parameterType=""list"">'), (198, '        insert into app_client_statistic_gather'), (199, '        (app_id,gather_time,connected_clients)'), (200, '        values'), (201, '        <foreach collection=""list"" item=""stat"" separator="","">'), (202, '            (#{stat.appId},#{stat.gatherTime},#{stat.connectedClients})'), (203, '        </foreach>'), (204, '        ON DUPLICATE KEY UPDATE'), (205, '        app_id=values(app_id),'), (206, '        gather_time=values(gather_time),'), (207, '        connected_clients=values(connected_clients)'), (208, '    </insert>'), (209, ''), (210, '    <insert id=""batchSaveTopologyExam"" parameterType=""list"">'), (211, '        insert into app_client_statistic_gather'), (212, '        (app_id,gather_time,topology_exam_result)'), (213, '        values'), (214, '        <foreach collection=""list"" item=""stat"" separator="","">'), (215, '            (#{stat.appId},#{stat.gatherTime},#{stat.topologyExamResult})'), (216, '        </foreach>'), (217, '        ON DUPLICATE KEY UPDATE'), (218, '        app_id=values(app_id),'), (219, '        gather_time=values(gather_time),'), (220, '        topology_exam_result=values(topology_exam_result)'), (221, '    </insert>'), (222, ''), (223, ''), (224, '    <select id=""getAppClientStatisticByGatherTime"" resultType=""hashmap"">'), (225, '        select'), (226, '        <include refid=""columns""/>'), (227, '        from app_client_statistic_gather'), (228, '        where gather_time = #{gatherTime}'), (229, '        <choose>'), (230, '            <when test=""appId != null and appId > 0"">'), (231, '                and app_id = #{appId}'), (232, '            </when>'), (233, '        </choose>'), (234, '    </select>'), (235, ''), (236, '    <select id=""getExpAppStatisticByGatherTime"" resultType=""hashmap"">'), (237, '        select'), (238, '        <include refid=""columns""/>,(conn_exp_count+cmd_exp_count) as exp_count'), (239, '        from app_client_statistic_gather'), (240, '        where gather_time = #{gatherTime}'), (241, '        ORDER BY exp_count DESC'), (242, '    </select>'), (243, ''), (244, ''), (245, '    <select id=""getExpAppStatsByGatherTime"" resultType=""hashmap"">'), (246, '        select app_client_statistic_gather.app_id as app_id,is_test,'), (247, '        (conn_exp_count + cmd_exp_count) as exp_count,'), (248, '        conn_exp_count,cmd_exp_count,'), (249, '        slow_log_count,latency_count'), (250, '        from app_client_statistic_gather,app_desc'), (251, '        where gather_time = #{gatherTime}'), (252, '        and app_client_statistic_gather.app_id = app_desc.app_id'), (253, '        and app_desc.is_test = 0'), (254, '        and conn_exp_count + cmd_exp_count > 0'), (255, '        ORDER BY exp_count DESC'), (256, '    </select>'), (257, ''), (258, ''), (259, '    <select id=""getLatencyAppStatsByGatherTime"" resultType=""hashmap"">'), (260, '        select app_client_statistic_gather.app_id as app_id,is_test,'), (261, '        slow_log_count,latency_count'), (262, '        from app_client_statistic_gather,app_desc'), (263, '        where gather_time = #{gatherTime}'), (264, '        and app_client_statistic_gather.app_id = app_desc.app_id'), (265, '        and app_desc.is_test = 0'), (266, '        and slow_log_count>100'), (267, '        ORDER BY slow_log_count DESC'), (268, '        LIMIT 10'), (269, '    </select>'), (270, ''), (271, ''), (272, '    <select id=""getMemAlterAppStatsByGatherTime"" resultType=""hashmap"">'), (273, '        select app_client_statistic_gather.app_id as app_id,is_test,'), (274, '        mem_used_ratio,round(used_memory/1024/1024,2) as format_used_memory'), (275, '        from app_client_statistic_gather,app_desc'), (276, '        where gather_time = #{gatherTime}'), (277, '        and app_client_statistic_gather.app_id = app_desc.app_id'), (278, '        and app_desc.is_test = 0'), (279, '        and mem_used_ratio &lt; 50'), (280, '        ORDER BY mem_used_ratio asc'), (281, '        LIMIT 10'), (282, '    </select>'), (283, ''), (284, ''), (285, '    <select id=""getFragRatioAppStatsByGatherTime"" resultType=""hashmap"">'), (286, '        select app_client_statistic_gather.app_id as app_id,is_test,'), (287, '        round(used_memory/1024/1024,2) as format_used_memory,'), (288, '        round(used_memory_rss/1024/1024,2) as format_used_memory_rss,'), (289, '        avg_mem_frag_ratio'), (290, '        from app_client_statistic_gather,app_desc'), (291, ""        where gather_time = '2020-06-03'""), (292, '        and app_client_statistic_gather.app_id = app_desc.app_id'), (293, '        and app_desc.is_test = 0'), (294, '        and avg_mem_frag_ratio>1.2'), (295, '        ORDER BY avg_mem_frag_ratio DESC;'), (296, '    </select>'), (297, '</mapper>')], 'deleted': []}"
154,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientValueStatDao.xml,AppClientValueStatDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientValueStatDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,collect_time,update_time,command,distribute_type,count'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""batchSave"">'), (10, '\t\tinsert into app_client_value_minute_stats(<include refid=""columns"" />)'), (11, '\t\tvalues'), (12, '\t\t<foreach collection=""list"" item=""valueDistri"" separator="","">'), (13, '        \t(#{valueDistri.appId},#{valueDistri.collectTime},#{valueDistri.updateTime},#{valueDistri.command},#{valueDistri.distributeType},#{valueDistri.count})'), (14, '\t    </foreach>'), (15, '\t    on duplicate key update'), (16, '\t    count = count + VALUES(count), update_time=now()'), (17, '\t</insert>'), (18, ''), (19, '\t<insert id=""save"">'), (20, '\t\tinsert into app_client_value_minute_stats(<include refid=""columns"" />)'), (21, '\t\tvalues(#{appId},#{collectTime},#{updateTime},#{command},#{distributeType},#{count})'), (22, '\t    on duplicate key update'), (23, '\t    count = count + #{count}, update_time=now()'), (24, '\t</insert>'), (25, ''), (26, '\t<select id=""getAppValueDistriList"" resultType=""AppClientValueDistriSimple"">'), (27, '    \tselect distribute_type, sum(count) as count'), (28, '    \tfrom app_client_value_minute_stats'), (29, '    \twhere app_id=#{appId} and collect_time between #{startTime} and #{endTime}'), (30, '        group by distribute_type order by distribute_type'), (31, '    </select>'), (32, ''), (33, '    <delete id=""deleteBeforeCollectTime"">'), (34, '    \tdelete from app_client_value_minute_stats where collect_time &lt;#{collectTime}'), (35, '    </delete>'), (36, ''), (37, ''), (38, '</mapper>')], 'deleted': []}"
155,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppClientVersionDao.xml,AppClientVersionDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientVersionDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,client_ip,client_version,report_time'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""saveOrUpdateClientVersion"" parameterType=""AppClientVersion"" keyProperty=""id""'), (10, '\t\tuseGeneratedKeys=""true"">'), (11, '\t\tinsert into app_client_version_statistic(<include refid=""columns""/>)'), (12, '\t\tvalues(#{appId},#{clientIp},#{clientVersion},#{reportTime})'), (13, '\t\ton duplicate key'), (14, '\t\tupdate client_version=#{clientVersion},report_time=#{reportTime}'), (15, '\t</insert>'), (16, ''), (17, '\t<select id=""getByClientIp"" resultType=""AppClientVersion"">'), (18, '\t\tselect id,<include refid=""columns""/> from app_client_version_statistic where client_ip=#{clientIp}'), (19, '\t</select>'), (20, ''), (21, '\t<select id=""getAppAllClientVersion"" resultType=""AppClientVersion"">'), (22, '\t\tselect id,<include refid=""columns""/> from app_client_version_statistic where app_id=#{appId}'), (23, '\t</select>'), (24, ''), (25, '\t<select id=""getAppMaxClientVersion"" resultType=""string"">'), (26, '\t\tselect max(client_version) from app_client_version_statistic where app_id=#{appId}'), (27, '\t</select>'), (28, ''), (29, '\t<select id=""getAllMaxClientVersion"" resultType=""map"">'), (30, '\t\tselect app_id ""appId"",max(client_version) ""clientVersion""'), (31, '\t\tfrom app_client_version_statistic'), (32, '\t\tgroup by app_id'), (33, '\t</select>'), (34, ''), (35, '\t<select id=""getAll"" resultType=""AppClientVersion"">'), (36, '\t\tselect id,<include refid=""columns""/> from app_client_version_statistic where 1=1'), (37, '\t\t<choose>'), (38, '        \t<when test=""appId > 0"">'), (39, '        \t \tand app_id=#{appId}'), (40, '        \t</when>'), (41, '        </choose>'), (42, '\t</select>'), (43, ''), (44, '</mapper>')], 'deleted': []}"
156,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppDailyDao.xml,AppDailyDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppDailyDao"">'), (6, '\t<sql id=""app_daily_column"">'), (7, '\t\tapp_id,date,create_time,slow_log_count,client_exception_count,max_minute_client_count,'), (8, '\t\tavg_minute_client_count,max_minute_command_count,avg_minute_command_count,avg_hit_ratio,'), (9, '\t\tmin_minute_hit_ratio,max_minute_hit_ratio,avg_used_memory,max_used_memory,expired_keys_count,'), (10, '\t\tevicted_keys_count,avg_minute_net_input_byte,max_minute_net_input_byte,avg_minute_net_output_byte,'), (11, '\t\tmax_minute_net_output_byte,avg_object_size,max_object_size,big_key_times,big_key_info,'), (12, '\t\tclient_cmd_count,client_avg_cmd_cost,client_conn_exp_count,client_avg_conn_exp_cost,client_cmd_exp_count,client_avg_cmd_exp_cost'), (13, '    </sql>'), (14, ''), (15, '    <insert id=""save"" parameterType=""AppDailyData"" keyProperty=""id"" useGeneratedKeys=""true"">'), (16, '    \tinsert into app_daily'), (17, '    \t\t(<include refid=""app_daily_column""/>)'), (18, '\t\tvalues'), (19, '\t\t(#{appId},#{date},now(),#{slowLogCount},#{clientExceptionCount},#{maxMinuteClientCount},'), (20, '\t\t#{avgMinuteClientCount},#{maxMinuteCommandCount},#{avgMinuteCommandCount},#{avgHitRatio},'), (21, '\t\t#{minMinuteHitRatio},#{maxMinuteHitRatio},#{avgUsedMemory},#{maxUsedMemory},#{expiredKeysCount},'), (22, '\t\t#{evictedKeysCount},#{avgMinuteNetInputByte},#{maxMinuteNetInputByte},#{avgMinuteNetOutputByte},'), (23, '\t\t#{maxMinuteNetOutputByte},#{avgObjectSize},#{maxObjectSize},#{bigKeyTimes},#{bigKeyInfo},'), (24, '\t\t#{clientCmdCount},#{clientAvgCmdCost},#{clientConnExpCount},#{clientAvgConnExpCost},#{clientCmdExpCount},#{clientAvgCmdExpCost})'), (25, '    </insert>'), (26, ''), (27, '    <select id=""getAppDaily"" resultType=""AppDailyData"">'), (28, '\t\tselect id,<include refid=""app_daily_column""/> from app_daily where app_id=#{appId} and date =#{date}'), (29, '\t</select>'), (30, ''), (31, '</mapper>'), (32, ''), (33, '')], 'deleted': []}"
157,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppDao.xml,AppDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppDao"">'), (6, '    <sql id=""app_desc_add_fields"">'), (7, '        app_id,name,user_id,status,intro,create_time,passed_time,type,officer,'), (8, '        ver_id,is_test,has_back_store,need_persistence,need_hot_back_up,forecase_qps,'), (9, '        forecast_obj_num,mem_alert_value,client_machine_room,app_key,client_conn_alert_value,hit_precent_alert_value,is_access_monitor,important_level,password,version_id'), (10, '    </sql>'), (11, '    <sql id=""app_desc_fields"">'), (12, '        app_id,name,user_id,status,intro,create_time,passed_time,type,officer,'), (13, '        ver_id,is_test,has_back_store,need_persistence,need_hot_back_up,forecase_qps,'), (14, '        forecast_obj_num,mem_alert_value,client_machine_room,app_key,client_conn_alert_value,hit_precent_alert_value,is_access_monitor,important_level,password ""pkey"",version_id'), (15, '    </sql>'), (16, '    <!--通过appId查询app的信息-->'), (17, '    <select id=""getAppDescById"" resultType=""AppDesc"" parameterType=""long"">'), (18, '        SELECT'), (19, '            <include refid=""app_desc_fields""/>'), (20, '        FROM app_desc'), (21, '        WHERE app_id = #{appId};'), (22, '    </select>'), (23, ''), (24, ''), (25, '    <select id=""getOnlineAppDescById"" resultType=""AppDesc"" parameterType=""long"">'), (26, '        SELECT'), (27, '        <include refid=""app_desc_fields""/>'), (28, '        FROM app_desc'), (29, '        WHERE app_id = #{appId}'), (30, '        AND status = 2'), (31, '    </select>'), (32, ''), (33, '    <!-- 根据应用名查询app信息 -->'), (34, '    <select id=""getByAppName"" resultType=""AppDesc"" parameterType=""string"">'), (35, '        SELECT'), (36, '            <include refid=""app_desc_fields""/>'), (37, '        FROM app_desc'), (38, '        WHERE name = #{appName};'), (39, '    </select>'), (40, ''), (41, ''), (42, '    <insert id=""save"" parameterType=""AppDesc""  keyProperty=""appId"" useGeneratedKeys=""true"" >'), (43, '    \tinsert into app_desc'), (44, '    \t\t(<include refid=""app_desc_add_fields""/>)'), (45, '\t\tvalues'), (46, '\t\t\t('), (47, '            #{appId},#{name},#{userId},#{status},#{intro},#{createTime},#{passedTime},'), (48, '\t\t\t#{type},#{officer},#{verId},#{isTest},#{hasBackStore},#{needPersistence},'), (49, '\t\t\t#{needHotBackUp},#{forecaseQps},#{forecastObjNum},#{memAlertValue},#{clientMachineRoom},'), (50, '            #{appKey},#{clientConnAlertValue},#{hitPrecentAlertValue},#{isAccessMonitor},#{importantLevel},#{pkey},#{versionId}'), (51, '            )'), (52, '    </insert>'), (53, ''), (54, '    <update id=""update"" parameterType=""AppDesc"">'), (55, '    \tupdate app_desc'), (56, '    \t\tset name=#{name}, user_id=#{userId}, status=#{status}, intro=#{intro}, create_time=#{createTime},'), (57, '    \t\t\tpassed_time=#{passedTime},type=#{type},'), (58, '    \t\t\tofficer=#{officer},ver_id=#{verId},mem_alert_value=#{memAlertValue},'), (59, '    \t\t\tclient_conn_alert_value=#{clientConnAlertValue},hit_precent_alert_value=#{hitPrecentAlertValue},is_access_monitor=#{isAccessMonitor},important_level=#{importantLevel},'), (60, '    \t\t\tpassword=#{pkey},version_id=#{versionId}'), (61, '    \twhere app_id=#{appId}'), (62, '    </update>'), (63, ''), (64, '    <sql id=""app_desc_select_column"">'), (65, '    \tapp_desc.app_id,name,app_desc.user_id,status,intro,create_time,passed_time,type,officer,ver_id,app_key,password ""pkey"",version_id,is_test'), (66, '    </sql>'), (67, '    <select id=""getAppDescList"" resultType=""AppDesc"" parameterType=""long"">'), (68, '    \tselect'), (69, '        \t<include refid=""app_desc_select_column""/>'), (70, '        from app_desc,app_to_user where app_to_user.user_id=#{userId} and app_to_user.app_id=app_desc.app_id and app_desc.status &lt; 3'), (71, '    </select>'), (72, ''), (73, '    <select id=""getOnlineApps"" resultType=""AppDesc"">'), (74, '        select'), (75, '        <include refid=""app_desc_select_column""/>'), (76, '        from app_desc'), (77, '        where status = 2'), (78, '    </select>'), (79, ''), (80, ''), (81, '    <select id=""getOnlineAppsNonTest"" resultType=""AppDesc"">'), (82, '        select'), (83, '        <include refid=""app_desc_select_column""/>'), (84, '        from app_desc'), (85, '        where status = 2 AND is_test = 0'), (86, '    </select>'), (87, ''), (88, '    <select id=""getAllApps"" resultType=""AppDesc"">'), (89, '        select'), (90, '        <include refid=""app_desc_select_column""/>'), (91, '        from app_desc'), (92, '        order by app_id'), (93, '    </select>'), (94, ''), (95, '    <select id=""getUserAppCount"" resultType=""int"" parameterType=""long"">'), (96, '    \tselect count(app_desc.app_id) from app_desc,app_to_user where app_to_user.user_id=#{userId} and app_to_user.app_id=app_desc.app_id and app_desc.status &lt; 3'), (97, '    </select>'), (98, ''), (99, '    <select id=""getAllAppCount"" resultType=""int"" parameterType=""AppSearch"">'), (100, '    \tselect count(app_id) from app_desc where 1=1 and status &lt; 3'), (101, '        <choose>'), (102, '            <when test=""appName != null and appName != \'\'"">'), (103, ""            \tand name like '%${appName}%'""), (104, '       \t \t</when>'), (105, '        </choose>'), (106, '        <choose>'), (107, '            <when test=""appType != null and appType > 0"">'), (108, '            \tand type = #{appType}'), (109, '       \t \t</when>'), (110, '        </choose>'), (111, '        <choose>'), (112, '            <when test=""appStatus != null and appStatus >= 0"">'), (113, '            \tand status = #{appStatus}'), (114, '       \t \t</when>'), (115, '        </choose>'), (116, '        <choose>'), (117, '            <when test=""appId != null and appId > 0"">'), (118, '            \tand app_id = #{appId}'), (119, '       \t \t</when>'), (120, '        </choose>'), (121, '        <choose>'), (122, '            <when test=""importantLevel != null and importantLevel > 0"">'), (123, '            \tand important_level = #{importantLevel}'), (124, '       \t \t</when>'), (125, '        </choose>'), (126, '        <choose>'), (127, '            <when test=""versionId != null and versionId > 0"">'), (128, '                and version_id = ${versionId}'), (129, '            </when>'), (130, '        </choose>'), (131, '        <choose>'), (132, '            <when test=""userId != null and userId > 0"">'), (133, '                and app_id in (select app_id from app_to_user where user_id = ${userId})'), (134, '            </when>'), (135, '        </choose>'), (136, '    </select>'), (137, ''), (138, '    <select id=""getAllAppDescList"" resultType=""AppDesc"" parameterType=""AppSearch"">'), (139, '    \tselect'), (140, '        \t<include refid=""app_desc_fields""/>'), (141, '        from app_desc where 1=1 and status &lt; 3'), (142, '        <choose>'), (143, '            <when test=""appName != null and appName != \'\'"">'), (144, ""            \tand name like '%${appName}%'""), (145, '       \t \t</when>'), (146, '        </choose>'), (147, '        <choose>'), (148, '            <when test=""appType != null and appType > 0"">'), (149, '            \tand type = #{appType}'), (150, '       \t \t</when>'), (151, '        </choose>'), (152, '        <choose>'), (153, '            <when test=""appStatus != null and appStatus >= 0"">'), (154, '            \tand status = #{appStatus}'), (155, '       \t \t</when>'), (156, '        </choose>'), (157, '        <choose>'), (158, '            <when test=""appId != null and appId > 0"">'), (159, '            \tand app_id = #{appId}'), (160, '       \t \t</when>'), (161, '        </choose>'), (162, '        <choose>'), (163, '            <when test=""importantLevel != null and importantLevel > 0"">'), (164, '            \tand important_level = ${importantLevel}'), (165, '       \t \t</when>'), (166, '        </choose>'), (167, '        <choose>'), (168, '            <when test=""versionId != null and versionId > 0"">'), (169, '                and version_id = ${versionId}'), (170, '            </when>'), (171, '        </choose>'), (172, '        <choose>'), (173, '            <when test=""userId != null and userId > 0"">'), (174, '                and app_id in (select app_id from app_to_user where user_id = ${userId})'), (175, '            </when>'), (176, '        </choose>'), (177, '        ORDER BY app_id desc'), (178, '        <choose>'), (179, '        \t<when test=""page != null"">'), (180, '        \t\t<choose>'), (181, '\t\t        \t<when test=""page.totalCount > page.pageSize"">'), (182, '            \t\t\tlimit #{page.start},#{page.pageSize}'), (183, '\t\t        \t</when>'), (184, '\t\t        \t<otherwise>'), (185, '\t\t        \t    limit #{page.totalCount}'), (186, '\t\t        \t</otherwise>'), (187, '\t\t        </choose>'), (188, '        \t</when>'), (189, '        </choose>'), (190, '    </select>'), (191, ''), (192, '    <select id=""getTotalAppCount"" resultType=""int"" parameterType=""AppSearch"">'), (193, '        select count(app_id) from app_desc'), (194, '    </select>'), (195, ''), (196, '    <update id=""updateAppKey"">'), (197, '    \tupdate app_desc set app_key=#{appKey} where app_id=#{appId}'), (198, '    </update>'), (199, ''), (200, '    <select id=""getAppDescByIds"" resultType=""AppDesc"" parameterType=""java.util.List"">'), (201, '        select * from app_desc where app_id in'), (202, '        <foreach collection=""appIds"" index=""index"" item=""appId"" open=""("" separator="","" close="")"">'), (203, '            #{appId}'), (204, '        </foreach>'), (205, '    </select>'), (206, ''), (207, '</mapper>'), (208, ''), (209, '')], 'deleted': []}"
158,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppDataMigrateStatusDao.xml,AppDataMigrateStatusDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppDataMigrateStatusDao"">'), (6, '    <sql id=""migrate_data_status_fields"">'), (7, '        migrate_id,migrate_tool,migrate_machine_ip,migrate_machine_port,source_migrate_type,source_servers,target_migrate_type,target_servers,'), (8, '        source_app_id,target_app_id,redis_source_version,redis_target_version,'), (9, '        user_id,status,start_time,end_time,log_path,config_path'), (10, '    </sql>'), (11, ''), (12, '    <insert id=""save"" parameterType=""AppDataMigrateStatus"" keyProperty=""id"" useGeneratedKeys=""true"">'), (13, '        insert into app_data_migrate_status'), (14, '        (<include refid=""migrate_data_status_fields""/>)'), (15, '        values'), (16, '        (#{migrateId},#{migrateTool},#{migrateMachineIp},#{migrateMachinePort},#{sourceMigrateType},#{sourceServers},#{targetMigrateType},#{targetServers},'), (17, '        #{sourceAppId},#{targetAppId},#{redisSourceVersion},#{redisTargetVersion},'), (18, '        #{userId},#{status},#{startTime},#{endTime},#{logPath},#{configPath})'), (19, '    </insert>'), (20, ''), (21, '    <select id=""getMigrateTaskCount"" resultType=""int"">'), (22, '        select count(*)'), (23, '        from app_data_migrate_status where 1=1'), (24, '        <choose>'), (25, '            <when test=""appDataMigrateSearch.sourceAppId != null and appDataMigrateSearch.sourceAppId > 0"">'), (26, '                and source_app_id = #{appDataMigrateSearch.sourceAppId}'), (27, '            </when>'), (28, '        </choose>'), (29, '        <choose>'), (30, '            <when test=""appDataMigrateSearch.targetAppId != null and appDataMigrateSearch.targetAppId > 0"">'), (31, '                and target_app_id = #{appDataMigrateSearch.targetAppId}'), (32, '            </when>'), (33, '        </choose>'), (34, ''), (35, '        <choose>'), (36, '            <when test=""appDataMigrateSearch.sourceInstanceIp != null and appDataMigrateSearch.sourceInstanceIp != \'\'"">'), (37, ""                and source_servers like '%${appDataMigrateSearch.sourceInstanceIp}%'""), (38, '            </when>'), (39, '        </choose>'), (40, '        <choose>'), (41, '            <when test=""appDataMigrateSearch.targetInstanceIp != null and appDataMigrateSearch.targetInstanceIp != \'\'"">'), (42, ""                and target_servers like '%${appDataMigrateSearch.targetInstanceIp}%'""), (43, '            </when>'), (44, '        </choose>'), (45, ''), (46, '        <choose>'), (47, '            <when test=""appDataMigrateSearch.startDate != null and appDataMigrateSearch.startDate != \'\'"">'), (48, '                and start_time > #{appDataMigrateSearch.startDate}'), (49, '            </when>'), (50, '        </choose>'), (51, '        <choose>'), (52, '            <when test=""appDataMigrateSearch.endDate != null and appDataMigrateSearch.endDate != \'\'"">'), (53, '                and end_time &lt;#{appDataMigrateSearch.endDate}'), (54, '            </when>'), (55, '        </choose>'), (56, '        <choose>'), (57, '            <when test=""appDataMigrateSearch.status >= 0"">'), (58, '                and status = #{appDataMigrateSearch.status}'), (59, '            </when>'), (60, '        </choose>'), (61, '        <choose>'), (62, '            <when test=""appDataMigrateSearch.migrateMachine != null and appDataMigrateSearch.migrateMachine != \'\'"">'), (63, '                and migrate_machine_ip = #{appDataMigrateSearch.migrateMachine}'), (64, '            </when>'), (65, '        </choose>'), (66, '        <choose>'), (67, '            <when test=""appDataMigrateSearch.userId != null and appDataMigrateSearch.userId>0"">'), (68, '                and user_id = #{appDataMigrateSearch.userId}'), (69, '            </when>'), (70, '        </choose>'), (71, '    </select>'), (72, ''), (73, '    <select id=""search"" resultType=""AppDataMigrateStatus"">'), (74, '        select app_data_migrate_status.id,<include refid=""migrate_data_status_fields""/>,app_user.ch_name as user_name'), (75, '        from app_data_migrate_status, app_user where 1=1 and app_data_migrate_status.user_id=app_user.id'), (76, '        <choose>'), (77, '            <when test=""appDataMigrateSearch.sourceAppId != null and appDataMigrateSearch.sourceAppId > 0"">'), (78, '                and source_app_id = #{appDataMigrateSearch.sourceAppId}'), (79, '            </when>'), (80, '        </choose>'), (81, '        <choose>'), (82, '            <when test=""appDataMigrateSearch.targetAppId != null and appDataMigrateSearch.targetAppId > 0"">'), (83, '                and target_app_id = #{appDataMigrateSearch.targetAppId}'), (84, '            </when>'), (85, '        </choose>'), (86, ''), (87, '        <choose>'), (88, '            <when test=""appDataMigrateSearch.sourceInstanceIp != null and appDataMigrateSearch.sourceInstanceIp != \'\'"">'), (89, ""                and source_servers like '%${appDataMigrateSearch.sourceInstanceIp}%'""), (90, '            </when>'), (91, '        </choose>'), (92, '        <choose>'), (93, '            <when test=""appDataMigrateSearch.targetInstanceIp != null and appDataMigrateSearch.targetInstanceIp != \'\'"">'), (94, ""                and target_servers like '%${appDataMigrateSearch.targetInstanceIp}%'""), (95, '            </when>'), (96, '        </choose>'), (97, ''), (98, '        <choose>'), (99, '            <when test=""appDataMigrateSearch.startDate != null and appDataMigrateSearch.startDate != \'\'"">'), (100, '                and start_time > #{appDataMigrateSearch.startDate}'), (101, '            </when>'), (102, '        </choose>'), (103, '        <choose>'), (104, '            <when test=""appDataMigrateSearch.endDate != null and appDataMigrateSearch.endDate != \'\'"">'), (105, '                and end_time &lt;#{appDataMigrateSearch.endDate}'), (106, '            </when>'), (107, '        </choose>'), (108, '        <choose>'), (109, '            <when test=""appDataMigrateSearch.status >= 0"">'), (110, '                and status = #{appDataMigrateSearch.status}'), (111, '            </when>'), (112, '        </choose>'), (113, '        <choose>'), (114, '            <when test=""appDataMigrateSearch.migrateMachine != null and appDataMigrateSearch.migrateMachine != \'\'"">'), (115, '                and migrate_machine_ip = #{appDataMigrateSearch.migrateMachine}'), (116, '            </when>'), (117, '        </choose>'), (118, '        <choose>'), (119, '            <when test=""appDataMigrateSearch.userId != null and appDataMigrateSearch.userId >0"">'), (120, '                and user_id = #{appDataMigrateSearch.userId}'), (121, '            </when>'), (122, '        </choose>'), (123, '        order by start_time desc'), (124, '        <choose>'), (125, '            <when test=""appDataMigrateSearch.page != null"">'), (126, '                <choose>'), (127, '                    <when test=""appDataMigrateSearch.page.totalCount > appDataMigrateSearch.page.pageSize"">'), (128, '                        limit #{appDataMigrateSearch.page.start},#{appDataMigrateSearch.page.pageSize}'), (129, '                    </when>'), (130, '                    <otherwise>'), (131, '                        limit #{appDataMigrateSearch.page.totalCount}'), (132, '                    </otherwise>'), (133, '                </choose>'), (134, '            </when>'), (135, '        </choose>'), (136, '    </select>'), (137, ''), (138, '    <select id=""get"" resultType=""AppDataMigrateStatus"">'), (139, '        select id,'), (140, '        <include refid=""migrate_data_status_fields""/>'), (141, '        from app_data_migrate_status where id = #{id}'), (142, '    </select>'), (143, ''), (144, '    <update id=""updateStatus"">'), (145, '    \tupdate app_data_migrate_status set status = #{status}, end_time=now() where id = #{id}'), (146, '    </update>'), (147, ''), (148, '    <select id=""getAllOnMigrateId"" resultType=""long"">'), (149, '        select id from app_data_migrate_status where status !=1;'), (150, '    </select>'), (151, ''), (152, '</mapper>'), (153, ''), (154, '')], 'deleted': []}"
159,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppInstanceClientRelationDao.xml,AppInstanceClientRelationDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppInstanceClientRelationDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,client_ip,instance_host,instance_port,instance_id,day'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""save"" parameterType=""AppInstanceClientRelation"" keyProperty=""id"" useGeneratedKeys=""true"">'), (10, '\t\tinsert ignore into app_client_instance(<include refid=""columns""/>)'), (11, '\t\tvalues(#{appId},#{clientIp},#{instanceHost},#{instancePort},#{instanceId},#{day})'), (12, '\t</insert>'), (13, ''), (14, '\t<insert id=""batchSave"" >'), (15, '\t\tinsert ignore into app_client_instance(<include refid=""columns"" />)'), (16, '\t\tvalues'), (17, '\t\t<foreach collection=""list"" item=""appInstanceClientRelation"" separator="","">'), (18, '\t\t\t(#{appInstanceClientRelation.appId},#{appInstanceClientRelation.clientIp},#{appInstanceClientRelation.instanceHost},#{appInstanceClientRelation.instancePort},#{appInstanceClientRelation.instanceId},#{appInstanceClientRelation.day})'), (19, '\t    </foreach>'), (20, '\t</insert>'), (21, ''), (22, '\t<select id=""isExist"" resultType=""int"">'), (23, '\t\tselect count(*) from app_client_instance where app_id=#{appId} and day=#{day} and client_ip=#{clientIp} and instance_id=#{instanceId}'), (24, '\t</select>'), (25, ''), (26, '\t<select id=""getAppInstanceClientRelationList"" resultType=""AppInstanceClientRelation"">'), (27, '\t\tselect <include refid=""columns""/> from app_client_instance where app_id=#{appId} and day=date(#{day})'), (28, '\t</select>'), (29, ''), (30, '</mapper>')], 'deleted': []}"
160,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppStatsDao.xml,AppStatsDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppStatsDao"">'), (5, '    <sql id=""app_minute_statistics_columns"">'), (6, '        app_id,collect_time,hits,misses,command_count,used_memory,used_memory_rss,'), (7, '        expired_keys,evicted_keys,net_input_byte,net_output_byte,'), (8, '        connected_clients,object_size,'), (9, '        cpu_sys,cpu_user,cpu_sys_children,cpu_user_children,'), (10, '        modify_time,accumulation'), (11, '    </sql>'), (12, ''), (13, '    <sql id=""select_table"">'), (14, '        <choose>'), (15, '            <when test=""td.dimensionality ==0"">app_minute_command_statistics</when>'), (16, '            <otherwise>app_hour_command_statistics</otherwise>'), (17, '        </choose>'), (18, '    </sql>'), (19, ''), (20, '    <sql id=""select_stat_table"">'), (21, '        <choose>'), (22, '            <when test=""td.dimensionality ==0"">app_minute_statistics</when>'), (23, '            <otherwise>app_hour_statistics</otherwise>'), (24, '        </choose>'), (25, '    </sql>'), (26, ''), (27, '    <sql id=""select_stat_filed"">'), (28, '        <choose>'), (29, '            <when test=""td.dimensionality ==0"">'), (30, '                <include refid=""app_minute_statistics_columns""/>'), (31, '            </when>'), (32, '            <otherwise>app_id,collect_time,hits,misses,command_count,used_memory/60 used_memory,'), (33, '                expired_keys,evicted_keys,net_input_byte,net_output_byte,'), (34, '                connected_clients,object_size,modify_time,accumulation'), (35, '            </otherwise>'), (36, '        </choose>'), (37, '    </sql>'), (38, ''), (39, '    <sql id=""app_minute_command_statistics_columns"">'), (40, '        app_id,collect_time,command_name,command_count,modify_time'), (41, '    </sql>'), (42, ''), (43, '    <insert id=""mergeMinuteAppStats"" parameterType=""AppStats"">'), (44, '        insert into app_minute_statistics'), (45, '        (<include refid=""app_minute_statistics_columns""/>)'), (46, '        values'), (47, '        (#{appId},#{collectTime},#{hits},#{misses},#{commandCount},#{usedMemory},#{usedMemoryRss},'), (48, '        #{expiredKeys},#{evictedKeys},#{netInputByte},#{netOutputByte},'), (49, '        #{connectedClients},#{objectSize},'), (50, '        #{cpuSys},#{cpuUser},#{cpuSysChildren},#{cpuUserChildren},'), (51, '        #{modifyTime},1)'), (52, '        on duplicate key update'), (53, '        hits = hits + #{hits},'), (54, '        misses = misses + #{misses},'), (55, '        command_count = command_count + #{commandCount},'), (56, '        used_memory = used_memory + #{usedMemory},'), (57, '        used_memory_rss = used_memory_rss + #{usedMemoryRss},'), (58, '        expired_keys = expired_keys + #{expiredKeys},'), (59, '        evicted_keys = evicted_keys + #{evictedKeys},'), (60, '        net_input_byte = net_input_byte + #{netInputByte},'), (61, '        net_output_byte = net_output_byte + #{netOutputByte},'), (62, '        connected_clients = connected_clients + #{connectedClients},'), (63, '        object_size = object_size + #{objectSize},'), (64, '        cpu_sys = cpu_sys + #{cpuSys},'), (65, '        cpu_user = cpu_user + #{cpuUser},'), (66, '        cpu_sys_children = cpu_sys_children + #{cpuSysChildren},'), (67, '        cpu_user_children = cpu_user_children + #{cpuUserChildren},'), (68, '        modify_time = #{modifyTime},'), (69, '        accumulation = accumulation + 1'), (70, '    </insert>'), (71, ''), (72, '    <insert id=""mergeMinuteCommandStatus"" parameterType=""AppCommandStats"">'), (73, '        insert into app_minute_command_statistics'), (74, '        (<include refid=""app_minute_command_statistics_columns""/>)'), (75, '        values'), (76, '        (#{appId},#{collectTime},#{commandName},#{commandCount},#{modifyTime})'), (77, '        on duplicate key update'), (78, '        command_count = command_count + #{commandCount},'), (79, '        modify_time = #{modifyTime}'), (80, '    </insert>'), (81, ''), (82, '    <insert id=""mergeHourAppStats"" parameterType=""AppStats"">'), (83, '        insert into app_hour_statistics'), (84, '        (<include refid=""app_minute_statistics_columns""/>)'), (85, '        values'), (86, '        (#{appId},substring(#{collectTime}, 1,'), (87, '        10),#{hits},#{misses},#{commandCount},#{usedMemory},#{usedMemoryRss},#{expiredKeys},'), (88, '        #{evictedKeys},#{netInputByte},#{netOutputByte},#{connectedClients},#{objectSize},'), (89, '        #{cpuSys},#{cpuUser},#{cpuSysChildren},#{cpuUserChildren},'), (90, '        #{modifyTime},1)'), (91, '        on duplicate key update'), (92, '        hits = hits + #{hits},'), (93, '        misses = misses + #{misses},'), (94, '        command_count = command_count + #{commandCount},'), (95, '        used_memory = used_memory+#{usedMemory} ,'), (96, '        used_memory_rss = used_memory_rss+#{usedMemoryRss} ,'), (97, '        expired_keys = expired_keys + #{expiredKeys},'), (98, '        evicted_keys = evicted_keys + #{evictedKeys},'), (99, '        net_input_byte = net_input_byte + #{netInputByte},'), (100, '        net_output_byte = net_output_byte + #{netOutputByte},'), (101, '        connected_clients = connected_clients + #{connectedClients},'), (102, '        object_size = object_size + #{objectSize},'), (103, '        cpu_sys = cpu_sys + #{cpuSys},'), (104, '        cpu_user = cpu_user + #{cpuUser},'), (105, '        cpu_sys_children = cpu_sys_children + #{cpuSysChildren},'), (106, '        cpu_user_children = cpu_user_children + #{cpuUserChildren},'), (107, '        modify_time = #{modifyTime},'), (108, '        accumulation = accumulation + 1'), (109, '    </insert>'), (110, ''), (111, '    <insert id=""mergeHourCommandStatus"" parameterType=""AppCommandStats"">'), (112, '        insert into app_hour_command_statistics'), (113, '        (<include refid=""app_minute_command_statistics_columns""/>)'), (114, '        values'), (115, '        (#{appId},substring(#{collectTime}, 1, 10),#{commandName},#{commandCount},#{modifyTime})'), (116, '        on duplicate key update'), (117, '        command_count = command_count + #{commandCount},'), (118, '        modify_time = #{modifyTime}'), (119, '    </insert>'), (120, ''), (121, '    <select id=""getAppStatsList"" resultType=""AppStats"">'), (122, '        select'), (123, '        <include refid=""select_stat_filed""/>,create_time'), (124, '        from'), (125, '        <include refid=""select_stat_table""/>'), (126, '        where'), (127, '        app_id = #{appId} and collect_time between #{td.begin} and #{td.end}'), (128, '    </select>'), (129, ''), (130, '    <select id=""getAppStatsByMinute"" resultType=""AppStats"">'), (131, '        select'), (132, '        <include refid=""app_minute_statistics_columns""/>'), (133, '        , create_time'), (134, '        from app_minute_statistics'), (135, '        where'), (136, '        app_id = #{appId} and collect_time between #{beginTime} and #{endTime}'), (137, '    </select>'), (138, ''), (139, ''), (140, '    <select id=""gatherAppsStats"" resultType=""AppClientStatisticGather"">'), (141, '        select app_id,'), (142, ""        DATE_FORMAT(create_time, '%Y-%m-%d') gather_time,""), (143, '        object_size,'), (144, '        used_memory,'), (145, '        used_memory_rss,'), (146, '        format(used_memory_rss/used_memory,2) as avg_mem_frag_ratio,'), (147, '        max(cpu_sys)  as                     max_cpu_sys,'), (148, '        max(cpu_user) as                     max_cpu_user'), (149, '        from app_minute_statistics'), (150, '        where modify_time between #{startTime} and #{endTime}'), (151, '        group by app_id;'), (152, '    </select>'), (153, ''), (154, ''), (155, '    <select id=""getAppStatsByHour"" resultType=""AppStats"">'), (156, '        select'), (157, '        <include refid=""app_minute_statistics_columns""/>'), (158, '        , create_time'), (159, '        from app_hour_statistics'), (160, '        where'), (161, '        app_id = #{appId} and collect_time between #{beginTime} and #{endTime}'), (162, '    </select>'), (163, ''), (164, ''), (165, '    <select id=""getAppCommandStatsList"" resultType=""AppCommandStats"">'), (166, '        select'), (167, '        <include refid=""app_minute_command_statistics_columns""/>'), (168, '        , create_time'), (169, '        from'), (170, '        <include refid=""select_table""/>'), (171, '        where'), (172, '        app_id = #{appId}'), (173, '        and command_name = #{commandName}'), (174, '        and collect_time between #{td.begin} and #{td.end}'), (175, '    </select>'), (176, ''), (177, '    <select id=""getAppAllCommandStatsListByMinute"" resultType=""AppCommandStats"">'), (178, '        select'), (179, '        app_id,'), (180, '        collect_time,'), (181, ""        'commands' command_name,""), (182, '        command_count,'), (183, '        create_time,'), (184, '        modify_time'), (185, '        from app_minute_statistics'), (186, '        where'), (187, '          app_id = #{appId}'), (188, '          and collect_time between #{beginTime} and #{endTime}'), (189, '    </select>'), (190, ''), (191, ''), (192, '    <select id=""getAppAllCommandStatsListByHour"" resultType=""AppCommandStats"">'), (193, '        select'), (194, '        app_id,'), (195, '        collect_time,'), (196, ""        'commands' command_name,""), (197, '        command_count,'), (198, '        create_time,'), (199, '        modify_time'), (200, '        from app_hour_statistics'), (201, '        where'), (202, '          app_id = #{appId}'), (203, '          and collect_time between #{beginTime} and #{endTime}'), (204, '    </select>'), (205, ''), (206, '    <select id=""getAppCommandStatsListByMinuteWithCommand"" resultType=""AppCommandStats"">'), (207, '        select'), (208, '        <include refid=""app_minute_command_statistics_columns""/>'), (209, '        , create_time'), (210, '        from app_minute_command_statistics'), (211, '        where'), (212, '        app_id = #{appId}'), (213, '        and command_name = #{commandName}'), (214, '        and collect_time between #{beginTime} and #{endTime}'), (215, '    </select>'), (216, ''), (217, ''), (218, '    <select id=""getAppCommandStatsListByHourWithCommand"" resultType=""AppCommandStats"">'), (219, '        select'), (220, '        <include refid=""app_minute_command_statistics_columns""/>'), (221, '        , create_time'), (222, '        from app_hour_command_statistics'), (223, '        where'), (224, '        app_id = #{appId}'), (225, '        and command_name = #{commandName}'), (226, '        and collect_time between #{beginTime} and #{endTime}'), (227, '    </select>'), (228, ''), (229, ''), (230, '    <select id=""getAppAllCommandStatsList"" resultType=""AppCommandStats"">'), (231, '        select'), (232, '        app_id,'), (233, '        collect_time,'), (234, ""        'commands' command_name,""), (235, '        command_count,'), (236, '        create_time,'), (237, '        modify_time'), (238, '        from'), (239, '        <include refid=""select_stat_table""/>'), (240, '        where'), (241, '        app_id = #{appId}'), (242, '        and collect_time between #{td.begin} and #{td.end}'), (243, '    </select>'), (244, ''), (245, '    <!-- 获取应用命令调用次数分布 -->'), (246, '    <select id=""getAppCommandGroup"" resultType=""AppCommandGroup"">'), (247, '        select'), (248, '        command_name,sum(command_count) as count'), (249, '        from'), (250, '        <include refid=""select_table""/>'), (251, '        where'), (252, '        app_id = #{appId}'), (253, '        and collect_time between #{td.begin} and #{td.end}'), (254, '        group by command_name'), (255, '    </select>'), (256, ''), (257, '    <!--查询一天中应用的命令执行次数的top-->'), (258, '    <select id=""getTopAppCommandStatsList"" resultType=""AppCommandStats"">'), (259, '        select'), (260, '        app_id, command_name , max(collect_time) collect_time, sum(command_count) command_count ,'), (261, '        max(modify_time) modify_time, max(create_time) create_time'), (262, '        from'), (263, '        <include refid=""select_table""/>'), (264, '        where app_id = #{appId}'), (265, '        and collect_time between #{td.begin} and #{td.end}'), (266, '        group by app_id,command_name'), (267, '        order by command_count desc , modify_time desc'), (268, '        limit #{top};'), (269, '    </select>'), (270, ''), (271, ''), (272, '    <select id=""getTopAppCommandGroupSum"" resultType=""AppCommandStats"">'), (273, '        select'), (274, '        app_id,collect_time,command_name,sum(command_count) as command_count,modify_time, create_time'), (275, '        from'), (276, '        <include refid=""select_table""/>'), (277, '        where app_id = #{appId}'), (278, '        and collect_time between #{td.begin} and #{td.end}'), (279, '        group by command_name'), (280, '        order by sum(command_count) desc'), (281, '        limit #{top};'), (282, '    </select>'), (283, ''), (284, '    <select id=""getCommandClimax"" resultType=""AppCommandStats"">'), (285, '        select t2.*'), (286, '        from (select app_id, command_name, max(command_count) command_count'), (287, '        from'), (288, '        <include refid=""select_table""/>'), (289, '        where'), (290, '        app_id = #{appId}'), (291, '        and command_name = #{commandName}'), (292, '        and collect_time between #{td.begin} and #{td.end}'), (293, '        group by app_id,command_name) t1 ,'), (294, '        <include refid=""select_table""/>'), (295, '        t2'), (296, '        where t1.app_id = t2.app_id'), (297, '        and t1.command_name=t2.command_name'), (298, '        and t1.command_count=t2.command_count'), (299, '        and t2.collect_time between #{td.begin} and #{td.end}'), (300, '        limit 1;'), (301, '    </select>'), (302, ''), (303, '    <select id=""getCommandClimaxCount"" resultType=""AppCommandStats"">'), (304, '        select max(command_count) as command_count'), (305, '        from'), (306, '        <include refid=""select_table""/>'), (307, '        where app_id = #{appId} and collect_time between #{td.begin} and #{td.end} and command_name = #{commandName}'), (308, '    </select>'), (309, ''), (310, '    <select id=""getCommandClimaxCreateTime"" resultType=""AppCommandStats"">'), (311, '        select create_time'), (312, '        from'), (313, '        <include refid=""select_table""/>'), (314, '        where app_id = #{appId} and collect_time between #{td.begin} and #{td.end} and command_name = #{commandName} and'), (315, '        command_count=#{commandCount} limit 1'), (316, '    </select>'), (317, ''), (318, '    <select id=""getAppMinuteStat"" resultType=""hashmap"">'), (319, '        select'), (320, '        \tavg(connected_clients) as avgClientCount,'), (321, '        \tmax(connected_clients) as maxClientCount,'), (322, '        \tavg(command_count) as avgCommandCount,'), (323, '        \tmax(command_count) as maxCommandCount,'), (324, '            sum(hits)/sum(command_count) as avgHitRatio,'), (325, '\t        max(hits/command_count) as maxHitRatio,'), (326, '\t        min(hits/command_count) as minHitRatio,'), (327, '\t        avg(used_memory) as avgUsedMemory,'), (328, '\t        max(used_memory) as maxUsedMemory,'), (329, '\t        sum(expired_keys) as expiredKeys,'), (330, '\t        sum(evicted_keys) as evictedKeys,'), (331, '\t        avg(net_input_byte) as avgNetInputByte,'), (332, '\t        max(net_input_byte) as maxNetInputByte,'), (333, '\t        avg(net_output_byte) as avgNetOutputByte,'), (334, '\t        max(net_output_byte) as maxNetOutputByte,'), (335, '\t        avg(object_size) as avgObjectSize,'), (336, '\t        max(object_size) as maxObjectSize'), (337, '        from app_minute_statistics'), (338, '        where app_id = #{appId} and collect_time between #{beginTime} and #{endTime}'), (339, '    </select>'), (340, ''), (341, '    <select id=""getTopMemFragRatioApps"" resultType=""AppTopMemFragRatio"">'), (342, '        select c.app_id,c.name,c.officer,c.status,c.intro,c.is_test,a.instanceCount,a.avgMemFragRatio,a.memUsedRatio,b.exceptionCount,d.name as versionName'), (343, '        from'), (344, '        (select app_id,count(id) as instanceCount,format(avg(mem_fragmentation_ratio),2) as avgMemFragRatio, round(sum(used_memory)/sum(max_memory)*100,2) as memUsedRatio'), (345, '          FROM instance_statistics'), (346, '          WHERE modify_time between #{startTime} and #{endTime} group by app_id order by avg(mem_fragmentation_ratio) desc) a'), (347, '        left join'), (348, '        (select app_id,sum(exception_count) as exceptionCount'), (349, '          FROM app_client_exception_minute_stat'), (350, '          WHERE collect_time between #{startTime} and #{endTime} group by app_id) b'), (351, '        on a.app_id=b.app_id'), (352, '        left join'), (353, '        app_desc c'), (354, '        on a.app_id=c.app_id'), (355, '        left join'), (356, '        redis_version d'), (357, '        on c.version_id=d.id'), (358, '        where c.status=2;'), (359, '    </select>'), (360, ''), (361, '    <select id=""getMemFragRatios"" resultType=""AppClientStatisticGather"">'), (362, ""        select app_id, count(id) as instanceCount, format(avg(mem_fragmentation_ratio),2) as avgMemFragRatio, round(sum(used_memory)/sum(max_memory)*100,2) as memUsedRatio, DATE_FORMAT(modify_time,'%Y-%m-%d') gather_time""), (363, '        FROM instance_statistics'), (364, '        WHERE modify_time between #{startTime} and #{endTime}'), (365, '        group by app_id'), (366, '    </select>'), (367, ''), (368, '    <select id=""getExceptionCount"" resultType=""AppClientStatisticGather"">'), (369, ""        select app_id, sum(exception_count) as exceptionCount, DATE_FORMAT(collect_time,'%Y-%m-%d') gather_time""), (370, '        FROM app_client_exception_minute_stat'), (371, '        WHERE collect_time between #{startTime} and #{endTime}'), (372, '        group by app_id'), (373, '    </select>'), (374, '</mapper>')], 'deleted': []}"
161,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppToUserDao.xml,AppToUserDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppToUserDao"">'), (6, '    <sql id=""app_to_user_column"">'), (7, '    \tid,user_id,app_id'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""save"" parameterType=""AppToUser"">'), (11, '    \tinsert into app_to_user'), (12, '    \t\t(<include refid=""app_to_user_column""/>)'), (13, '\t\tvalues'), (14, '\t\t\t(#{id},#{userId},#{appId})'), (15, '    </insert>'), (16, ''), (17, '    <!-- 获取用户的app -->'), (18, '    <select id=""getByUserId"" resultType=""AppToUser"" parameterType=""long"">'), (19, '    \tselect'), (20, '        \t<include refid=""app_to_user_column""/>'), (21, '        from app_to_user where user_id=#{userId}'), (22, '    </select>'), (23, ''), (24, '    <!-- 获取app的用户 -->'), (25, '    <select id=""getByAppId"" resultType=""AppToUser"" parameterType=""long"">'), (26, '    \tselect'), (27, '        \t<include refid=""app_to_user_column""/>'), (28, '        from app_to_user where app_id=#{appId}'), (29, '    </select>'), (30, ''), (31, ''), (32, '    <delete id=""deleteByAppId"" parameterType=""long"">'), (33, '    \tdelete from app_to_user where app_id=#{appId}'), (34, '    </delete>'), (35, ''), (36, '    <select id=""deleteAppToUser"" parameterType=""AppToUser"">'), (37, '        delete from app_to_user where app_id=#{appId} and user_id=#{userId}'), (38, '    </select>'), (39, ''), (40, '</mapper>'), (41, ''), (42, '')], 'deleted': []}"
162,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/AppUserDao.xml,AppUserDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppUserDao"">'), (6, '\t<!--'), (7, '\t字典sql'), (8, ""        set @tn='app_user';""), (9, '        select'), (10, '            group_concat(column_name)'), (11, '        from'), (12, '            information_schema.columns'), (13, '        where'), (14, ""            table_schema = 'cache-cloud' and table_name = @tn;""), (15, '\t-->'), (16, '\t<sql id=""user_column"">'), (17, '\t\tid,name,ch_name,email,mobile,weChat,type,isAlert'), (18, '    </sql>'), (19, ''), (20, '    <select id=""get"" resultType=""AppUser"" parameterType=""long"">'), (21, '        select'), (22, '        \t<include refid=""user_column""/>'), (23, '        from app_user'), (24, '        where id = #{id};'), (25, '    </select>'), (26, ''), (27, '    <select id=""getByName"" resultType=""AppUser"" parameterType=""string"">'), (28, '        select'), (29, '        \t<include refid=""user_column""/>'), (30, '        from app_user'), (31, '        where name = #{name};'), (32, '    </select>'), (33, ''), (34, '    <select id=""getByEmail"" resultType=""AppUser"" parameterType=""string"">'), (35, '        select'), (36, '        <include refid=""user_column""/>'), (37, '        from app_user'), (38, '        where email = #{email};'), (39, '    </select>'), (40, ''), (41, '    <insert id=""save"" parameterType=""AppUser"" keyProperty=""id"" useGeneratedKeys=""true"">'), (42, '    \tinsert into app_user'), (43, '    \t\t(<include refid=""user_column""/>)'), (44, '\t\tvalues'), (45, '\t\t\t(#{id},#{name},#{chName},#{email},#{mobile},#{weChat},#{type},#{isAlert})'), (46, '    </insert>'), (47, ''), (48, '    <delete id=""delete"" parameterType=""long"">'), (49, '    \tdelete from app_user where id=#{id}'), (50, '    </delete>'), (51, ''), (52, '    <update id=""update"" parameterType=""AppUser"">'), (53, '    \tupdate app_user'), (54, '    \t\tset name=#{name}, ch_name=#{chName}, email=#{email}, mobile=#{mobile}, weChat=#{weChat}, type=#{type}, isAlert=#{isAlert}'), (55, '    \twhere id=#{id}'), (56, '    </update>'), (57, ''), (58, '    <select id=""getUserList"" resultType=""AppUser"" parameterType=""string"">'), (59, '    \tselect'), (60, '        \t<include refid=""user_column""/>'), (61, '        from app_user where 1=1'), (62, '        <choose>'), (63, '        \t<when test=""chName != \'\' and chName != null"">'), (64, '        \t \tand ch_name=#{chName}'), (65, '        \t</when>'), (66, '        </choose>'), (67, '    </select>'), (68, ''), (69, '    <select id=""getAllUser"" resultType=""AppUser"">'), (70, '        select'), (71, '        <include refid=""user_column""/>'), (72, '        from app_user where type >= 0'), (73, '    </select>'), (74, ''), (75, '    <select id=""getAdminList"" resultType=""AppUser"">'), (76, '        select'), (77, '        <include refid=""user_column""/>'), (78, '        from app_user where type = 0'), (79, '    </select>'), (80, ''), (81, '</mapper>'), (82, ''), (83, '')], 'deleted': []}"
163,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/ConfigDao.xml,ConfigDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.ConfigDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tconfig_key,config_value ,info,status,order_id'), (7, '\t</sql>'), (8, ''), (9, '\t<select id=""getConfigList"" resultType=""com.sohu.cache.entity.SystemConfig"">'), (10, '\t\tselect'), (11, '\t\t<include refid=""columns"" />'), (12, '\t\tfrom system_config where status=#{status} order by order_id'), (13, '\t</select>'), (14, ''), (15, '\t<update id=""update"">'), (16, '\t\tupdate system_config set config_value = #{configValue} where config_key=#{configKey}'), (17, '\t</update>'), (18, ''), (19, '</mapper>')], 'deleted': []}"
164,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/DbPoolStatDao.xml,DbPoolStatDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.DbPoolStatDao"">'), (6, '    <sql id=""db_pool_columns"">'), (7, '        db_pool_name, ip, port, collect_time, collect_date, max_size,'), (8, '        min_size, busy_size, idle_size, total_size, create_time, update_time'), (9, '    </sql>'), (10, ''), (11, '    <sql id=""db_pool_fields"">'), (12, '        #{dbPoolName}, #{ip}, #{port}, #{collectTime}, #{collectDate}, #{maxSize},'), (13, '        #{minSize}, #{busySize}, #{idleSize}, #{totalSize}, #{createTime}, #{updateTime}'), (14, '    </sql>'), (15, ''), (16, '    <insert id=""save"" parameterType=""DbPoolStat"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (17, '        insert into db_pool_stat (<include refid=""db_pool_columns""/>)'), (18, '        value(<include refid=""db_pool_fields""/>);'), (19, '    </insert>'), (20, ''), (21, '</mapper>'), (22, ''), (23, '')], 'deleted': []}"
165,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/DiagnosticTaskRecordDao.xml,DiagnosticTaskRecordDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.DiagnosticTaskRecordDao"">'), (5, '    <sql id=""columns"">'), (6, '    \tapp_id,type,task_id,parent_task_id,audit_id,status,cost,redis_key,node,diagnostic_condition,param1,param2'), (7, '    </sql>'), (8, ''), (9, '    <insert id=""insertDiagnosticTaskRecord"" parameterType=""com.sohu.cache.entity.DiagnosticTaskRecord"" keyProperty=""id""'), (10, '            useGeneratedKeys=""true"">'), (11, '        insert into diagnostic_task_record (<include refid=""columns""/>)'), (12, '        values(#{appId},#{type},#{taskId},#{parentTaskId},#{auditId},#{status},#{cost},#{redisKey},#{node},#{diagnosticCondition},#{param1},#{param2})'), (13, '    </insert>'), (14, ''), (15, '    <update id=""updateDiagnosticStatus"">'), (16, '        update diagnostic_task_record'), (17, '        set redis_key = #{redisKey},status = #{status}, cost = #{cost}'), (18, '        where id=#{id}'), (19, '    </update>'), (20, ''), (21, '    <select id=""getDiagnosticTaskRecords"" resultType=""DiagnosticTaskRecord"">'), (22, ""        select *,concat(concat(cost div 60000, 'm:'), concat(cost mod 60000 div 1000 , 's:'), concat(cost mod 1000, 'ms')) as format_cost_time""), (23, '        from diagnostic_task_record'), (24, '        where 1=1'), (25, '        <choose>'), (26, '            <when test=""appId != null and appId > 0"">'), (27, '                and app_id = #{appId}'), (28, '            </when>'), (29, '        </choose>'), (30, '        <choose>'), (31, '            <when test=""parentTaskId != null and parentTaskId > 0"">'), (32, '                and parent_task_id = #{parentTaskId}'), (33, '            </when>'), (34, '        </choose>'), (35, '        <choose>'), (36, '            <when test=""auditId != null and auditId > 0"">'), (37, '                and audit_id = #{auditId}'), (38, '            </when>'), (39, '        </choose>'), (40, '        <choose>'), (41, '            <when test=""type != null and type > -1"">'), (42, '                and type = #{type}'), (43, '            </when>'), (44, '        </choose>'), (45, '        <choose>'), (46, '            <when test=""status != null and status > -1"">'), (47, '                and status = #{status}'), (48, '            </when>'), (49, '        </choose>'), (50, '        order by create_time desc'), (51, '    </select>'), (52, '</mapper>')], 'deleted': []}"
166,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/ErrorLogStatDao.xml,ErrorLogStatDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.ErrorLogStatDao"">'), (6, '    <sql id=""error_log_columns"">'), (7, '        class_name, collect_time, ip, port, diff_error_count, total_error_count, create_time, update_time'), (8, '    </sql>'), (9, ''), (10, '    <sql id=""error_log_fields"">'), (11, '        #{className}, #{collectTime}, #{ip}, #{port}, #{diffErrorCount}, #{totalErrorCount}, #{createTime}, #{updateTime}'), (12, '    </sql>'), (13, ''), (14, '    <insert id=""save"" parameterType=""ErrorLogStat"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (15, '        insert into error_log_stat (<include refid=""error_log_columns""/>)'), (16, '        value(<include refid=""error_log_fields""/>);'), (17, '    </insert>'), (18, ''), (19, '    <select id=""getLastErrorCount"" resultType=""Long"">'), (20, '    \tselect total_error_count from error_log_stat'), (21, '    \twhere ip=#{ip} and port=#{port} and class_name=#{className} order by id desc limit 1'), (22, '    </select>'), (23, ''), (24, '</mapper>'), (25, ''), (26, '')], 'deleted': []}"
167,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/InstanceAlertConfigDao.xml,InstanceAlertConfigDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceAlertConfigDao"">'), (5, ''), (6, '    <sql id=""instance_alert_config_column"">'), (7, '    \talert_config,alert_value,config_info,type,instance_id,status,compare_type,'), (8, '    \tcheck_cycle,update_time,last_check_time'), (9, '    </sql>'), (10, ''), (11, '    <insert id=""save"" parameterType=""InstanceAlertConfig""  keyProperty=""id"" useGeneratedKeys=""true"">'), (12, '\t\tinsert into instance_alert_configs(<include refid=""instance_alert_config_column"" />)'), (13, '\t\tvalues(#{alertConfig},#{alertValue},#{configInfo},#{type},#{instanceId},#{status},#{compareType},'), (14, '\t\t#{checkCycle},#{updateTime},#{lastCheckTime})'), (15, '\t\ton duplicate key update'), (16, '\t\talert_value = #{alertValue},check_cycle = #{checkCycle}, update_time = now(),status = #{status},last_check_time=now()'), (17, '\t</insert>'), (18, ''), (19, '    <insert id=""batchSave"">'), (20, '        insert into instance_alert_configs(<include refid=""instance_alert_config_column"" />)'), (21, '        values'), (22, '        <foreach collection=""list"" item=""instance"" separator="","" >'), (23, '            (#{instance.alertConfig},#{instance.alertValue},#{instance.configInfo},#{instance.type},#{instance.instanceId},#{instance.status},#{instance.compareType},'), (24, '            #{instance.checkCycle},#{instance.updateTime},#{instance.lastCheckTime})'), (25, '        </foreach>'), (26, '        on duplicate key update'), (27, '        alert_value = VALUES(alert_value),'), (28, '        compare_type = VALUES(compare_type),'), (29, '        check_cycle = VALUES(check_cycle),'), (30, '        update_time = now(),'), (31, '        status = VALUES(status),'), (32, '        last_check_time=now()'), (33, '    </insert>'), (34, ''), (35, '    <select id=""getAll"" resultType=""InstanceAlertConfig"">'), (36, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs'), (37, '    </select>'), (38, ''), (39, '    <select id=""get"" resultType=""InstanceAlertConfig"">'), (40, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs where id = #{id}'), (41, '    </select>'), (42, ''), (43, '\t<delete id=""remove"">'), (44, '\t\tdelete from instance_alert_configs where id = #{id}'), (45, '\t</delete>'), (46, ''), (47, '\t<select id=""getByType"" resultType=""InstanceAlertConfig"">'), (48, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs where type = #{type} order by id'), (49, '    </select>'), (50, ''), (51, '    <select id=""getByAlertConfig"" resultType=""InstanceAlertConfig"">'), (52, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs where alert_config = #{alertConfig}'), (53, '    </select>'), (54, ''), (55, '    <update id=""update"">'), (56, '    \t\tupdate instance_alert_configs set alert_value = #{alertValue}, check_cycle = #{checkCycle} where id = #{id}'), (57, '    </update>'), (58, ''), (59, '    <update id=""updateLastCheckTime"">'), (60, '    \t\tupdate instance_alert_configs set last_check_time = #{lastCheckTime} where id = #{id}'), (61, '    </update>'), (62, ''), (63, '</mapper>')], 'deleted': []}"
168,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/InstanceBigKeyDao.xml,InstanceBigKeyDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceBigKeyDao"">'), (5, ''), (6, '    <sql id=""instance_big_key_columns"">'), (7, '        instance_id,app_id,audit_id,role,ip,port,big_key,type,length,create_time'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""batchSave"">'), (11, '        insert into instance_big_key(<include refid=""instance_big_key_columns""/>)'), (12, '        values'), (13, '        <foreach collection=""instanceBigKeyList"" item=""instanceBigKey"" separator="","">'), (14, '        \t(#{instanceBigKey.instanceId},#{instanceBigKey.appId},#{instanceBigKey.auditId},'), (15, '        \t#{instanceBigKey.role},#{instanceBigKey.ip},#{instanceBigKey.port},#{instanceBigKey.bigKey},'), (16, '        \t#{instanceBigKey.type},#{instanceBigKey.length},#{instanceBigKey.createTime})'), (17, '\t    </foreach>'), (18, '    </insert>'), (19, ''), (20, '    <select id=""getAppBigKeyCount"" resultType=""int"">'), (21, '        select count(*) as count'), (22, '        from instance_big_key where app_id = #{appId} and audit_id = #{auditId}'), (23, '    </select>'), (24, ''), (25, '    <select id=""getAppBigKeyList"" resultType=""InstanceBigKey"">'), (26, '        select id,<include refid=""instance_big_key_columns""/>'), (27, '        from instance_big_key where app_id = #{appId} and audit_id = #{auditId}'), (28, '        <choose>'), (29, '        \t<when test=""page != null"">'), (30, '        \t\t<choose>'), (31, '\t\t        \t<when test=""page.totalCount > page.pageSize"">'), (32, '            \t\t\tlimit #{page.start},#{page.pageSize};'), (33, '\t\t        \t</when>'), (34, '\t\t        \t<otherwise>'), (35, '\t\t        \t    limit #{page.totalCount}'), (36, '\t\t        \t</otherwise>'), (37, '\t\t        </choose>'), (38, '        \t</when>'), (39, '        </choose>'), (40, '    </select>'), (41, ''), (42, '</mapper>')], 'deleted': []}"
169,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/InstanceConfigDao.xml,InstanceConfigDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceConfigDao"">'), (5, '    <sql id=""columns"">'), (6, '    \tconfig_key, config_value, info, update_time, type, status,version_id'), (7, '    </sql>'), (8, ''), (9, '    <select id=""getByType"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (10, '        select id,<include refid=""columns""/> from instance_config where type = #{type}'), (11, '    </select>'), (12, ''), (13, '    <select id=""getByVersionAndType"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (14, '        select id,<include refid=""columns""/> from instance_config where type = #{type} and version_id = #{versionId}'), (15, '    </select>'), (16, ''), (17, '    <select id=""getByVersion"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (18, '        select id,<include refid=""columns""/> from instance_config where version_id = #{versionId} and status = 1'), (19, '    </select>'), (20, ''), (21, '    <select id=""getById"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (22, '        select id,<include refid=""columns""/> from instance_config where id = #{id}'), (23, '    </select>'), (24, ''), (25, '    <select id=""getByConfigKeyAndType"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (26, '        select id,<include refid=""columns""/> from instance_config where config_key = #{configKey} and type = #{type}'), (27, '    </select>'), (28, ''), (29, '    <select id=""getAllInstanceConfig"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (30, '        select id,<include refid=""columns""/> from instance_config'), (31, '    </select>'), (32, ''), (33, '    <select id=""getConfigByRedisVersionId"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (34, '        select id,<include refid=""columns""/> from instance_config where version_id = #{versionId}'), (35, '    </select>'), (36, ''), (37, '    <insert id=""saveOrUpdate"">'), (38, '\t\tinsert into instance_config(<include refid=""columns"" />)'), (39, '\t\tvalues(#{configKey},#{configValue},#{info},now(),#{type},#{status},#{versionId})'), (40, '\t    on duplicate key update'), (41, '\t    config_value = #{configValue}, info = #{info},'), (42, '\t    update_time = now(),status = #{status} ,version_id=#{versionId}'), (43, '\t</insert>'), (44, ''), (45, '\t<update id=""updateStatus"">'), (46, '\t\tupdate instance_config set status = #{status} where id = #{id}'), (47, '\t</update>'), (48, ''), (49, '\t<delete id=""remove"">'), (50, '\t\tdelete from instance_config where id = #{id}'), (51, '\t</delete>'), (52, ''), (53, '</mapper>')], 'deleted': []}"
170,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/InstanceDao.xml,InstanceDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.InstanceDao"">'), (6, '    <sql id=""instance_info_columns"">'), (7, '        id, app_id, host_id, ip, port, status, mem, conn, cmd, type'), (8, '    </sql>'), (9, ''), (10, '    <!--通过type查询实例列表-->'), (11, '    <select id=""getInstListByType"" resultType=""InstanceInfo"" parameterType=""int"">'), (12, '        SELECT'), (13, '        <include refid=""instance_info_columns""/>'), (14, '        FROM instance_info'), (15, '        WHERE type = #{type} and status=1'), (16, '        ORDER BY id;'), (17, '    </select>'), (18, ''), (19, '    <!--通过appId查询实例列表-->'), (20, '    <select id=""getInstListByAppId"" resultType=""InstanceInfo"" parameterType=""long"">'), (21, '        SELECT'), (22, '        <include refid=""instance_info_columns""/>'), (23, '        FROM instance_info'), (24, '        WHERE app_id = #{appId}'), (25, '        ORDER BY id;'), (26, '    </select>'), (27, ''), (28, '    <!--通过appId查询有效的实例列表-->'), (29, '    <select id=""getEffectiveInstListByAppId"" resultType=""InstanceInfo"" parameterType=""long"">'), (30, '        SELECT'), (31, '        <include refid=""instance_info_columns""/>'), (32, '        FROM instance_info'), (33, '        WHERE app_id = #{appId} and status in (0,1)'), (34, '        ORDER BY id;'), (35, '    </select>'), (36, ''), (37, '    <select id=""getMemoryByHost"" resultType=""int"">'), (38, '        select ifnull(sum(mem),0)'), (39, '        from instance_info'), (40, '        where ip = #{host} and status in (0,1)'), (41, '    </select>'), (42, ''), (43, '    <select id=""getInstanceCountByHost"" resultType=""int"">'), (44, '        select count(*)'), (45, '        from instance_info'), (46, '        where ip = #{host} and status in (0,1)'), (47, '    </select>'), (48, ''), (49, '    <!--通过host和port查询一个实例信息-->'), (50, '    <select id=""getInstByIpAndPort"" resultType=""InstanceInfo"">'), (51, '        SELECT'), (52, '        <include refid=""instance_info_columns""/>'), (53, '        FROM instance_info'), (54, '        WHERE ip = #{ip} AND port = #{port} AND status = 1'), (55, '    </select>'), (56, ''), (57, '    <select id=""getAllInstByIpAndPort"" resultType=""InstanceInfo"">'), (58, '        SELECT'), (59, '        <include refid=""instance_info_columns""/>'), (60, '        FROM instance_info'), (61, '        WHERE ip = #{ip} AND port = #{port}'), (62, '    </select>'), (63, ''), (64, '    <!--通过host和port查询一个实例信息-->'), (65, '    <select id=""getAllInsts"" resultType=""InstanceInfo"">'), (66, '        SELECT'), (67, '        <include refid=""instance_info_columns""/>'), (68, '        FROM instance_info'), (69, '        WHERE status in (0,1)'), (70, '    </select>'), (71, ''), (72, '    <select id=""checkHeartStopInstance"" resultType=""InstanceInfo"">'), (73, '        SELECT'), (74, '        <include refid=""instance_info_columns""/>'), (75, '        FROM instance_info'), (76, '        WHERE ip = #{ip} and status in (0,1)'), (77, '    </select>'), (78, ''), (79, '    <select id=""getAllHeartStopInstance"" resultType=""InstanceInfo"">'), (80, '        SELECT'), (81, '        <include refid=""instance_info_columns""/>'), (82, '        FROM instance_info'), (83, '        WHERE status in (0,-1)'), (84, '    </select>'), (85, ''), (86, '    <!--通过host和port查询一个实例数-->'), (87, '    <select id=""getCountByIpAndPort"" resultType=""int"">'), (88, '        SELECT count(*)'), (89, '        FROM instance_info'), (90, '        WHERE ip = #{ip} AND port = #{port}'), (91, '    </select>'), (92, ''), (93, '    <!--通过id查询一个实例信息-->'), (94, '    <select id=""getInstanceInfoById"" resultType=""InstanceInfo"">'), (95, '        SELECT'), (96, '        <include refid=""instance_info_columns""/>'), (97, '        FROM instance_info'), (98, '        WHERE id = #{id}'), (99, '    </select>'), (100, ''), (101, '    <!--保存实例-->'), (102, '    <insert id=""saveInstance"" parameterType=""InstanceInfo"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (103, '        INSERT INTO instance_info (app_id, host_id, ip, port, status, mem, conn, cmd, type)'), (104, '        VALUE(#{appId}, #{hostId}, #{ip}, #{port}, #{status}, #{mem}, #{conn}, #{cmd}, #{type});'), (105, '    </insert>'), (106, ''), (107, '    <update id=""update"" parameterType=""InstanceInfo"">'), (108, '        update instance_info'), (109, '        set'), (110, '        <if test=""appId != null"">app_id=#{appId},</if>'), (111, '        <if test=""hostId != null"">host_id=#{hostId},</if>'), (112, '        <if test=""ip != null"">ip=#{ip},</if>'), (113, '        <if test=""port != null"">port=#{port},</if>'), (114, '        <if test=""mem != null"">mem=#{mem},</if>'), (115, '        <if test=""conn != null"">conn=#{conn},</if>'), (116, '        <if test=""cmd != null"">cmd=#{cmd},</if>'), (117, '        status=#{status}'), (118, '        where'), (119, '        id=#{id}'), (120, '    </update>'), (121, ''), (122, '    <select id=""getAppInstanceInfo"" parameterType=""long"" resultType=""InstanceInfo"">'), (123, '        select'), (124, '        <include refid=""instance_info_columns""/>'), (125, '        from instance_info where app_id=#{appId} and status=1'), (126, '    </select>'), (127, ''), (128, '    <select id=""getInstanceTypeCount"" resultType=""int"">'), (129, '        select count(*)'), (130, '        from instance_info'), (131, '        where ip = #{ip} and type = #{type}'), (132, '    </select>'), (133, ''), (134, '    <select id=""getInstancesByType"" resultType=""InstanceInfo"">'), (135, '        select  <include refid=""instance_info_columns""/>'), (136, '        from instance_info'), (137, '        where app_id = #{app_id} and type = #{type} and status=1'), (138, '    </select>'), (139, ''), (140, '    <!--通过机器ip查询实例列表-->'), (141, '    <select id=""getInstListByIp"" resultType=""InstanceInfo"" parameterType=""string"">'), (142, '        SELECT'), (143, '        <include refid=""instance_info_columns""/>'), (144, '        FROM instance_info'), (145, '        WHERE ip = #{ip} and status in (0,1)'), (146, '        ORDER BY id;'), (147, '    </select>'), (148, ''), (149, '    <select id=""getMachineInstanceCountMap"" resultType=""hashmap"">'), (150, '    \tselect ip, count(*) as count from instance_info where status=1 group by ip;'), (151, '    </select>'), (152, ''), (153, '    <select id=""getTotalEffectiveInst"" resultType=""hashmap"">'), (154, '        SELECT info.id from app_desc app,instance_info info where app.app_id=info.app_id and app.`status`=2 and info.`status`=1;'), (155, '    </select>'), (156, ''), (157, '    <select id=""getAppIdListByIp"" resultType=""long"" parameterType=""java.util.List"">'), (158, '        select app_id FROM instance_info WHERE status=1 AND ip IN'), (159, '        <foreach collection=""list"" index=""index"" item=""ip"" open=""("" separator="","" close="")"">'), (160, '            #{ip}'), (161, '        </foreach>'), (162, '        GROUP BY app_id'), (163, '    </select>'), (164, ''), (165, '    <update id=""updateStatus"">'), (166, '        update instance_info set status=#{status},update_time = now() where app_id=#{appId} and ip=#{ip} and port=#{port}'), (167, '    </update>'), (168, ''), (169, '</mapper>'), (170, ''), (171, '')], 'deleted': []}"
171,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/InstanceFaultDao.xml,InstanceFaultDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.InstanceFaultDao"">'), (6, '    <sql id=""instance_fault_column"">'), (7, '\t\tapp_id,inst_id,ip,port,status,create_time,type,reason'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""insert"" parameterType=""InstanceFault"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (11, '        insert into instance_fault(app_id,inst_id,ip,port,status,create_time,type,reason)'), (12, '        VALUE (#{appId},#{instId},#{ip},#{port},#{status},#{createTime},#{type},#{reason})'), (13, '    </insert>'), (14, ''), (15, '    <select id=""getListByInstId"" resultType=""InstanceFault"">'), (16, '        select'), (17, '          id, <include refid=""instance_fault_column""/>'), (18, '        from instance_fault'), (19, '        where inst_id = #{instId}'), (20, '        order by create_time desc'), (21, '    </select>'), (22, ''), (23, '    <select id=""getListByAppId"" resultType=""InstanceFault"">'), (24, '        select'), (25, '        id, <include refid=""instance_fault_column""/>'), (26, '        from instance_fault'), (27, '        where app_id = #{appId}'), (28, '        order by create_time desc'), (29, '    </select>'), (30, ''), (31, ''), (32, '</mapper>'), (33, ''), (34, '')], 'deleted': []}"
172,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/InstanceLatencyHistoryDao.xml,InstanceLatencyHistoryDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceLatencyHistoryDao"">'), (5, ''), (6, '    <sql id=""instance_latency_history_columns"">'), (7, '        instance_id,app_id,ip,port,event,execute_date,execution_cost'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""batchSave"">'), (11, '        insert ignore into instance_latency_history(<include refid=""instance_latency_history_columns""/>)'), (12, '        values'), (13, '        <foreach collection=""list"" item=""instanceLatencyHistory"" separator="","">'), (14, '            (#{instanceLatencyHistory.instanceId},'), (15, '            #{instanceLatencyHistory.appId},'), (16, '            #{instanceLatencyHistory.ip},'), (17, '            #{instanceLatencyHistory.port},'), (18, '            #{instanceLatencyHistory.event},'), (19, '            #{instanceLatencyHistory.executeDate},'), (20, '            #{instanceLatencyHistory.executionCost})'), (21, '        </foreach>'), (22, '    </insert>'), (23, ''), (24, '    <select id=""getAppLatencyStats"" resultType=""hashmap"">'), (25, '        select app_id,count(1)count,'), (26, ""        FROM_UNIXTIME(UNIX_TIMESTAMP(execute_date), '%Y%m%d%H%i') execute_date_min,""), (27, ""        UNIX_TIMESTAMP(FROM_UNIXTIME(UNIX_TIMESTAMP(execute_date), '%Y-%m-%d %H:%i')) timestamp,""), (28, '        event'), (29, '        from instance_latency_history'), (30, '        where app_id=#{appId} and execute_date between #{startTime} and #{endTime}'), (31, '        group by event,execute_date_min'), (32, '        order by execute_date_min asc'), (33, '    </select>'), (34, ''), (35, '    <select id=""getAppLatencyStatsGroupByInstance"" resultType=""hashmap"">'), (36, '        select concat(ip,"":"",port) as host_port,instance_id,count(*) as count'), (37, '        from instance_latency_history'), (38, '        where app_id=#{appId}'), (39, '        and execute_date between #{startTime} and #{endTime}'), (40, '        group by host_port'), (41, '    </select>'), (42, ''), (43, '    <select id=""getAppLatencyInfo"" resultType=""hashmap"">'), (44, '        select concat(ip,"":"",port) as host_port,UNIX_TIMESTAMP(execute_date) timestamp,'), (45, '        <include refid=""instance_latency_history_columns""/>'), (46, '        from instance_latency_history'), (47, '        where app_id=#{appId}'), (48, '        <choose>'), (49, '            <when test=""event != null and event != \'\'"">'), (50, '                and event=#{event}'), (51, '            </when>'), (52, '        </choose>'), (53, '        and execute_date between #{startTime} and #{endTime}'), (54, '    </select>'), (55, ''), (56, ''), (57, '    <select id=""getAppLatencyCountStat"" resultType=""AppClientStatisticGather"">'), (58, ""        select app_id, count(1) as latency_count, DATE_FORMAT(execute_date,'%Y-%m-%d') gather_time""), (59, '        from instance_latency_history'), (60, '        where execute_date between #{startTime} and #{endTime}'), (61, '        group by app_id'), (62, '    </select>'), (63, '</mapper>')], 'deleted': []}"
173,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/InstanceReshardProcessDao.xml,InstanceReshardProcessDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceReshardProcessDao"">'), (5, ''), (6, '    <sql id=""instance_reshard_process_column"">'), (7, '\t    \tapp_id,audit_id,source_instance_id,target_instance_id,start_slot,end_slot,'), (8, '\t    \tmigrating_slot,is_pipeline,finish_slot_num,status,start_time,end_time,create_time,update_time'), (9, '    </sql>'), (10, ''), (11, '    <insert id=""save"" parameterType=""InstanceReshardProcess""  keyProperty=""id"" useGeneratedKeys=""true"">'), (12, '\t\tinsert into instance_reshard_process(<include refid=""instance_reshard_process_column"" />)'), (13, '\t\tvalues(#{appId},#{auditId},#{sourceInstanceId},#{targetInstanceId},#{startSlot},#{endSlot},'), (14, '\t\t#{migratingSlot},#{isPipeline},#{finishSlotNum},#{status},#{startTime},#{endTime},#{createTime},#{updateTime})'), (15, '\t</insert>'), (16, ''), (17, '    <select id=""getByAuditId"" resultType=""InstanceReshardProcess"">'), (18, '        select id,<include refid=""instance_reshard_process_column""/> from instance_reshard_process where audit_id = #{auditId}'), (19, '    </select>'), (20, ''), (21, '    <select id=""get"" resultType=""InstanceReshardProcess"">'), (22, '        select id,<include refid=""instance_reshard_process_column""/> from instance_reshard_process where id = #{id}'), (23, '    </select>'), (24, ''), (25, '    <update id=""updateStatus"">'), (26, '    \t\tupdate instance_reshard_process set status = #{status} where id = #{id}'), (27, '    </update>'), (28, ''), (29, '    <update id=""updateEndTime"">'), (30, '    \t\tupdate instance_reshard_process set end_time = #{endTime} where id = #{id}'), (31, '    </update>'), (32, ''), (33, '    <update id=""increaseFinishSlotNum"">'), (34, '    \t\tupdate instance_reshard_process set finish_slot_num = finish_slot_num + 1 where id = #{id}'), (35, '    </update>'), (36, ''), (37, '    <update id=""updateMigratingSlot"">'), (38, '    \t\tupdate instance_reshard_process set migrating_slot = #{migratingSlot} where id = #{id}'), (39, '    </update>'), (40, ''), (41, '</mapper>')], 'deleted': []}"
174,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/InstanceSlowLogDao.xml,InstanceSlowLogDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceSlowLogDao"">'), (5, ''), (6, '    <sql id=""instance_slow_log_columns"">'), (7, '        instance_id,app_id,ip,port,slow_log_id,cost_time,command,execute_time,create_time'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""batchSave"">'), (11, '        insert ignore into instance_slow_log(<include refid=""instance_slow_log_columns""/>)'), (12, '        values'), (13, '        <foreach collection=""list"" item=""instanceSlowLog"" separator="","">'), (14, '            (#{instanceSlowLog.instanceId},#{instanceSlowLog.appId},#{instanceSlowLog.ip},#{instanceSlowLog.port},#{instanceSlowLog.slowLogId},#{instanceSlowLog.costTime},#{instanceSlowLog.command},#{instanceSlowLog.executeTime},#{instanceSlowLog.createTime})'), (15, '        </foreach>'), (16, '    </insert>'), (17, ''), (18, '    <select id=""getByAppId"" resultType=""InstanceSlowLog"">'), (19, '        select id,'), (20, '        <include refid=""instance_slow_log_columns""/>'), (21, '        from instance_slow_log where app_id = #{appId}'), (22, '    </select>'), (23, ''), (24, '    <select id=""getByInstanceExecuteTime"" resultType=""InstanceSlowLog"">'), (25, '        select id,'), (26, '        <include refid=""instance_slow_log_columns""/>'), (27, '        from instance_slow_log'), (28, '        where instance_id = #{instanceId} and execute_time=#{executeDate}'), (29, '        limit 10'), (30, '    </select>'), (31, ''), (32, ''), (33, '    <select id=""search"" resultType=""InstanceSlowLog"">'), (34, '        select id,'), (35, '        <include refid=""instance_slow_log_columns""/>'), (36, ""        from instance_slow_log where app_id = #{appId} and create_time between DATE_FORMAT(#{startDate}, '%Y-%m-%d') and""), (37, ""        DATE_FORMAT(#{endDate}, '%Y-%m-%d') order by execute_time desc""), (38, '    </select>'), (39, ''), (40, '    <select id=""getInstanceSlowLogCountMapByAppId"" resultType=""hashmap"">'), (41, '        select concat(ip,"":"",port) as hostPort,count(*) as count'), (42, ""        from instance_slow_log where app_id = #{appId} and create_time between DATE_FORMAT(#{startDate}, '%Y-%m-%d') and DATE_FORMAT(#{endDate}, '%Y-%m-%d') group by hostPort order by count desc""), (43, '    </select>'), (44, ''), (45, '    <select id=""getAppSlowLogCount"" resultType=""int"">'), (46, '        select count(*) as count'), (47, ""        from instance_slow_log where app_id = #{appId} and execute_time between DATE_FORMAT(#{startDate}, '%Y-%m-%d') and DATE_FORMAT(#{endDate}, '%Y-%m-%d')""), (48, '    </select>'), (49, ''), (50, '    <select id=""getAppSlowLogCountStat"" resultType=""AppClientStatisticGather"">'), (51, ""        select app_id, count(*) as slowLogCount, DATE_FORMAT(execute_time,'%Y-%m-%d') gather_time""), (52, '        from instance_slow_log'), (53, '        where execute_time between #{startTime} and #{endTime}'), (54, '        group by app_id'), (55, '    </select>'), (56, ''), (57, ''), (58, '</mapper>')], 'deleted': []}"
175,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/InstanceStatsDao.xml,InstanceStatsDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceStatsDao"">'), (5, ''), (6, '    <sql id=""instance_statistics_columns"">'), (7, '        inst_id,app_id,host_id,ip,port,role,max_memory,used_memory,curr_items,curr_connections,misses,hits,modify_time,mem_fragmentation_ratio,aof_delayed_fsync'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""updateInstanceStats"" parameterType=""InstanceStats"">'), (11, '        INSERT INTO instance_statistics'), (12, '          (<include refid=""instance_statistics_columns""/>)'), (13, '        VALUES (#{instId},#{appId},#{hostId},#{ip},#{port},#{role},#{maxMemory},#{usedMemory},#{currItems},#{currConnections},#{misses},#{hits},'), (14, '                  #{modifyTime},#{memFragmentationRatio},#{aofDelayedFsync})'), (15, '        ON DUPLICATE KEY UPDATE'), (16, '          inst_id = #{instId},'), (17, '          host_id = #{hostId},'), (18, '          role = #{role},'), (19, '          max_memory = #{maxMemory},'), (20, '          used_memory = #{usedMemory},'), (21, '          curr_items = #{currItems},'), (22, '          curr_connections = #{currConnections},'), (23, '          misses = #{misses},'), (24, '          hits = #{hits},'), (25, '          modify_time = #{modifyTime},'), (26, '          mem_fragmentation_ratio = #{memFragmentationRatio},'), (27, '          aof_delayed_fsync = #{aofDelayedFsync}'), (28, '    </insert>'), (29, ''), (30, '    <select id=""getInstanceStatsByHost"" resultType=""InstanceStats"">'), (31, '        select id,<include refid=""instance_statistics_columns""/>'), (32, '        from instance_statistics'), (33, '        where ip = #{ip} and port = #{port}'), (34, '    </select>'), (35, ''), (36, '    <select id=""getInstanceStatsByIp"" resultType=""InstanceStats"">'), (37, '        select id,<include refid=""instance_statistics_columns""/>'), (38, '        from instance_statistics'), (39, '        where ip = #{ip}'), (40, '    </select>'), (41, ''), (42, '    <select id=""getInstanceStatsByInsId"" resultType=""InstanceStats"">'), (43, '        select id,<include refid=""instance_statistics_columns""/>'), (44, '        from instance_statistics'), (45, '        where inst_id = #{id}'), (46, '    </select>'), (47, ''), (48, '    <select id=""getInstanceStatsByAppId"" resultType=""InstanceStats"">'), (49, '        select id,<include refid=""instance_statistics_columns""/>'), (50, '        from instance_statistics'), (51, '        where app_id = #{appId}'), (52, '    </select>'), (53, ''), (54, '    <select id=""getInstanceStats"" resultType=""InstanceStats"">'), (55, '        select id,<include refid=""instance_statistics_columns""/>'), (56, '        from instance_statistics'), (57, '    </select>'), (58, ''), (59, '    <select id=""getMachineMemByIp"" resultType=""java.util.Map"">'), (60, '        SELECT count(statistic.id) instanceNum, sum(statistic.max_memory) applyMem, sum(statistic.used_memory) usedMem,'), (61, '        sum(statistic.mem_fragmentation_ratio*statistic.used_memory) usedMemRss'), (62, '        FROM instance_statistics statistic, instance_info info'), (63, '        WHERE statistic.inst_id = info.id'), (64, '        AND info.status = 1'), (65, '        AND statistic.ip = #{ip}'), (66, '    </select>'), (67, ''), (68, '    <select id=""getTotalMem"" resultType=""hashmap"">'), (69, '        SELECT SUM(max_memory)/1024/1024/1024 totalMem,sum(used_memory)/1024/1024/1024 totalUsedMem from instance_statistics;'), (70, '    </select>'), (71, ''), (72, '    <select id=""getTotalAppMem"" resultType=""hashmap"">'), (73, '        SELECT SUM(max_memory)/1024/1024/1024 totalAppMem,sum(used_memory)/1024/1024/1024 totalAppUsedMem from instance_statistics where inst_id in'), (74, '        <foreach collection=""list"" item=""item"" index=""instancelist"" open=""("" separator="","" close="")"">'), (75, '            #{item}'), (76, '        </foreach>'), (77, '        and role=1;'), (78, '    </select>'), (79, ''), (80, '    <select id=""getMachineInstanceStatList"" resultType=""MachineInstanceStat"">'), (81, '        SELECT stat.ip,sum(stat.max_memory) as max_memory,sum(stat.used_memory) as used_memory'), (82, '        from instance_statistics stat,instance_info info'), (83, '        where stat.inst_id = info.id and info.status=1 group by stat.ip;'), (84, '    </select>'), (85, ''), (86, '</mapper>')], 'deleted': []}"
176,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/MachineDao.xml,MachineDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.MachineDao"">'), (5, '    <sql id=""machine_info_columns"">'), (6, '        ssh_user,ssh_passwd,ip,room,mem,cpu,`virtual`,real_ip,service_time,fault_count,warn,available,type,groupId,extra_desc,collect,version_install,use_type,k8s_type,rack,disk'), (7, '    </sql>'), (8, ''), (9, '    <sql id=""machine_men_stat_info_columns"">'), (10, '        ip,mem,cpu,use_type,room,real_ip,rack'), (11, '    </sql>'), (12, ''), (13, '    <sql id=""machine_info_fields"">'), (14, '        #{sshUser},#{sshPasswd},#{ip},#{room},#{mem},#{cpu},#{virtual},#{realIp},#{serviceTime},'), (15, '        #{faultCount},#{warn},#{available},#{type},#{groupId},#{extraDesc},#{collect},#{versionInstall},#{useType},#{k8sType},#{rack},#{disk}'), (16, '    </sql>'), (17, ''), (18, '    <!--返回所有可用的机器资源-->'), (19, '    <select id=""getAllMachines"" resultType=""MachineInfo"">'), (20, '        select'), (21, '        id, modify_time, <include refid=""machine_info_columns""/>'), (22, '        from machine_info'), (23, '        where available = 1'), (24, '    </select>'), (25, ''), (26, '    <!--通过ip查找机器-->'), (27, '    <select id=""getMachineInfoByIp"" resultType=""MachineInfo"">'), (28, '        select'), (29, '          id, modify_time, <include refid=""machine_info_columns""/>'), (30, '        from machine_info'), (31, '        where ip = #{ip};'), (32, '    </select>'), (33, ''), (34, '    <!--通过ip查找机器-->'), (35, '    <select id=""getMachineInfoByLikeIp"" resultType=""MachineInfo"">'), (36, '        select'), (37, '          id, modify_time, <include refid=""machine_info_columns""/>'), (38, '        from machine_info where available = 1'), (39, '        <choose>'), (40, '            <when test=""ipLike != \'\' and ipLike != null"">'), (41, ""                and ip like '%${ipLike}%'""), (42, '            </when>'), (43, '        </choose>'), (44, '    </select>'), (45, ''), (46, '    <!--通过ip查找机器-->'), (47, '    <select id=""getMachineInfoByCondition"" resultType=""MachineInfo"">'), (48, '        select'), (49, '        id, modify_time, <include refid=""machine_info_columns""/>'), (50, '        from machine_info where available = 1'), (51, '        <choose>'), (52, '            <when test=""ipLike != \'\' and ipLike != null"">'), (53, ""                and ip like '%${ipLike}%'""), (54, '            </when>'), (55, '        </choose>'), (56, '        <choose>'), (57, '            <when test=""useType != \'-1\'.toString() and useType != null"">'), (58, '                and use_type = #{useType}'), (59, '            </when>'), (60, '        </choose>'), (61, '        <choose>'), (62, '            <when test=""type != \'-1\'.toString() and type != null"">'), (63, '                and type = #{type}'), (64, '            </when>'), (65, '        </choose>'), (66, '        <choose>'), (67, '            <when test=""versionStr != \'\' and versionStr != null"">'), (68, ""                and version_install like '%${versionStr}%'""), (69, '            </when>'), (70, '        </choose>'), (71, '        <choose>'), (72, '            <when test=""k8sType != \'-1\'.toString() and k8sType != null"">'), (73, '                and k8s_type = #{k8sType}'), (74, '            </when>'), (75, '        </choose>'), (76, '        <choose>'), (77, '            <when test=""realip != \'\' and realip != null"">'), (78, '                and real_ip = #{realip}'), (79, '            </when>'), (80, '        </choose>'), (81, '    </select>'), (82, ''), (83, '    <!--通过ip real_ip查找机器-->'), (84, '    <select id=""existk8sMachine"" resultType=""MachineInfo"">'), (85, '        select'), (86, '        id, modify_time, <include refid=""machine_info_columns""/>'), (87, '        from machine_info where ip = #{ip} and k8s_type=1'), (88, '    </select>'), (89, ''), (90, '    <select id=""getK8sMachineList"" resultType=""MachineInfo"">'), (91, '        select'), (92, '        id, modify_time, <include refid=""machine_info_columns""/>'), (93, '        from machine_info where available = 1 and k8s_type=1'), (94, '    </select>'), (95, ''), (96, '    <!--通过room和useType查找机器-->'), (97, '    <select id=""getMachineMemStatInfoByCondition"" resultType=""MachineMemStatInfo"">'), (98, '        select'), (99, '        id, <include refid=""machine_men_stat_info_columns""/>'), (100, '        from machine_info where available = 1'), (101, '        <choose>'), (102, '            <when test=""room != null"">'), (103, ""                and room like '%${room}%'""), (104, '            </when>'), (105, '        </choose>'), (106, '        <choose>'), (107, '            <when test=""useType != \'\' and useType != null"">'), (108, '                and use_type = #{useType}'), (109, '            </when>'), (110, '        </choose>'), (111, '    </select>'), (112, ''), (113, '    <select id=""getMachineMemStatInfoByIp"" resultType=""MachineMemStatInfo"">'), (114, '        select'), (115, '        id, <include refid=""machine_men_stat_info_columns""/>'), (116, '        from machine_info where available = 1'), (117, '        where ip = #{ip};'), (118, '    </select>'), (119, ''), (120, '    <select id=""getMachineMemStatInfoByIpList"" resultType=""MachineMemStatInfo"" parameterType=""java.util.List"">'), (121, '        select'), (122, '        id, <include refid=""machine_men_stat_info_columns""/>'), (123, '        from machine_info where available = 1'), (124, '        and ip IN'), (125, '        <foreach collection=""list"" index=""index"" item=""item"" open=""("" separator="","" close="")"">'), (126, '        #{item}'), (127, '        </foreach>'), (128, '    </select>'), (129, ''), (130, '    <!--保存机器信息-->'), (131, '    <insert id=""saveMachineInfo"" parameterType=""MachineInfo"">'), (132, '        insert into machine_info'), (133, '          (<include refid=""machine_info_columns""/>)'), (134, '        values'), (135, '          (<include refid=""machine_info_fields""/>)'), (136, '        on duplicate key'), (137, '        update ssh_user=#{sshUser},ssh_passwd=#{sshPasswd},room=#{room},mem=#{mem},cpu=#{cpu},disk=#{disk},'), (138, '        `virtual`=#{virtual},real_ip=#{realIp},service_time=#{serviceTime},fault_count=#{faultCount},'), (139, '        warn=#{warn},available=#{available},type=#{type},groupId=#{groupId},extra_desc=#{extraDesc},collect=#{collect},version_install=#{versionInstall},'), (140, '        use_type=#{useType},k8s_type=#{k8sType},rack=#{rack}'), (141, '    </insert>'), (142, ''), (143, '    <!--根据ip删除一台机器的信息:置无效-->'), (144, '    <update id=""removeMachineInfoByIp"" parameterType=""string"">'), (145, '        update machine_info set available = 0 WHERE ip = #{ip}'), (146, '    </update>'), (147, ''), (148, '    <!--根据ip更新物理机ip-->'), (149, '    <update id=""updateMachineRealIpByIp"" parameterType=""string"">'), (150, '        update machine_info set real_ip = #{real_ip} WHERE ip = #{ip}'), (151, '    </update>'), (152, ''), (153, '    <!--通过type查找机器-->'), (154, '    <select id=""getMachineInfoByType"" resultType=""MachineInfo"">'), (155, '        select'), (156, '          id, modify_time, <include refid=""machine_info_columns""/>'), (157, '        from machine_info where type = #{type} and available = 1'), (158, '    </select>'), (159, ''), (160, '    <!-- 更新机器类型 -->'), (161, '    <update id=""updateMachineType"">'), (162, '    \tupdate machine_info set type = #{type} where id = #{id}'), (163, '    </update>'), (164, ''), (165, '    <select id=""getTotalMachineMem"" resultType=""hashmap"">'), (166, '        SELECT sum(memory_total)/1024/1024/1024 machineTotal,sum(memory_free)/1024/1024/1024 machineFreeTotal from  machine_statistics ;'), (167, '    </select>'), (168, ''), (169, '    <select id=""getRoomStat"" resultType=""hashmap"">'), (170, '        SELECT room as name,count(room) as num from machine_info where available=1 group by room;'), (171, '    </select>'), (172, ''), (173, '    <update id=""updateMachineAllocate"">'), (174, '    \tupdate machine_info set is_allocating = #{status} where ip = #{ip}'), (175, '    </update>'), (176, ''), (177, '</mapper>')], 'deleted': []}"
177,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/MachineRelationDao.xml,MachineRelationDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.MachineRelationDao"">'), (5, ''), (6, '    <sql id=""columns"">'), (7, '        ip,real_ip,update_time,status,extra_desc'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""saveOrUpdateMachineRelation"" parameterType=""MachineRelation"" keyProperty=""id"" useGeneratedKeys=""true"">'), (11, '        insert into machine_relation(<include refid=""columns""/>)'), (12, '        values(#{ip},#{realIp},#{updateTime},#{status},#{extraDesc})'), (13, '        on duplicate key'), (14, '        update ip=#{ip},real_ip=#{realIp},update_time=#{updateTime},status=#{status},extra_desc=#{extraDesc}'), (15, '    </insert>'), (16, ''), (17, '    <update id=""updateMachineRelation"">'), (18, '        update machine_relation set taskid = #{taskid}, is_sync= #{is_sync} where id = #{id}'), (19, '    </update>'), (20, ''), (21, '    <select id=""getRelationList"" resultType=""MachineRelation"">'), (22, '        select * from machine_relation'), (23, '        <choose>'), (24, '            <when test=""ip != \'\' and ip != null"">'), (25, '                where ip = #{ip}'), (26, '            </when>'), (27, '        </choose>'), (28, '        ORDER BY ip,update_time DESC'), (29, '    </select>'), (30, ''), (31, '    <select id=""getOnlinePodList"" resultType=""MachineRelation"">'), (32, '        select * from machine_relation where 1 = 1 and status = #{status}'), (33, '        <choose>'), (34, '            <when test=""ip != \'\' and ip != null"">'), (35, '                and ip = #{ip}'), (36, '            </when>'), (37, '        </choose>'), (38, '        ORDER BY ip,update_time DESC'), (39, '    </select>'), (40, ''), (41, '    <select id=""getUnSyncRelationList"" resultType=""MachineRelation"">'), (42, '        select * from machine_relation where ip = #{ip} and real_ip= #{real_ip} and is_sync in (0,-1)'), (43, '    </select>'), (44, ''), (45, '    <update id=""updateMachineSyncStatus"">'), (46, '        update machine_relation set is_sync=#{is_sync},sync_time=now() where id = #{id}'), (47, '    </update>'), (48, ''), (49, '    <select id=""getMachineSyncStatus"" resultType=""MachineRelation"">'), (50, '        select * from machine_relation where ip = #{ip} and real_ip= #{real_ip} and is_sync = #{is_sync}'), (51, '    </select>'), (52, ''), (53, '</mapper>')], 'deleted': []}"
178,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/MachineStatsDao.xml,MachineStatsDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.MachineStatsDao"">'), (5, ''), (6, '    <sql id=""machine_statistics_columns"">'), (7, '        ip,host_id,cpu_usage,`load`,traffic,max_memory,machine_memory,instance_count,memory_usage_ratio,memory_free,memory_total,modify_time'), (8, '    </sql>'), (9, ''), (10, '    <sql id=""instance_info_columns"">'), (11, '        instance.id, instance.parent_id, instance.app_id, instance.host_id, instance.ip, instance.PORT, instance.STATUS, instance.mem, instance.conn, instance.cmd, instance.type'), (12, '    </sql>'), (13, ''), (14, '    <!--保存机器当前最新的统计信息-->'), (15, '    <insert id=""mergeMachineStats"" parameterType=""MachineStats"">'), (16, '        insert into machine_statistics'), (17, '          (<include refid=""machine_statistics_columns""/>)'), (18, '        values'), (19, '          (#{ip},#{hostId},#{cpuUsage},#{load},#{traffic},#{maxMemory},#{machineMemory},#{instanceCount},#{memoryUsageRatio},#{memoryFree},#{memoryTotal},#{modifyTime})'), (20, '        on duplicate key update'), (21, '           host_id = #{hostId},'), (22, '           cpu_usage = #{cpuUsage},'), (23, '           `load` = #{load},'), (24, '           traffic = #{traffic},'), (25, '           memory_usage_ratio = #{memoryUsageRatio},'), (26, '           memory_free = #{memoryFree},'), (27, '           memory_total = #{memoryTotal},'), (28, '           max_memory = #{maxMemory},'), (29, '           instance_count = #{instanceCount},'), (30, '           machine_memory = #{machineMemory},'), (31, '           modify_time = #{modifyTime}'), (32, '    </insert>'), (33, ''), (34, '    <!--查询机器下的所有实例的静态信息-->'), (35, '    <select id=""getInstInfoOfMachine"" resultType=""InstanceInfo"">'), (36, '        SELECT'), (37, '           <include refid=""instance_info_columns""/>'), (38, '        FROM'), (39, '            machine_info AS machine,'), (40, '            instance_info AS instance'), (41, '        WHERE'), (42, '            machine.id = instance.host_id'), (43, '        AND machine.ip = instance.ip'), (44, '        AND machine.available = 1'), (45, '        AND machine.ip = #{ip}'), (46, '    </select>'), (47, ''), (48, '    <!--查询机器下的所有实例的最新状态信息-->'), (49, '    <select id=""getInstStatOfMachine"" resultType=""InstanceStats"" parameterType=""long"">'), (50, '        SELECT istat.*'), (51, '        FROM machine_statistics as mstat, instance_statistics AS istat'), (52, '        WHERE mstat.host_id = #{hostId}'), (53, '        AND mstat.host_id = istat.host_id'), (54, '        ORDER BY istat.max_memory DESC;'), (55, '    </select>'), (56, ''), (57, '    <select id=""getMachineStats"" resultType=""MachineStats"">'), (58, '        select'), (59, '          id,<include refid=""machine_statistics_columns""/>'), (60, '        from machine_statistics'), (61, '        <choose>'), (62, '            <when test=""ipLike != \'\' and ipLike != null"">'), (63, ""                where ip like '%${ipLike}%'""), (64, '            </when>'), (65, '        </choose>'), (66, '    </select>'), (67, ''), (68, '    <select id=""getAllMachineStats"" resultType=""MachineStats"">'), (69, '        select'), (70, '          id,<include refid=""machine_statistics_columns""/>'), (71, '        from machine_statistics'), (72, '    </select>'), (73, ''), (74, '    <!--根据机器的ip查询机器的最新状态信息-->'), (75, '    <select id=""getMachineStatsByIp"" resultType=""MachineStats"">'), (76, '        select'), (77, '          id,<include refid=""machine_statistics_columns""/>'), (78, '        from machine_statistics'), (79, '        where ip = #{ip};'), (80, '    </select>'), (81, ''), (82, '    <!--根据机器的hostId查询机器的最新状态信息-->'), (83, '    <select id=""getMachineStatsByHostId"" resultType=""MachineStats"" parameterType=""long"">'), (84, '        select'), (85, '          id,<include refid=""machine_statistics_columns""/>'), (86, '        from machine_statistics'), (87, '        where host_id = #{hostId};'), (88, '    </select>'), (89, ''), (90, '    <!-- 删除机器统计信息 -->'), (91, '    <delete id=""deleteMachineStatsByIp"" parameterType=""string"">'), (92, '    \tdelete from machine_statistics where ip = #{ip};'), (93, '    </delete>'), (94, ''), (95, ''), (96, '</mapper>')], 'deleted': []}"
179,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/QuartzDao.xml,QuartzDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.QuartzDao"">'), (6, '    <sql id=""quartz_triggers_columns"">'), (7, '        t.SCHED_NAME,t.TRIGGER_NAME,t.TRIGGER_GROUP,t.JOB_NAME,t.JOB_GROUP,t.DESCRIPTION,t.NEXT_FIRE_TIME,t.PREV_FIRE_TIME,t.PRIORITY,'), (8, '        t.TRIGGER_STATE,t.TRIGGER_TYPE,t.START_TIME,t.END_TIME,t.CALENDAR_NAME,t.MISFIRE_INSTR'), (9, '    </sql>'), (10, ''), (11, '    <!--查询job分组下的所有trigger-->'), (12, '    <select id=""getTriggersByJobGroup"" resultType=""TriggerInfo"" parameterType=""String"">'), (13, '        SELECT <include refid=""quartz_triggers_columns""/>'), (14, '        FROM QRTZ_TRIGGERS t'), (15, '        WHERE JOB_GROUP = #{jobGroup};'), (16, '    </select>'), (17, ''), (18, '    <!--返回所有trigger-->'), (19, '    <select id=""getAllTriggers"" resultType=""TriggerInfo"">'), (20, '        SELECT <include refid=""quartz_triggers_columns""/>, ifnull(ct.CRON_EXPRESSION,\'\') cron'), (21, '        FROM QRTZ_TRIGGERS t'), (22, '        LEFT JOIN QRTZ_CRON_TRIGGERS ct'), (23, '        on (t.SCHED_NAME = ct.SCHED_NAME and t.TRIGGER_NAME = ct.TRIGGER_NAME and t.TRIGGER_GROUP=ct.TRIGGER_GROUP)'), (24, '    </select>'), (25, ''), (26, '    <!--查询trigger：模糊匹配trigger name或trigger group-->'), (27, '    <select id=""searchTriggerByNameOrGroup"" resultType=""TriggerInfo"" parameterType=""String"">'), (28, '        SELECT <include refid=""quartz_triggers_columns""/>, ifnull(ct.CRON_EXPRESSION,\'\') cron'), (29, '        FROM QRTZ_TRIGGERS t'), (30, '        LEFT JOIN QRTZ_CRON_TRIGGERS ct'), (31, '        on (t.SCHED_NAME = ct.SCHED_NAME and t.TRIGGER_NAME = ct.TRIGGER_NAME and t.TRIGGER_GROUP=ct.TRIGGER_GROUP)'), (32, '        WHERE t.TRIGGER_NAME REGEXP #{queryString}'), (33, '        OR t.TRIGGER_GROUP REGEXP #{queryString};'), (34, '    </select>'), (35, ''), (36, '    <select id=""getTriggerStateCount"" resultType=""int"">'), (37, '        select count(*) from QRTZ_TRIGGERS where TRIGGER_STATE = #{triggerState}'), (38, '    </select>'), (39, ''), (40, '    <select id=""getMisFireTriggerCount"" resultType=""int"">'), (41, '        select count(*) from QRTZ_TRIGGERS where NEXT_FIRE_TIME &lt; unix_timestamp(now())*1000'), (42, '    </select>'), (43, ''), (44, '</mapper>')], 'deleted': []}"
180,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/ResourceDao.xml,ResourceDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.ResourceDao"">'), (5, '\t<sql id=""resource_columns"">'), (6, '\t\tid,name,intro,type,lastmodify,dir,url,ispush,status,username,task_id'), (7, '\t</sql>'), (8, ''), (9, '\t<sql id=""resource_fields"">'), (10, '\t\t#{id}, #{name}, #{intro}, #{type}, #{lastmodify}, #{dir}, #{url}, #{ispush}, #{status}, #{username},#{taskId}'), (11, '\t</sql>'), (12, ''), (13, '\t<select id=""getResourceList"" resultType=""com.sohu.cache.entity.SystemResource"">'), (14, '\t\tselect'), (15, '\t\t<include refid=""resource_columns"" />'), (16, '\t\tfrom system_resource where status = 1'), (17, '\t\t<choose>'), (18, '            <when test=""resourceType > 0"">'), (19, '                and type = #{resourceType}'), (20, '            </when>'), (21, '        </choose>'), (22, '\t\torder by type asc,dir asc,name desc'), (23, '\t</select>'), (24, ''), (25, '\t<select id=""getResourceListByName"" resultType=""com.sohu.cache.entity.SystemResource"">'), (26, '\t\tselect'), (27, '\t\t<include refid=""resource_columns"" />'), (28, '\t\tfrom system_resource where status = 1 and name like CONCAT(""%"",#{searchName},""%"")  and type = #{resourceType}'), (29, '\t\torder by type asc,dir asc,name desc'), (30, '\t</select>'), (31, ''), (32, '\t<select id=""getResourceById"" resultType=""com.sohu.cache.entity.SystemResource"">'), (33, '\t\tselect'), (34, '\t\t<include refid=""resource_columns"" />'), (35, '\t\tfrom system_resource where id = #{resourceId}'), (36, '\t</select>'), (37, ''), (38, '\t<select id=""getResourceByName"" resultType=""com.sohu.cache.entity.SystemResource"">'), (39, '\t\tselect'), (40, '\t\t<include refid=""resource_columns"" />'), (41, '\t\tfrom system_resource where name = #{resourceName} and status=1'), (42, '\t</select>'), (43, ''), (44, '\t<insert id=""save"" parameterType=""SystemResource"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (45, '\t\tinsert into system_resource (<include refid=""resource_columns""/>)'), (46, '\t\tvalue(<include refid=""resource_fields""/>);'), (47, '\t</insert>'), (48, ''), (49, '\t<update id=""update"" parameterType=""SystemResource"">'), (50, '\t\tupdate system_resource'), (51, '\t\tset name=#{name}, intro=#{intro}, type=#{type}, url=#{url},dir=#{dir}, ispush=#{ispush}, lastmodify=now(),'), (52, '\t\tstatus=#{status}, username=#{username}, task_id=#{taskId}'), (53, '\t\twhere id=#{id}'), (54, '\t</update>'), (55, ''), (56, '\t<select id=""getAppUseRedis"" resultType=""java.util.HashMap"">'), (57, '\t\tSELECT version_id,count(version_id) as num from app_desc where `status`=2 GROUP BY version_id'), (58, '\t</select>'), (59, ''), (60, '</mapper>')], 'deleted': []}"
181,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/ServerStatusDao.xml,ServerStatusDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.ServerStatusDao"">'), (6, ''), (7, '\t<!-- 获取服务器信息 -->'), (8, '    <select id=""queryServerInfo"" resultType=""ServerInfo"">'), (9, '    \tselect ip,host,nmon,cpus,cpu_model cpuModel,dist,kernel,ulimit'), (10, '        from server where ip=#{ip}'), (11, '    </select>'), (12, ''), (13, '\t<select id=""getAllServerInfo"" resultType=""ServerInfo"">'), (14, '\t\tSELECT ser.ip,ser.dist from machine_info machine, server ser'), (15, '\t\twhere machine.ip = ser.ip and machine.available=1'), (16, '\t</select>'), (17, ''), (18, '    <!-- 保存服务器发行版信息 -->'), (19, '    <insert id=""saveServerInfo"">'), (20, '    \tinsert ignore into server(ip,dist) values (#{ip},#{dist})'), (21, '    </insert>'), (22, ''), (23, '    <!-- 删除服务器信息 -->'), (24, '    <select id=""deleteServerInfo"">'), (25, '    \tdelete from server where ip=#{ip}'), (26, '    </select>'), (27, ''), (28, '    <!-- 保存/更新服务器信息 -->'), (29, '    <insert id=""saveAndUpdateServerInfo"">'), (30, '    \tinsert into server (ip,host,nmon,cpus,cpu_model,kernel,ulimit)'), (31, '\t\tvalues (#{server.ip},#{server.host},#{server.nmon},#{server.cpus},#{server.cpuModel},#{server.kernel},#{server.ulimit})'), (32, '\t\ton duplicate key update host=values(host), nmon=values(nmon), cpus=values(cpus),'), (33, '\t\tcpu_model=values(cpu_model), kernel=values(kernel), ulimit=values(ulimit)'), (34, '    </insert>'), (35, ''), (36, '    <!-- 获取服务器状态 -->'), (37, '    <select id=""queryServerOverview"" resultType=""ServerStatus"">'), (38, '    \tselect ip,cdate,ctime,cuser,csys,cwio,cload1,cload5,cload15,'), (39, '\t\t\t   mtotal,mfree,mcache,mbuffer,mswap,mswap_free mswapFree,'), (40, '\t\t\t   nin,nout,tuse,torphan,twait,'), (41, '\t\t\t   dread,dwrite,diops,dbusy'), (42, '\t\tfrom server_stat'), (43, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (44, '    </select>'), (45, ''), (46, '    <!-- 获取服务器cpu状态 -->'), (47, '    <select id=""queryServerCpu"" resultType=""ServerStatus"">'), (48, '    \tselect ctime, c_ext cExt'), (49, '\t\tfrom server_stat'), (50, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (51, '    </select>'), (52, ''), (53, '    <!-- 获取服务器net状态 -->'), (54, '    <select id=""queryServerNet"" resultType=""ServerStatus"">'), (55, '    \tselect ctime, nin_ext ninExt,nout_ext noutExt'), (56, '\t\tfrom server_stat'), (57, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (58, '    </select>'), (59, ''), (60, '    <!-- 获取服务器disk状态 -->'), (61, '    <select id=""queryServerDisk"" resultType=""ServerStatus"">'), (62, '    \tselect ctime, d_ext dExt,dspace'), (63, '\t\tfrom server_stat'), (64, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (65, '    </select>'), (66, ''), (67, '    <!-- 获取服务器状态 -->'), (68, '    <select id=""queryServerStat"" resultType=""ServerStatus"">'), (69, '    \tselect ip,cdate,ctime,cuser,csys,cwio,c_ext cExt,cload1,cload5,cload15,'), (70, '\t\t\t   mtotal,mfree,mcache,mbuffer,mswap,mswap_free mswapFree,'), (71, '\t\t\t   nin,nout,nin_ext ninExt,nout_ext noutExt,tuse,torphan,twait,'), (72, '\t\t\t   dread,dwrite,diops,dbusy,d_ext dExt,dspace""'), (73, '\t\tfrom server_stat'), (74, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (75, '    </select>'), (76, ''), (77, '    <!-- 保存服务器状态-->'), (78, '    <insert id=""saveServerStat"">'), (79, '    \tinsert ignore into server_stat(ip,cdate,ctime,cuser,csys,cwio,c_ext,'), (80, '    \t\t   cload1,cload5,cload15,'), (81, '    \t\t   mtotal,mfree,mcache,mbuffer,mswap,mswap_free,'), (82, '    \t\t   nin,nout,nin_ext,nout_ext,'), (83, '    \t\t   tuse,torphan,twait,'), (84, '    \t\t   dread,dwrite,diops,dbusy,d_ext,dspace)'), (85, '     \tvalues(#{server.ip},#{server.collectTime},#{server.time},'), (86, '     \t\t   #{server.cpu.user},#{server.cpu.sys},#{server.cpu.wait},#{server.cpu.ext},'), (87, '     \t\t   #{server.load.load1},#{server.load.load5},#{server.load.load15},'), (88, '     \t\t   #{server.mem.total},#{server.mem.totalFree},#{server.mem.cache},'), (89, '     \t\t   #{server.mem.buffer},#{server.mem.swap},#{server.mem.swapFree},'), (90, '     \t\t   #{server.net.nin},#{server.net.nout},#{server.net.ninDetail},#{server.net.noutDetail},'), (91, '     \t\t   #{server.connection.established},#{server.connection.orphan},#{server.connection.timeWait},'), (92, '     \t\t   #{server.disk.read},#{server.disk.write},#{server.disk.iops},#{server.disk.busy},'), (93, '     \t\t   #{server.disk.ext},#{server.disk.space})'), (94, '    </insert>'), (95, '</mapper>')], 'deleted': []}"
182,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/StandardStatsDao.xml,StandardStatsDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.StandardStatsDao"">'), (5, ''), (6, '    <insert id=""mergeStandardStats"" parameterType=""StandardStats"">'), (7, '        replace into standard_statistics(collect_time,ip,port,db_type,info_json,diff_json,cluster_info_json)'), (8, '        values (#{collectTime},#{ip},#{port},#{dbType},#{infoJson},#{diffJson},#{clusterInfoJson})'), (9, '    </insert>'), (10, ''), (11, '    <!-- StandardStats保留10分钟 -->'), (12, '    <insert id=""mergeInstanceMinuteStats"" parameterType=""StandardStats"">'), (13, '        replace into instance_minute_stats(collect_time,ip,port,db_type,json)'), (14, '        values (#{collectTime},#{ip},#{port},#{dbType},#{diffJson})'), (15, '    </insert>'), (16, ''), (17, '    <!-- instance_minute_stats默认保留7天,清理逻辑见:CleanupDayDimensionalityJob -->'), (18, '    <select id=""getDiffJsonList"" resultType=""StandardStats"">'), (19, '        select collect_time , json as diff_json'), (20, '        from instance_minute_stats'), (21, '        where  ip=#{ip} and port=#{port} and db_type=#{dbType}'), (22, '        and collect_time between #{beginTime} and #{endTime}'), (23, '    </select>'), (24, ''), (25, '    <select id=""getStandardStats"" resultType=""StandardStats"">'), (26, '        select id,collect_time,ip,port,db_type,info_json,diff_json,cluster_info_json,created_time'), (27, '        from standard_statistics'), (28, '        where  ip=#{ip} and port=#{port} and db_type=#{dbType}'), (29, '          and collect_time = #{collectTime}'), (30, '    </select>'), (31, ''), (32, '    <delete id=""deleteStandardStatsLessCreatedTime"">'), (33, '        delete'), (34, '        from standard_statistics'), (35, '        where <![CDATA[ created_time <=  #{createdTime}'), (36, '        ]]>'), (37, '    </delete>'), (38, ''), (39, '    <select id=""getStandardStatsByCreateTime"" resultType=""StandardStats"">'), (40, '        select id,collect_time,ip,port,db_type,info_json,diff_json,cluster_info_json,created_time'), (41, '        from standard_statistics'), (42, '        where created_time between #{beginTime} and #{endTime} and db_type=#{dbType}'), (43, '    </select>'), (44, ''), (45, '</mapper>')], 'deleted': []}"
183,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/TaskQueueDao.xml,TaskQueueDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.TaskQueueDao"">'), (5, ''), (6, '    <sql id=""task_queue_columns"">'), (7, '    \tapp_id, class_name, param, init_param, status, parent_task_id, create_time, update_time,'), (8, '    \tstart_time, end_time, priority, error_code, error_msg, task_note, important_info'), (9, '    </sql>'), (10, ''), (11, '    <sql id=""task_queue_fields"">'), (12, '    \t#{appId}, #{className}, #{param}, #{initParam}, #{status}, #{parentTaskId}, #{createTime}, #{updateTime},'), (13, '    \t#{startTime}, #{endTime}, #{priority}, #{errorCode}, #{errorMsg}, #{taskNote}, #{importantInfo}'), (14, '    </sql>'), (15, ''), (16, '    <insert id=""save"" parameterType=""TaskQueue"" keyProperty=""id"" useGeneratedKeys=""true"">'), (17, '        insert into task_queue'), (18, '        \t(<include refid=""task_queue_columns""/>)'), (19, '        values'), (20, '        \t(<include refid=""task_queue_fields""/>)'), (21, '    </insert>'), (22, ''), (23, '    <select id=""getById"" resultType=""TaskQueue"">'), (24, '        select id,<include refid=""task_queue_columns""/>, execute_ip_port'), (25, '        from task_queue'), (26, '        where id = #{taskId}'), (27, '    </select>'), (28, ''), (29, '    <select id=""getChildTaskQueueList"" resultType=""TaskQueue"">'), (30, '    \tselect id,<include refid=""task_queue_columns""/>, execute_ip_port'), (31, '        from task_queue'), (32, '        where parent_task_id = #{taskId}'), (33, '    </select>'), (34, ''), (35, '    <update id=""updateStatus"">'), (36, '    \tupdate task_queue set status = #{status} where id = #{taskId}'), (37, '    </update>'), (38, ''), (39, '    <select id=""getTaskQueueListByStatus"" resultType=""TaskQueue"">'), (40, '        select id,<include refid=""task_queue_columns""/>, execute_ip_port'), (41, '        from task_queue where status = #{status} order by id'), (42, '    </select>'), (43, ''), (44, '    <select id=""getByAppAndClass"" resultType=""TaskQueue"">'), (45, '        select id,<include refid=""task_queue_columns""/>, execute_ip_port'), (46, '        from task_queue where app_id = #{appId} and class_name=#{className}'), (47, '    </select>'), (48, ''), (49, ''), (50, '    <update id=""updateParam"">'), (51, '    \tupdate task_queue set param = #{param} where id = #{taskId}'), (52, '    </update>'), (53, ''), (54, '\t<update id=""updateStartTime"">'), (55, '    \tupdate task_queue set start_time = #{startTime} where id = #{taskId}'), (56, '    </update>'), (57, ''), (58, '    <update id=""updateEndTime"">'), (59, '    \tupdate task_queue set end_time = #{endTime} where id = #{taskId}'), (60, '    </update>'), (61, ''), (62, '    <update id=""updateExecuteIpPort"">'), (63, '    \tupdate task_queue set execute_ip_port = #{executeIpPort} where id = #{taskId}'), (64, '    </update>'), (65, ''), (66, '    <select id=""getTaskQueueCount"" resultType=""int"">'), (67, '        select count(*) from task_queue where 1=1'), (68, '        <choose>'), (69, '            <when test=""className != null and className != \'\'"">'), (70, '                 and class_name = #{className}'), (71, '            </when>'), (72, '        </choose>'), (73, '        <choose>'), (74, '            <when test=""appId != null and appId > 0"">'), (75, '                 and app_id = #{appId}'), (76, '            </when>'), (77, '        </choose>'), (78, '        <choose>'), (79, '            <when test=""status >= 0"">'), (80, '                 and status = #{status}'), (81, '            </when>'), (82, '        </choose>'), (83, '    </select>'), (84, ''), (85, '    <select id=""getTaskQueueList"" resultType=""TaskQueue"">'), (86, '        select id,<include refid=""task_queue_columns""/>, execute_ip_port'), (87, '        from task_queue where 1=1'), (88, '        <choose>'), (89, '            <when test=""className != null and className != \'\'"">'), (90, '                 and class_name = #{className}'), (91, '            </when>'), (92, '        </choose>'), (93, '        <choose>'), (94, '            <when test=""appId != null and appId > 0"">'), (95, '                 and app_id = #{appId}'), (96, '            </when>'), (97, '        </choose>'), (98, '        <choose>'), (99, '            <when test=""status >= 0"">'), (100, '                 and status = #{status}'), (101, '            </when>'), (102, '        </choose>'), (103, '        <choose>'), (104, '        \t<when test=""page != null"">'), (105, '        \t\t<choose>'), (106, '\t\t        \t<when test=""page.totalCount > page.pageSize"">'), (107, '            \t\t\tlimit #{page.start},#{page.pageSize};'), (108, '\t\t        \t</when>'), (109, '\t\t        \t<otherwise>'), (110, '\t\t        \t    limit #{page.totalCount}'), (111, '\t\t        \t</otherwise>'), (112, '\t\t        </choose>'), (113, '        \t</when>'), (114, '        </choose>'), (115, '    </select>'), (116, ''), (117, '    <select id=""getStatusCount"" resultType=""int"">'), (118, '        select count(*) from task_queue where status = #{status}'), (119, '    </select>'), (120, ''), (121, ''), (122, '</mapper>')], 'deleted': []}"
184,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/TaskStepFlowDao.xml,TaskStepFlowDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.TaskStepFlowDao"">'), (5, ''), (6, '    <sql id=""task_step_flow_columns"">'), (7, '    \ttask_id, class_name, step_name, order_no, status,'), (8, '    \tlog, start_time, end_time, create_time, update_time, child_task_id'), (9, '    </sql>'), (10, ''), (11, '    <sql id=""task_step_flow_fields"">'), (12, '    \t#{taskId}, #{className}, #{stepName}, #{orderNo}, #{status},'), (13, '    \t#{log}, #{startTime}, #{endTime}, #{createTime}, #{updateTime}, #{childTaskId}'), (14, '    </sql>'), (15, ''), (16, '    <insert id=""save"" parameterType=""TaskStepFlow"" keyProperty=""id"" useGeneratedKeys=""true"">'), (17, '        insert into task_step_flow'), (18, '        (<include refid=""task_step_flow_columns""/>)'), (19, '        values'), (20, '        (<include refid=""task_step_flow_fields""/>)'), (21, '    </insert>'), (22, ''), (23, '    <select id=""getByTaskClassStep"" resultType=""TaskStepFlow"">'), (24, '        select id,<include refid=""task_step_flow_columns""/>, execute_ip_port'), (25, '        from task_step_flow'), (26, '        where task_id = #{taskId} and class_name = #{className} and step_name = #{stepName}'), (27, '    </select>'), (28, ''), (29, '    <update id=""updateStatus"">'), (30, '    \tupdate task_step_flow set status = #{status} where id = #{id}'), (31, '    </update>'), (32, ''), (33, '    <update id=""updateLog"">'), (34, '    \tupdate task_step_flow set log = #{log} where id = #{id}'), (35, '    </update>'), (36, ''), (37, '    <update id=""updateStartTime"">'), (38, '    \tupdate task_step_flow set start_time = #{startTime} where id = #{id}'), (39, '    </update>'), (40, ''), (41, '    <update id=""updateEndTime"">'), (42, '    \tupdate task_step_flow set end_Time = #{endTime} where id = #{id}'), (43, '    </update>'), (44, ''), (45, '    <update id=""updateChildTaskId"">'), (46, '    \tupdate task_step_flow set child_task_id = #{childTaskId} where id = #{id}'), (47, '    </update>'), (48, ''), (49, '    <update id=""updateExecuteIpPort"">'), (50, '    \tupdate task_step_flow set execute_ip_port = #{executeIpPort} where id = #{taskId}'), (51, '    </update>'), (52, ''), (53, '    <select id=""getTaskStepFlowList"" resultType=""TaskStepFlow"">'), (54, '        select id,<include refid=""task_step_flow_columns""/>, execute_ip_port'), (55, '        from task_step_flow'), (56, '        where task_id = #{taskId} order by order_no'), (57, '    </select>'), (58, ''), (59, '</mapper>')], 'deleted': []}"
185,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/TaskStepMetaDao.xml,TaskStepMetaDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.TaskStepMetaDao"">'), (5, ''), (6, '    <sql id=""task_step_meta_columns"">'), (7, '    \tclass_name, step_name, step_desc, ops_device,'), (8, '    \ttimeout, order_no, create_time, update_time'), (9, '    </sql>'), (10, ''), (11, '    <sql id=""task_step_meta_fields"">'), (12, '    \t#{className}, #{stepName}, #{stepDesc}, #{opsDevice},'), (13, '    \t#{timeout}, #{orderNo}, #{createTime}, #{updateTime}'), (14, '    </sql>'), (15, ''), (16, '    <insert id=""save"" parameterType=""TaskStepMeta"" keyProperty=""id"" useGeneratedKeys=""true"">'), (17, '        insert into task_step_meta'), (18, '        \t(<include refid=""task_step_meta_columns""/>)'), (19, '        values'), (20, '        \t(<include refid=""task_step_meta_fields""/>)'), (21, '    </insert>'), (22, ''), (23, '    <select id=""getTaskStepMetaList"" resultType=""TaskStepMeta"">'), (24, '        select id,<include refid=""task_step_meta_columns""/>'), (25, '        from task_step_meta'), (26, '        where class_name = #{className}'), (27, '    </select>'), (28, ''), (29, '</mapper>')], 'deleted': []}"
186,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mapper/ThreadPoolStatDao.xml,ThreadPoolStatDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.ThreadPoolStatDao"">'), (6, '    <sql id=""thread_pool_columns"">'), (7, '        thread_pool_name, ip, port, collect_time, collect_date, maximum_pool_size,'), (8, '        core_pool_size, active_count, diff_task_count, task_count,'), (9, '        completed_task_count, queue_size, create_time, update_time'), (10, '    </sql>'), (11, ''), (12, '    <sql id=""thread_pool_fields"">'), (13, '        #{threadPoolName}, #{ip}, #{port}, #{collectTime}, #{collectDate}, #{maximumPoolSize},'), (14, '        #{corePoolSize}, #{activeCount}, #{diffTaskCount}, #{taskCount},'), (15, '        #{completedTaskCount},#{queueSize}, #{createTime}, #{updateTime}'), (16, '    </sql>'), (17, ''), (18, '    <insert id=""save"" parameterType=""ThreadPoolStat"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (19, '        insert into thread_pool_stat (<include refid=""thread_pool_columns""/>)'), (20, '        value(<include refid=""thread_pool_fields""/>);'), (21, '    </insert>'), (22, ''), (23, '    <select id=""getLastTaskCount"" resultType=""Long"">'), (24, '    \tselect task_count from thread_pool_stat'), (25, '    \twhere ip=#{ip} and port=#{port} and thread_pool_name=#{threadPoolName} order by id desc limit 1'), (26, '    </select>'), (27, ''), (28, '</mapper>'), (29, ''), (30, '')], 'deleted': []}"
187,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/mybatis-config.xml,mybatis-config.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE configuration PUBLIC ""-//mybatis.org//DTD Config 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-config.dtd"">'), (4, ''), (5, '<configuration>'), (6, ''), (7, '    <!--数据库的字段名到pojo类的属性名的自动映射-->'), (8, '    <settings>'), (9, '        <!-- 使用jdbc的getGeneratedKeys自动获取主键主键策略:默认false -->'), (10, '        <setting name=""useGeneratedKeys"" value=""true""/>'), (11, '        <!-- 使用列别名代替列名,默认true -->'), (12, '        <setting name=""useColumnLabel"" value=""true""/>'), (13, '        <!-- 开启自动驼峰-下划线命名规则,默认false: Table(create_time) -> Entity(createTime) -->'), (14, '        <setting name=""mapUnderscoreToCamelCase"" value=""true""/>'), (15, '        <!-- 开启debug调试日志 -->'), (16, '        <!--<setting name=""logImpl"" value=""STDOUT_LOGGING""/>-->'), (17, '    </settings>'), (18, ''), (19, '</configuration>')], 'deleted': []}"
188,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/spring/spring-client-report.xml,spring-client-report.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:util=""http://www.springframework.org/schema/util""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '                     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd""'), (6, '       default-autowire=""byName"">'), (7, ''), (8, ''), (9, '    <!-- 耗时分布  -->'), (10, '    <bean id=""clientReportCostDistriService""'), (11, '          class=""com.sohu.cache.client.service.impl.ClientReportCostDistriServiceImpl""/>'), (12, '    <!-- 客户端异常 -->'), (13, '    <bean id=""clientReportExceptionService""'), (14, '          class=""com.sohu.cache.client.service.impl.ClientReportExceptionServiceImpl""/>'), (15, '    <!-- 值分布 -->'), (16, '    <bean id=""clientReportValueDistriService""'), (17, '          class=""com.sohu.cache.client.service.impl.ClientReportValueDistriServiceImplV2""/>'), (18, ''), (19, ''), (20, '    <!-- 客户端版本收集 -->'), (21, '    <bean id=""clientVersionService"" class=""com.sohu.cache.client.service.impl.ClientVersionServiceImpl""/>'), (22, ''), (23, '    <!-- 应用下节点和客户端对应关系 -->'), (24, '    <bean id=""appInstanceClientRelationService""'), (25, '          class=""com.sohu.cache.client.service.impl.AppInstanceClientRelationServiceImpl""/>'), (26, ''), (27, '    <bean id=""clientReportInstanceService"" class=""com.sohu.cache.client.service.impl.ClientReportInstanceServiceImpl""/>'), (28, ''), (29, '    <!-- 客户端应用服务类 -->'), (30, '    <bean id=""appClientService"" class=""com.sohu.cache.client.service.impl.AppClientServiceImpl""/>'), (31, ''), (32, '</beans>')], 'deleted': []}"
189,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/spring/spring-data.xml,spring-data.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"" default-autowire=""byName"">'), (6, ''), (7, ''), (8, '    <bean id=""jdbcTemplate"" class=""org.springframework.jdbc.core.JdbcTemplate"">'), (9, '        <property name=""dataSource"" ref=""cacheCloudDB""/>'), (10, '    </bean>'), (11, ''), (12, '    <bean name=""transactionManager"" class=""org.springframework.jdbc.datasource.DataSourceTransactionManager"">'), (13, '        <property name=""dataSource"" ref=""cacheCloudDB""/>'), (14, '    </bean>'), (15, ''), (16, '</beans>')], 'deleted': []}"
190,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/spring/spring-inspector.xml,spring-inspector.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"" default-autowire=""byName"">'), (6, ''), (7, '    <bean id=""hostInspectHandler"" class=""com.sohu.cache.inspect.impl.HostInspectHandler"" init-method=""init"">'), (8, '        <property name=""inspectorList"">'), (9, '            <list>'), (10, '                <bean class=""com.sohu.cache.inspect.impl.InstanceRunInspector""/>'), (11, '                <bean class=""com.sohu.cache.inspect.impl.RedisIsolationPersistenceInspector""/>'), (12, '            </list>'), (13, '        </property>'), (14, '    </bean>'), (15, ''), (16, '    <bean id=""appInspectHandler"" class=""com.sohu.cache.inspect.impl.AppInspectHandler"" init-method=""init"">'), (17, '        <property name=""inspectorList"">'), (18, '        \t<list>'), (19, '        \t\t<bean class=""com.sohu.cache.inspect.impl.AppMemInspector""/>'), (20, '            \t<bean class=""com.sohu.cache.inspect.impl.AppClientConnInspector""/>'), (21, '            \t<bean class=""com.sohu.cache.inspect.impl.AppHitPrecentInspector""/>'), (22, '        \t</list>'), (23, '        </property>'), (24, '    </bean>'), (25, ''), (26, '</beans>')], 'deleted': []}"
191,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/spring/spring-mvc.xml,spring-mvc.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xmlns:context=""http://www.springframework.org/schema/context""'), (5, '       xmlns:mvc=""http://www.springframework.org/schema/mvc""'), (6, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (7, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd'), (8, '        http://www.springframework.org/schema/context'), (9, '        http://www.springframework.org/schema/context/spring-context-3.0.xsd'), (10, '        http://www.springframework.org/schema/mvc'), (11, '        http://www.springframework.org/schema/mvc/spring-mvc.xsd"" default-autowire=""byName"">'), (12, ''), (13, '    <context:component-scan base-package=""com.sohu.cache.client.heartbeat,com.sohu.cache.web.controller""/>'), (14, ''), (15, '    <mvc:resources mapping=""/resources/**"" location=""/WEB-INF/resources/""/>'), (16, '    <mvc:resources mapping=""/assets/flash/**"" location=""/WEB-INF/resources/assets/flash/""/>'), (17, ''), (18, '    <mvc:interceptors>'), (19, '        <!-- 前台验证 -->'), (20, '        <mvc:interceptor>'), (21, '            <mvc:mapping path=""/admin/app/*""/>'), (22, '            <mvc:mapping path=""/admin/instance/*""/>'), (23, '            <mvc:mapping path=""/client/show/**""/>'), (24, '            <mvc:mapping path=""/server/*""/>'), (25, '            <bean class=""com.sohu.cache.interceptor.FrontUserLoginInterceptor""/>'), (26, '        </mvc:interceptor>'), (27, '        <!-- 后台管理员验证 -->'), (28, '        <mvc:interceptor>'), (29, '            <mvc:mapping path=""/manage/app/*""/>'), (30, '            <mvc:mapping path=""/manage/instance/*""/>'), (31, '            <mvc:mapping path=""/manage/user/*""/>'), (32, '            <mvc:mapping path=""/manage/quartz/*""/>'), (33, '            <mvc:mapping path=""/manage/total/*""/>'), (34, '            <mvc:mapping path=""/manage/machine/*""/>'), (35, '            <mvc:mapping path=""/manage/notice/*""/>'), (36, '            <mvc:mapping path=""/import/app/*""/>'), (37, '            <mvc:mapping path=""/manage/config/*""/>'), (38, '            <mvc:mapping path=""/data/migrate/*""/>'), (39, '            <mvc:mapping path=""/manage/redisConfig/*""/>'), (40, '            <mvc:mapping path=""/manage/instanceAlert/*""/>'), (41, '            <mvc:mapping path=""/manage/redis/upgrade/*""/>'), (42, '            <mvc:mapping path=""/manage/app/migrate/*""/>'), (43, '            <bean class=""com.sohu.cache.interceptor.ManageUserLoginInterceptor""/>'), (44, '        </mvc:interceptor>'), (45, '        <!-- 应用和实例权限验证 -->'), (46, '        <mvc:interceptor>'), (47, '            <mvc:mapping path=""/admin/app/*""/>'), (48, '            <mvc:mapping path=""/admin/instance/*""/>'), (49, '            <bean class=""com.sohu.cache.interceptor.AppAndInstanceAuthorityInterceptor""/>'), (50, '        </mvc:interceptor>'), (51, '    </mvc:interceptors>'), (52, ''), (53, '    <bean class=""org.springframework.web.servlet.view.ContentNegotiatingViewResolver"">'), (54, '        <property name=""order"" value=""1""/>'), (55, '        <property name=""contentNegotiationManager"">'), (56, '            <bean class=""org.springframework.web.accept.ContentNegotiationManager"">'), (57, '                <constructor-arg>'), (58, '                    <bean class=""org.springframework.web.accept.PathExtensionContentNegotiationStrategy"">'), (59, '                        <constructor-arg>'), (60, '                            <map>'), (61, '                                <entry key=""json"" value=""application/json""/>'), (62, '                            </map>'), (63, '                        </constructor-arg>'), (64, '                    </bean>'), (65, '                </constructor-arg>'), (66, '            </bean>'), (67, '        </property>'), (68, '        <property name=""defaultViews"">'), (69, '            <list>'), (70, '                <bean class=""org.springframework.web.servlet.view.json.MappingJackson2JsonView""/>'), (71, '            </list>'), (72, '        </property>'), (73, '    </bean>'), (74, ''), (75, '</beans>')], 'deleted': []}"
192,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/spring/spring-mybatis.xml,spring-mybatis.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xmlns:context=""http://www.springframework.org/schema/context""'), (5, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (6, '                     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd'), (7, '                     http://www.springframework.org/schema/context'), (8, '                     http://www.springframework.org/schema/context/spring-context.xsd"">'), (9, ''), (10, '    <bean id=""cacheCloudDB"" class=""com.zaxxer.hikari.HikariDataSource"" destroy-method=""close"">'), (11, '        <property name=""driverClassName"" value=""${cachecloud.jdbc.driver}"" />'), (12, '        <property name=""jdbcUrl"" value=""${cachecloud.primary.url}"" />'), (13, '        <property name=""username"" value=""${cachecloud.primary.user}"" />'), (14, '        <property name=""password"" value=""${cachecloud.primary.password}"" />'), (15, '        <property name=""maximumPoolSize"" value=""${cachecloud.primary.maxPoolSize}"" />'), (16, '        <property name=""minimumIdle"" value=""${cachecloud.primary.initialPoolSize}"" />'), (17, '        <property name=""connectionTimeout"" value=""60000"" />'), (18, '        <property name=""idleTimeout"" value=""600000"" />'), (19, '    </bean>'), (20, ''), (21, '    <bean id=""mysqlSessionFactory"" class=""org.mybatis.spring.SqlSessionFactoryBean"" primary=""true"">'), (22, '        <property name=""dataSource"" ref=""cacheCloudDB""/>'), (23, '        <!-- mybatis配置文件的位置 -->'), (24, '        <property name=""configLocation"" value=""classpath:mybatis-config.xml""/>'), (25, '        <!-- domain的包路径，类似MyBatis的typeAliases配置 -->'), (26, '        <property name=""vfs"" value=""org.mybatis.spring.boot.autoconfigure.SpringBootVFS""/>'), (27, '        <property name=""typeAliasesPackage"" value=""com.sohu.cache.entity,com.sohu.cache.task.entity""/>'), (28, '        <!-- mapper配置文件的路径，类似MyBatis的mappers配置 -->'), (29, '        <property name=""mapperLocations"" value=""classpath:mapper/*.xml""/>'), (30, '    </bean>'), (31, ''), (32, '    <!-- 扫描接口类的包路径 -->'), (33, '    <bean class=""org.mybatis.spring.mapper.MapperScannerConfigurer"">'), (34, '        <property name=""sqlSessionFactoryBeanName"" value=""mysqlSessionFactory""/>'), (35, '        <property name=""basePackage"" value=""com.sohu.cache.dao""/>'), (36, '    </bean>'), (37, ''), (38, '</beans>')], 'deleted': []}"
193,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/spring/spring-quartz.xml,spring-quartz.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '                     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd""'), (6, '       default-autowire=""byName"">'), (7, ''), (8, '    <bean id=""systemConfigRefreshTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (9, '        <property name=""name"" value=""systemConfigRefreshTrigger""/>'), (10, '        <property name=""group"" value=""systemConfigRefreshGroup""/>'), (11, '        <property name=""jobDetail"" ref=""systemConfigRefreshJobDetail""/>'), (12, '        <property name=""cronExpression"" value=""0/30 * * ? * *""/>'), (13, '        <property name=""misfireInstruction"" value=""2""/>'), (14, '    </bean>'), (15, '    <bean id=""dispatcherBrevityScheduleTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (16, '        <property name=""name"" value=""dispatcherBrevityScheduleTrigger""/>'), (17, '        <property name=""group"" value=""dispatcherBrevityScheduleGroup""/>'), (18, '        <property name=""jobDetail"" ref=""dispatcherBrevityScheduleJobDetail""/>'), (19, '        <property name=""cronExpression"" value=""1 0/1 * ? * *""/>'), (20, '    </bean>'), (21, ''), (22, '    <bean id=""systemConfigRefreshJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (23, '        <property name=""name"" value=""systemConfigRefreshJobDetail""></property>'), (24, '        <property name=""group"" value=""systemConfigRefreshGroup""></property>'), (25, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.SystemConfigRefreshJob""></property>'), (26, '        <property name=""durability"" value=""true""/>'), (27, '    </bean>'), (28, '    <bean id=""dispatcherBrevityScheduleJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (29, '        <property name=""name"" value=""dispatcherBrevityScheduleJobDetail""></property>'), (30, '        <property name=""group"" value=""dispatcherBrevityScheduleGroup""></property>'), (31, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.brevity.DispatcherBrevityScheduleJob""></property>'), (32, '        <property name=""durability"" value=""true""/>'), (33, '    </bean>'), (34, '    <bean id=""monitorThreadPoolJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (35, '        <property name=""name"" value=""monitorThreadPoolJobDetail""></property>'), (36, '        <property name=""group"" value=""monitorThreadPoolGroup""></property>'), (37, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.MonitorThreadPoolJob""></property>'), (38, '        <property name=""durability"" value=""true""/>'), (39, '    </bean>'), (40, '    <bean id=""errorLogMinuteStatJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (41, '        <property name=""name"" value=""errorLogMinuteStatJob""/>'), (42, '        <property name=""group"" value=""errorLogMinuteStatGroup""/>'), (43, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.ErrorLogMinuteStatJob""/>'), (44, '        <property name=""durability"" value=""true"" />'), (45, '    </bean>'), (46, ''), (47, '    <bean id=""errorLogMinuteStatTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (48, '        <property name=""name"" value=""errorLogMinuteStatTrigger""/>'), (49, '        <property name=""group"" value=""errorLogMinuteStatGroup""/>'), (50, '        <property name=""jobDetail"" ref=""errorLogMinuteStatJobDetail""/>'), (51, '        <property name=""cronExpression"" value=""0 0/1 * ? * *""/>'), (52, '    </bean>'), (53, ''), (54, '    <!-- inJvm模式 -->'), (55, '    <bean id=""jvmQuartzScheduler"" name=""jvmQuartzScheduler"" lazy-init=""false""'), (56, '          class=""org.springframework.scheduling.quartz.SchedulerFactoryBean"">'), (57, '        <property name=""taskExecutor"" ref=""jvmQuartzThreadPool""/>'), (58, '        <property name=""quartzProperties"">'), (59, '            <props>'), (60, '                <prop key=""org.quartz.scheduler.instanceName"">cachecloudJvmScheduler</prop>'), (61, '                <prop key=""org.quartz.jobStore.class"">org.quartz.simpl.RAMJobStore</prop>'), (62, '                <prop key=""org.quartz.scheduler.instanceId"">AUTO</prop>'), (63, '                <prop key=""org.quartz.scheduler.jmx.export"">true</prop>'), (64, '                <prop key=""org.quartz.plugin.shutdownHook.class"">org.quartz.plugins.management.ShutdownHookPlugin</prop>'), (65, '                <prop key=""org.quartz.plugin.shutdownHook.cleanShutdown"">true</prop>'), (66, '                <prop key=""org.quartz.plugin.triggHistory.class"">org.quartz.plugins.history.LoggingJobHistoryPlugin</prop>'), (67, '            </props>'), (68, '        </property>'), (69, '        <property name=""startupDelay"" value=""10""/>'), (70, '        <property name=""applicationContextSchedulerContextKey"" value=""applicationContext""/>'), (71, '        <property name=""overwriteExistingJobs"" value=""true""/>'), (72, '        <property name=""autoStartup"" value=""true""/>'), (73, ''), (74, '        <property name=""triggers"">'), (75, '            <array>'), (76, '                <ref bean=""systemConfigRefreshTrigger""/>'), (77, '                <ref bean=""dispatcherBrevityScheduleTrigger""/>'), (78, '                <ref bean=""errorLogMinuteStatTrigger""/>'), (79, '                <ref bean=""monitorThreadPoolTrigger""/>'), (80, '            </array>'), (81, '        </property>'), (82, ''), (83, '        <property name=""jobDetails"">'), (84, '            <array>'), (85, '                <ref bean=""systemConfigRefreshJobDetail""/>'), (86, '                <ref bean=""dispatcherBrevityScheduleJobDetail""/>'), (87, '                <ref bean=""errorLogMinuteStatJobDetail""/>'), (88, '                <ref bean=""monitorThreadPoolJobDetail""/>'), (89, '            </array>'), (90, '        </property>'), (91, '    </bean>'), (92, ''), (93, '    <!-- quartz线程池 -->'), (94, '    <bean id=""jvmQuartzThreadPool"" class=""org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor"">'), (95, '        <!-- 核心线程数  -->'), (96, '        <property name=""corePoolSize"" value=""30""/>'), (97, '        <!-- 最大线程数 -->'), (98, '        <property name=""maxPoolSize"" value=""30""/>'), (99, '        <!-- 队列最大长度 >=mainExecutor.maxSize -->'), (100, '        <property name=""queueCapacity"" value=""200""/>'), (101, '        <!-- 线程池维护线程所允许的空闲时间 -->'), (102, '        <property name=""keepAliveSeconds"" value=""300""/>'), (103, '        <!-- 拒绝任务策略:被拒绝后直接在调用者线程中运行当前被放弃任务 -->'), (104, '        <property name=""rejectedExecutionHandler"">'), (105, '            <bean class=""java.util.concurrent.ThreadPoolExecutor$DiscardPolicy""/>'), (106, '        </property>'), (107, '    </bean>'), (108, ''), (109, '    <!-- quartz线程池 -->'), (110, '    <bean id=""quartzThreadPool"" class=""org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor"">'), (111, '        <!-- 核心线程数  -->'), (112, '        <property name=""corePoolSize"" value=""200""/>'), (113, '        <!-- 最大线程数 -->'), (114, '        <property name=""maxPoolSize"" value=""200""/>'), (115, '        <!-- 队列最大长度 >=mainExecutor.maxSize -->'), (116, '        <property name=""queueCapacity"" value=""1024""/>'), (117, '        <!-- 线程池维护线程所允许的空闲时间 -->'), (118, '        <property name=""keepAliveSeconds"" value=""300""/>'), (119, '        <!-- 拒绝任务策略:被拒绝后直接在调用者线程中运行当前被放弃任务 -->'), (120, '        <property name=""rejectedExecutionHandler"">'), (121, '            <bean class=""java.util.concurrent.ThreadPoolExecutor$DiscardPolicy""/>'), (122, '        </property>'), (123, '    </bean>'), (124, ''), (125, '    <!-- 分布式QuartzScheduler -->'), (126, '    <bean id=""clusterScheduler"" name=""clusterScheduler"" lazy-init=""false""'), (127, '          class=""org.springframework.scheduling.quartz.SchedulerFactoryBean"">'), (128, '        <property name=""dataSource"" ref=""cacheCloudDB""></property>'), (129, '        <property name=""taskExecutor"" ref=""quartzThreadPool""/>'), (130, '        <property name=""quartzProperties"">'), (131, '            <props>'), (132, '                <prop key=""org.quartz.scheduler.instanceName"">CacheCloudScheduler</prop>'), (133, '                <prop key=""org.quartz.scheduler.instanceId"">AUTO</prop>'), (134, '                <prop key=""org.quartz.jobStore.class"">org.quartz.impl.jdbcjobstore.JobStoreTX</prop>'), (135, '                <prop key=""org.quartz.scheduler.batchTriggerAcquisitionMaxCount"">200</prop>'), (136, '                <prop key=""org.quartz.jobStore.driverDelegateClass"">org.quartz.impl.jdbcjobstore.StdJDBCDelegate</prop>'), (137, '                <!-- 表名前缀 -->'), (138, '                <prop key=""org.quartz.jobStore.tablePrefix"">QRTZ_</prop>'), (139, '                <prop key=""org.quartz.jobStore.isClustered"">true</prop>'), (140, '                <prop key=""org.quartz.jobStore.clusterCheckinInterval"">15000</prop>'), (141, '                <prop key=""org.quartz.jobStore.maxMisfiresToHandleAtATime"">20</prop>'), (142, '                <prop key=""org.quartz.jobStore.misfireThreshold"">60000</prop>'), (143, '                <!-- 打开JMX 配置 -->'), (144, '                <prop key=""org.quartz.scheduler.jmx.export"">true</prop>'), (145, '                <prop key=""org.quartz.plugin.shutdownHook.class"">org.quartz.plugins.management.ShutdownHookPlugin</prop>'), (146, '                <prop key=""org.quartz.plugin.shutdownHook.cleanShutdown"">true</prop>'), (147, '                <prop key=""org.terracotta.quartz.skipUpdateCheck"">true</prop>'), (148, '                <prop key=""org.quartz.plugin.triggHistory.class"">org.quartz.plugins.history.LoggingJobHistoryPlugin</prop>'), (149, '            </props>'), (150, '        </property>'), (151, '        <property name=""schedulerName"" value=""CacheCloudScheduler""/>'), (152, '        <property name=""applicationContextSchedulerContextKey"" value=""applicationContext""/>'), (153, '        <property name=""overwriteExistingJobs"" value=""true""/>'), (154, '        <property name=""waitForJobsToCompleteOnShutdown"" value=""false""/>'), (155, '        <property name=""startupDelay"" value=""10""/>'), (156, '        <property name=""autoStartup"" value=""true""/>'), (157, '        <property name=""triggers"">'), (158, '            <array>'), (159, '                <ref bean=""hostInspectorTrigger""/>'), (160, '                <ref bean=""appInspectorTrigger""/>'), (161, '                <ref bean=""appDailyTrigger""/>'), (162, '                <ref bean=""expAppsDailyTrigger""/>'), (163, '                <ref bean=""instanceAlertValueTrigger""/>'), (164, ''), (165, '                <ref bean=""taskExecuteJobTrigger""/>'), (166, '                <ref bean=""maintainBrevitySchedulerTrigger""/>'), (167, ''), (168, '                <ref bean=""cleanupDayDimensionalityTrigger""/>'), (169, '                <ref bean=""cleanupMinuteDimensionalityTrigger""/>'), (170, '                <ref bean=""gatherAppClientStatisticsTrigger""/>'), (171, '                <ref bean=""reviseAppClientStatisGatherTrigger""/>'), (172, '                <ref bean=""cleanupDayAppClientStatTrigger""/>'), (173, '                <ref bean=""instanceStateTrigger""/>'), (174, '            </array>'), (175, '        </property>'), (176, '        <property name=""jobDetails"">'), (177, '            <array>'), (178, '                <ref bean=""inspectorJobDetail""/>'), (179, '                <ref bean=""appDailyJobDetail""/>'), (180, '                <ref bean=""expAppsDailyJobDetail""/>'), (181, '                <ref bean=""instanceAlertValueJobDetail""/>'), (182, ''), (183, '                <ref bean=""taskExecuteJobDetail""/>'), (184, '                <ref bean=""maintainBrevitySchedulerJobDetail""/>'), (185, ''), (186, '                <ref bean=""cleanupDayDimensionalityJobDetail""/>'), (187, '                <ref bean=""cleanupMinuteDimensionalityJobDetail""/>'), (188, '                <ref bean=""gatherAppClientStatisticsJobDetail""/>'), (189, '                <ref bean=""reviseAppClientStatisGatherJobDetail""/>'), (190, '                <ref bean=""cleanupDayAppClientStatJobDetail""/>'), (191, '                <ref bean=""instanceStateJobDetail""/>'), (192, '            </array>'), (193, '        </property>'), (194, ''), (195, '    </bean>'), (196, ''), (197, '    <bean id=""maintainBrevitySchedulerJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (198, '        <property name=""name"" value=""maintainBrevitySchedulerJob""></property>'), (199, '        <property name=""group"" value=""maintainBrevitySchedulerGroup""></property>'), (200, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.brevity.BrevitySchedulerJob""></property>'), (201, '        <property name=""durability"" value=""true""/>'), (202, '    </bean>'), (203, ''), (204, '    <bean id=""maintainBrevitySchedulerTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (205, '        <property name=""name"" value=""maintainBrevitySchedulerTrigger""/>'), (206, '        <property name=""group"" value=""maintainBrevitySchedulerGroup""/>'), (207, '        <property name=""jobDetail"" ref=""maintainBrevitySchedulerJobDetail""/>'), (208, '        <property name=""cronExpression"" value=""30 0/1 * ? * *""/>'), (209, '    </bean>'), (210, ''), (211, '    <bean id=""cleanupMinuteDimensionalityJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (212, '        <property name=""name"" value=""cleanUpMinuteStatisticsJobDetail""></property>'), (213, '        <property name=""group"" value=""cleanUpMinuteStatisticsGroup""></property>'), (214, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.CleanupMinuteDimensionalityJob""></property>'), (215, '        <property name=""durability"" value=""true""/>'), (216, '    </bean>'), (217, ''), (218, '    <bean id=""cleanupMinuteDimensionalityTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (219, '        <property name=""name"" value=""cleanupMinuteDimensionalityTrigger""/>'), (220, '        <property name=""group"" value=""cleanUpMinuteStatisticsGroup""/>'), (221, '        <property name=""jobDetail"" ref=""cleanupMinuteDimensionalityJobDetail""/>'), (222, '        <!-- 每10分钟执行一次 -->'), (223, '        <property name=""cronExpression"" value=""0 0/10 * ? * *""/>'), (224, '    </bean>'), (225, ''), (226, '    <bean id=""gatherAppClientStatisticsJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (227, '        <property name=""name"" value=""gatherAppClientStatisticsJobDetail""></property>'), (228, '        <property name=""group"" value=""gatherAppClientStatisticsGroup""></property>'), (229, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.GatherAppClientStatisticsJob""></property>'), (230, '        <property name=""durability"" value=""true""/>'), (231, '    </bean>'), (232, ''), (233, '    <bean id=""gatherAppClientStatisticsTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (234, '        <property name=""name"" value=""gatherAppClientStatisticsTrigger""/>'), (235, '        <property name=""group"" value=""gatherAppClientStatisticsGroup""/>'), (236, '        <property name=""jobDetail"" ref=""gatherAppClientStatisticsJobDetail""/>'), (237, '        <!-- 每5分钟执行一次 -->'), (238, '        <property name=""cronExpression"" value=""0 0/5 * ? * *""/>'), (239, '    </bean>'), (240, ''), (241, '    <bean id=""reviseAppClientStatisGatherJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (242, '        <property name=""name"" value=""reviseAppClientStatisGatherJobDetail""></property>'), (243, '        <property name=""group"" value=""reviseAppClientStatisGatherGroup""></property>'), (244, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.ReviseAppClientStatisGatherJob""></property>'), (245, '        <property name=""durability"" value=""true""/>'), (246, '    </bean>'), (247, ''), (248, '    <bean id=""reviseAppClientStatisGatherTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (249, '        <property name=""name"" value=""reviseAppClientStatisGatherTrigger""/>'), (250, '        <property name=""group"" value=""reviseAppClientStatisGatherGroup""/>'), (251, '        <property name=""jobDetail"" ref=""reviseAppClientStatisGatherJobDetail""/>'), (252, '        <!-- 每天1点执行一次 -->'), (253, '        <property name=""cronExpression"" value=""0 0 1 * * ?""/>'), (254, '    </bean>'), (255, ''), (256, '    <bean id=""cleanupDayAppClientStatJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (257, '        <property name=""name"" value=""cleanupDayAppClientStatJobDetail""></property>'), (258, '        <property name=""group"" value=""cleanupDayAppClientStatGroup""></property>'), (259, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.CleanupDayAppClientStatJob""></property>'), (260, '        <property name=""durability"" value=""true""/>'), (261, '    </bean>'), (262, ''), (263, '    <bean id=""cleanupDayAppClientStatTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (264, '        <property name=""name"" value=""cleanupDayAppClientStatTrigger""/>'), (265, '        <property name=""group"" value=""cleanupDayAppClientStatGroup""/>'), (266, '        <property name=""jobDetail"" ref=""cleanupDayAppClientStatJobDetail""/>'), (267, '        <!-- 每天10点执行一次 -->'), (268, '        <property name=""cronExpression"" value=""0 0 10 * * ?""/>'), (269, '    </bean>'), (270, ''), (271, '    <bean id=""cleanupDayDimensionalityJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (272, '        <property name=""name"" value=""cleanUpDayStatisticsJobDetail""></property>'), (273, '        <property name=""group"" value=""cleanUpDayStatisticsGroup""></property>'), (274, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.CleanupDayDimensionalityJob""></property>'), (275, '        <property name=""durability"" value=""true""/>'), (276, '    </bean>'), (277, ''), (278, '    <bean id=""cleanupDayDimensionalityTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (279, '        <property name=""name"" value=""cleanupDayDimensionalityTrigger""/>'), (280, '        <property name=""group"" value=""cleanUpDayStatisticsGroup""/>'), (281, '        <property name=""jobDetail"" ref=""cleanupDayDimensionalityJobDetail""/>'), (282, '        <!-- 每天执行一次 -->'), (283, '        <property name=""cronExpression"" value=""0 0 12 * * ?""/>'), (284, '    </bean>'), (285, ''), (286, '    <bean id=""inspectorJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (287, '        <property name=""name"" value=""inspectorJob""></property>'), (288, '        <property name=""group"" value=""inspector""></property>'), (289, '        <property name=""jobClass"" value=""com.sohu.cache.inspect.InspectorJob""></property>'), (290, '        <property name=""durability"" value=""true""/>'), (291, '    </bean>'), (292, ''), (293, '    <bean id=""hostInspectorTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (294, '        <property name=""name"" value=""hostInspectorTrigger""/>'), (295, '        <property name=""group"" value=""inspector""/>'), (296, '        <property name=""jobDetail"" ref=""inspectorJobDetail""/>'), (297, '        <!-- 5分钟执行一次 -->'), (298, '        <property name=""cronExpression"" value=""0 0/5 * ? * *""/>'), (299, '        <property name=""jobDataAsMap"">'), (300, '            <map>'), (301, '                <entry key=""inspectorType"" value=""host""/>'), (302, '            </map>'), (303, '        </property>'), (304, '        <property name=""misfireInstruction"" value=""2""/>'), (305, '    </bean>'), (306, ''), (307, '    <bean id=""appInspectorTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (308, '        <property name=""name"" value=""appInspectorTrigger""/>'), (309, '        <property name=""group"" value=""inspector""/>'), (310, '        <property name=""jobDetail"" ref=""inspectorJobDetail""/>'), (311, '        <!-- 20分钟执行一次 -->'), (312, '        <property name=""cronExpression"" value=""0 0/20 * ? * *""/>'), (313, '        <property name=""jobDataAsMap"">'), (314, '            <map>'), (315, '                <entry key=""inspectorType"" value=""app""/>'), (316, '            </map>'), (317, '        </property>'), (318, '        <property name=""misfireInstruction"" value=""2""/>'), (319, '    </bean>'), (320, ''), (321, '    <bean id=""taskExecuteJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (322, '        <property name=""name"" value=""taskExecuteJob""></property>'), (323, '        <property name=""group"" value=""taskExecuteGroup""></property>'), (324, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.TaskExecuteJob""/>'), (325, '        <property name=""requestsRecovery"" value=""true""/>'), (326, '        <property name=""durability"" value=""true""/>'), (327, '    </bean>'), (328, ''), (329, '    <bean id=""taskExecuteJobTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (330, '        <property name=""name"" value=""taskExecuteTrigger""/>'), (331, '        <property name=""group"" value=""taskExecuteGroup""/>'), (332, '        <property name=""jobDetail"" ref=""taskExecuteJobDetail""/>'), (333, '        <property name=""cronExpression"" value=""0/10 * * ? * *""/>'), (334, '    </bean>'), (335, ''), (336, '    <bean id=""appDailyJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (337, '        <property name=""name"" value=""appDailyJob""></property>'), (338, '        <property name=""group"" value=""appDaily""></property>'), (339, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.AppDailyJob""></property>'), (340, '        <property name=""durability"" value=""true""/>'), (341, '    </bean>'), (342, ''), (343, '    <bean id=""appDailyTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (344, '        <property name=""name"" value=""appDailyTrigger""/>'), (345, '        <property name=""group"" value=""appDaily""/>'), (346, '        <property name=""jobDetail"" ref=""appDailyJobDetail""/>'), (347, '        <property name=""cronExpression"" value=""0 0 10 * * ?""/>'), (348, '    </bean>'), (349, ''), (350, '    <bean id=""expAppsDailyJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (351, '        <property name=""name"" value=""expAppsDailyJob""></property>'), (352, '        <property name=""group"" value=""expAppsDaily""></property>'), (353, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.ExpAppsDailyJob""></property>'), (354, '        <property name=""durability"" value=""true""/>'), (355, '    </bean>'), (356, ''), (357, '    <bean id=""expAppsDailyTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (358, '        <property name=""name"" value=""expAppsDailyTrigger""/>'), (359, '        <property name=""group"" value=""expAppsDaily""/>'), (360, '        <property name=""jobDetail"" ref=""expAppsDailyJobDetail""/>'), (361, '        <property name=""cronExpression"" value=""0 0 9 * * ?""/>'), (362, '    </bean>'), (363, ''), (364, '    <bean id=""instanceAlertValueJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (365, '        <property name=""name"" value=""instanceAlertValueJob""></property>'), (366, '        <property name=""group"" value=""instanceAlertValue""></property>'), (367, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.InstanceAlertValueJob""></property>'), (368, '        <property name=""durability"" value=""true""/>'), (369, '    </bean>'), (370, ''), (371, '    <bean id=""instanceAlertValueTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (372, '        <property name=""name"" value=""instanceAlertValueTrigger""/>'), (373, '        <property name=""group"" value=""instanceAlertValue""/>'), (374, '        <property name=""jobDetail"" ref=""instanceAlertValueJobDetail""/>'), (375, '        <property name=""cronExpression"" value=""0 0/1 * ? * *""/>'), (376, '        <property name=""misfireInstruction"" value=""2""/>'), (377, '    </bean>'), (378, ''), (379, '    <bean id=""monitorThreadPoolTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (380, '        <property name=""name"" value=""monitorThreadPoolTrigger""/>'), (381, '        <property name=""group"" value=""monitorThreadPoolGroup""/>'), (382, '        <property name=""jobDetail"" ref=""monitorThreadPoolJobDetail""/>'), (383, '        <property name=""cronExpression"" value=""0/10 * * ? * *""/>'), (384, '    </bean>'), (385, ''), (386, '    <bean id=""instanceStateJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (387, '        <property name=""name"" value=""instanceStateJob""></property>'), (388, '        <property name=""group"" value=""instanceState""></property>'), (389, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.InstanceStatJob""></property>'), (390, '        <property name=""durability"" value=""true""/>'), (391, '    </bean>'), (392, ''), (393, '    <bean id=""instanceStateTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (394, '        <property name=""name"" value=""instanceStateTrigger""/>'), (395, '        <property name=""group"" value=""instanceState""/>'), (396, '        <property name=""jobDetail"" ref=""instanceStateJobDetail""/>'), (397, '        <property name=""cronExpression"" value=""0 0/10 * ? * *""/>'), (398, '    </bean>'), (399, '</beans>')], 'deleted': []}"
194,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/spring/spring.xml,spring.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"">'), (6, '    <import resource=""classpath:spring/spring-quartz.xml""/>'), (7, '    <import resource=""classpath:spring/spring-mybatis.xml""/>'), (8, '    <import resource=""classpath:spring/spring-data.xml""/>'), (9, '    <import resource=""classpath:spring/spring-mvc.xml""/>'), (10, '\t<import resource=""classpath:spring/spring-client-report.xml""/>'), (11, '\t<import resource=""classpath:spring/spring-inspector.xml""/>'), (12, '</beans>')], 'deleted': []}"
195,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/access/app-apply.png,app-apply.png,1,"{'added': [], 'deleted': []}"
196,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/access/baseinfo.png,baseinfo.png,1,"{'added': [], 'deleted': []}"
197,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/access/config.png,config.png,1,"{'added': [], 'deleted': []}"
198,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/access/deploy.png,deploy.png,1,"{'added': [], 'deleted': []}"
199,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/access/globalconfig.png,globalconfig.png,1,"{'added': [], 'deleted': []}"
200,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/access/login.png,login.png,1,"{'added': [], 'deleted': []}"
201,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/app-analysis-application.png,app-analysis-application.png,1,"{'added': [], 'deleted': []}"
202,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/app-analysis.png,app-analysis.png,1,"{'added': [], 'deleted': []}"
203,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-appCmd.png,client-appCmd.png,1,"{'added': [], 'deleted': []}"
204,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-appDetail.png,client-appDetail.png,1,"{'added': [], 'deleted': []}"
205,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-appStatsInfoImg.jpg,client-appStatsInfoImg.jpg,1,"{'added': [], 'deleted': []}"
206,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-application-tag.png,client-application-tag.png,1,"{'added': [], 'deleted': []}"
207,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-application.png,client-application.png,1,"{'added': [], 'deleted': []}"
208,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-apps.png,client-apps.png,1,"{'added': [], 'deleted': []}"
209,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-capacity.png,client-capacity.png,1,"{'added': [], 'deleted': []}"
210,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-code.png,client-code.png,1,"{'added': [], 'deleted': []}"
211,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-codeImg.jpg,client-codeImg.jpg,1,"{'added': [], 'deleted': []}"
212,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-instancelist.png,client-instancelist.png,1,"{'added': [], 'deleted': []}"
213,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-login.png,client-login.png,1,"{'added': [], 'deleted': []}"
214,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-process.png,client-process.png,1,"{'added': [], 'deleted': []}"
215,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-register.png,client-register.png,1,"{'added': [], 'deleted': []}"
216,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-statistic.png,client-statistic.png,1,"{'added': [], 'deleted': []}"
217,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-statsInfo.jpg,client-statsInfo.jpg,1,"{'added': [], 'deleted': []}"
218,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-statsInfo1.jpg,client-statsInfo1.jpg,1,"{'added': [], 'deleted': []}"
219,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-statsInfo2.jpg,client-statsInfo2.jpg,1,"{'added': [], 'deleted': []}"
220,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/client-topology.png,client-topology.png,1,"{'added': [], 'deleted': []}"
221,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/command-statistic-all.png,command-statistic-all.png,1,"{'added': [], 'deleted': []}"
222,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/command-statistic-client.png,command-statistic-client.png,1,"{'added': [], 'deleted': []}"
223,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/command-statistic.png,command-statistic.png,1,"{'added': [], 'deleted': []}"
224,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/command-statistic1.png,command-statistic1.png,1,"{'added': [], 'deleted': []}"
225,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/command-statistic2.png,command-statistic2.png,1,"{'added': [], 'deleted': []}"
226,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/exception-statistic-client-cmd.png,exception-statistic-client-cmd.png,1,"{'added': [], 'deleted': []}"
227,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/exception-statistic-client-conn.png,exception-statistic-client-conn.png,1,"{'added': [], 'deleted': []}"
228,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/exception-statistic-client.png,exception-statistic-client.png,1,"{'added': [], 'deleted': []}"
229,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/exception-statistic-client1.png,exception-statistic-client1.png,1,"{'added': [], 'deleted': []}"
230,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/exception-statistic.png,exception-statistic.png,1,"{'added': [], 'deleted': []}"
231,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/instance-config.png,instance-config.png,1,"{'added': [], 'deleted': []}"
232,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/instance-configEdit.png,instance-configEdit.png,1,"{'added': [], 'deleted': []}"
233,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/instance-connInfo.png,instance-connInfo.png,1,"{'added': [], 'deleted': []}"
234,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/instance-slowlog.png,instance-slowlog.png,1,"{'added': [], 'deleted': []}"
235,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/client/instance-stats.png,instance-stats.png,1,"{'added': [], 'deleted': []}"
236,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/exception.png,exception.png,1,"{'added': [], 'deleted': []}"
237,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/flowChart.png,flowChart.png,1,"{'added': [], 'deleted': []}"
238,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/fragratio.png,fragratio.png,1,"{'added': [], 'deleted': []}"
239,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/appAlterConfig.png,appAlterConfig.png,1,"{'added': [], 'deleted': []}"
240,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/appClean.png,appClean.png,1,"{'added': [], 'deleted': []}"
241,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/appConfig.png,appConfig.png,1,"{'added': [], 'deleted': []}"
242,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/appDelKey.png,appDelKey.png,1,"{'added': [], 'deleted': []}"
243,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/appDiagnostic.png,appDiagnostic.png,1,"{'added': [], 'deleted': []}"
244,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/appInit.png,appInit.png,1,"{'added': [], 'deleted': []}"
245,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/appKeyAnalysis.png,appKeyAnalysis.png,1,"{'added': [], 'deleted': []}"
246,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/appOffline.png,appOffline.png,1,"{'added': [], 'deleted': []}"
247,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/appScale.png,appScale.png,1,"{'added': [], 'deleted': []}"
248,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/auditList.png,auditList.png,1,"{'added': [], 'deleted': []}"
249,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/jobList.png,jobList.png,1,"{'added': [], 'deleted': []}"
250,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/job/myJobs.png,myJobs.png,1,"{'added': [], 'deleted': []}"
251,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/mem.png,mem.png,1,"{'added': [], 'deleted': []}"
252,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/app-detail.png,app-detail.png,1,"{'added': [], 'deleted': []}"
253,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/app-machines.png,app-machines.png,1,"{'added': [], 'deleted': []}"
254,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/app-migrate.png,app-migrate.png,1,"{'added': [], 'deleted': []}"
255,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/app-operation-cluster.png,app-operation-cluster.png,1,"{'added': [], 'deleted': []}"
256,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/app-operation-sentinel.png,app-operation-sentinel.png,1,"{'added': [], 'deleted': []}"
257,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/app-redisPassword.png,app-redisPassword.png,1,"{'added': [], 'deleted': []}"
258,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/app-topologyExam.png,app-topologyExam.png,1,"{'added': [], 'deleted': []}"
259,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-alter-app.png,cc-alter-app.png,1,"{'added': [], 'deleted': []}"
260,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-alter-special.png,cc-alter-special.png,1,"{'added': [], 'deleted': []}"
261,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-alter.png,cc-alter.png,1,"{'added': [], 'deleted': []}"
262,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-configuration.png,cc-configuration.png,1,"{'added': [], 'deleted': []}"
263,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-redisConfiguration.png,cc-redisConfiguration.png,1,"{'added': [], 'deleted': []}"
264,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-redisVersion.png,cc-redisVersion.png,1,"{'added': [], 'deleted': []}"
265,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-taskflow-appDeplogy-detail1.png,cc-taskflow-appDeplogy-detail1.png,1,"{'added': [], 'deleted': []}"
266,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-taskflow-appDeplogy-detail2.png,cc-taskflow-appDeplogy-detail2.png,1,"{'added': [], 'deleted': []}"
267,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-taskflow-appDeplogy-detail3.png,cc-taskflow-appDeplogy-detail3.png,1,"{'added': [], 'deleted': []}"
268,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-taskflow-appDeplogy.png,cc-taskflow-appDeplogy.png,1,"{'added': [], 'deleted': []}"
269,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-taskflow.png,cc-taskflow.png,1,"{'added': [], 'deleted': []}"
270,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-trigger.png,cc-trigger.png,1,"{'added': [], 'deleted': []}"
271,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/cc-user.png,cc-user.png,1,"{'added': [], 'deleted': []}"
272,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/key-analysis-taskflow.png,key-analysis-taskflow.png,1,"{'added': [], 'deleted': []}"
273,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/key-analysis.png,key-analysis.png,1,"{'added': [], 'deleted': []}"
274,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/machine-mem.png,machine-mem.png,1,"{'added': [], 'deleted': []}"
275,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/machine-room.png,machine-room.png,1,"{'added': [], 'deleted': []}"
276,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/quartz.png,quartz.png,1,"{'added': [], 'deleted': []}"
277,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/redisversion.png,redisversion.png,1,"{'added': [], 'deleted': []}"
278,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-cli-stats.png,server-cli-stats.png,1,"{'added': [], 'deleted': []}"
279,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-cluster.png,server-cluster.png,1,"{'added': [], 'deleted': []}"
280,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-expand-hor.png,server-expand-hor.png,1,"{'added': [], 'deleted': []}"
281,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-expand.png,server-expand.png,1,"{'added': [], 'deleted': []}"
282,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-fun.png,server-fun.png,1,"{'added': [], 'deleted': []}"
283,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-machine-add.png,server-machine-add.png,1,"{'added': [], 'deleted': []}"
284,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-machine.png,server-machine.png,1,"{'added': [], 'deleted': []}"
285,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-operate.png,server-operate.png,1,"{'added': [], 'deleted': []}"
286,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-operation.png,server-operation.png,1,"{'added': [], 'deleted': []}"
287,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-sentinel.png,server-sentinel.png,1,"{'added': [], 'deleted': []}"
288,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-standalone-deploy.png,server-standalone-deploy.png,1,"{'added': [], 'deleted': []}"
289,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-standalone.png,server-standalone.png,1,"{'added': [], 'deleted': []}"
290,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-user-add.png,server-user-add.png,1,"{'added': [], 'deleted': []}"
291,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/server-user.png,server-user.png,1,"{'added': [], 'deleted': []}"
292,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/task.png,task.png,1,"{'added': [], 'deleted': []}"
293,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/taskmanage.png,taskmanage.png,1,"{'added': [], 'deleted': []}"
294,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/server/total.png,total.png,1,"{'added': [], 'deleted': []}"
295,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/function/topology.png,topology.png,1,"{'added': [], 'deleted': []}"
296,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/intro/global.png,global.png,1,"{'added': [], 'deleted': []}"
297,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/intro/slove.png,slove.png,1,"{'added': [], 'deleted': []}"
298,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/intro/statistic.png,statistic.png,1,"{'added': [], 'deleted': []}"
299,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/alert/alert-when-apply.png,alert-when-apply.png,1,"{'added': [], 'deleted': []}"
300,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/alert/app-alert-config.png,app-alert-config.png,1,"{'added': [], 'deleted': []}"
301,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/alert/app-alert.png,app-alert.png,1,"{'added': [], 'deleted': []}"
302,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/alert/redis-alert-common.png,redis-alert-common.png,1,"{'added': [], 'deleted': []}"
303,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/alert/redis-alert-special-config.png,redis-alert-special-config.png,1,"{'added': [], 'deleted': []}"
304,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/alert/redis-alert-special.png,redis-alert-special.png,1,"{'added': [], 'deleted': []}"
305,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appDeploy/app_deal.png,app_deal.png,1,"{'added': [], 'deleted': []}"
306,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appDeploy/app_deploy.png,app_deploy.png,1,"{'added': [], 'deleted': []}"
307,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appDeploy/app_reject.png,app_reject.png,1,"{'added': [], 'deleted': []}"
308,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appDeploy/deploy_taskflow.png,deploy_taskflow.png,1,"{'added': [], 'deleted': []}"
309,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appDeploy/instance-status.png,instance-status.png,1,"{'added': [], 'deleted': []}"
310,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appDeploy/machine_info.png,machine_info.png,1,"{'added': [], 'deleted': []}"
311,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appDeploy/skip.png,skip.png,1,"{'added': [], 'deleted': []}"
312,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate0.png,app-migrate0.png,1,"{'added': [], 'deleted': []}"
313,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate1.png,app-migrate1.png,1,"{'added': [], 'deleted': []}"
314,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate2.png,app-migrate2.png,1,"{'added': [], 'deleted': []}"
315,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate3.png,app-migrate3.png,1,"{'added': [], 'deleted': []}"
316,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate4.png,app-migrate4.png,1,"{'added': [], 'deleted': []}"
317,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate5.png,app-migrate5.png,1,"{'added': [], 'deleted': []}"
318,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate6.png,app-migrate6.png,1,"{'added': [], 'deleted': []}"
319,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate7.png,app-migrate7.png,1,"{'added': [], 'deleted': []}"
320,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/appMigrate/app-migrate8.png,app-migrate8.png,1,"{'added': [], 'deleted': []}"
321,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-enter-migtool.png,cc-enter-migtool.png,1,"{'added': [], 'deleted': []}"
322,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-addtask.png,cc-migrate-addtask.png,1,"{'added': [], 'deleted': []}"
323,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-checklog.png,cc-migrate-checklog.png,1,"{'added': [], 'deleted': []}"
324,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-checkres.png,cc-migrate-checkres.png,1,"{'added': [], 'deleted': []}"
325,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-checkres1.png,cc-migrate-checkres1.png,1,"{'added': [], 'deleted': []}"
326,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-checkres2.png,cc-migrate-checkres2.png,1,"{'added': [], 'deleted': []}"
327,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-client1.png,cc-migrate-client1.png,1,"{'added': [], 'deleted': []}"
328,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-client2.png,cc-migrate-client2.png,1,"{'added': [], 'deleted': []}"
329,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-client3.png,cc-migrate-client3.png,1,"{'added': [], 'deleted': []}"
330,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-client4.png,cc-migrate-client4.png,1,"{'added': [], 'deleted': []}"
331,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-client5.png,cc-migrate-client5.png,1,"{'added': [], 'deleted': []}"
332,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-machine.png,cc-migrate-machine.png,1,"{'added': [], 'deleted': []}"
333,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-redis-migtool-dir.png,cc-migrate-redis-migtool-dir.png,1,"{'added': [], 'deleted': []}"
334,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-redis-shake-dir.png,cc-migrate-redis-shake-dir.png,1,"{'added': [], 'deleted': []}"
335,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-start-check.png,cc-migrate-start-check.png,1,"{'added': [], 'deleted': []}"
336,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-tasklist.png,cc-migrate-tasklist.png,1,"{'added': [], 'deleted': []}"
337,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/cc-migrate-tool.png,cc-migrate-tool.png,1,"{'added': [], 'deleted': []}"
338,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/migratetool.png,migratetool.png,1,"{'added': [], 'deleted': []}"
339,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/migrate/redis-shake.png,redis-shake.png,1,"{'added': [], 'deleted': []}"
340,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/cluster.png,cluster.png,1,"{'added': [], 'deleted': []}"
341,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/cmd.png,cmd.png,1,"{'added': [], 'deleted': []}"
342,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/data-clear.png,data-clear.png,1,"{'added': [], 'deleted': []}"
343,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/jedis-pool.png,jedis-pool.png,1,"{'added': [], 'deleted': []}"
344,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/machine-room.png,machine-room.png,1,"{'added': [], 'deleted': []}"
345,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/profile-modify.png,profile-modify.png,1,"{'added': [], 'deleted': []}"
346,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/profile-modify2.png,profile-modify2.png,1,"{'added': [], 'deleted': []}"
347,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/profile-modify3.png,profile-modify3.png,1,"{'added': [], 'deleted': []}"
348,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/publish.png,publish.png,1,"{'added': [], 'deleted': []}"
349,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/redis-type.png,redis-type.png,1,"{'added': [], 'deleted': []}"
350,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/sentinel.png,sentinel.png,1,"{'added': [], 'deleted': []}"
351,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/operate/standalone.png,standalone.png,1,"{'added': [], 'deleted': []}"
352,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/optimize/aof-schedule.png,aof-schedule.png,1,"{'added': [], 'deleted': []}"
353,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/optimize/pipeline.png,pipeline.png,1,"{'added': [], 'deleted': []}"
354,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/version/dir.png,dir.png,1,"{'added': [], 'deleted': []}"
355,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/version/redis.png,redis.png,1,"{'added': [], 'deleted': []}"
356,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/version/respo.png,respo.png,1,"{'added': [], 'deleted': []}"
357,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/version/script.png,script.png,1,"{'added': [], 'deleted': []}"
358,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/version/tool.png,tool.png,1,"{'added': [], 'deleted': []}"
359,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/version/upgrade-process.png,upgrade-process.png,1,"{'added': [], 'deleted': []}"
360,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/version/upgrade.png,upgrade.png,1,"{'added': [], 'deleted': []}"
361,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/operate/version/versionConfig.png,versionConfig.png,1,"{'added': [], 'deleted': []}"
362,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/quickstart/addmachine.png,addmachine.png,1,"{'added': [], 'deleted': []}"
363,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/quickstart/appdeploy.png,appdeploy.png,1,"{'added': [], 'deleted': []}"
364,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/quickstart/appjob.png,appjob.png,1,"{'added': [], 'deleted': []}"
365,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/quickstart/apptask.png,apptask.png,1,"{'added': [], 'deleted': []}"
366,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/quickstart/login.png,login.png,1,"{'added': [], 'deleted': []}"
367,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/quickstart/quickstart.png,quickstart.png,1,"{'added': [], 'deleted': []}"
368,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/quickstart/register.png,register.png,1,"{'added': [], 'deleted': []}"
369,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/readme/CacheCloud功能架构.png,CacheCloud功能架构.png,1,"{'added': [], 'deleted': []}"
370,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/readme/cachecloud.png,cachecloud.png,1,"{'added': [], 'deleted': []}"
371,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/readme/subcribe.png,subcribe.png,1,"{'added': [], 'deleted': []}"
372,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/readme/user.png,user.png,1,"{'added': [], 'deleted': []}"
373,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/readme/wechat.png,wechat.png,1,"{'added': [], 'deleted': []}"
374,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/NTP.png,NTP.png,1,"{'added': [], 'deleted': []}"
375,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/activefrag-code.png,activefrag-code.png,1,"{'added': [], 'deleted': []}"
376,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/bigkey/bandwidth.png,bandwidth.png,1,"{'added': [], 'deleted': []}"
377,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/bigkey/debug-obj-key.png,debug-obj-key.png,1,"{'added': [], 'deleted': []}"
378,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/bigkey/strlen-key.png,strlen-key.png,1,"{'added': [], 'deleted': []}"
379,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/clientbuffer.png,clientbuffer.png,1,"{'added': [], 'deleted': []}"
380,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/cpu-monitor.png,cpu-monitor.png,1,"{'added': [], 'deleted': []}"
381,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/del-compare.png,del-compare.png,1,"{'added': [], 'deleted': []}"
382,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/del-cost.png,del-cost.png,1,"{'added': [], 'deleted': []}"
383,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/delstr-cost.png,delstr-cost.png,1,"{'added': [], 'deleted': []}"
384,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/hotkey/hotkey-monitor.png,hotkey-monitor.png,1,"{'added': [], 'deleted': []}"
385,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/hotkey/hotkey-proxy.png,hotkey-proxy.png,1,"{'added': [], 'deleted': []}"
386,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/hotkey/hotkey-tcppacket.png,hotkey-tcppacket.png,1,"{'added': [], 'deleted': []}"
387,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/jedispool.png,jedispool.png,1,"{'added': [], 'deleted': []}"
388,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/machine-cpu-monitor.png,machine-cpu-monitor.png,1,"{'added': [], 'deleted': []}"
389,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/mem-imbalance.png,mem-imbalance.png,1,"{'added': [], 'deleted': []}"
390,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/SDS-example1.png,SDS-example1.png,1,"{'added': [], 'deleted': []}"
391,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/SDS-example2.png,SDS-example2.png,1,"{'added': [], 'deleted': []}"
392,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/SDS-example3.png,SDS-example3.png,1,"{'added': [], 'deleted': []}"
393,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/SDS.png,SDS.png,1,"{'added': [], 'deleted': []}"
394,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/comparison-of-serializaiton-tools.png,comparison-of-serializaiton-tools.png,1,"{'added': [], 'deleted': []}"
395,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/hash-encoding-transform.png,hash-encoding-transform.png,1,"{'added': [], 'deleted': []}"
396,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/intset-structure.png,intset-structure.png,1,"{'added': [], 'deleted': []}"
397,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/keys-hash.png,keys-hash.png,1,"{'added': [], 'deleted': []}"
398,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/redis-object.png,redis-object.png,1,"{'added': [], 'deleted': []}"
399,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/refcount.png,refcount.png,1,"{'added': [], 'deleted': []}"
400,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/img/troubleshooting/memory/ziplist-structure.png,ziplist-structure.png,1,"{'added': [], 'deleted': []}"
401,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/access/client.md,client.md,1,"{'added': [(1, '<a name=""access""/>'), (2, ''), (3, '## 一、<span id=""cc1"">Java接入方法</span>'), (4, ''), (5, '### 1、<span id=""cc12"">cachecloud-client-redis接入方式</span>'), (6, ''), (7, '**Maven坐标:**'), (8, ''), (9, '```'), (10, '<!-- cachecloud封装的jedis客户端，需要用cachecloud-client下的jedis模块打包 -->'), (11, '<dependency>'), (12, '    <groupId>redis.clients</groupId>'), (13, '    <artifactId>jedis</artifactId>'), (14, '    <version>x.y.z-RELEASE</version>'), (15, '</dependency>'), (16, ''), (17, '<!-- cachecloud客户端 -->'), (18, '<dependency>'), (19, '    <groupId>com.sohu.tv</groupId>'), (20, '    <artifactId>cachecloud-client-redis</artifactId>'), (21, '    <version>u.v.w-RELEASE</version>'), (22, '</dependency>'), (23, ''), (24, '<!-- 公司内部Nexus仓库配置 -->'), (25, '<repositories>'), (26, '    <repository>'), (27, '        <id>xx.nexus</id>'), (28, '        <url>http://xx/nexus/content/groups/public</url>'), (29, '    </repository>'), (30, '</repositories>'), (31, ''), (32, '```'), (33, ''), (34, '**Configuration:**'), (35, ''), (36, '```'), (37, '@Configuration'), (38, 'public class RedisConfiguration {'), (39, ''), (40, '    /**'), (41, '     * Redis Cluster'), (42, '     */'), (43, '    @Bean(destroyMethod = ""close"")'), (44, '    public PipelineCluster pipelineCluster(@Value(""${cachecloud.demo.appId}"") long appId) {'), (45, '        //默认配置'), (46, '        PipelineCluster pipelineCluster = ClientBuilder.redisCluster(appId).build();'), (47, '        return pipelineCluster;'), (48, '    }'), (49, ''), (50, '    /**'), (51, '     * Redis Sentinel'), (52, '     */'), (53, '    @Bean(destroyMethod = ""destroy"")'), (54, '    public JedisSentinelPool jedisSentinelPool(@Value(""${cachecloud.demo.appId}"") long appId) {'), (55, '        //默认配置'), (56, '        JedisSentinelPool jedisSentinelPool = ClientBuilder.redisSentinel(appId).build();'), (57, '        return jedisSentinelPool;'), (58, '    }'), (59, ''), (60, '    /**'), (61, '     * Redis Standalone'), (62, '     */'), (63, '    @Bean(destroyMethod = ""destroy"")'), (64, '    public JedisPool jedisPool(@Value(""${cachecloud.demo.appId}"") long appId) {'), (65, '        //默认配置'), (66, '        JedisPool jedisPool = ClientBuilder.redisStandalone(appId).build();'), (67, '        return jedisPool;'), (68, '    }'), (69, '}'), (70, ''), (71, ''), (72, '```'), (73, '**Usage:**'), (74, '```'), (75, '@Component'), (76, '@Slf4j'), (77, 'public class RedisDao {'), (78, ''), (79, '    @Autowired'), (80, '    private PipelineCluster pipelineCluster;'), (81, ''), (82, '    @Autowired'), (83, '    private JedisSentinelPool jedisSentinelPool;'), (84, ''), (85, '    @Autowired'), (86, '    private JedisPool jedisPool;'), (87, ''), (88, '    public String getFromCluster(String key) {'), (89, '        String value = pipelineCluster.get(key);'), (90, '        log.info(""value={}"", value);'), (91, '        return value;'), (92, '    }'), (93, ''), (94, '    public String getFromSentinel(String key) {'), (95, '        Jedis jedis = null;'), (96, '        try {'), (97, '            jedis = jedisSentinelPool.getResource();'), (98, '            String value = jedis.get(key);'), (99, '            log.info(""value={}"", value);'), (100, '            return value;'), (101, '        } catch (Exception e) {'), (102, '            log.error(e.getMessage(), e);'), (103, '        } finally {'), (104, '            if (jedis != null) {'), (105, '                jedis.close();'), (106, '            }'), (107, '        }'), (108, '        return null;'), (109, '    }'), (110, ''), (111, '    public String getFromStandalone(String key) {'), (112, '        Jedis jedis = null;'), (113, '        try {'), (114, '            jedis = jedisPool.getResource();'), (115, '            String value = jedis.get(key);'), (116, '            log.info(""value={}"", value);'), (117, '            return value;'), (118, '        } catch (Exception e) {'), (119, '            log.error(e.getMessage(), e);'), (120, '        } finally {'), (121, '            if (jedis != null) {'), (122, '                jedis.close();'), (123, '            }'), (124, '        }'), (125, '        return null;'), (126, '    }'), (127, '}'), (128, ''), (129, '```'), (130, ''), (131, ''), (132, '### 2、<span id=""cc3"">cachecloud-client-lettuce接入方式</span>'), (133, ''), (134, '**Maven坐标:**'), (135, ''), (136, '```'), (137, ''), (138, '<!-- lettuce客户端依赖 -->'), (139, '<dependency>'), (140, '    <groupId>com.sohu.tv</groupId>'), (141, '    <artifactId>cachecloud-client-lettuce</artifactId>'), (142, '    <version>x.y.z-RELEASE</version>'), (143, '</dependency>'), (144, ''), (145, '```'), (146, ''), (147, '**Configuration:**'), (148, '```'), (149, '@Configuration'), (150, 'public class LettuceConfiguration {'), (151, ''), (152, '    @Bean'), (153, '    public ClientResources.Builder clientResourcesBuilder() {'), (154, '        return DefaultClientResources.builder()'), (155, '                .ioThreadPoolSize(8)'), (156, '                .computationThreadPoolSize(10);'), (157, '    }'), (158, ''), (159, '    @Bean'), (160, '    public ClusterClientOptions.Builder clusterClientOptionsBuilder() {'), (161, '        SocketOptions socketOptions = SocketOptions.builder().keepAlive(true).tcpNoDelay(false)'), (162, '                .connectTimeout(Duration.ofSeconds(5)).build();'), (163, ''), (164, '        ClusterClientOptions.Builder clientOptionsBuilder = ClusterClientOptions.builder()'), (165, '                .timeoutOptions(TimeoutOptions.enabled(Duration.ofSeconds(5)))'), (166, '                .socketOptions(socketOptions);'), (167, ''), (168, '        return clientOptionsBuilder;'), (169, '    }'), (170, ''), (171, '    @Bean(destroyMethod = ""shutdown"")'), (172, '    public RedisClusterClient redisClusterClient(@Value(""${cachecloud.demo.appId}"") long appId,'), (173, '                                                 @Value(""${cachecloud.demo.password}"") String password,'), (174, '                                                 ClientResources.Builder clientResourcesBuilder,'), (175, '                                                 ClusterClientOptions.Builder clusterClientOptionsBuilder) {'), (176, ''), (177, '        RedisClusterClient redisClusterClient = LettuceClientBuilder'), (178, '                .redisCluster(appId, password)'), (179, '                .setClientResourcesBuilder(clientResourcesBuilder)'), (180, '                .setClusterClientOptionsBuilder(clusterClientOptionsBuilder)'), (181, '                .build();'), (182, ''), (183, '        return redisClusterClient;'), (184, '    }'), (185, ''), (186, '    @Bean(destroyMethod = ""close"")'), (187, '    public StatefulRedisClusterConnection<String, String> clusterConnection(RedisClusterClient redisClusterClient) {'), (188, ''), (189, '        StatefulRedisClusterConnection<String, String> connection = redisClusterClient.connect();'), (190, '        connection.setReadFrom(ReadFrom.REPLICA_PREFERRED);'), (191, '        return connection;'), (192, '    }'), (193, ''), (194, '}'), (195, ''), (196, '```'), (197, '**Usage:**'), (198, '```'), (199, '@Component'), (200, '@Slf4j'), (201, 'public class RedisDao {'), (202, ''), (203, '    @Autowired'), (204, '    private StatefulRedisClusterConnection<String, String> clusterConnection;'), (205, ''), (206, '    public String get(String key){'), (207, '        RedisAdvancedClusterCommands<String, String> clusterCommands = clusterConnection.sync();'), (208, '        String value = clusterCommands.get(key);'), (209, '        log.info(""value={}"", value);'), (210, '        return value;'), (211, '    }'), (212, '}'), (213, '```'), (214, ''), (215, '### 3、<span id=""cc4"">跨机房客户端cachecloud-client-crossroom-redis接入方式</span>'), (216, ''), (217, '**Maven坐标:**'), (218, ''), (219, '```'), (220, '<!-- 跨机房客户端依赖 -->'), (221, '<dependency>'), (222, '    <groupId>com.sohu.tv</groupId>'), (223, '    <artifactId>cachecloud-client-crossroom-redis</artifactId>'), (224, '    <version>x.y.z-RELEASE</version>'), (225, '</dependency>'), (226, ''), (227, '```'), (228, ''), (229, '**Configuration:**'), (230, '```'), (231, '@Configuration'), (232, 'public class RedisConfiguration {'), (233, ''), (234, '    /**'), (235, '     * 需要同一个业务申请两个应用，部署在不同机房，目前支持两个机房的跨机房使用'), (236, '     *'), (237, '     * @param majorAppId 部署在机房一的应用Id'), (238, '     * @param minorAppId 部署在机房二的应用Id'), (239, '     */'), (240, '    @Bean'), (241, '    public RedisCrossRoomClient redisCrossRoomClient(@Value(""${cachecloud.demo.majorAppId}"") long majorAppId,'), (242, '                                                     @Value(""${cachecloud.demo.minorAppId}"") long minorAppId) {'), (243, '        PipelineCluster majorPipelineCluster = ClientBuilder.redisCluster(majorAppId).build();'), (244, '        PipelineCluster minorPipelineCluster = ClientBuilder.redisCluster(minorAppId).build();'), (245, '        RedisCrossRoomClient redisCrossRoomClient = RedisCrossRoomClientBuilder'), (246, '                .redisCluster(majorAppId, majorPipelineCluster, minorAppId, minorPipelineCluster)'), (247, '                .build();'), (248, '        return redisCrossRoomClient;'), (249, '    }'), (250, '}'), (251, ''), (252, '```'), (253, ''), (254, '**usage:** 和cachecloud-client-redis使用方式相同'), (255, ''), (256, '## 二、<span id=""cc2"">REST API接入方法</span>'), (257, ''), (258, '### (1) 接口地址'), (259, '\thttp://ip:port/cache/client/redis/{appType}/{appId}.json?clientVersion={clientVersion}'), (260, ''), (261, '\tappType=cluster|sentinel|standalone'), (262, ''), (263, '\tappId是应用id'), (264, ''), (265, '\tclientVersion是客户端版本'), (266, ''), (267, '### (2) REST接口结果'), (268, '\t{'), (269, '\t  message: ""client is up to date, Cheers!"",'), (270, '\t  shardNum: 10,'), (271, '\t  appId: 10192,'), (272, '\t  status: 1,'), (273, '\t  shardInfo: ""10.10.xx.xx:6390,10.10.xx.xx:6382 10.10.xx.xx:6387,10.10.xx.xx:6379 10.10.xx.xx:6387,10.10.xx.xx:7382 10.10.xx.xx:6380,10.10.xx.xx:6392""'), (274, '\t}'), (275, ''), (276, '## <span id=""cc3"">三、python客户端接入</span>'), (277, ''), (278, '**Redis Cluster:** 这里使用支持集群模式的python客户端[redis-py-cluster](https://github.com/Grokzen/redis-py-cluster)，需要先安装 `` pip install redis-py-cluster ``'), (279, ''), (280, '```'), (281, 'import requests'), (282, 'from rediscluster import RedisCluster'), (283, ''), (284, 'app_id = 10782'), (285, ""redis_type = 'cluster'""), (286, ""password = 'password'""), (287, ""domain = 'xxx.com'""), (288, ''), (289, ""url = 'http://{0}/cache/client/redis/{1}/{2}.json?clientVersion=2.0.3-RELEASE'.format(domain, redis_type, app_id)""), (290, ''), (291, 'response = requests.get(url, timeout=1)'), (292, ''), (293, 'json = response.json()'), (294, ''), (295, ""shard_info_array = json['shardInfo'].split(' ')""), (296, ''), (297, ""seed = {'host': 'localhost', 'port': '6379'}""), (298, ''), (299, 'if len(shard_info_array) > 0:'), (300, ""    seed['host'] = shard_info_array[0].split(':')[0]""), (301, ""    seed['port'] = shard_info_array[0].split(':')[1]""), (302, ''), (303, 'startup_nodes = [seed]'), (304, ''), (305, '# Note: decode_responses must be set to True when used with python3'), (306, 'rc = RedisCluster(startup_nodes=startup_nodes, decode_responses=True, password=password)'), (307, ''), (308, 'rc.set(""foo"", ""bar"")'), (309, ''), (310, 'print(rc.get(""foo""))'), (311, ''), (312, '```'), (313, ''), (314, '**Redis Sentinel&Standalone:** 使用[redis.io](https://redis.io/clients#python)推荐的python客户端[redis-py](https://github.com/andymccurdy/redis-py)，'), (315, '需要先安装 `` pip install redis-py ``'), (316, ''), (317, 'Redis Sentinel:'), (318, ''), (319, '```'), (320, 'from redis.sentinel import Sentinel'), (321, 'import requests'), (322, ''), (323, 'app_id = 10669'), (324, ""redis_type = 'sentinel'""), (325, ""password = 'password'""), (326, ""domain = 'xxx.com'""), (327, ''), (328, ""url = 'http://{0}/cache/client/redis/{1}/{2}.json?clientVersion=2.0.3-RELEASE'.format(domain, redis_type, app_id)""), (329, ''), (330, 'response = requests.get(url, timeout=1)'), (331, ''), (332, 'json = response.json()'), (333, ''), (334, ""sentinels_array = json['sentinels'].split(' ')""), (335, ''), (336, 'sentinels = []'), (337, ''), (338, 'for node in sentinels_array:'), (339, ""    sentinels.append((node.split(':')))""), (340, ''), (341, ""master_name = json['masterName']""), (342, ''), (343, 'sentinel = Sentinel(sentinels)'), (344, ''), (345, 'master = sentinel.master_for(master_name, socket_timeout=1, password=password)'), (346, ''), (347, 'master.set(""key1"", ""value"")'), (348, ''), (349, ""v1 = master.get('key1')""), (350, ''), (351, 'print(v1)'), (352, ''), (353, '```'), (354, 'Redis Standalone:'), (355, ''), (356, '```'), (357, 'import redis'), (358, 'import requests'), (359, ''), (360, 'app_id = 10744'), (361, ""redis_type = 'standalone'""), (362, ""password = 'password'""), (363, ""domain = 'xxx.com'""), (364, ''), (365, ""url = 'http://{0}/cache/client/redis/{0}/{1}.json?clientVersion=2.0.3-RELEASE'.format(domain, redis_type, app_id)""), (366, ''), (367, 'response = requests.get(url, timeout=1)'), (368, ''), (369, 'json = response.json()'), (370, ''), (371, ""host_port = json['standalone'].split(':')""), (372, ''), (373, ""host = 'localhost'""), (374, 'port = 6379'), (375, ''), (376, 'if len(host_port) > 0:'), (377, '    host = host_port[0]'), (378, '    port = host_port[1]'), (379, ''), (380, 'r = redis.Redis(host=host, port=port, password=password)'), (381, ''), (382, ""v2 = r.get('key1')""), (383, ''), (384, 'print(v2)'), (385, ''), (386, '```'), (387, ''), (388, '')], 'deleted': []}"
402,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/access/client.toc.md,client.toc.md,1,"{'added': [(1, '##### 目录'), (2, '* [一、Java接入方式](#cc1)'), (3, '    - [1.cachecloud-client-redis接入方式](#cc12)'), (4, '    - [2.cachecloud-client-lettuce接入方式](#cc13)'), (5, '    - [3.跨机房客户端cachecloud-client-crossroom-redis接入方式](#cc13)'), (6, '* [二、REST API接入方式](#cc2)'), (7, '* [三、Python接入方式](#cc3)')], 'deleted': []}"
403,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/access/config.md,config.md,1,"{'added': [(1, '## 系统全局配置说明'), (2, ''), (3, '### 一、系统配置说明'), (4, ''), (5, '在早期的CacheCloud版本中，许多配置需要对源码进行一些修复，对于一些运维人员以及对java不太熟悉的朋友来说不是很友好，为此添加了系统配置页面，系统配置页面可以动态修改系统的一些配置，例如ssh的相关信息，客户端版本信息，机器报警阀值，文档地址、maven仓库、手机和邮件报警、值班联系人配置等等，具体示意图如下：'), (6, ''), (7, '<img src=""../../img/access/globalconfig.png"" width=""80%""/>'), (8, ''), (9, '### 二、详细说明'), (10, ''), (11, '#### 1.ssh相关配置：'), (12, ''), (13, 'ssh配置主要是打通cachecloud服务器与Redis机器交互通讯方式。'), (14, ''), (15, '> 1.1 ssh授权方式：'), (16, ''), (17, '- ssh授权方式'), (18, ''), (19, '````'), (20, 'cachecloud.ssh.auth.type = (1：密码，2：public key)'), (21, ''), (22, '````'), (23, ''), (24, '> 1.2 ssh用户名密码配置:'), (25, ''), (26, '- ssh用户名'), (27, '- ssh密码'), (28, '- ssh端口'), (29, ''), (30, '```'), (31, 'cachecloud.machine.username = cachecloud'), (32, 'cachecloud.machine.password = cachecloud'), (33, 'cachecloud.machine.ssh.port = 22'), (34, '```'), (35, ''), (36, '> 1.3 [ssh公钥配置](../operate/ssh.md):'), (37, ''), (38, '- 公钥用户名'), (39, '- 密钥路径'), (40, ''), (41, '````'), (42, 'cachecloud.public.key.pem = /opt/ssh/id_rsa (cachecloud服务器上路径)'), (43, 'cachecloud.public.user.name = cachecloud'), (44, '````'), (45, ''), (46, '#### 2.管理员配置:'), (47, ''), (48, '- admin用户名：cachecloud超级管理员登录名'), (49, '- admin密码： cachecloud超级管理员密码'), (50, '- 超级管理员组: 除了admin，可以添加其他成员，用于做下线的操作(超级管理员与普通管理员的区别：目前只是下线应用)'), (51, ''), (52, '#### 3.机器报警阀值：'), (53, 'cachecloud会定期对机器重要指标进行检测进行报警(报警实现请参考：https://github.com/sohutv/cachecloud/wiki/3.%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%8E%A5%E5%85%A5%E6%96%87%E6%A1%A3#cc5-2)'), (54, ''), (55, '- cpu报警阀值'), (56, '- 内存报警阀值'), (57, '- 负载报警阀值'), (58, '- 应用连接数报警阀值'), (59, ''), (60, ''), (61, '#### 4.系统信息：'), (62, ''), (63, '- CacheCloud系统文档：[文档地址](../intro/index.md)'), (64, '- 值班电话：系统相关负责人联系方式'), (65, ''), (66, '[系统信息](../../img/access/baseinfo.png)'), (67, ''), (68, '#### 5.报警信息'), (69, ''), (70, '- 邮件联系人：用逗号隔开'), (71, '- 邮件报警接口：用逗号隔开'), (72, '- 微信报警接口：用逗号隔开'), (73, '- 微信号报警：用逗号隔开'), (74, ''), (75, ''), (76, '#### 6.客户端版本管理（**修改请慎重，修改不当可能造成客户端启动失效**）'), (77, ''), (78, '- 可用客户端版本(用逗号隔开)：良好的客户端版本列表，没有bug，如果客户端使用该版本的客户端可正常使用。'), (79, '- 警告客户端版本(用逗号隔开): 即将被放弃的客户端版本列表，如果客户端使用该版本能启动成功，但是可能存在bug，建议替换成可用版本的客户端。'), (80, '- 不可用客户端版本(用逗号隔开)： 不可用的客户端版本列表，如果客户端使用该版本将启动失败。'), (81, '注意，最后一个可用版本的版本号，就是接入代码中的版本号，代表最新的版本，例如1.1,1.2,1.5 ,具体客户端版本参考: [CC客户端版本](../intro/releaseNote.md)'), (82, ''), (83, '#### 7. 相关工具'), (84, ''), (85, '- nmon安装目录:'), (86, '- redis-migrate-tool安装路径:'), (87, '- redis-shake安装路径:'), (88, '- redis-full-check安装路径:'), (89, ''), (90, ''), (91, '####'), (92, ''), (93, '### 三、注意'), (94, ''), (95, '系统配置的初始化值,需要导入2.0.sql(目录:cachecloud-web/sql)中的相关表和数据：'), (96, ''), (97, '```'), (98, 'CREATE TABLE `system_config` ('), (99, ""  `config_key` varchar(255) NOT NULL COMMENT '配置key',""), (100, ""  `config_value` varchar(512) NOT NULL COMMENT '配置value',""), (101, ""  `info` varchar(255) NOT NULL COMMENT '配置说明',""), (102, ""  `status` tinyint(4) NOT NULL COMMENT '1:可用,0:不可用',""), (103, ""  `order_id` int(11) NOT NULL COMMENT '顺序',""), (104, '  PRIMARY KEY (`config_key`)'), (105, "") ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='系统配置';""), (106, ''), (107, '--'), (108, '-- init cachecloud data'), (109, '--'), (110, ''), (111, 'BEGIN;'), (112, 'INSERT INTO `system_config` VALUES'), (113, "" ('cachecloud.admin.user.name', 'admin', 'cachecloud-admin用户名', '1', '6'),""), (114, ""('cachecloud.admin.user.password', 'admin', 'cachelcoud-admin密码', '1', '7'),""), (115, ""('cachecloud.app.client.conn.threshold', '2000', '应用连接数报警阀值', '1', '24'),""), (116, ""('cachecloud.app.secret.base.key', 'cachecloud-2014', 'appkey秘钥基准key', '1', '29'),""), (117, ""('cachecloud.base.dir', '/opt', 'cachecloud根目录，要和cachecloud-init.sh脚本中的目录一致', '1', '23'),""), (118, ""('cachecloud.contact', 'user1:(xx@zz.com, user1:135xxxxxxxx)<br/>user2: (user2@zz.com, user2:138xxxxxxxx)', '值班联系人信息', '1', '16'),""), (119, ""('cachecloud.cookie.domain', '', 'cookie登录方式所需要的域名', '1', '22'),""), (120, ""('cachecloud.documentUrl', 'http://cachecloud.github.io', '文档地址', '1', '12'),""), (121, ""('cachecloud.email.alert.interface', '', '邮件报警接口(说明:http://cachecloud.github.io 邮件和短信报警接口规范)', '1', '25'),""), (122, ""('cachecloud.error.client', '0.0', '不可用客户端版本(用逗号隔开)', '1', '19'),""), (123, ""('cachecloud.good.client', '1.0-SNAPSHOT', '可用客户端版本(用逗号隔开)', '1', '17'),""), (124, ""('cachecloud.ldap.url', '', 'LDAP接口地址(例如:ldap://ldap.xx.com)', '1', '27'),""), (125, ""('cachecloud.machine.ssh.name', 'cachecloud', '机器ssh用户名', '1', '1'),""), (126, ""('cachecloud.machine.ssh.password', 'cachecloud', '机器ssh密码', '1', '2'),""), (127, ""('cachecloud.machine.ssh.port', '22', '机器ssh端口', '1', '3'),""), (128, ""('cachecloud.machine.stats.cron.minute', '1', '机器性能统计周期(分钟)', '1', '30'),""), (129, ""('cachecloud.mavenWareHouse', 'http://your_maven_house', 'maven仓库地址(客户端)', '1', '15'),""), (130, ""('cachecloud.mobile.alert.interface', '', '短信报警接口(说明:http://cachecloud.github.io 邮件和短信报警接口规范)', '1', '26'),""), (131, ""('cachecloud.nmon.dir', '/opt/cachecloud', 'nmon安装目录', '1', '31'),""), (132, ""('cachecloud.owner.email', 'xx@sohu.com,yy@qq.com', '邮件报警(逗号隔开)', '1', '13'),""), (133, ""('cachecloud.owner.phone', '13812345678,13787654321', '手机号报警(逗号隔开)', '1', '14'),""), (134, ""('cachecloud.public.key.pem', '/opt/ssh/id_rsa', '密钥路径', '1', '3'),""), (135, ""('cachecloud.public.user.name', 'cachecloud', '公钥用户名', '1', '3'),""), (136, ""('cachecloud.ssh.auth.type', '1', 'ssh授权方式', '1', '4'),""), (137, ""('cachecloud.superAdmin', 'admin,xx,yy', '超级管理员组', '1', '8'),""), (138, ""('cachecloud.user.login.type', '1', '用户登录状态保存方式(session或cookie)', '1', '21'),""), (139, ""('cachecloud.warn.client', '0.1', '警告客户端版本(用逗号隔开)', '1', '18'),""), (140, ""('cachecloud.whether.schedule.clean.data', 'false', '是否定期清理统计数据', '1', '28'),""), (141, ""('machine.cpu.alert.ratio', '80.0', '机器cpu报警阀值', '1', '9'),""), (142, ""('machine.load.alert.ratio', '8.0', '机器负载报警阀值', '1', '11'),""), (143, ""('machine.mem.alert.ratio', '80.0', '机器内存报警阀值', '1', '10'),""), (144, ""('redis.migrate.tool.home', '/opt/cachecloud/redis-migrate-tool/', 'redis-migrate-tool安装路径', '1', '20');""), (145, 'COMMIT;'), (146, '```')], 'deleted': []}"
404,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/access/docker.md,docker.md,1,"{'added': [(1, '## 一、Redis docker部署步骤'), (2, ''), (3, '### 1. 准备Redis二进制资源包：'), (4, ''), (5, '  - 1). 资源下载: [下载Redis资源包](http://download.redis.io/releases)'), (6, '  - 2). 下载所需要用到Redis版本资源: 例如: [redis-3.0.7](http://download.redis.io/releases/redis-3.0.7.tar.gz)、[redis-3.2.12](http://download.redis.io/releases/redis-3.2.12.tar.gz)、[redis-4.0.14](http://download.redis.io/releases/redis-4.0.14.tar.gz)、[redis-5.0.7](http://download.redis.io/releases/redis-5.0.7.tar.gz)'), (7, '  - 3). 在宿主/容器环境安装(make)redis资源包，对make编译完成资源重新打包redis-${大版本}.${小版本}.${增量版本}-make.tar.gz'), (8, ''), (9, '### 2. 文件说明：'), (10, ''), (11, '```'), (12, '   1).cachecloud-init-docker.sh: 宿主环境(物理机/虚拟机)初始化系统环境变量;'), (13, '   2).cachecloud-env.sh: cachecloud安装初始化脚本,如果是docker环境 默认会指定初始化;'), (14, '   3).supervisord.conf: 进程管理工具，可指定容器默认启动的后台守护进程,用于管理sshd以及容器初始化的过程;'), (15, '   4).authorized_keys: 默认为空，构建镜像会自动生成公钥写入到文件'), (16, '   5).build.sh: 编译dockerfile创建镜像;'), (17, '```'), (18, ''), (19, '### 3. dockerfile说明'), (20, ''), (21, '````'), (22, 'FROM centos:7.5.1804'), (23, 'RUN \\'), (24, '    /usr/bin/yum -y install wget make openssh-clients openssh-server;\\'), (25, '    mkdir -p /opt/cachecloud /home/cachecloud/.ssh'), (26, 'ADD redis-3.0.7-make.tar.gz /opt/cachecloud'), (27, 'ADD redis-3.2.12-make.tar.gz /opt/cachecloud'), (28, 'ADD redis-4.0.14-make.tar.gz /opt/cachecloud'), (29, 'ADD redis-5.0.6-make.tar.gz /opt/cachecloud'), (30, 'ADD cachecloud-env.sh /opt/cachecloud'), (31, 'ADD cachecloud-init-docker.sh /opt/cachecloud'), (32, 'ADD profile /etc'), (33, 'ADD supervisord.conf /etc'), (34, 'ADD public/authorized_keys /home/cachecloud/.ssh'), (35, 'RUN \\'), (36, '    source /etc/profile;\\'), (37, '    chmod +x /opt/cachecloud/*;\\'), (38, '    chown 600 /home/cachecloud/.ssh/authorized_keys;\\'), (39, '    sh /opt/cachecloud/cachecloud-init-docker.sh;\\'), (40, '    sh /opt/cachecloud/cachecloud-env.sh;\\'), (41, '    make -C /opt/cachecloud/redis-5.0.6 install;\\'), (42, '    ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key ;\\'), (43, '    ssh-keygen -t rsa -f /etc/ssh/ssh_host_ecdsa_key ;\\'), (44, '    ssh-keygen -t rsa -f /etc/ssh/ssh_host_ed25519_key ;\\'), (45, '    ssh-keygen -t rsa -f /etc/ssh/ssh_host_ecdsa_key ;\\'), (46, '    echo ""StrictModes no"" >> /etc/ssh/sshd_config;\\'), (47, '    yum -y install python-setuptools;\\'), (48, '    easy_install supervisor'), (49, 'EXPOSE 22'), (50, 'CMD /bin/bash'), (51, '````'), (52, '构建说明：'), (53, ''), (54, '1).基于centos7.5操作系统构建镜像；'), (55, ''), (56, '2).工具包安装: sshd工具/supervisord进程管理工具等；'), (57, ''), (58, '3).Redis二进制资源包解压安装/基础目录/用户权限；'), (59, ''), (60, '4).build.sh: 编译dockerfile创建镜像;'), (61, ''), (62, '### 4. 构建镜像:  sh build.sh'), (63, ''), (64, '```'), (65, '    前提: 当前环境需要安装docker环境'), (66, '    1). 查看镜像'), (67, '        $ docker images'), (68, ''), (69, '        REPOSITORY            TAG                 IMAGE ID            CREATED             SIZE'), (70, '        redis                 202002111559        c1f0da6454ab        3 minutes ago       1.08GB'), (71, ''), (72, '    2). 以交互模式启动一个容器'), (73, '        $ docker run -i -t redis:202002111559 /bin/bash'), (74, ''), (75, '        [root@d5e8923560bd cachecloud]# tree -L 1'), (76, '        .'), (77, '        |-- cachecloud-env.sh'), (78, '        |-- cachecloud-init-docker.sh'), (79, '        |-- conf'), (80, '        |-- data'), (81, '        |-- logs'), (82, '        |-- redis'), (83, '        |-- redis-3.2.12'), (84, '        |-- redis-4.0.14'), (85, '        `-- redis-5.0.6'), (86, '```'), (87, ''), (88, '## 二、Cachecloud docker部署步骤'), (89, ''), (90, ''), (91, '## 三、迁移工具部署'), (92, ''), (93, ''), (94, '')], 'deleted': []}"
405,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/access/docker.toc.md,docker.toc.md,1,"{'added': [(1, '##### 目录'), (2, '* [一、Redis docker部署步骤](#d1)'), (3, '* [二、Cachecloud docker部署步骤](#d2)')], 'deleted': []}"
406,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/access/index.md,index.md,1,"{'added': [(1, '## CacheCloud接入流程'), (2, ''), (3, '### 一、[系统初始化](init.md)'), (4, ''), (5, '+ **1.初始化数据库** ：导入项目中sql文件初始化库表结构；'), (6, '+ **2.CacheCloud项目配置** ：系统需要[初始化配置参数](config.md)；'), (7, '+ **3.启动cachecloud系统** ：启动运行cachecloud项目；'), (8, '+ **4.手动安装机器环境**：redis机器手动安装环境；'), (9, '+ **5.访问机器方式**：用户名/密码或公钥方式访问机器；'), (10, '+ **6.一些扩展性问题说明**：扩展问题说明；'), (11, ''), (12, '### 二、用户申请应用流程'), (13, ''), (14, '<img src=""../../img/access/app-apply.png"" width=""60%""/>'), (15, ''), (16, '+ **1.应用申请** ：填写客户端需求以及申请应用类型。'), (17, '+ **2.后台开通** ：管理员根据客户端需求，分配合理机器资源进行初始化应用。'), (18, '+ **3.邮件通知** ：管理员审核成功后，会通过邮件告知申请人员可以接入使用。'), (19, '+ **4.[客户端接入](client.md)** ：使用方通过appId接入CacheCloud资源。'), (20, ''), (21, '')], 'deleted': []}"
407,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/access/init.md,init.md,1,"{'added': [(1, '## 系统接入'), (2, ''), (3, '* [一、初始化数据库](#cc1)'), (4, '* [二、CacheCloud系统配置](#cc2)'), (5, '* [三、CacheCloud部署拓扑](#cc3)'), (6, '* [四、CacheCloud服务部署](#cc4)'), (7, '* [五、Redis机器环境安装](#cc5)'), (8, '* [六、系统扩展性模块说明](#cc6)'), (9, ''), (10, ''), (11, '<a name=""cc1""/>'), (12, ''), (13, '### 一、初始化数据库'), (14, '  导入项目sql目录下初始化库表结构，默认插入admin超级管理员。以下表为相关sql文件说明:'), (15, ''), (16, '  | 序号 | sql文件名 | 说明  |'), (17, '  | :-------------------------- | :-------------------------- |:----------------------------- |'), (18, '  | 1 | 1.2.sql     | CacheCloud1.2版本的sql文件 |'), (19, '  | 2 | 1.2-2.0.sql     | CacheCloud从1.2版本升级到2.0版本增量sql文件 |'), (20, '  | 3 | 2.0.sql | CacheCloud2.0版本的sql文件 |'), (21, ''), (22, '<a name=""cc2""/>'), (23, ''), (24, '### 二、CacheCloud系统配置'), (25, ''), (26, '项目采用springboot部署方式，通过application-${profile}.yml来区分不同环境资源隔离,其中profile:本地(默认为local)、测试(test)、线上(online)。'), (27, '当第一次启动系统后，需要对管理后台进行初始化配置，详细配置请参考: [系统配置说明](config.md)'), (28, ''), (29, '<img src=""../../img/access/globalconfig.png"" width=""60%""/>'), (30, ''), (31, '<a name=""cc3""/>'), (32, ''), (33, '### 三、CacheCloud部署拓扑'), (34, ''), (35, '<img src=""../../img/access/deploy.png"" width=""80%""/>'), (36, ''), (37, '````'), (38, '服务拓扑说明:'), (39, '1. 资源说明: nginx机器/cachecloud机器各4台，其中每2台机器分布在不同机房；'), (40, '2. 域名说明: 申请nginx域名： cc.**.**.com用于访问'), (41, '3. 虚ip说明：每组虚ip映射2台nginx机器，防止nginx出现单点问题；'), (42, '4. 机房说明: nginx/cachecloud机器每2台资源会分布在不同机房，为防止因为某个机房网络问题导致无法访问cc后台；'), (43, '````'), (44, ''), (45, '<a name=""cc4""/>'), (46, ''), (47, '### 四、CacheCloud服务部署'), (48, ''), (49, '- 1.本地环境:'), (50, ''), (51, '````'), (52, '(a). 在cachecloud根目录编译：mvn clean compile install'), (53, '(b). 在cachecloud-web模块下启动：mvn spring-boot:run'), (54, '````'), (55, ''), (56, '- 2.生产环境:'), (57, ''), (58, '````'), (59, '(a).项目根目录下编译打包：mvn clean compile install -Ponline'), (60, '(b).上传war包(cachecloud-web/target/cachecloud-web-online.war)到服务器/opt/cachecloud-web目录下'), (61, '(c).启动资源包：java -jar cachecloud-web-online.war -Dspring.profiles.active=online'), (62, '````'), (63, ''), (64, '- 3.后台登录:'), (65, ''), (66, '(a) 访问：http://127.0.0.1:9999/manage/login'), (67, ''), (68, '(b) 如果访问正常，请使用用户名:admin、密码:admin访问系统，跳转到应用列表下：'), (69, ''), (70, ' <img src=""../../img/access/login.png"" width=""40%""/>'), (71, ''), (72, '<a name=""cc5""/>'), (73, ''), (74, '### 五、Redis机器环境安装'), (75, ''), (76, '- 5.1 Redis机器环境手动安装：'), (77, ''), (78, '````'), (79, '1. 运行脚本:'), (80, ''), (81, '  cachecloud项目中的cachecloud-init.sh(目录：cachecloud-web\\script\\cachecloud-init.sh)脚本是用来初始化Redis服务器环境，主要工作如下：'), (82, '    (a). 创建cachecloud项目用户;'), (83, '    (b). 创建cachecloud项目的工作目录、数据目录、配置目录、日志目录、redis安装目录、临时目录等等;'), (84, '    (c). 安装最新的release版本的Redis;'), (85, ''), (86, '2. 脚本执行:'), (87, '    (a). 使用root登录目标服务器;'), (88, '    (b). 将cachecloud-init.sh脚本拷贝到目标服务器当前用户目录下;'), (89, '    (c). 执行 sh cachecloud-init.sh ${yourusername};'), (90, '    (d). 两次确认密码;'), (91, '    (e). 一路安装直到成功;'), (92, '请确保机器和用户名与cachecloud后台中系统用户名/密码配置一致。'), (93, ''), (94, '3. 建议和警告'), (95, '    (a). 请在root用户下执行初始化脚本，因为初始化脚本涉及到了用户的创建等较高的权限。'), (96, '    (b). 出于安全的考虑，所选的机器最好不要有外网IP地址。'), (97, '    (c). 用户名和密码最好不要用cachecloud, 密码尽可能复杂。'), (98, '    (d). 请确保/opt/有足够的硬盘空间，因为/opt/cachecloud/data要存储RDB和AOF的持久化文件，如果硬盘过小，会造成持久化失败。（如果硬盘确实很小，建议建立一个软链接到/opt/cachecloud/data,且保证软链接的目录也是username用户，一定要保证/opt/cachecloud的目录结构）'), (99, '    (e). 脚本中目前使用的是redis-3.0.7，如有需要请自行替换，建议使用3.0 release以后的版本。但是要注意3.2版本中bind的默认是127.0.0.1'), (100, '````'), (101, ''), (102, '- 5.2 Redis机器环境镜像安装：[Redis镜像安装](docker.md)'), (103, '- 5.3 Redis机器授权方式：[访问Redis机器方式](../operate/ssh.md)'), (104, ''), (105, '<a name=""cc6""/>'), (106, ''), (107, '### 六、系统扩展性模块说明'), (108, ''), (109, '#### 1. 登录模块:'), (110, ''), (111, '除了超级管理员admin:admin以外，所有的用户在登录时都要做两项内容的验证：'), (112, ''), (113, '- (1). 实现登陆逻辑：'), (114, '根据各公司自身需要实现逻辑可以在cachecloud-custom模块com.sohu.cache.login.impl.DefaultLoginComponent类中实现：'), (115, ''), (116, '```Java'), (117, '    public class DefaultLoginComponent implements LoginComponent {'), (118, ''), (119, '        @Override'), (120, '        public boolean passportCheck(String userName, String password) {'), (121, '            /**'), (122, '             * your company login check code'), (123, '             */'), (124, '            return true;'), (125, '        }'), (126, ''), (127, '        @Override'), (128, '        public String getEmail(String ticket) {'), (129, '            return null;'), (130, '        }'), (131, ''), (132, '        @Override'), (133, '        public String getRedirectUrl(HttpServletRequest request) {'), (134, '            return null;'), (135, '        }'), (136, ''), (137, '        @Override'), (138, '        public String getLogoutUrl() {'), (139, '            return null;'), (140, '        }'), (141, '    }'), (142, '```'), (143, '- (2). 是否为cachecloud用户'), (144, ''), (145, '    需要验证用户是否在app_user表中'), (146, ''), (147, '#### 2. 报警模块说明'), (148, ''), (149, 'cachecloud提供了邮件和微信两种形式的报警工具,这里主要是对Redis机器/实例等重要指标进行监控。'), (150, '各个公司、项目组可以根据需要实现对应报警接口逻辑，具体参考：'), (151, ''), (152, '- 2.1 代码实现：'), (153, ''), (154, '    - (1).邮件报警接口实现:com.sohu.cache.alert.impl.DefaultEmailComponent (cachecloud-custom)'), (155, '    ```Java'), (156, '    public class DefaultEmailComponent implements EmailComponent {'), (157, ''), (158, '        @Override'), (159, '        public boolean sendMail(String title, String content, List<String> emailList, List<String> ccList) {'), (160, '            //todo'), (161, '            throw new UnsupportedOperationException();'), (162, '        }'), (163, ''), (164, '        @Override'), (165, '        public boolean sendMail(String title, String content, List<String> emailList) {'), (166, '            //todo'), (167, '            throw new UnsupportedOperationException();'), (168, '        }'), (169, ''), (170, '        @Override'), (171, '        public boolean sendMailToAdmin(String title, String content) {'), (172, '            //todo'), (173, '            throw new UnsupportedOperationException();'), (174, '        }'), (175, ''), (176, '        @Override'), (177, '        public String getAdminEmail() {'), (178, '            //todo'), (179, '            throw new UnsupportedOperationException();'), (180, '        }'), (181, '    }'), (182, '    ```'), (183, ''), (184, '    - (2).微信报警接口实现:com.sohu.cache.alert.impl.DefaultWeChatComponent (cachecloud-custom)'), (185, '    ```Java'), (186, '    public class DefaultWeChatComponent implements WeChatComponent {'), (187, ''), (188, '        @Override'), (189, '        public boolean sendWeChat(String title, String message, List<String> weChatList) {'), (190, '            //todo'), (191, '            throw new UnsupportedOperationException();'), (192, '        }'), (193, ''), (194, '        @Override'), (195, '        public boolean sendWeChatToAll(String title, String message, List<String> weChatList) {'), (196, '            //todo'), (197, '            throw new UnsupportedOperationException();'), (198, '        }'), (199, ''), (200, '        @Override'), (201, '        public boolean sendWeChatToAdmin(String title, String message) {'), (202, '            //todo'), (203, '            throw new UnsupportedOperationException();'), (204, '        }'), (205, '    }'), (206, '    ```'), (207, ''), (208, '- 2.2 接口实现'), (209, ''), (210, '提供了http接口规范，只要按照规范开发http接口，任何语言都可以实现。'), (211, ''), (212, '(1).邮件：'), (213, ''), (214, '参数 | 含义 | 是否必须'), (215, '---|--- |---'), (216, 'title | 邮件标题 | 是'), (217, 'content | 邮件内容 | 是'), (218, 'receiver | 收件人列表 | 是'), (219, 'cc | 抄送人列表 | 否'), (220, ''), (221, ''), (222, '例如我们用python语言按照上面的参数开发了一个http接口'), (223, '```'), (224, 'www.xxx.com/emailAlert?title=xx&content=xx&receiver=x&cc=x'), (225, '```'), (226, '(2).微信：'), (227, ''), (228, '参数 | 含义 | 是否必须'), (229, '---|--- |---'), (230, 'title | 短信内容 | 是'), (231, 'message | 手机号列表 | 是'), (232, 'weChatList | 微信人员列表 | 是'), (233, ''), (234, '例如我们用python语言按照上面的参数开发了一个http接口'), (235, '```'), (236, 'www.xxx.com/weChatAlert?title=xx&message=xx&weChatList=xx'), (237, '```'), (238, ''), (239, '(3). 修改系统配置：'), (240, ''), (241, '确认无误后，我们需要把它添加到系统配置修改中即可：'), (242, '![](http://i0.itc.cn/20160713/3084_7a9245a4_c1a1_d6ec_a7cd_9c7f269d3fc6_1.png)'), (243, ''), (244, ''), (245, ''), (246, '')], 'deleted': []}"
408,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/access/init.toc.md,init.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* [一、初始化数据库](#cc1)'), (4, '* [二、CacheCloud系统配置](#cc2)'), (5, '* [三、CacheCloud部署拓扑](#cc3)'), (6, '* [四、CacheCloud服务部署](#cc4)'), (7, '* [五、Redis机器环境安装](#cc5)'), (8, '* [六、系统扩展性模块说明](#cc6)')], 'deleted': []}"
409,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/access/resource.md,resource.md,1,"{'added': [(1, '## 系统资源管理'), (2, ''), (3, '<a name=""cc1""/>'), (4, ''), (5, '### 一、目的'), (6, ''), (7, 'CacheCloud系统需要依赖一些脚本，Redis资源包，迁移工具，公钥/私钥等资源，由于比较零碎，此项功能用于对资源及其版本同一管理控制，简化运维提升效率。'), (8, '主要分以下几大类：'), (9, ''), (10, '- 仓库配置：配置资源的仓库地址，可用于推送和下载资源；'), (11, '- 目录管理：区分各类资源的目录结构，便于管理资源；'), (12, '- 脚本管理：管理系统依赖资源的脚本；'), (13, '- Redis资源管理： 管理redis资源包不同版本及推送下载；'), (14, '- 迁移工具资源管理：管理迁移工具不同资源包版本及推送下载；'), (15, ''), (16, '### 二、仓库配置'), (17, ''), (18, '<img src=""../../img/operate/version/respo.png"" width=""100%""/>'), (19, ''), (20, '远程仓库地址：可访问的仓库ip地址；例如:10.%.%.%'), (21, ''), (22, '根目录：仓库资源的根目录；例如:/opt/download/software/cachecloud/resource'), (23, ''), (24, '资源下载地址：可访问资源地址；例如:http://%.%.sohuno.com/software/cachecloud/resource'), (25, ''), (26, '### 三、目录管理'), (27, ''), (28, '<img src=""../../img/operate/version/dir.png"" width=""100%""/>'), (29, ''), (30, '对不同类型资源创建不同目录，需要做推送后及在远程仓库创建对应资源目录(格式:/${dir})；'), (31, ''), (32, '### 四、脚本管理'), (33, ''), (34, '<img src=""../../img/operate/version/script.png"" width=""100%""/>'), (35, ''), (36, '对系统依赖脚本进行版本管理，可在编译内容和推送脚本到仓库上；'), (37, ''), (38, '### 五、Redis资源管理'), (39, ''), (40, '<img src=""../../img/operate/version/redis.png"" width=""100%""/>'), (41, ''), (42, 'Redis资源管理支持对Redis大小版本做统一管理和版本控制(3.0.x -> 3.2.x -> 4.0.x -> 5.0.x -> 6.0.0-rc)的不断迭代更新，项目也需要用到不同版本和新特性。'), (43, ''), (44, '#### 5.1.新增资源包'), (45, ''), (46, '- 1).Redis版本格式规范，验证格式：redis-主.子.增量版本'), (47, '- 2).安装目录规范：/opt/cachecloud/redis-主.子.增量版本'), (48, '- 3).是否备份：可直接继承之前版本配置模板，进行增量修改配置'), (49, ''), (50, '#### 5.2.修改配置'), (51, ''), (52, '点击`修改配置`，可新增配置项：'), (53, ''), (54, '<img src=""../../img/operate/version/versionConfig.png"" width=""60%""/>'), (55, ''), (56, '#### 5.3、应用版本升级'), (57, ''), (58, '只支持小版本增量升级(Redis-3.2.x/Redis-4.0.x/Redis-5.0.x):'), (59, '例如:Redis-5.0.6 升级到 Redis-5.0.7'), (60, ''), (61, '<img src=""../../img/operate/version/upgrade.png"" width=""100%""/>'), (62, ''), (63, '点击`版本升级`，可升级当前应用版本:'), (64, ''), (65, '<img src=""../../img/operate/version/upgrade-process.png"" width=""60%""/>'), (66, ''), (67, '升级完后，若为升级版本5.0.7为当前管理的最终小版本号，则应用按钮会显示为`最新版本`。'), (68, ''), (69, '### 六、迁移工具资源管理'), (70, ''), (71, '<img src=""../../img/operate/version/tool.png"" width=""100%""/>'), (72, ''), (73, '对系统迁移工具版本管理，方便对资源的可控和管理；')], 'deleted': []}"
410,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/architecture/index.md,index.md,1,"{'added': [(1, '## CacheCloud系统架构介绍'), (2, ''), (3, 'CacheCloud系统架构介绍，主要包含以下方面:'), (4, ''), (5, '+ 1.[服务架构](service.md)'), (6, '    + 1.1 类型架构'), (7, '    + 1.2 伸缩架构'), (8, '+ 2.[技术架构](tech.md)'), (9, ''), (10, ''), (11, '')], 'deleted': []}"
411,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/architecture/service.md,service.md,1,"{'added': [(1, '## CacheCloud服务架构'), (2, ''), (3, '<a name=""cc7-1""/>'), (4, ''), (5, '### 一、类型架构'), (6, '- 1.standalone类型架构'), (7, ''), (8, '<img src=""http://i0.itc.cn/20160126/3084_a31f490d_64e3_3e43_6b99_18edbb45d8bc_1.png""/>'), (9, ''), (10, '用于可穿透业务场景，如后端有DB存储，脱机影响不大的应用。'), (11, ''), (12, '- 2.sentinel类型架构'), (13, ''), (14, '<img src=""http://i2.itc.cn/20160126/3084_0e82352a_0037_592e_89b3_29bee971bb71_1.png""/>'), (15, ''), (16, '用于高可用需求场景,可用于高可用Cache,存储等场景。'), (17, '内存/QPS受限于单机。'), (18, ''), (19, '- 3.cluster类型架构'), (20, ''), (21, '<img src=""http://i0.itc.cn/20160126/3084_e7ab6ad2_359b_d617_c255_6d56b25e2cd9_1.png""/>'), (22, ''), (23, '用于高可用需求场景,可用于大数据量高可用Cache/存储等场景。'), (24, '内存/QPS不受限于单机，可受益于分布式集群高扩展性'), (25, ''), (26, '<a name=""cc7-2""/>'), (27, ''), (28, '### 二、伸缩架构'), (29, ''), (30, '- 1.垂直伸缩架构'), (31, ''), (32, '<img src=""http://i1.itc.cn/20160126/3084_dbf1c47c_d145_1145_cebb_92aa6bb7fef5_1.png""/>'), (33, ''), (34, '通过统一调整每个实例可用内存量做到垂直拓展，受限于机器物理内存资源.'), (35, '适用于所有redis类型应用'), (36, ''), (37, '- 2.水平(sentinel)伸缩架构'), (38, ''), (39, '<img src=""http://i1.itc.cn/20160126/3084_93deddfb_fd46_21db_a1cf_46256ffd09e3_1.png""/>'), (40, ''), (41, '通过在线切换主从关系和实例所属机器实现扩容。'), (42, '适用于sentinel应用,在物理资源不够用/换掉故障机器时使用.'), (43, ''), (44, '- 3.水平(cluster)伸缩架构'), (45, ''), (46, '<img src=""http://i1.itc.cn/20160126/3084_b974e379_96cb_edad_2e8a_ecf0821c3020_1.png""/>'), (47, ''), (48, '通过动态加减实例并在线迁移数据实现伸缩性。'), (49, '适用于redis-cluster应用,伸缩性最灵活但是速度最慢。')], 'deleted': []}"
412,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/architecture/tech.md,tech.md,1,"{'added': [(1, '## CacheCloud技术架构'), (2, ''), (3, '<a name=""cc7-3""/>'), (4, ''), (5, '### 一、技术架构：'), (6, ''), (7, '<img src=""http://i0.itc.cn/20160126/3084_07c6991a_f1c6_e6b7_0300_5e024d45f7ea_1.png""/>'), (8, '<img src=""http://i1.itc.cn/20160126/3084_36e5d705_e812_7b83_e18e_cdad6c6d4c37_1.jpg""/>'), (9, ''), (10, '<a name=""cc8""/>')], 'deleted': []}"
413,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/client-statistic.md,client-statistic.md,1,"{'added': [(1, '## 客户端指标统计汇总'), (2, ''), (3, '- 统计全天应用各维度汇总数据,包括: 应用内存使用率、应用碎片率、应用慢查询、异常数量以及命令调用情况汇总。'), (4, ''), (5, '<img src=""../../img/function/exception.png"" width=""100%"">'), (6, '')], 'deleted': []}"
414,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/client.md,client.md,1,"{'added': [(1, '<a name=""cc1""/>'), (2, ''), (3, '客户端模块介绍用户使用CacheCloud平台功能，包括客户端接入、应用/实例监控数据曲线展示、shell命令执行平台及报警权限设置等功能。'), (4, ''), (5, '## 一、总体使用流程'), (6, '用户使用CacheCloud平台总体流程如下：'), (7, ''), (8, '![总体使用流程](../../img/function/client/client-process.png)'), (9, ''), (10, '<a name=""cc2""/>'), (11, ''), (12, '## 二、账户申请'), (13, ''), (14, '在执行所有操作之前，用户首先需要申请一个系统账号。当需要开通账户时，填写相关信息，管理员收到申请邮件时确认开通。'), (15, ''), (16, '- 进入CacheCloud首页，点击注册按钮'), (17, ''), (18, '![](../../img/function/client/client-login.png)'), (19, ''), (20, '- 填写用户相关信息'), (21, ''), (22, '![](../../img/function/client/client-register.png)'), (23, ''), (24, '<a name=""cc3""/>'), (25, ''), (26, '## 三、应用申请'), (27, '- 首次登录系统，如下图所示，点击右上角自己的姓名，在弹出的下拉框中选择应用申请。'), (28, ''), (29, '![](../../img/function/client/client-application-tag.png)'), (30, ''), (31, '- 弹出应用申请界面，如下图所示，按要求填写应用需求，提交申请即可。提交申请后，您将收到应用申请的邮件提醒及处理进度。'), (32, ''), (33, '![](../../img/function/client/client-application.png)'), (34, ''), (35, '<a name=""cc4""/>'), (36, ''), (37, '## 四、应用接入Demo'), (38, '- 当您的应用申请流程全部完成后(收到应用已经开通的邮件)，您可以开始使用您的应用。登录系统后，您会看到您申请及负责的应用列表，例如登录后，可以看到一个id为998的应用。如下图所示，点击应用id或应用名，进入应用详情页面。'), (39, ''), (40, '![](../../img/function/client/client-apps.png)'), (41, ''), (42, ''), (43, '- 点击接入代码tab页，如下图所示，查看使用[代码demo](#access)，参考demo代码进行测试和使用。'), (44, ''), (45, '![](../../img/function/client/client-code.png)'), (46, ''), (47, ''), (48, '<a name=""cc5""/>'), (49, ''), (50, '## 五、统计信息'), (51, '当您的应用开始使用后，您可以按照如下步骤查看应用统计数据和各实例统计数据。如第四章中所述，进入应用详情页面后，可以看到应用统计信息、拓扑结构、应用详情、命令分析，命令执行、接入代码、慢查询等。接入代码已经在上一节中做过阐述，本章中，我们将依次查看应用统计信息等其他功能。'), (52, ''), (53, '- 在页面详情页，默认展示应用统计信息，可以看到全局信息、命令统计、各命令峰值信息，全命令统计、命中统计、网络流量等全天统计曲线。按照顺序，'), (54, '  + 全局信息：展示应用的全局信息，包括内存使用率、当前连接数、应用redis版本、应用类型、主从节点数、命中率、当前对象数、当前状态及分布的机器数；'), (55, '  + 命令统计：展示当前应用执行最频繁的5个命令的分布情况；'), (56, '  + 各命令峰值信息：展示当前应用执行最频繁的5个命令的峰值统计；'), (57, '  + 全命令统计：展示当前应用的命令执行次数趋势图；'), (58, '  + 命中统计：展示当前应用的命中次数趋势图；'), (59, '  + 网络流量：展示应用的输入输出流量趋势图，亦可查看应用下各实例的网络输入输出流量；'), (60, '  + CPU消耗：展示应用的CPU消耗情况趋势图，亦可查看应用下各实例的CPU消耗情况趋势；'), (61, '  + 内存使用量：展示应用的内存使用情况趋势图，亦可查看应用下各实例的内存碎片率情况；'), (62, '  + 客户端连接统计：展示该应用下客户端连接数趋势图；'), (63, '  + 键个数统计：展示该应用下键个数趋势图。'), (64, ''), (65, '![](../../img/function/client/client-statsInfo.jpg)'), (66, ''), (67, '![](../../img/function/client/client-statsInfo1.jpg)'), (68, ''), (69, '![](../../img/function/client/client-statsInfo2.jpg)'), (70, ''), (71, '    - 扩容/缩容，在应用统计信息页面，点击申请扩容，弹出如图弹框，按照要求填写对应信息，提交。提交成功后，将收到进度邮件。'), (72, ''), (73, '   ![](../../img/function/client/client-capacity.png)'), (74, ''), (75, '    - 客户端统计'), (76, ''), (77, '- 命令曲线，命令曲线展示了该应用下执行最频繁的5个命令的执行次数趋势比较图，可以点击不同命令查看个命令的趋势图。'), (78, ''), (79, '![](../../img/function/client/client-codeImg.jpg)'), (80, ''), (81, '<a name=""cc6""/>'), (82, ''), (83, '## 六、应用详情、拓扑、扩容/缩容、命令执行'), (84, ''), (85, '在应用详情页面，还剩下实例列表、应用详情、命令执行、应用拓扑页面，本节中将描述这部分功能。'), (86, ''), (87, '- 实例列表，展示应用下各实例的具体情况，可以看到该应用的具体实例分布情况，包括ip、端口，实例状态，角色以及关联实例的id，根据应用类型的不同，可能会有区别。'), (88, ''), (89, '![](../../img/function/client/client-instancelist.png)'), (90, ''), (91, '- 应用拓扑，展示应用实例在各机器上的分布情况。'), (92, ''), (93, '![](../../img/function/client/client-topology.png)'), (94, ''), (95, '- 应用详情，运维应用详情，配置应用报警，管理用户下的用户。'), (96, ''), (97, '![](../../img/function/client/client-appDetail.png)'), (98, ''), (99, '- 接入代码，参考[“应用接入Demo”](#cc4)'), (100, ''), (101, '<a name=""cc7""/>'), (102, ''), (103, '## 七、实例信息查看及配置修改'), (104, ''), (105, '- 实例统计信息：在实例列表界面中，点击实例id可以跳转到实例信息页面，默认展示实例的统计信息，在实例页面可以看到菜单。'), (106, ''), (107, '![](../../img/function/client/instance-stats.png)'), (108, ''), (109, '- 其中拓扑结构，命令曲线，命令执行参考应用相关操作。'), (110, ''), (111, '- 慢查询分析：Redis实例中，可以对慢查询进行查看分析，点击慢查询分析，如下图，可以看到实例的慢查询操作。'), (112, ''), (113, '![](../../img/function/client/instance-slowlog.png)'), (114, ''), (115, '- 配置查询：点击配置查询可以对当前配置信息进行查询，如下图，根据应用需求，可以对配置信息进行修改，点击申请修改配置，如下图，按照要求填写信息，提交后会收到处理进度邮件。'), (116, ''), (117, '![](../../img/function/client/instance-config.png)'), (118, ''), (119, '![](../../img/function/client/instance-configEdit.png)'), (120, ''), (121, '- 连接信息：查看当前客户端连接信息。'), (122, ''), (123, '![](../../img/function/client/instance-connInfo.png)'), (124, ''), (125, '- 故障警报：展示当前实例故障情况。'), (126, ''), (127, '<a name=""cc8""/>'), (128, ''), (129, '## 八、CacheCloud Shell Console'), (130, ''), (131, '在应用或实例页面，点击命令执行，如下图，打开命令执行tab页面，可以在console中执行只读命令。'), (132, ''), (133, '![](../../img/function/client/client-appCmd.png)'), (134, ''), (135, '<a name=""cc9""/>'), (136, ''), (137, '## 九、权限管理及报警阀值设置'), (138, ''), (139, '在应用对应页面，点击应用详情，打开本应用的详情页面，可以看到应用详情，报警指标，用户管理。如下图，'), (140, '- 对应用信息进行修改；'), (141, '- 对需要接收该appId报警信息的人员进行管理；'), (142, '- 对报警指标进行设置和管理。'), (143, ''), (144, '![](../../img/function/client/client-appDetail.png)'), (145, ''), (146, ''), (147, '<a name=""cc10""/>'), (148, ''), (149, '## 十、客户端使用统计'), (150, ''), (151, '应用首页查看客户端统计，主要客户命令调用，异常统计情况。'), (152, '某个客户端调用/流量/耗时'), (153, '具体命令调用/流量/耗时'), (154, ''), (155, '<img width=""100%"" src=""../../img/function/client/client-statistic.png""/>'), (156, ''), (157, '- 客户命令调用统计，展示应用下命令调用全局统计情况，包括命令调用次数、命令平均耗时、输入/输出流量趋势。'), (158, ''), (159, '![](../../img/function/client/command-statistic.png)'), (160, '![](../../img/function/client/command-statistic1.png)'), (161, '![](../../img/function/client/command-statistic2.png)'), (162, ''), (163, '**点击“客户端详情”，查看不同客户端下各命令的调用情况。**'), (164, ''), (165, '![](../../img/function/client/command-statistic-client.png)'), (166, ''), (167, ''), (168, '![](../../img/function/client/command-statistic-all.png)'), (169, ''), (170, '- 客户端异常情况统计：展示应用下异常情况全局统计情况，包括异常次数、异常平均耗时趋势。'), (171, ''), (172, '![](../../img/function/client/exception-statistic.png)'), (173, ''), (174, '**异常分为客户端连接异常及命令调用超时异常，可分别点击“客户端连接异常详情”和“客户端命令超时详情”查看不同客户端下对应的异常情况。**'), (175, ''), (176, '**1.客户端连接异常详情**'), (177, ''), (178, '![](../../img/function/client/exception-statistic-client-conn.png)'), (179, ''), (180, '**2.客户端命令超时详情**'), (181, ''), (182, '![](../../img/function/client/exception-statistic-client.png)'), (183, ''), (184, '![](../../img/function/client/exception-statistic-client1.png)'), (185, ''), (186, '    点击图中点查看超时命令详情，包括命令的执行时间，命令明文，参数明文和字节数信息，如下图：'), (187, ''), (188, '![](../../img/function/client/exception-statistic-client-cmd.png)'), (189, ''), (190, '<a name=""cc11""/>'), (191, ''), (192, '## 十一、应用分析'), (193, ''), (194, '键值分析主要用来分析应用BigKey/过期键/键值分布等情况。'), (195, ''), (196, '![](../../img/function/client/app-analysis.png)'), (197, ''), (198, '![](../../img/function/client/app-analysis-application.png)')], 'deleted': []}"
415,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/client.toc.md,client.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* [一、总体使用流程](#cc1)'), (4, '* [二、账户申请](#cc2)'), (5, '* [三、应用申请](#cc3)'), (6, '* [四、应用接入demo](#cc4)'), (7, '* [五、统计信息](#cc5)'), (8, '* [六、应用详情查询、扩容](#cc6)'), (9, '* [七、实例信息查看及配置修改](#cc7)'), (10, '* [八、CacheCloud Shell Console](#cc8)'), (11, '* [九、权限管理及报警阀值设置](#cc9)'), (12, '* [<span style=""color:green"">十、客户端使用统计(new)</span>](#cc10)'), (13, '* [<span style=""color:green"">十一、应用分析(new)</span>](#cc11)')], 'deleted': []}"
416,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/index.md,index.md,1,"{'added': [(1, '## CacheCloud功能介绍'), (2, ''), (3, '### 主要功能分以下五个模块:'), (4, '+ wiki管理：系统介绍、FAQ、系统接入、系统功能、功能手册、常见问题'), (5, '+ Redis搭建：环境初始化、实例部署安装、类型架构支持'), (6, '+ 客户端接入：Java-SDK接入、客户端监控、其他语言接入；'), (7, '+ 运维管理：宿主环境、资源管理、应用审计、应用运维、应用质量监控、应用诊断扥西'), (8, '+ 弹性伸缩：资源评估、垂直伸缩、水平伸缩、外部接入；'), (9, '+ 统计监控：指标采集、应用统计、节点统计、机器统计、监控报警、问题诊断；'), (10, '![cachecloud功能架构](cachecloud-web/src/main/resources/static/img/readme/CacheCloud功能架构.png)')], 'deleted': []}"
417,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/job.md,job.md,1,"{'added': [(1, '## 工单流程'), (2, 'Cacheloud系统提供完善的工单申请-审批流程。用户可以提交自己名下相关应用的工单申请，由管理员驳回/处理、通过后，一条完整的工单流程执行完毕。'), (3, '### 1.工单申请'), (4, '- 点击""我的申请""进入工单列表界面：'), (5, ''), (6, '  <img src=""../../img/function/job/myJobs.png"" width=""100%"">'), (7, ''), (8, '  展示了工单申请/处理情况汇总，每条工单具体的记录，工单状态分为：待审、已受理、通过、驳回，工单受理后显示处理人。'), (9, ''), (10, '  <img src=""../../img/function/job/jobList.png"" width=""100%"">'), (11, ''), (12, '- ""创建工单""按不同类型分为：申请应用，数据清理（全库清理/删除数据），下线应用，诊断应用，键值分析，扩容/缩容，修改应用配置和修改报警。'), (13, ''), (14, '    a.应用申请：'), (15, ''), (16, '    <img src=""../../img/function/job/appInit.png"" width=""80%"">'), (17, ''), (18, '    b.数据清理：分为全库清理和删除数据'), (19, ''), (20, '    <img src=""../../img/function/job/appClean.png"" width=""80%"">'), (21, ''), (22, '    <img src=""../../img/function/job/appDelKey.png"" width=""80%"">'), (23, ''), (24, '    c.下线应用：'), (25, ''), (26, '    <img src=""../../img/function/job/appOffline.png"" width=""80%"">'), (27, ''), (28, '    d.诊断应用:'), (29, ''), (30, '    <img src=""../../img/function/job/appDiagnostic.png"" width=""80%"">'), (31, ''), (32, '    e.键值分析:'), (33, ''), (34, '    <img src=""../../img/function/job/appKeyAnalysis.png"" width=""80%"">'), (35, ''), (36, '    f.扩容/缩容:'), (37, ''), (38, '    <img src=""../../img/function/job/appScale.png"" width=""80%"">'), (39, ''), (40, '    g.修改应用配置:'), (41, ''), (42, '    <img src=""../../img/function/job/appConfig.png"" width=""80%"">'), (43, ''), (44, '    h.修改报警:'), (45, ''), (46, '    <img src=""../../img/function/job/appAlterConfig.png"" width=""80%"">'), (47, ''), (48, ''), (49, '### 2.工单审批'), (50, ''), (51, '- 工单审批界面展示了""工单处理汇总情况""和""审批列表""：'), (52, ''), (53, '   工单状态分为：待审、处理中、通过、驳回，工单受理后显示处理人。'), (54, ''), (55, '   <img src=""../../img/function/job/auditList.png"" width=""100%"">')], 'deleted': []}"
418,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/operations.md,operations.md,1,"{'added': [(1, ''), (2, ''), (3, ''), (4, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CacheCloud除了有面向用户的界面，还有面向管理员的运维界面，帮助管理员做一些如工单处理、日常运维管理等工作。'), (5, ''), (6, ''), (7, '<a name=""cc1""/>'), (8, ''), (9, '## 一、用户工单运维'), (10, ''), (11, '<a name=""cc1-1""/>'), (12, ''), (13, '### 1. 工单类型'), (14, ''), (15, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如下图所示，来自用户的工单有以下几种：'), (16, ''), (17, '+ 应用申请：用户需要申请开通redis standalone、redis sentinel和redis cluster；'), (18, '+ 应用扩容：用户需要对当前的应用进行内存容量扩容；'), (19, '+ 应用配置修改：用户希望对当前的redis配置做调整；'), (20, '+ 键值分析：用户申请分析应用BigKey/过期键/键值分布等情况；'), (21, '+ 注册用户申请：管理员只需要开通或驳回就可以了。'), (22, ''), (23, '<img src=""../../img/function/server/server-operation.png"" width=""100%""/>'), (24, ''), (25, '<a name=""cc1-2""/>'), (26, ''), (27, '### 2. 开通应用'), (28, '\t(1). 不同类型的redis，开通使用不同的格式。'), (29, '\t(2). 一键开通中唯一需要的就是机器的IP。'), (30, '\t添加机器时，要综合考虑，用户提交关于客户端的基本信息：QPS、容量、机房、主从等信息，决定选用的什么配置、什么机房的机器。'), (31, ''), (32, '#### (1) redis-standalone开通'), (33, '- 如下图，按照步骤填选：'), (34, ''), (35, '<img src=""../../img/function/server/server-standalone.png"" width=""100%""/>'), (36, ''), (37, '- 点击自动生成“部署预览”，确认部署信息后，点击“开始部署”：'), (38, ''), (39, '<img src=""../../img/function/server/server-standalone-deploy.png"" width=""100%""/>'), (40, ''), (41, '#### (2) redis-sentinel开通'), (42, ''), (43, '步骤同上'), (44, ''), (45, '![](../../img/function/server/server-sentinel.png)'), (46, ''), (47, '#### (3) redis-cluster开通'), (48, ''), (49, '步骤同上'), (50, ''), (51, '![](../../img/function/server/server-cluster.png)'), (52, ''), (53, '详细操作可参考：[运维手册-应用部署](../../wiki/operate/appDeploy.md)。'), (54, ''), (55, '<a name=""cc1-3""/>'), (56, ''), (57, '### 3. 扩容申请'), (58, '- 垂直扩容'), (59, '在“扩容配置”一栏填写扩容后单实例最大内存即可'), (60, ''), (61, '<img src=""../../img/function/server/server-expand.png"" width=""100%""/>'), (62, ''), (63, '- 水平扩容'), (64, ''), (65, '水平扩容相对麻烦且费时一些，在开通时候管理员尽量根据用户提交的信息(QPS，容量等)，尽量提前预支一些实例，如果还是抗不住，就可做水平扩容。'), (66, ''), (67, 'a. 添加一个redis-cluster节点，格式为masterIp:memSize:slaveIp，并meet到集群中；'), (68, ''), (69, 'b. 迁移slot: 迁移slot速度较慢，CacheCloud支持slot断点续传的功能。'), (70, ''), (71, '<img src=""../../img/function/server/server-expand-hor.png"" width=""100%""/>'), (72, ''), (73, '<a name=""cc1-4""/>'), (74, ''), (75, '### 4. 配置修改申请'), (76, '填写需要修改的配置项和配置值。'), (77, ''), (78, '<img src=""http://i1.itc.cn/20160125/3084_25e4c289_a9d6_ee95_6fd9_032effce7b8d_1.jpg""  width=""100%""/>'), (79, ''), (80, '<a name=""cc1-5""/>'), (81, ''), (82, '### 5. 键值分析'), (83, '点击“分析”，进行键值分析'), (84, ''), (85, '<img src=""../../img/function/server/key-analysis.png"" width=""100%""/>'), (86, ''), (87, '跳转到键值分析任务流'), (88, ''), (89, '<img src=""../../img/function/server/key-analysis-taskflow.png"" width=""100%""/>'), (90, ''), (91, '<a name=""cc1-6""/>'), (92, ''), (93, '### 6. 注册用户申请'), (94, '直接点击通过或者驳回即可。'), (95, ''), (96, '<a name=""cc2""/>'), (97, ''), (98, '## 二、管理员运维'), (99, ''), (100, '<img src=""../../img/function/server/server-operate.png"" width=""100%""/>'), (101, ''), (102, '<a name=""cc2-1""/>'), (103, ''), (104, '### 1. 应用运维'), (105, ''), (106, '在应用运维中可管理应用实例，查看应用机器列表，应用详情和审批列表，修改应用密码，并提供了应用诊断工具。'), (107, ''), (108, '- 管理应用实例'), (109, ''), (110, '**Redis Sentinel**'), (111, ''), (112, 'a. 一键添加sentinel节点'), (113, 'b. 一键Failover'), (114, 'c. 上下线实例'), (115, 'd. 添加slave节点'), (116, 'e. 查看操作日志'), (117, ''), (118, '![](../../img/function/server/app-operation-sentinel.png)'), (119, ''), (120, '<a name=""cc2-1-cluster""/>'), (121, ''), (122, '**Redis Cluster**'), (123, ''), (124, 'a. 添加Slave'), (125, 'b.一键Failover'), (126, 'c.上下线实例'), (127, 'd. 查看操作日志'), (128, ''), (129, '![](../../img/function/server/app-operation-cluster.png)'), (130, ''), (131, '- 应用机器列表'), (132, ''), (133, '查看该应用分布机器的使用情况，包括内存使用率、已分配内存、cpu使用率等信息。'), (134, ''), (135, '![](../../img/function/server/app-machines.png)'), (136, ''), (137, '- 应用详情和审批列表'), (138, ''), (139, '![](../../img/function/server/app-detail.png)'), (140, ''), (141, '- 应用密码修改'), (142, ''), (143, '![](../../img/function/server/app-redisPassword.png)'), (144, ''), (145, '- 应用诊断工具'), (146, ''), (147, '目前提供对应用拓扑规范检查的功能，提交任务流处理。'), (148, ''), (149, '![](../../img/function/server/app-topologyExam.png)'), (150, ''), (151, ''), (152, '<a name=""cc2-2""/>'), (153, ''), (154, '### 2. 应用迁移'), (155, ''), (156, '应用一键迁移，对当前应用所有节点进行failover，迁移到其他机器。详细操作可参考：[运维手册-应用迁移](../../wiki/operate/appMigrate.md)。'), (157, ''), (158, '![](../../img/function/server/app-migrate.png)'), (159, ''), (160, '<a name=""cc2-3""/>'), (161, ''), (162, '### 3. 应用下线'), (163, ''), (164, '下线当前应用，销毁所有存活节点。点击“应用下线”，跳转到应用下线任务流，可查看下线情况。'), (165, ''), (166, '<a name=""cc2-4""/>'), (167, ''), (168, '### 4. Redis版本更新'), (169, ''), (170, '升级应用的redis版本。详细操作可参考：[运维手册-Redis版本管理.应用版本升级](../access/redisVersion.md)。'), (171, ''), (172, '<a name=""cc3""/>'), (173, ''), (174, '## 三、 机器管理'), (175, '新机器除了要用脚本进行初始化安装CacheCloud的环境以外，还要统一进行管理，CacheCloud后台提供了机器的增删改查功能，还有一些简单的(cpu，网络，负载)监控功能。'), (176, ''), (177, 'CacheCloud之所以没有提供完整的机器监控功能，是因为各个公司一般都有自己专门的机器运维和监控工具，其中或自己开发或使用像ganglia、nagios等软件搭建。'), (178, ''), (179, '<img src=""../../img/function/server/server-machine.png"" width=""100%""/>'), (180, ''), (181, '![](../../img/function/server/server-machine-add.png)'), (182, ''), (183, '<a name=""cc4""/>'), (184, ''), (185, '## 四、 用户管理'), (186, ''), (187, '管理CacheCloud平台用户信息。'), (188, ''), (189, '<img src=""../../img/function/server/cc-user.png"" width=""100%""/>'), (190, ''), (191, '<a name=""cc5""/>'), (192, ''), (193, '## 五、Redis版本管理'), (194, ''), (195, '统一管理redis版本，提供查看安装各redis版本的机器信息，修改版本信息，一键安装等功能。'), (196, '详细操作可参考：[运维手册-版本管理](../access/redisVersion.md)。'), (197, ''), (198, '<img width=""100%"" src=""../../img/function/server/redisversion.png""/>'), (199, ''), (200, '<a name=""cc6""/>'), (201, ''), (202, '## 六、Redis任务流管理'), (203, ''), (204, 'CacheCloud平台引入任务流机制，将用户操作提交为异步任务，复杂任务拆分为多个子任务，每个子任务又按照步骤依次执行，每个任务/步骤直接是相互独立，可查看任务关系、任务信息、执行状态、运行日志等信息。'), (205, ''), (206, '<img width=""100%"" src=""../../img/function/server/taskmanage.png""/>'), (207, ''), (208, '- 下面以“RedisClusterAppDeployTask”任务为例进行使用讲解。'), (209, ''), (210, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy.png""/>'), (211, ''), (212, '1. 管理员提交“redis-cluster开通”任务（参考[应用运维-Redis Cluster](#cc2-1-cluster)）；'), (213, '2. 系统自动生成“RedisClusterAppDeployTask”*（部署redis-cluster应用）父任务及多个“RedisServerInstallTask”（在机器上安装redis server）子任务，可查看各任务的基本信息、状态、进度等信息；'), (214, '3. 点击“执行步骤”可查看任务的具体执行步骤，包括任务的基本信息（各种参数），任务流/步骤列表，任务详细日志（帮助问题排查）；'), (215, '4. 对运行中的任务可以暂停，对暂停/失败的任务亦可提交“重试任务”。'), (216, ''), (217, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy-detail1.png""/>'), (218, ''), (219, '<img width=""100%"" src=""../../img/function/server/cc-taskflow-appDeplogy-detail1.png""/>'), (220, ''), (221, '<img width=""100%"" src="".../../img/function/server/cc-taskflow-appDeplogy-detail3.png""/>'), (222, ''), (223, '<img width=""100%"" src=""../../img/function/server/cc-taskflow.png""/>'), (224, ''), (225, ''), (226, '<a name=""cc7""/>'), (227, ''), (228, '## 七、Redis报警阈值管理'), (229, ''), (230, '管理redis报警阈值，支持对应用整体/单个实例进行报警配置。'), (231, ''), (232, '<img width=""100%"" src=""../../img/function/server/cc-alter.png""/>'), (233, ''), (234, '<img width=""100%"" src=""../../img/function/server/cc-alter-special.png""/>'), (235, ''), (236, '![](../../img/function/server/cc-alter-app.png)'), (237, ''), (238, '<a name=""cc8""/>'), (239, ''), (240, '## 八、Redis配置模板管理'), (241, ''), (242, '此功能是Redis全局配置模板(每次开启应用时用到)，并非用于修改线上配置。可对redis的不同版本不同配置项进行增删改查操作，请谨慎修改。'), (243, ''), (244, '<img width=""100%"" src=""../../img/function/server/cc-configuration.png""/>'), (245, ''), (246, ''), (247, '<a name=""cc9""/>'), (248, ''), (249, '## 九、调度任务'), (250, ''), (251, '对CacheCloud平台的定时任务进行管理，可开启/暂停/删除某个定时任务。'), (252, ''), (253, '<img width=""100%"" src=""../../img/function/server/cc-trigger.png""/>'), (254, ''), (255, '<a name=""cc10""/>'), (256, ''), (257, '## 十、系统配置管理'), (258, ''), (259, '对CacheCloud平台的基本配置信息进行管理。具体配置模板信息如下：'), (260, ''), (261, '<img width=""100%"" src=""../../img/function/server/cc-redisConfiguration.png""/>'), (262, ''), (263, '-----'), (264, '')], 'deleted': []}"
419,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/operations.toc.md,operations.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* [一、用户工单运维](#cc1)'), (4, '    * [1. 工单类型](#cc1-1)'), (5, '    * [2. 开通应用](#cc1-2)'), (6, '    * [3. 扩容申请](#cc1-3)'), (7, '    * [4. 配置修改申请](#cc1-4)'), (8, '    * [5. 注册用户申请](#cc1-5)'), (9, '    * [5. 键值分析](#cc1-6)'), (10, '* [二、管理员运维](#cc2)'), (11, '    * [1. 应用运维](#cc2-1)'), (12, '    * [2. 应用迁移](#cc2-2)'), (13, '    * [3. 应用下线](#cc2-3)'), (14, '    * [4. Redis版本更新](#cc2-4)'), (15, '* [三、机器管理](#cc3)'), (16, '* [四、用户管理](#cc4)'), (17, '* [<span style=""color:green"">五、Redis版本管理(new)</span>](#cc5)'), (18, '* [<span style=""color:green"">六、Redis任务流管理(new)</span>](#cc6)'), (19, '* [七、Redis报警阈值管理](#cc7)'), (20, '* [八、Redis配置模板管理](#cc8)'), (21, '* [九、调度任务](#cc9)'), (22, '* [十、系统配置管理](#cc10)')], 'deleted': []}"
420,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/server-statistic.md,server-statistic.md,1,"{'added': [(1, '## 服务端指标统计汇总'), (2, ''), (3, '- 1.应用内存指标:用于快速发现需要伸缩内存的应用，统计了内存使用率、分片数、客户端连接数等指标。'), (4, '<img src=""../../img/function/mem.png"" width=""100%"">'), (5, ''), (6, '- 2.应用碎片率指标:用于快速发现高碎片率应用，统计了rss内存使用、redis版本、键数量等指标。'), (7, '<img src=""../../img/function/fragratio.png"" width=""100%"">'), (8, ''), (9, '- 3.应用拓扑诊断指标:用于快速发现应用拓扑是否异常，例如:主从节点是否同一台机器、故障转移是否满足、宿主环境资源分布等。'), (10, '<img src=""../../img/function/topology.png"" width=""100%"">')], 'deleted': []}"
421,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/server-statistic.toc.md,server-statistic.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* [一、内存指标](#cc1)'), (4, '* [二、碎片率指标](#cc2)'), (5, '* [三、应用拓扑诊断](#cc3)')], 'deleted': []}"
422,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/function/statistics.md,statistics.md,1,"{'added': [(1, ''), (2, '## 一、服务端全局统计'), (3, ''), (4, '- 1.资源总览：统计所有在线运行应用数量、实例数量、机器数量、redis版本数量以及机器内存分配和使用情况汇总。'), (5, '    <img width=""100%"" src=""../../img/function/server/total.png""/>'), (6, ''), (7, '- 2.内存使用分布及统计：统计不同机房维度机器内存使用率、分配率情况。'), (8, ''), (9, '    <img width=""100%"" src=""../../img/function/server/machine-mem.png""/>'), (10, '    <img width=""100%"" src=""../../img/function/server/machine-room.png""/>'), (11, ''), (12, ''), (13, '- 3.调度任务统计：当前系统运行调度任务数量。'), (14, ''), (15, '    <img width=""100%"" src=""../../img/function/server/quartz.png""/>'), (16, ''), (17, '- 4.任务流统计: 当前系统执行所有任务流的状态：总任务数/成功任务数/失败任务数。'), (18, ''), (19, '    <img width=""100%"" src=""../../img/function/server/task.png""/>'), (20, ''), (21, '----------'), (22, '')], 'deleted': []}"
423,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/intro/index.md,index.md,1,"{'added': [(1, '### 目录'), (2, '* [一、CacheCloud是什么](#cc1)'), (3, '* [二、CacheCloud功能架构](#cc2)'), (4, '* [三、CacheCloud使用规模](#cc3)'), (5, '* [四、阿里云ecs试用版本](#cc4)'), (6, '* [五、FAQ快速接入](#cc5)'), (7, '* [六、服务用户](#cc6)'), (8, '* [七、图书分享](#cc7)'), (9, '* [八、支持与帮助](#cc8)'), (10, ''), (11, '<a name=""cc1""/>'), (12, '## 一、CacheCloud是什么'), (13, ''), (14, 'CacheCloud是一个Redis云管理平台：支持Redis多种架构(Standalone、Sentinel、Cluster)高效管理、有效降低大规模redis运维成本，提升资源管控能力和利用率。平台提供快速搭建/迁移，运维管理，弹性伸缩，统计监控，客户端整合接入等功能。'), (15, '![cachecloud云平台](../../img/readme/cachecloud.png)'), (16, ''), (17, '<a name=""cc2""/>'), (18, '## 二、CacheCloud功能架构'), (19, ''), (20, '+ Wiki管理：FAQ、系统介绍、系统接入、系统功能、功能手册、常见问题；'), (21, '+ Redis搭建：环境初始化、实例部署安装、类型架构支持；'), (22, '+ 客户端接入：Java-SDK接入、客户端监控、其他语言接入；'), (23, '+ 运维管理：宿主环境、资源管理、应用审计、应用运维、应用质量监控、应用拓扑诊断；'), (24, '+ 弹性伸缩：资源评估、垂直伸缩、水平伸缩、外部接入；'), (25, '+ 统计监控：指标采集、应用统计、节点统计、机器统计、监控报警、问题诊断；'), (26, '<img src=""../../img/readme/CacheCloud功能架构.png"" width=""100%""/>'), (27, ''), (28, '<a name=""cc3""/>'), (29, '## 三、CacheCloud使用规模'), (30, ''), (31, '+ 400亿+ commands/day'), (32, '+ 15T+ Memory Total'), (33, '+ 300+ app Total / 3000+ Instances Total'), (34, '+ 200+ Machines Total'), (35, ''), (36, '<a name=""cc4""/>'), (37, '## 四、阿里云ecs试用版本'), (38, ''), (39, '+ CacheCloud后台地址：[地址](http://47.97.112.178:8080/admin/app/list)'), (40, '+ 用户名/登录密码：cachecloud_user:cachecloud_user'), (41, '+ 开源版本试用时间: 2020-10-18 ，如果大家有空闲公网资源可以贡献，请[联系我们](#cc8)'), (42, ''), (43, '<a name=""cc5""/>'), (44, '## 五、FAQ快速接入'), (45, ''), (46, '+ [快速开始](../../wiki/quickstart/index.md)'), (47, '+ [客户端接入](../../wiki/access/client.md)'), (48, ''), (49, '<a name=""cc6""/>'), (50, '## 六、服务用户'), (51, ''), (52, '<img src=""../../img/readme/user.png"" width=""60%""/>'), (53, ''), (54, '<a name=""cc7""/>'), (55, '## 七、图书分享'), (56, ''), (57, '由CacheCloud团队撰写的实体书《Redis开发与运维》(机械工业出版)已在各大网店售卖，本书包含了CacheCloud团队在Redis规模化开发运维大量经验，以及Cachecloud更为系统的介绍，[目录介绍和购买地址](https://cachecloud.github.io/2016/10/24/Redis3%E5%BC%80%E5%8F%91%E8%BF%90%E7%BB%B4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-%E7%9B%AE%E5%BD%95/)，欢迎大家指教和购买。'), (58, '### 相关样章'), (59, '+ 1.[Redis架构之防雪崩设计](https://mp.weixin.qq.com/s/TBCEwLVAXdsTszRVpXhVug)'), (60, '+ 2.[Redis的内存优化](https://cachecloud.github.io/2017/02/16/Redis%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/)'), (61, '+ 3.[Redis的Linux系统优化](https://cachecloud.github.io/2017/02/16/Redis%E7%9A%84Linux%E7%B3%BB%E7%BB%9F%E4%BC%98%E5%8C%96/)'), (62, '+ 4.[Redis客户端常见异常分析](https://cachecloud.github.io/2017/02/20/Redis%E7%83%AD%E7%82%B9key%E5%AF%BB%E6%89%BE%E4%B8%8E%E4%BC%98%E5%8C%96/)'), (63, '+ 5.[Redis热点key寻找与优化](https://cachecloud.github.io/2017/02/20/Redis%E7%83%AD%E7%82%B9key%E5%AF%BB%E6%89%BE%E4%B8%8E%E4%BC%98%E5%8C%96/)'), (64, '+ 6.[Redis无限全量复制问题分析与优化](https://cachecloud.github.io/2016/11/24/%E5%85%A8%E9%87%8F%E5%A4%8D%E5%88%B6%E9%97%AE%E9%A2%98/)'), (65, ''), (66, '<a name=""cc8""/>'), (67, '## 八、支持与帮助'), (68, ''), (69, '+ QQ群：534429768'), (70, '+ Redis开发运维公众号：关注Redis开发运维实战，发布Cachecloud最新动态，帮大家减轻工作负担。'), (71, '<img src=""../../img/readme/subcribe.png"" width=""40%""/>'), (72, ''), (73, '+ 微信：如果大家有公网资源可以联系我，会加入到开源版本服务资源部署试用，提高大家的用户体验。'), (74, '<img src=""../../img/readme/wechat.png"" width=""40%""/>'), (75, ''), (76, '如果你觉得CacheCloud对你有帮助，欢迎Star。')], 'deleted': []}"
424,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/intro/redisVersion.md,redisVersion.md,1,"{'added': [(1, 'Redis开源代码地址：[https://github.com/antirez/redis](https://github.com/antirez/redis)，作者blog地址：http://antirez.com/'), (2, '目前Redis各大版本lastest-release如下：'), (3, ''), (4, '> **<span id=""r5"">6.0-rc</span>**'), (5, ''), (6, '[redis6.0-changlog](https://raw.githubusercontent.com/antirez/redis/6.0/00-RELEASENOTES)'), (7, ''), (8, '````'), (9, '1.新的模块系统：提供新的模块API，模块可实现在RDB中存储数据，关联服务器事件，捕获重写命令，根据key阻塞客户端等功能'), (10, '2.重写过期淘汰：新的实现支持动态调整且能够更高效的回收过期键。'), (11, '3.SSL加密：所有的通信管道支持SSL。'), (12, '4.ACL支持: 控制用户只能访问某些命令以及对某些键的访问。'), (13, '5.新协议RESP3: 新协议可以返回更多响应语义，新客户端可以从该协议中读取更多调用内容。'), (14, '6.协助客户端缓存: Redis可以辅助优化客户端缓存实现。该功能仍处于开发阶段后续会有调整，更多内容: https://redis.io/topics/client-side-caching'), (15, '7.多线程IO: Redis可使用多线程处理网络数据的读写和协议解析，在不使用pipeline情况下，提升redis2倍的IO执行效率。'), (16, '8.无盘复制: 从节点也支持无盘复制，开启配置后从节点可以从socket缓冲区加载RDB数据到内存。'), (17, '9.基准测试：redis-benchmark 现在支持集群模式。'), (18, '10.随机命令：优化SRANDMEMBER等随机命令的分布'), (19, '11.redis-cli优化'), (20, '12.重写Systemd支持'), (21, '13.发布集群代理架构：https://github.com/artix75/redis-cluster-proxy'), (22, '14.发布Disque(消息队列)模块：https://github.com/antirez/disque-module'), (23, '````'), (24, ''), (25, '> **<span id=""r4"">5.0.7</span>**'), (26, ''), (27, '[redis5.0 changlog](https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES)'), (28, ''), (29, '````'), (30, '1.新的流数据类型(Stream data type) https://redis.io/topics/streams-intro'), (31, '2.新的 Redis 模块 API：定时器、集群和字典 API(Timers, Cluster and Dictionary APIs)'), (32, '3.RDB 增加 LFU 和 LRU 信息'), (33, '4.集群管理器从 Ruby (redis-trib.rb) 移植到了redis-cli 中的 C 语言代码'), (34, '5.新的有序集合(sorted set)命令：ZPOPMIN/MAX 和阻塞变体(blocking variants)'), (35, '6.升级 Active defragmentation 至 v2 版本'), (36, '7.增强 HyperLogLog 的实现'), (37, '8.更好的内存统计报告'), (38, '9.许多包含子命令的命令现在都有一个 HELP 子命令'), (39, '10.客户端频繁连接和断开连接时，性能表现更好'), (40, '11.许多错误修复和其他方面的改进'), (41, '12.升级 Jemalloc 至 5.1 版本'), (42, '13.引入 CLIENT UNBLOCK 和 CLIENT ID'), (43, '14.新增 LOLWUT 命令 http://antirez.com/news/123'), (44, '15.在不存在需要保持向后兼容性的地方，弃用 ""slave"" 术语'), (45, '16.网络层中的差异优化'), (46, '17.Lua 相关的改进'), (47, '18.引入动态的 HZ(Dynamic HZ) 以平衡空闲 CPU 使用率和响应性'), (48, '19.对 Redis 核心代码进行了重构并在许多方面进行了改进'), (49, '````'), (50, ''), (51, ''), (52, '> **<span id=""r3"">4.0.14</span>**'), (53, ''), (54, '[redis4.0 changlog](https://raw.githubusercontent.com/antirez/redis/4.0/00-RELEASENOTES)'), (55, ''), (56, '```'), (57, '1.Redis模块系统 modules system'), (58, '2.psync2全量/增量数据同步增强'), (59, '3.Lazyfree异步机制'), (60, '4.支持aof+rdb混合持久化'), (61, '5.内存分析及优化(memory help查看支持内存命令)'), (62, '6.内存碎片整理'), (63, '```'), (64, ''), (65, '> **<span id=""r2"">3.2.12</span>**'), (66, ''), (67, '[redis3.2 changlog](https://raw.githubusercontent.com/antirez/redis/3.2/00-RELEASENOTES)'), (68, ''), (69, '> **<span id=""r1"">3.0.7</span>**'), (70, ''), (71, '[redis3.0 changlog](https://raw.githubusercontent.com/antirez/redis/3.0/00-RELEASENOTES)')], 'deleted': []}"
425,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/intro/redisVersion.toc.md,redisVersion.toc.md,1,"{'added': [(1, '##### redis lastest release版本说明'), (2, ''), (3, '* 一、[6.0.4](#r5)'), (4, '* 二、[5.0.9](#r4)'), (5, '* 三、[4.0.14](#r3)'), (6, '* 四、[3.2.12](#r2)'), (7, '* 五、[3.0.7](#r1)')], 'deleted': []}"
426,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/intro/releaseNote.md,releaseNote.md,1,"{'added': [(1, '## 以下是关于CacheCloud定制客户端版本变更记录'), (2, ''), (3, '### <span style=""color:green"">CacheCloud定制客户端分类说明：</span>'), (4, ''), (5, '- 1.[cachecloud-client-redis](#j1) (基于Jedis定制客户端)'), (6, '- 2.[cachecloud-jedis](#j2) (定制完善Jedis客户端)'), (7, '- 3.[cachecloud-client-crossroom-redis](#j3) (跨机房容灾高可用客户端)'), (8, '- 4.[cachecloud-client-lettuce](#j4) (基于lettuce定制客户端)'), (9, '- 5.[cachecloud-client-spectator](#j5) (客户端上报类库)'), (10, ''), (11, ''), (12, '### 一、**<span id=""j1"">cachecloud-client-redis客户端</span>**'), (13, ''), (14, '> <span id=""j10"">2.0.1版本</span>'), (15, ''), (16, '  - **5. 版本号: 2.0.1-RELEASE**'), (17, '      + 4.1. 发布日期：2020-03-17'), (18, '      + 4.2. 重要变更：'), (19, '        ````'), (20, '         1) 增加对指标收集器StatCollector非空判断，为空则不上报指标，兼容不通过Builder构造Jedis实例的情况；'), (21, '         2) 优化命令调用逻辑，解决因为命令调用较少导致的漏报和延迟上报的问题。'), (22, '        ````'), (23, ''), (24, '> <span id=""j11"">2.0.0版本</span>'), (25, ''), (26, '  - **4. 版本号: 2.0.0-RELEASE**'), (27, '      + 4.1. 发布日期：2020-02-12'), (28, '      + 4.2. 重要变更：'), (29, '        ````'), (30, '         1) 支持Redis 5 API，Jedis相关类路径变更；'), (31, '         2) 重构Jedis客户端，增加命令超时和连接异常等指标统计上报逻辑；'), (32, '         3) RedisClusterBuilder/RedisSentinelBuilder/RedisStandaloneBuilder客户端对同一appid只实例化一次。'), (33, '        ````'), (34, ''), (35, '> <span id=""j12"">1.7.0版本</span>'), (36, ''), (37, '   - **3. 版本号: 1.7.1-SNAPSHOT**'), (38, ''), (39, '      + 3.1. 发布日期：2019-03-21'), (40, '      + 3.2. 重要变更：'), (41, '         ````'), (42, '         1) 优化Redis集群下应用只用pipeline批量读写，当redis节点变更或下线，客户端无法获取到新节点拓扑。'), (43, '         ````'), (44, ''), (45, '   - **2. 版本号: 1.7.0-SNAPSHOT**'), (46, '     + 2.1 发布日期：2018-09-14'), (47, '     + 2.2 重要变更：'), (48, '         ````'), (49, '         1) 支持standalone/sentinel/cluster在线密码修改；'), (50, '         2) 修复上报因版本编译产生的内存泄漏问题。'), (51, '         ````'), (52, ''), (53, '> <span id=""j13"">1.6.0版本</span>'), (54, ''), (55, '   - **1. 版本号: 1.6.0-SNAPSHOT**'), (56, '     + 1.1 发布日期：2018-09-14'), (57, '     + 1.2 重要变更：'), (58, '         ````'), (59, '         1) 支持connectTimeOut和soTimeOut参数，同时兼容老版本的setTime方法；'), (60, '         2) 增加支持客户端上报开关；'), (61, '         3) 客户端键值区间支持。'), (62, '         ````'), (63, ''), (64, '### 二、**<span id=""j2"">Jedis</span>**'), (65, ''), (66, '> <span id=""j20"">3.1.0版本</span>'), (67, ''), (68, '- **3. 版本号: 3.1.0-CC-2-RELEASE**'), (69, '     + 2.1 发布日期：2020-03-17'), (70, '     + 2.2 重要变更：'), (71, '         ````'), (72, '         1) 加上对指标收集器StatCollector非空判断，为空则不上报指标，兼容不通过Builder构造Jedis实例的情况。'), (73, '         ````'), (74, ''), (75, '- **3. 版本号: 3.1.0-CC-1-RELEASE**'), (76, '     + 2.1 发布日期：2020-02-12'), (77, '     + 2.2 重要变更：'), (78, '         ````'), (79, '         1) 合并官方jedis3.1.0版本；'), (80, '         2) 支持Redis 5相关api。'), (81, '         ````'), (82, ''), (83, '> <span id=""j22"">2.9.0版本</span>'), (84, ''), (85, '- **2. 版本号: 2.9.0-CC-4-SNAPSHOT**'), (86, '     + 1.1 发布日期：2019-06-28'), (87, '     + 1.2 重要变更：'), (88, '         ````'), (89, '          1) 合并官方jedis2.9.0版本；'), (90, '          2) 优化集群风暴。'), (91, '         ````'), (92, '- **1. 版本号: 2.9.0-CC-3-SNAPSHOT**'), (93, '     + 1.1 发布日期：2018-09-14'), (94, '     + 1.2 重要变更：'), (95, '         ````'), (96, '          1) 支持standalone/sentinel/cluster在线密码修改。'), (97, '         ````'), (98, ''), (99, '### 三、**<span id=""j3"">cachecloud-client-crossroom-redis</span>**'), (100, ''), (101, '><span id=""j31"">1.4.0版本</span>'), (102, ''), (103, '- **3. 版本号: 1.4.0-RELEASE**'), (104, ''), (105, '     + 3.1 发布日期：2020-02-12'), (106, '     + 3.2 重要变更：'), (107, '         ````'), (108, '         1) 升级Jedis版本至3.1.0-CC-1-RELEASE，cachecloud-client-redis版本至2.0.0-RELEASE；'), (109, '         ````'), (110, '><span id=""j32"">1.3.2版本</span>'), (111, '- **2. 版本号: 1.3.2-SNAPSHOT**'), (112, '     + 2.1 发布日期：2019-12-09'), (113, '     + 2.2 重要变更：'), (114, ''), (115, '         ````'), (116, '         1) 跨机房api支持命令zadd、lpop、llen、rpush、zrem、mzadds、mHgetAll、sadd、sismember、scard等。'), (117, '         ````'), (118, '><span id=""j33"">1.2版本</span>'), (119, '- **1. 版本号: 1.2-SNAPSHOT**'), (120, '     + 1.1 发布日期：2016-09-28'), (121, '     + 1.2 重要变更：'), (122, '         ````'), (123, '         1) 修改客户端初始化方式。'), (124, '         ````'), (125, ''), (126, '### 四、**<span id=""j4"">cachecloud-client-lettuce</span>**'), (127, ''), (128, '><span id=""j41"">1.0版本</span>'), (129, '- **2. 版本号: 1.0-RELEASE**'), (130, '     + 1.1 发布日期：2020-02-20'), (131, '     + 1.2 重要变更：'), (132, '         ````'), (133, '         1) 升级原生lettuce至5.2.0.RELEASE版本。'), (134, '         ````'), (135, '- **1. 版本号: 1.0-SNAPSHOT**'), (136, '     + 1.1 发布日期：2018-12-24'), (137, '     + 1.2 重要变更：'), (138, '         ````'), (139, '         1) 增加CacheCloud初始化方式。'), (140, '         ````'), (141, ''), (142, '### 五、**<span id=""j5"">cachecloud-client-spectator</span>**'), (143, ''), (144, '><span id=""j51"">1.0版本</span>'), (145, '- **2. 版本号: 1.0.1-RELEASE**'), (146, '     + 1.1 发布日期：2020-03-17'), (147, '     + 1.2 重要变更：'), (148, '         ````'), (149, '         1) 优化命令调用逻辑，解决因为命令调用较少导致的漏报和延迟上报的问题。'), (150, '         ````'), (151, ''), (152, '- **1. 版本号: 1.0.0-RELEASE**'), (153, '     + 1.1 发布日期：2020-02-12'), (154, '     + 1.2 重要变更：'), (155, '         ````'), (156, '         1) 重构Jedis命令调用和异常上报逻辑。'), (157, '         ````')], 'deleted': []}"
427,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/intro/releaseNote.toc.md,releaseNote.toc.md,1,"{'added': [(1, '##### 客户端变更版本目录'), (2, ''), (3, '* 一、[cachecloud-client-redis](#j1)'), (4, '    - [2.0.0版本](#j11)'), (5, '    - [1.7.0版本](#j12)'), (6, '    - [1.6.0版本](#j13)'), (7, '* 二、[jedis](#j2)'), (8, '    - [3.1.0-cc版本](#j21)'), (9, '    - [2.9.0-cc版本](#j22)'), (10, '* 三、[cachecloud-client-crossroom-redis](#j3)'), (11, '    - [1.4.0版本](#j31)'), (12, '    - [1.3.2版本](#j32)'), (13, '    - [1.2版本](#j33)'), (14, '* 四、[cachecloud-client-lettuce](#j4)'), (15, '    - [1.0版本](#j41)'), (16, '* 五、[cachecloud-client-spectator](#j5)'), (17, '    - [1.0版本](#j51)')], 'deleted': []}"
428,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/appAlert.md,appAlert.md,1,"{'added': [(1, '## 一、应用报警配置'), (2, ''), (3, '应用报警是指用户对自己申请的应用重要指标设置的报警，主要监控应用的内存使用率，客户端连接数等指标。'), (4, ''), (5, '在用户申请应用时，CacheCloud会要求设置内存报警和客户端连接数报警的阈值；'), (6, ''), (7, '<img src=""../../img/operate/alert/alert-when-apply.png"" width=""100%""/>'), (8, ''), (9, '对已存在的应用，通过CacheCloud后台应用详情页面，可查看当前应用报警指标的配置，以及配置接收报警的用户；'), (10, ''), (11, '<img src=""../../img/operate/alert/app-alert.png"" width=""100%""/>'), (12, ''), (13, '点击“应用报警配置”，对报警的阈值进行修改。'), (14, ''), (15, '<img src=""../../img/operate/alert/app-alert-config.png"" width=""100%""/>'), (16, ''), (17, '## 二、Redis报警配置'), (18, ''), (19, 'Redis报警是CacheCloud后台对用户申请的应用和Redis实例相关监控指标设置的报警。'), (20, ''), (21, '进入CacheCloud后台页面，在Redis报警阈值页面，可看到目前配置的全局监控指标和特殊实例监控指标：'), (22, ''), (23, '<img src=""../../img/operate/alert/redis-alert-common.png"" width=""100%""/>'), (24, ''), (25, '<img src=""../../img/operate/alert/redis-alert-special.png"" width=""100%""/>'), (26, ''), (27, 'Redis全局报警指标如下：'), (28, ''), (29, '| 配置名 | 说明  | 监控周期 |  关系  |  参考阈值 |'), (30, '| :-------------------------- |:----------------------------- | :------------------------------------------:|  :------------------------------------------:|  :------------------------------------------:|'), (31, '| aof_current_size | aof当前尺寸(单位：MB) | 30分钟 | 大于 | 6000 |'), (32, '| aof_delayed_fsync | 分钟aof阻塞个数 | 1分钟 | 大于 | 3 |'), (33, '| client_biggest_input_buf | 输入缓冲区最大buffer大小(单位：MB) | 1分钟 | 大于 | 10 |'), (34, '| client_longest_output_list | 输出缓冲区最大队列长度 | 1分钟 | 大于 | 50000 |'), (35, '| instantaneous_ops_per_sec | 实时ops | 1分钟 | 大于 | 60000 |'), (36, '| latest_fork_usec | 上次fork所用时间（单位：微妙 | 1天 | 大于 | 400000 |'), (37, '| mem_fragmentation_ratio | 内存碎片率（检测大于500MB的） | 1天 | 大于 | 1.5 |'), (38, '| rdb_last_bgsave_status | 上一次bgsave状态 | 1小时 | 不等于 | ok |'), (39, '| total_net_output_bytes | 分钟网络输出流量(单位：MB) | 1分钟 | 大于 | 5000 |'), (40, '| total_net_input_bytes | 分钟网络输入流量(单位：MB)\t| 1分钟 | 大于 | 1200 |'), (41, '| sync_partial_err | 分钟部分复制失败次数 | 1分钟 | 大于 | 0 |'), (42, '| sync_partial_ok | 分钟部分复制成功次数 | 1分钟 | 大于 | 0 |'), (43, '| sync_full | 分钟全量复制执行次数 | 1分钟 | 大于 | 0 |'), (44, '| rejected_connections | 分钟拒绝连接数\t | 1分钟 | 大于 | 0 |'), (45, '| master_slave_offset_diff | 主从节点偏移量差(单位：字节)\t | 5分钟 | 大于 | 20000000 |'), (46, '| cluster_state | 集群状态 | 1分钟 | 不等于 | ok |'), (47, '| cluster_slots_ok | 集群成功分配槽个数\t | 1分钟 | 不等于 | 16384 |'), (48, ''), (49, 'CacheCloud默认按照全局报警配置监控所有Redis实例，如果某些应用或者实例需要特殊配置报警阈值，可通过以下按钮，添加特殊报警项。'), (50, ''), (51, '<img src=""../../img/operate/alert/redis-alert-special-config.png"" width=""100%""/>'), (52, ''), (53, ''), (54, '')], 'deleted': []}"
429,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/appDeploy.md,appDeploy.md,1,"{'added': [(1, ''), (2, ''), (3, '## 应用部署'), (4, ''), (5, '\u200b    用户提交应用申请（详细操作可参考：[系统功能-客户端.应用申请](../../wiki/function/client.md)）后，管理员在可在后台-流程审批页面驳回或开通应用，如下图：'), (6, ''), (7, '<img src=""../../img/operate/appDeploy/app_deal.png"" width=""100%""/>'), (8, ''), (9, '### 驳回应用需要填写原因'), (10, '<img src=""../../img/operate/appDeploy/app_reject.png"" width=""60%""/>'), (11, ''), (12, '### 开通应用'), (13, '点击“审批处理”开始应用部署，如下图：'), (14, '<img src=""../../img/operate/appDeploy/app_deploy.png"" width=""100%""/>'), (15, '应用部署可分为以下步骤：'), (16, ''), (17, '1. 查看应用申请详情，如存储种类，是否测试、客户端机房信息、内存申请详情、Redis版本等，按照申请要求开通应用，可做适当调整。'), (18, '2. 填写应用基础信息，应用级别：S/A/B(默认)/c，重要性依次降低；选择Redis版本；给应用（Redis）的默认密码。'), (19, '3. 填写应用部署信息，'), (20, '      - 应用类型：RedisStandalone/sentinel+Redis/RedisCluster等；'), (21, ''), (22, '      - maxMemory：单个实例的内存，单位MB；'), (23, ''), (24, '      - 选择部署Redis机器及每台机器部署的实例数。机器信息分为四个部分：机器ip（代表所属机房），使用/总核数（使用率），使用/总内存（使用率）以及特殊说明。'), (25, '        **注意**：可参考机器信息挑选机器，注意一个应用下的实例尽量部署在统一机房，一个实例最少占用一核，剩余内存需大于单实例的内存。'), (26, '        <img src=""../../img/operate/appDeploy/machine_info.png"" width=""100%""/>'), (27, '4. 信息填写完毕后，点击“生成部署预览”，可生成部署机器信息和部署信息预览，如下图，'), (28, '    <img src=""../../img/function/server/server-cluster.png"" width=""100%""/>'), (29, '      - 部署机器信息展示了挑选的机器的ip、已存在的实例数/核数、已使用/剩余/总内存、需要部署的实例角色数量、机器所在的宿主机/机器信息，可参考挑选机器原则重新挑选。'), (30, ''), (31, '      - 部署信息预览，不同类型的redis，开通使用不同的格式：'), (32, '        cluster类型：master_ip:memory:slave_ip (至少三组，测试应用可以没有slave)，如上图；'), (33, '        sentinel类型：master_ip:memory:slave_ip，sentinel_ip (至少三组，可跨机房)，如图：'), (34, '        <img src=""../../img/function/server/server-sentinel.png"" width=""100%""/>'), (35, '        standalone类型：master_ip:memory，如图：'), (36, '        <img src=""../../img/function/server/server-standalone-deploy.png"" width=""100%""/>'), (37, '        如果部署信息不满足要求，可重新填写信息，挑选机器，重新“生成部署预览”。'), (38, ''), (39, '  5. 确认部署预览信息无误后，点击开始部署，跳转到应用任务流部署页面，检查应用部署情况：'), (40, '     <img src=""../../img/operate/appDeploy/skip.png"" width=""50%""/>'), (41, '     <img src=""../../img/operate/appDeploy/deploy_taskflow.png"" width=""100%""/>'), (42, '     确认应用部署成功后，回到后台-流程审批页面，点击“通过”，就此整个应用开通完成。'), (43, ''), (44, '### 总结'), (45, ''), (46, '        (1).不同类型的redis，使用不同的格式部署。'), (47, '        (2).一键部署中唯一需要的就是机器的IP。'), (48, '        (3).添加机器时，要综合考虑，用户提交关于客户端的基本信息：QPS、容量、机房、主从等信息，决定挑选的什么配置、什么机房的机器。'), (49, '        (4).应用开始部署后，部署任务流页面确认应用部署完毕，需要跳回到审批页点击“通过”，就此整个应用开通才算完成。')], 'deleted': []}"
430,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/appMigrate.md,appMigrate.md,1,"{'added': [(1, '## 应用迁移步骤'), (2, ''), (3, '<a name=""step1""/>'), (4, ''), (5, '### 1. 进入CacheCloud后台'), (6, ''), (7, '在CacheCloud后台的“应用运维”页面，选择要进行迁移的应用，点击“应用迁移”。 这种迁移方式不会更换应用的appId，通过主从节点的failover实现，是对客户端无感知迁移。'), (8, ''), (9, '<img src=""../../img/operate/appMigrate/app-migrate0.png"" width=""100%""/>'), (10, ''), (11, '<a name=""step2""/>'), (12, ''), (13, '### 2. 使用迁移工具进行迁移'), (14, ''), (15, '应用迁移整体包含八个主要步骤：'), (16, ''), (17, '+ (1) 应用信息：查看源应用的实例IP，角色和Redis版本等信息，选择迁移的目标机房和迁移机器；'), (18, ''), (19, '<img src=""../../img/operate/appMigrate/app-migrate1.png"" width=""100%""/>'), (20, ''), (21, '+ (2) 应用迁移计划：这一步主要查看节点的变更信息，新增实例（Slave）的IP和端口号，点击继续进行新老Salve节点的替换；'), (22, ''), (23, '<img src=""../../img/operate/appMigrate/app-migrate2.png"" width=""100%""/>'), (24, ''), (25, '+ (3) 新老Salve节点替换: 替换完成之后查看最新实例信息，点击继续，进行主从切换；'), (26, ''), (27, '<img src=""../../img/operate/appMigrate/app-migrate3.png"" width=""100%""/>'), (28, ''), (29, '+ (4) 主从Failover: 完成主从节点切换，点击继续，添加新的Slave；'), (30, ''), (31, '<img src=""../../img/operate/appMigrate/app-migrate4.png"" width=""100%""/>'), (32, ''), (33, '+ (5) 添加Slave: 添加新的Slave；'), (34, ''), (35, '<img src=""../../img/operate/appMigrate/app-migrate5.png"" width=""100%""/>'), (36, ''), (37, '+ (6) 新实例状态检测：检查新实例的连接状态，是否异常，点击继续，下线老的Slave；'), (38, ''), (39, '<img src=""../../img/operate/appMigrate/app-migrate6.png"" width=""100%""/>'), (40, ''), (41, '+ (7) 下线Slave: 下线老的Slave；'), (42, ''), (43, '<img src=""../../img/operate/appMigrate/app-migrate7.png"" width=""100%""/>'), (44, ''), (45, '+ (8) 迁移完成: 完成迁移。'), (46, ''), (47, '<img src=""../../img/operate/appMigrate/app-migrate8.png"" width=""100%""/>')], 'deleted': []}"
431,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/baseConcept.md,baseConcept.md,1,"{'added': [(1, '## 基础概念：'), (2, ''), (3, '### 一. 应用、实例、机器、CacheCloud客户端、CacheCloud服务端'), (4, ''), (5, '- 1.1 `实例`'), (6, ''), (7, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一个Redis进程，例如在ip为10.10.xx.xx启动了端口为6379的Redis进程。'), (8, ''), (9, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实例可以是Redis单机数据节点、Redis-Sentinel类型下的Redis数据节点和sentinel节点，也可以是Redis-Cluster下的Redis数据节点。'), (10, ''), (11, '- 1.2 `应用`'), (12, ''), (13, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一个redis集群是由若干个实例组成的，分配给每个CacheCloud用户的redis集群就是一个应用（包含应用id）。'), (14, ''), (15, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一个应用可以是一个Redis单机、一个Redis-Sentinel集群，或者一个Redis-Cluster集群。但是对于CacheCloud用户来说，不需要知道每个Redis实例的ip:port信息，只需要一个appId就可以获取这些细节。主流云服务都采用appId的形式分配给用户，提供各种云服务。'), (16, ''), (17, '- 1.3 `机器`'), (18, ''), (19, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;机器资源可以理解为是物理机、虚拟机、docker容器、k8s容器等。一台机器可以部署多个应用，多个实例。'), (20, ''), (21, '- 1.4 `CacheCloud客户端`'), (22, ''), (23, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;提供用户通过appId快速接入CacheCloud系统的api（可以理解成获取应用对应Redis实例的REST接口或者封装好的jar包）。'), (24, ''), (25, '- 1.5 `CacheCloud服务端`'), (26, ''), (27, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CacheCloud用户通过appId获取Redis服务地址的服务端。用于收集，展示和管理实例、应用、机器各个层面的数据，帮助CacheCloud用户快速掌握Redis集群使用状态。'), (28, ''), (29, '<a name=""cc1-2""/>'), (30, ''), (31, '### 二、实例状态：待分配、心跳停止、已下线、运行中'), (32, ''), (33, '+ `待分配`：在应用开通期间，实例处于分配的过程中，如果分配成功则是运行中状态；'), (34, '+ `心跳停止`：通过系统监控判断实例有可能下线状态，但是由于网络等原因，实例可能并没有下线，所以需要管理员人工确认；'), (35, '+ `已下线`：管理员对Redis实例进行下线操作；'), (36, '+ `运行中`：正在运行的Redis实例状态。'), (37, ''), (38, '<img width=""100%"" src=""../../img/operate/appDeploy/instance-status.png""/>')], 'deleted': []}"
432,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/baseOperate.md,baseOperate.md,1,"{'added': [(1, '## 基础运维'), (2, ''), (3, '<a name=""cc1""/>'), (4, ''), (5, '### 1. 客户端服务机房问题'), (6, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Redis是比较依赖于网络环境的，较差的网络环境会带来一系列问题，最明显的就是访问速度，之前做过一个统计，跨机房要比同一个机房慢数倍。'), (7, ''), (8, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;所以用户在申请应用的时候，要填写自己的服务所在的机房，这样CacheCloud的管理员会根据您的机房情况给予合理的分配。'), (9, ''), (10, '<img width=""90%"" src=""../../img/operate/operate/machine-room.png""/>'), (11, ''), (12, '<a name=""cc2""/>'), (13, ''), (14, '### 2. 配置修改问题'), (15, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cachecloud中各种类型(Redis-standalone、Redis-sentinel, Redis-cluster)，在开启应用时，使用我们认为最优的配置。'), (16, ''), (17, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;但是，每个用户自己服务类型不同，需求可能会不同，例如对于maxmemory-policy、list-max-ziplist-entries、list-max-ziplist-value等配置就会有所不同，如果有需要修改配置，用户可以自行提交配置修改。'), (18, ''), (19, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;修改方法如下：'), (20, '+ (1) 进入应用页面的“拓扑结构”选项卡，点击ID进入实例页面'), (21, '<img width=""100%"" src=""../../img/operate/operate/profile-modify.png""/>'), (22, ''), (23, '+ (2) 进入“配置查询”选项卡'), (24, '<img width=""100%"" src=""../../img/operate/operate/profile-modify2.png""/>'), (25, ''), (26, '+ (3) 点击“申请修改配置”，填写相应字段和值'), (27, '<img width=""60%"" src=""../../img/operate/operate/profile-modify3.png""/>'), (28, ''), (29, '+ (4) 后台管理员接收到申请邮件，进行处理，处理完成后，用户将收到相应处理邮件'), (30, ''), (31, '#### 注： 修改的配置会对应用的所有节点生效，因为所有节点的配置是统一的。'), (32, ''), (33, '<a name=""cc3""/>'), (34, ''), (35, '### 3. maxmemory-policy配置说明'), (36, ''), (37, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cachecloud对于每个Redis节点都设置了maxmemory, 所以需要有对应的maxmemory-policy，默认策略是volatile-lru。'), (38, ''), (39, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Redis提供了6种策略应对maxmemory, 用户可以根据自己的需求选择对应的策略。'), (40, '+ volatile-lru -> 用lru算法删除过期的键值'), (41, '+ allkeys-lru -> 用lru算法删除所有键值'), (42, '+ volatile-random -> 随机删除过期的键值'), (43, '+ allkeys-random -> 随机删除任何键值'), (44, '+ volatile-ttl -> 删除最近要到期的键值（监控TTL）'), (45, '+ noeviction -> 不会写操作，返回一个错误'), (46, ''), (47, '<a name=""cc4""/>'), (48, ''), (49, '### 4. 数据清理问题'), (50, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cachecloud测试应用用户可以自行清理内存，处于安全的考虑正式应用需要联系管理员进行清理。'), (51, '<img width=""100%"" src=""../../img/operate/operate/data-clear.png""/>'), (52, ''), (53, '<a name=""cc5""/>'), (54, ''), (55, '### 5. 应用选型问题'), (56, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如上图所示，目前CacheCloud提供了3种类型的存储类型'), (57, ''), (58, '<img width=""60%"" src=""../../img/operate/operate/redis-type.png""/>'), (59, ''), (60, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用户可以根据自己的需要选择适合自己的类型，下面对Redis的三种类型使用场景进行简单说明：'), (61, '* (1) 底层数据（例如mysql, hbase等等）允许被穿透，而且不考虑高可用性，可以考虑Redis-Standalone类型。'), (62, '    * 缺点： 非高可用、受单机影响扩展性(容量，读写等)有限'), (63, '    * 优点：结构简单'), (64, ''), (65, '<img width=""80%"" src=""../../img/operate/operate/standalone.png""/>'), (66, ''), (67, '* (2) 如想保证Redis的高可用（通过主从和sentinel机制），可以选择Redis-Sentinel类型'), (68, '    * 缺点：受单机影响扩展性(容量，读写等)有限'), (69, '    * 优点：高可用，结构相对简单'), (70, ''), (71, '<img width=""80%"" src=""../../img/operate/operate/sentinel.png""/>'), (72, ''), (73, '* (3) 如想保证高可用、可扩展、大容量等要求，可以选择Redis-Cluster'), (74, '下面给一些建议：'), (75, '    * 并不是说Redis-Cluster比其他两种类型好，用户需要根据自己的需求选择（比如内存需求量不大，保证高可用选择Redis-Sentinel类型就足够了）'), (76, '    * 如果当前或者未来需要的内存量超过6个G， 建议选择Redis-Cluster类型。'), (77, ''), (78, '<img width=""80%"" src=""../../img/operate/operate/cluster.png""/>'), (79, ''), (80, '<a name=""cc6""/>'), (81, ''), (82, '### 6. Jedis连接池GenericObjectPoolConfig配置'), (83, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jedis源码中使用了common-pool2作为连接池管理工具，无论是对于Redis-Standalone, Redis-Sentinel, Redis-Cluster进行操作，通常是通过jedis连接池(JedisPool, JedisSentinelPool)获取连接，所以需要选择合理的连接池配置。'), (84, '通常的代码如下（可以参考cachecloud中代码接入模块）：'), (85, '```Java'), (86, 'GenericObjectPoolConfig poolConfig = new GenericObjectPoolConfig();'), (87, 'poolConfig.setMaxTotal(GenericObjectPoolConfig.DEFAULT_MAX_TOTAL * 5);'), (88, 'poolConfig.setMaxIdle(GenericObjectPoolConfig.DEFAULT_MAX_IDLE * 3);'), (89, 'poolConfig.setMinIdle(GenericObjectPoolConfig.DEFAULT_MIN_IDLE * 2);'), (90, 'poolConfig.setJmxEnabled(true);'), (91, 'poolConfig.setMaxWaitMillis(3000);'), (92, 'PipelineCluster redisCluster = ClientBuilder.redisCluster(appId)'), (93, '    .setJedisPoolConfig(poolConfig)'), (94, '    .setTimeout(1)'), (95, '    .setMaxRedirections(5)'), (96, '    .build();'), (97, '```'), (98, '\t其中poolConfig就是对于连接池的配置，其中有几个配置较为重要。'), (99, '\tmaxActive: 链接池中最大连接数,默认为8. (并非越大越好，具体原因可以参考GenericObjectPool的实现)'), (100, '\tmaxIdle: 链接池中最大空闲的连接数,默认为8.'), (101, '\tminIdle: 连接池中最少空闲的连接数,默认为0.'), (102, '\tmaxWait: 当连接池资源耗尽时，调用者最大阻塞的时间，超时将跑出异常。单位，毫秒数;默认为-1.表示永不超时.'), (103, '\tjmxEnabled： 当设置为true, 且服务开启的jmx服务时，使用jconsole, jvisualvm等工具将看到如下关于连接池的很全面的统计，这些统计结果有助于优化自己的配置。'), (104, ''), (105, '<img width=""100%"" src=""../../img/operate/operate/jedis-pool.png""/>'), (106, ''), (107, '### 其余配置如下：'), (108, '+\t 1. minEvictableIdleTimeMillis: 连接空闲的最小时间，达到此值后空闲连接将可能会被移除。负值(-1)表示永远不移除。默认-1。这个也很重要，一般不用移除，每次makeObject()开销比较大。'), (109, '+    2. numTestsPerEvictionRun: 对于“空闲连接”检测线程而言，每次检测的连接资源的个数。默认为3。'), (110, '+    3. testOnBorrow: 向调用者输出“连接”资源时，是否检测有效，如果无效则从连接池中移除，并尝试继续获取。默认为false。借资源时候是否要验证，比如jedis对象验证是ip:port是否发生改变，且执行一个ping命令。'), (111, '+    4. testOnReturn:  向连接池“归还”连接时，是否检测“连接”对象的有效性。默认为false。还资源时候是否要验证，同上。'), (112, '+    5. testWhileIdle:  向调用者输出“连接”对象时，是否检测它的空闲超时；如果“连接”空闲超时，将会被移除。默认为false。空闲是否要定时检查一遍所有的对象。'), (113, '+    6. timeBetweenEvictionRunsMillis:  “空闲连接”检测线程，检测的周期，毫秒数。如果为负值，表示不运行“检测线程”。默认为-1。'), (114, '+    7. whenExhaustedAction: 当“连接池”中active数量达到阀值时，即“连接”资源耗尽时，连接池需要采取的手段, 默认为1。'), (115, ''), (116, '<a name=""cc7""/>'), (117, ''), (118, '### 7. Redis-Sentinel类型的客户端调用过程（建议）'), (119, '(1) 初始化JedisSentinelPool (通常是单例的，可以通过java代码或者spring实现)，具体方法可以参考CacheCloud接入代码模块'), (120, '```Java'), (121, '//spring 配置'), (122, '<bean id=""redisSentinelFactory"" class=""com.sohu.tv.mobil.common.data.RedisSentinelFactory"" init-method=""init"">'), (123, '    <property name=""appId"" value=""appId""/>'), (124, '</bean>'), (125, '<bean id=""redisSentinelPool"" factory-bean=""redisSentinelFactory"" factory-method=""getJedisSentinelPool""/>'), (126, ''), (127, 'package xx.xx;'), (128, 'import com.sohu.tv.builder.ClientBuilder;'), (129, 'import org.apache.commons.pool2.impl.GenericObjectPoolConfig;'), (130, 'import org.slf4j.Logger;'), (131, 'import org.slf4j.LoggerFactory;'), (132, 'import redis.clients.jedis.JedisSentinelPool;'), (133, 'public class RedisSentinelFactory {'), (134, ''), (135, '    private final Logger logger = LoggerFactory.getLogger(this.getClass());'), (136, ''), (137, '    private JedisSentinelPool jedisSentinelPool;'), (138, ''), (139, '    private int appId;'), (140, ''), (141, '    public void init(){'), (142, '        //根据自己需要设置poolConfig'), (143, '        GenericObjectPoolConfig poolConfig = new GenericObjectPoolConfig();'), (144, '        poolConfig.setMaxTotal(GenericObjectPoolConfig.DEFAULT_MAX_TOTAL * 10);'), (145, '        poolConfig.setMaxIdle(GenericObjectPoolConfig.DEFAULT_MAX_IDLE * 5);'), (146, '        poolConfig.setMinIdle(GenericObjectPoolConfig.DEFAULT_MAX_IDLE * 2);'), (147, '        poolConfig.setMaxWaitMillis(1000L);'), (148, '        poolConfig.setJmxEnabled(true);'), (149, '        try {'), (150, '            //根据自己需要设置超时时间'), (151, '            jedisSentinelPool = ClientBuilder.redisSentinel(appId)'), (152, '                .setTimeout(2000)'), (153, '                .setPoolConfig(poolConfig)'), (154, '                .build();'), (155, '        } catch (Exception e) {'), (156, '            logger.error(e.getMessage(), e);'), (157, '        }'), (158, '    }'), (159, ''), (160, '    public JedisSentinelPool getJedisSentinelPool() {'), (161, '        return jedisSentinelPool;'), (162, '    }'), (163, ''), (164, '    public void setAppId(int appId) {'), (165, '        this.appId = appId;'), (166, '    }'), (167, '}'), (168, '```'), (169, ''), (170, '(2) 每次调用的建议写法：'), (171, '```Java'), (172, '\t\tJedis jedis = null;'), (173, '        try {'), (174, '            jedis = redisSentinelPool.getResource();'), (175, '            //jedis command'), (176, '        } catch (Exception e) {'), (177, '            logger.error(e.getMessage(), e);'), (178, '        } finally {'), (179, '            if (jedis != null)'), (180, '                jedis.close();'), (181, '        }'), (182, '```'), (183, '其中jedis.close()并非关闭连接（可能是jedis定义上带来的歧义），如果看jedis源码会发现close实现如下:'), (184, '```Java'), (185, '    public void close() {'), (186, '        if (dataSource != null) {'), (187, '            if (client.isBroken()) {'), (188, '                this.dataSource.returnBrokenResource(this);'), (189, '            } else {'), (190, '                this.dataSource.returnResource(this);'), (191, '            }'), (192, '        } else {'), (193, '            client.close();'), (194, '        }'), (195, '    }'), (196, '```'), (197, '它会帮助你决定returnBrokenResource还是returnResource来归回jedis连接对象，其中dataSource!=null说明使用pool管理jedis连接(具体可以参考JedisPool, JedisSentinelPool的实现中 setDataSource)。'), (198, ''), (199, '<a name=""cc8""/>'), (200, ''), (201, '### 8. Redis-Cluster类型的客户端调用过程（建议）'), (202, '相比于Redis-Sentinel类型Jedis-Cluster的调用相对简单(Jedis源码内部对于cluster节点的选择以及pool的管理做了透明处理)'), (203, '+ (1) 初始化JedisCluster(通常是单例的，可以通过java代码或者spring实现)，具体方法可以参考cachecloud接入代码模块。'), (204, '+ (2) 每次调用直接使用jedisCluster.command即可。'), (205, ''), (206, '<a name=""cc9""/>'), (207, ''), (208, '### 9. 数据库个数问题'), (209, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Redis实例（Redis-Cluster除外）默认提供了16个数据库，用户可以使用select x来实现数据库的切换，但是这个功能从总体上弊大于利，不建议使用，默认使用数据库0即可。'), (210, '具体原因：'), (211, '如果你在其他语言的客户端中执行Redis命令，并且该客户端没有像redis-cli那样一直显示目标数据库的号码，那么在数次切换数据库之后，你很可能会忘记自己当前正在使用的是哪个数据库。当出现这种情况时，为了避免对数据库进行误操作，在执行Redis命令特别是像FLUSHDB这样的危险命令之前，最好先执行一个SELECT命令，显式地切换到指定的数据库，然后才执行别的命令，总之会陷入混乱。'), (212, ''), (213, '<a name=""cc10""/>'), (214, ''), (215, '### 10. Redis-Sentinel类型应用统计中publish命令'), (216, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;细心的人会发现即使你的Redis-Sentinel类型的应用没做过任何publish操作，命令统计依然会有周期性publish的调用记录。'), (217, ''), (218, '<img width=""100%"" src=""../../img/operate/operate/publish.png""/>'), (219, ''), (220, ''), (221, '原因是因为sentinel为了保证高可用性，订阅节点上 __sentinel__:hello 频道上publish的信息，确认redis节点的可用性。'), (222, '所以这个统计用户不需要关心，可以忽略。'), (223, ''), (224, '<a name=""cc11""/>'), (225, ''), (226, '### 11. 命令执行模块问题'), (227, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为了保证数据安全，对于测试应用可以执行任意命令。'), (228, ''), (229, '<img width=""100%"" src=""../../img/operate/operate/cmd.png""/>'), (230, ''), (231, '对于线上应用，只允许执行如下命令：'), (232, ''), (233, '\tdebug,exists,object,ttl,type,scan,get,getbit,getrange,mget,setrange,strlen,hexists,hget,hgetall,hkeys,hlen,hmget,hvals,hscan,lindex,llen,'), (234, '\tlrange,scard,sismember,sscan,srandmember,zcard,zcount,zrange,zrangebyscore,zrank,zrevrange,zscore,zscan,dbsize,info,time,lastsave;')], 'deleted': []}"
433,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/baseOperate.toc.md,baseOperate.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* [1. 客户端服务机房问题](#cc1)'), (4, '* [2. 配置修改问题](#cc2)'), (5, '* [3. maxmemory-policy配置说明](#cc3)'), (6, '* [4. 数据清理问题](#cc4)'), (7, '* [5. 应用选型问题](#cc5)'), (8, '* [6. Jedis连接池GenericObjectPoolConfig配置](#cc6)'), (9, '* [7. Redis-Sentinel类型的客户端调用过程（建议）](#cc7)'), (10, '* [8. Redis-Cluster类型的客户端调用过程（建议）](#cc8)'), (11, '* [9. 数据库个数问题](#cc9)'), (12, '* [10. Redis-Sentinel类型应用统计中publish命令](#cc10)'), (13, '* [11. 命令执行模块问题](#cc11)')], 'deleted': []}"
434,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/baseOptimize.md,baseOptimize.md,1,"{'added': [(1, '## 系统运维优化'), (2, ''), (3, '### 1. aof持久化隔离自动运维'), (4, ''), (5, '<img src=""../../img/operate/optimize/aof-schedule.png"" width=""70%""/>'), (6, ''), (7, '异步工作线程扫描每台机器aof文件增长率。'), (8, '对于达到aof重写机制的实例在本机轮流触发重写，实现重写隔离机制。'), (9, ''), (10, '#### 2. redis复制流程分析和优化'), (11, ''), (12, '+ 2.1 redis复制操作'), (13, '分为全量复制和增量复制，全量复制开销主要在三方面：'), (14, '    + (a) master节点bgsave是rdb落地操作。'), (15, '    + (b) rdb文件在主从之间传输开销。'), (16, '    + (c) slave节点加载rdb文件，避免不必须的全量复制。'), (17, ''), (18, '+ 2.2 增量复制用于网络不稳定等原因造成rdb重传的问题'), (19, '    + (a) 使用psync master_run_id offset 向主节点获取miss数据，'), (20, '    + (b) master检查repl-backlog-buffer是否存在offset内的数据，'), (21, '    + (c) 存在时，发送增量数据'), (22, '    + (d) 不存在时做全量复制操作'), (23, ''), (24, '+ 2.3 总结：增量复制是否生效依赖于以下三点，根据应用场景做优化'), (25, '    + repl-backlog-size参数大小'), (26, '    + 主从节点写入量'), (27, '    + 主从网络环境'), (28, ''), (29, '### 3. redis-cluster 批量操作（mget）优化'), (30, ''), (31, 'redis-cluster节点不支持mget，mset等批量操作，client端只能批量get模拟mget操作，与redis节点通信io复杂度N(keys)。'), (32, ''), (33, 'CacheCloud-client端使用pipeline封装mget等批量操作，与redis节点通信io复杂度为N(nodes)。'), (34, ''), (35, '<img src=""../../img/operate/optimize/pipeline.png"" width=""60%""/>'), (36, '')], 'deleted': []}"
435,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/index.md,index.md,1,"{'added': [(1, '## CacheCloud运维手册'), (2, ''), (3, '本节主要介绍常用运维及系统优化，分以下方面：'), (4, ''), (5, '+ 1.[基础概念](baseConcept.md)：应用、实例、机器等运维'), (6, '+ 2.常用运维'), (7, '    + 2.1 [基础运维](baseOperate.md)'), (8, '    + 2.2 [应用部署](appDeploy.md)'), (9, '    + 2.3 [迁移工具](migrateTool.md)'), (10, '    + 2.4 [应用迁移](appMigrate.md)'), (11, '    + 2.5 [版本管理](../access/redisVersion.md)'), (12, '    + 2.6 [报警指标](appAlert.md)'), (13, '    + 2.7 [CacheCloud支持密码方案](rediscode.md)'), (14, '+ 3.[系统运维优化](baseOptimize.md)'), (15, ''), (16, '')], 'deleted': []}"
436,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/migrateTool.md,migrateTool.md,1,"{'added': [(1, '### 一、CacheCloud数据迁移工具能做什么？'), (2, ''), (3, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cachecloud数据迁移工具支持redis数据同步工作，可以完成如下功能：'), (4, ''), (5, '+ 支持任意两种类型的source和target进行数据迁移，如RDB文件、Redis Standalone、Redis Sentinel、Redis Cluster、CacheCloud应用；'), (6, '+ 迁移过程中，源集群不影响对外提供服务；'), (7, '+ 高效性，多线程并发迁移；'), (8, '+ 迁移过程便捷，流程可视化；'), (9, '+ 集成redis-migrate-tool、redis-shake redis数据同步的工具。'), (10, '+ 数据迁移具有实时性，所以使用合理可以基本保证数据一致性(原理可以参考第二小节)；'), (11, '+ 数据校验功能。'), (12, ''), (13, '<img width=""100%"" src=""../../img/operate/migrate/migratetool.png""/>'), (14, ''), (15, '### 二、CacheCloud数据迁移工具是如何实现的？'), (16, ''), (17, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CacheCloud数据迁移工具底层使用了redis-migrate-tool和redis-shake两种主流redis数据同步的工具。所以这里有必要对这两种数据迁移工具做简单说明。'), (18, ''), (19, '+ [redis-migrate-tool](https://github.com/vipshop/redis-migrate-tool)'), (20, ''), (21, '    redis-migrate-tool是用c语言开发的Redis数据迁移工具，可以做到在stadalone、sentinel、cluster、rdb(不支持做为target)彼此迁移数据，'), (22, '服务于唯品会公司数千个Redis节点，从数据迁移的准确性、稳定性、高效性等方面都能满足的生产环境的需求。'), (23, '使用文档：[https://github.com/vipshop/redis-migrate-tool](https://github.com/vipshop/redis-migrate-tool)'), (24, ''), (25, '+ [redis-shake](https://github.com/alibaba/RedisShake)'), (26, ''), (27, '    redis-migrate-tool仅支持Redis3-4的迁移，不支持redis5-5/4/3 版本数据同步(rdb文件解析异常)，而且已经不在维护，故升级为阿里云开源的redis-shake工具。'), (28, '    该工具友好地支持2.8-5.0版本的数据同步/解析、恢复、备份，支持多种部署结构迁移场景，后续会支持断点续传、多活等，且由Redis&MongoDB团队持续优化和维护。'), (29, '    使用文档： [https://github.com/alibaba/RedisShake](https://github.com/alibaba/RedisShake)'), (30, ''), (31, ''), (32, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;迁移工具是基于复制的原理，所以是实时迁移的，这点比起redis自带的redis-trib.rb的import 功能要方便很多。'), (33, '故CacheCloud选择它们作为数据迁移的基础组件，通过可视化的方式完成参数配置、节点数据迁移、进度查询、日志查询、配置查询和历史记录等一系列功能，使得数据迁移更简单、便捷。'), (34, ''), (35, '<img width=""100%"" src=""../../img/operate/migrate/cc-migrate-tool.png""/>'), (36, ''), (37, '### 三、CacheCloud数据迁移工具如何部署和使用'), (38, ''), (39, '1. 准备迁移工具机器'), (40, '    + 初始化机器，在“管理后台-机器管理”页面点击“添加新机器”，请参考相关文档；'), (41, '    + 添加机器时候，选择机器类型为“Redis迁移工具机器”，建议单独使用一台机器做迁移，因为迁移的过程可能会占用机器的很多资源。'), (42, '![](../../img/operate/migrate/cc-migrate-machine.png)'), (43, ''), (44, '2. 安装部署redis-migrate-tool/redis-shake'), (45, '    + redis-migrate-tool'), (46, '在“管理后台-系统配置管理”中配置安装目录，'), (47, '![](../../img/operate/migrate/cc-migrate-redis-migtool-dir.png)'), (48, '    安装方法可以参考redis-migrate-tool主页或者按照如下安装:'), (49, '        ```'), (50, '        $ cd /opt/cachecloud/'), (51, '        $ wget https://github.com/vipshop/redis-migrate-tool/archive/master.zip'), (52, '        $ mv master master.zip'), (53, '        $ unzip master.zip'), (54, '        $ mv redis-migrate-tool-master redis-migrate-tool'), (55, '        $ cd redis-migrate-tool'), (56, '        $ mkdir data'), (57, '        $ autoreconf -fvi'), (58, '        $ ./configure'), (59, '        $ make'), (60, '        $ src/redis-migrate-tool -h'), (61, '        ```'), (62, '      最为重要的一步是, 注意这里的cachecloud-open是ssh的用户名'), (63, '      ```'), (64, '      $ chown -R ${cachecloud-ssh-username}.${cachecloud-ssh-username} /opt/cachecloud/redis-migrate-tool'), (65, '      ```'), (66, '    + redis-shake'), (67, '    在“管理后台-系统配置管理”中配置安装目录：'), (68, '    ![](../../img/operate/migrate/cc-migrate-redis-shake-dir.png)'), (69, '    安装方法可以参考redis-shake主页或者按照如下安装：'), (70, '        ```'), (71, '        1.下载redis-shake安装包，下载地址 https://github.com/alibaba/RedisShake/releases'), (72, '        2.解压到/opt/cachecloud/redis-shake目录下'), (73, '        3.创建文件夹conf（存放配置文件）、 logs（存放日志）和pid（存放进程信息）'), (74, '        4.下载redis-full-check安装包，下载地址 https://github.com/alibaba/RedisFullCheck/releases'), (75, '        5.解压到/opt/cachecloud/redis-full-shake目录下'), (76, '        6.创建文件夹data（存放比对数据结果）'), (77, '        ```'), (78, '3. 添加迁移任务'), (79, '    a. 点击“迁移数据工具”进入迁移数据记录列表页面。'), (80, '    <img width=""100%"" src=""../../img/operate/migrate/cc-enter-migtool.png""/>'), (81, '    b. 在移数据记录列表中可以查看历史迁移任务信息，任务的配置文件、迁移状态、迁移日志，停止任务，进行数据校验等运维操作。'), (82, '    <img width=""100%"" src=""../../img/operate/migrate/cc-migrate-tasklist.png""/>'), (83, '    c. 点击“点击添加新的迁移按钮”，选择迁移工具，迁移机器，配置源和目标信息，点击验证按钮，按照通过后就开启了一个迁移的任务，回到迁移列表，就可以观察迁移日志、关闭迁移任务、迁移状态查询等。'), (84, '    <img width=""100%"" src=""../../img/operate/migrate/cc-migrate-addtask.png""/>'), (85, ''), (86, '4. 数据校验'), (87, '  - 数据迁移完毕后，点击“数据校验”按钮，跳转到如下界面，说明校验程序已经启动：'), (88, '    <img width=""100%"" src=""../../img/operate/migrate/cc-migrate-start-check.png""/>'), (89, '  - 可通过点击“校验日志”，查看log（默认log 5s刷新）：'), (90, '    <img width=""100%"" src=""../../img/operate/migrate/cc-migrate-checklog.png""/>'), (91, '  - 查看数据校验结果'), (92, '    校验数据报错在校验机器的/opt/cachecloud/redis-full-check/data目录下：'), (93, '    ![](../../img/operate/migrate/cc-migrate-checkres.png)'), (94, '    查看不一致结果记录到result文件：'), (95, '    ![](../../img/operate/migrate/cc-migrate-checkres2.png)'), (96, '### 四、客户端怎么迁移'), (97, '1. 当迁移工作基本完成后，我们就需要迁移客户端了，为了方便演示我们假设只有两个客户端。'), (98, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client1.png""/>'), (99, '2. 迁移第一个客户端，观察客户端是否出现异常。'), (100, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client2.png""/>'), (101, '3. 迁移第二个客户端，继续观察。'), (102, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client3.png""/>'), (103, '4. 检查source应用是否还有调用。'), (104, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client4.png""/>'), (105, '5. 下线source应用和迁移工具。'), (106, '<img width=""90%"" src=""../../img/operate/migrate/cc-migrate-client5.png""/>'), (107, '### 五、一些建议'), (108, '- 尽可能单独找一台机器作为迁移机器，因为迁移的过程可能会占用机器的很多资源；'), (109, '- redis-migrate-tool/redis-shake很具体的原理问题和细节可以到社区或CacheCloud群里找作者提问；'), (110, '- redis-shake使用或迁移日志中的问题可以参考：'), (111, '    [https://github.com/alibaba/RedisShake/wiki/FAQ](https://github.com/alibaba/RedisShake/wiki/FAQ)'), (112, '    [https://github.com/alibaba/RedisShake/issues](https://github.com/alibaba/RedisShake/issues)'), (113, '- 迁移工具页面还有很多要优化的地方，后期会听取大家意见逐渐改善。'), (114, ''), (115, ''), (116, '\u200b')], 'deleted': []}"
437,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/redisVersion.toc.md,redisVersion.toc.md,1,"{'added': [(1, '#### 目录'), (2, ''), (3, '* [一、目的](#cc1)'), (4, '* [二、新增版本及配置](#cc2)'), (5, '    * [2.1 新增版本](#cc21)'), (6, '    * [2.2 新增配置](#cc22)'), (7, '    * [2.3 申请应用](#cc23)'), (8, '* [三、应用版本升级](#cc3)')], 'deleted': []}"
438,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/rediscode.md,rediscode.md,1,"{'added': [(1, '## CacheCloud支持密码方案'), (2, ''), (3, '### 一. 密码设计'), (4, ''), (5, '\t密码粒度分布'), (6, '\t\t密码按照应用划分，相同应用的redis使用同一个密码。'), (7, '\t\t密码保持健壮性，防止被暴力破解，密码格式: `md5(key+{appId})`'), (8, '\t\t密码需要埋入SDK项目内部。'), (9, ''), (10, '## 二. 接入方式'), (11, ''), (12, '- 改造Jedis: 优点:升级sdk支持在线切换，数据没有丢失。缺点：只支持Jedis，其他接入方式需要手动修改修改密码，密码生成过程固定。'), (13, '````'), (14, '    a. standalone 模式: 改造JeidsPool.makeObject.'), (15, '    b. cluster 模式: 集群内所有节点使用同一密码，防止failover失败。Jedis改造JedisClusterConnectionHandler.initializeSlotsCache 方法。'), (16, '    c. sentinel模式:  主从所有节点必须使用同一个密码。改造JedisSentinelPool.initPool'), (17, '````'), (18, '- 支持失败判定：NOAUTH Authentication required 异常后，中断连接下次重连。'), (19, '````'), (20, '    a. RESTful请求携带密码。优点:不需要改造客户端，密码生成规则灵活 缺点：升级协同困难。'), (21, '    b. RESTful数据中密码字段使用对称加密，防止直接传输明文。'), (22, '````'), (23, '- 客户端sdk加入判断是否设置密码功能。'), (24, '````'), (25, '    a. 在线修改密码:'), (26, '        redis客户端连接未使用密码时，修改密码后报错需要重连。'), (27, '        redis客户端连接使用密码连接时，修改密码原有连接继续可用。'), (28, '````'), (29, ''), (30, '### 三、Cachecloud改造'), (31, ''), (32, '- 确保CacheCloud管理功能支持密码 修改和校验。'), (33, '- 代码点: Jeids,jedisPool , PipelineCluster , JedisCluster, redis-cli(shell)'), (34, '\t应用界面支持密码查询。'), (35, '- cachecloud 增加redis节点(三种类型)在线密码修改及配置落地。'), (36, '    - standalone'), (37, '    ````'), (38, '    1. 在线添加密码：config set requirepass 123'), (39, '    2. 有密码未认证测试：ping\t=> NOAUTH Authentication required'), (40, '    3. 有密码已认证测试: 验证密码 auth 123\t | ping => PONG'), (41, '    4. 持久化配置后测试：配置落地 config rewrite | auth 123 | ping=>PONG'), (42, '    ````'), (43, '    **结论**：standalone模式能够在线支持密码修改，并持久化配置，客户端auth之后可以正常使用，测试通过.'), (44, ''), (45, '\t- sentinel哨兵'), (46, '\t````'), (47, '\t**观察设置密码过程中master 、slave、sentinel的表现**'), (48, ''), (49, '\t1. 在线对maste添加密码：config set requirepass 123'), (50, '        1.1 slave表现为从master断开'), (51, '        1.2 由于sentinel无法和设有密码的master通信，故sentinel认为该节点down掉，选举'), (52, '            slave为master'), (53, ''), (54, '\t2.slave也设置密码：config set requirepass 123'), (55, '\t\t2.1 由于无法和master&slave通信，故认为都down掉了，sentinel会重复的进行选举'), (56, ''), (57, '\t3. sentinel在线修改配置：sentinel set ${mastername} auth-pass 123'), (58, '\t4. 强制刷新：sentinel flushconfig(redis版本>=3.0.2支持)'), (59, '\t5. slave此时并未完成master的密码配置，slave日志会有同步失败的日志'), (60, '        5.1 为slave设置链接master的密码：config set masterauth 123, slave full resync from master(master会做一次全量复制)'), (61, '        5.2 对master和slave执行config rewrite完成配置持久化'), (62, '\t````'), (63, '\t**结论**：'), (64, '\tsentinel模式下的master&slave，能够在线支持密码修改，并持久化配置，客户端auth之后可以正常使用，测试通过'), (65, '\t另外：由于sentinel模式下，master<->slave可能相互转换，所以，master和slave均需要配置requirepass和masterauth'), (66, ''), (67, '\t- cluster集群'), (68, '    ````'), (69, '\t1. 在线对maste添加密码：config set requirepass 123'), (70, '        1.1 slave变现为从master断开'), (71, '        1.2 redis cluster并未认为被设置密码的master down调，这点与sentinel表现不'), (72, '            同，估计gossip协议忽略了redis的密码'), (73, '        1.3 对slave设置链接master密码：config set masterauth passwd123 ,'), (74, '            slave full resync from master'), (75, '        1.4 对slave设置密码：config set requirepass 123'), (76, '        1.5 对master和slave进行持久化配置：config rewrite'), (77, '    ````'), (78, '\t**结论**：cluster模式能够在线支持密码修改，并ß持久化配置，客户端auth之后可以正常使用，测试通过,另外：由于cluster模式下，master<->slave可能相互转换，所以，master和slave均需要配置requirepass和masterauth.'), (79, ''), (80, '### 四、cachecloud后台设置'), (81, ''), (82, '- 创建应用,默认密码'), (83, ''), (84, ''), (85, '- 修改密码'), (86, '    <img src=""http://i0.itc.cn/20170814/aac_a309d856_c48c_5526_6e61_478f0382b321_2.png"" width=""100%""/>'), (87, ''), (88, '    - `更新`按钮:redis密码设置'), (89, '    - `校验`按钮:用于校验redis实例密码是否都设置成功'), (90, '')], 'deleted': []}"
439,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/operate/ssh.md,ssh.md,1,"{'added': [(1, '## Redis机器授权方式'), (2, ''), (3, '### 1.用户名/密码访问'), (4, ''), (5, '参考系统配置初始化参数，机器ssh用户名：${yourusername}/机器ssh密码${yourpassword}'), (6, ''), (7, '<a name=""cc52""/>'), (8, ''), (9, '### 2.公钥访问'), (10, ''), (11, '参考系统配置初始化参数，密钥路径：${path}/公钥用户名：${yourusername}'), (12, ''), (13, '> 生成公钥/私钥文件流程:'), (14, ''), (15, '#### 1.生成公钥/私钥文件'), (16, '```'), (17, '1).执行命令:ssh-keygen -t rsa -C ${yourusername} -f /opt/id_rsa(-f可指定文件路径)'), (18, '2).目录: /opt'), (19, '3).公钥文件:id_rsa.pub'), (20, '4).私钥文件:id_rsa'), (21, '```'), (22, ''), (23, '#### 2.公钥/私钥配置方式'), (24, ''), (25, '- 2.1 公钥配置'), (26, ''), (27, '所有Redis机器需要基于cachecloud用户目录下写入公钥信息并授权'), (28, '````'), (29, '1).写入公钥信息:'), (30, 'echo ""***"" >> /home/cachecloud/.ssh/authorized_keys  （***为上面生成id_rsa.pub公钥信息）'), (31, '2).文件权限:'), (32, 'chmod 755 /home/cachecloud/.ssh/authorized_keys'), (33, '````'), (34, ''), (35, '- 2.2 私钥配置'), (36, ''), (37, 'cachecloud后台机器上配置私钥'), (38, '````'), (39, '1).指定私钥文件路径：/opt/ssh/id_rsa'), (40, '2).授权私钥文件权限：chmod 600 /opt/ssh/id_rsa'), (41, '3).通过cachecloud用户登录redis机器: ssh -i /opt/ssh/id_rsa -l cachecloud ${ip}'), (42, '````'), (43, ''), (44, '#### 3.后台配置公钥/私钥信息'), (45, ''), (46, '- 密钥路径：cachecloud机器上id_rsa文件路径'), (47, '- 公钥用户名： 连接Redis机器的用户名'), (48, ''), (49, '<img width=""60%"" height=""40%"" src=""../../img/access/config.png""/>')], 'deleted': []}"
440,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/quickstart/index.md,index.md,1,"{'added': [(1, '## 快速接入 quick start'), (2, '”快速接入“ 帮助你快速启动cachecloud中台，并创建一个应用。'), (3, '<img src=""../../img/quickstart/quickstart.png"" width=""60%""/>'), (4, ''), (5, '<a name=""cc1""/>'), (6, ''), (7, '### 一、准备war包'), (8, 'a.下载war包：[cachecloud-web.war](http://47.97.112.178/redis-ecs/cachecloud-web.war)'), (9, ''), (10, 'b.也可以clone源码，自行打包：'), (11, ''), (12, '\t//clone项目'), (13, '\tgit clone https://github.com/sohutv/cachecloud.git'), (14, '\t//打包'), (15, '\tmvn clean package'), (16, ''), (17, '<a name=""cc2""/>'), (18, ''), (19, '### 二、初始化数据'), (20, '导入项目sql目录下初始化库表结构，默认插入admin超级管理员。'), (21, ''), (22, '创建数据库：'), (23, ''), (24, '\turl: jdbc:mysql://xxx:3306/cachecloud_open'), (25, '\tuser: xxx'), (26, '\tpassword: xxx'), (27, ''), (28, '导入建表文件：/cachecloud-open/cachecloud-web/sql/cc2.0.sql'), (29, ''), (30, '<a name=""cc3""/>'), (31, ''), (32, '### 三、启动工程'), (33, '准备配置文件：application-open.yml'), (34, ''), (35, '\t#配置应用名称'), (36, '\tspring:'), (37, '\t  application:'), (38, '\t    name: cloud.cachecloud-web.open'), (39, '\t#配置数据库'), (40, '\tcachecloud:'), (41, '\t  primary: #mysql数据库'), (42, '\t    url: ${jdbcUrl}'), (43, '\t    user: ${username}'), (44, '\t    password: ${password}'), (45, '\t  redis: #配置cachecloud-web需要的redis，用户存储任务流日志，可稍后配置'), (46, '\t    main:'), (47, '\t      host: 127.0.0.1'), (48, '\t      port: 6379'), (49, '\t      password:'), (50, '\t#配置访问端口,默认8080'), (51, '\tserver:'), (52, '\t  port: 8080'), (53, '启动工程'), (54, ''), (55, ' \t//启动web工程'), (56, '\tnohup java -jar -Dspring.profiles.active=open -Dspring.config.location=${配置文件路径} cachecloud-web.war &'), (57, ''), (58, '访问web：<http://localhost:8080/manage/login> 使用默认管理员账户登录：用户名 admin 密码 admin'), (59, '<img src=""../../img/quickstart/login.png"" width=""50%""/>'), (60, ''), (61, '<a name=""cc4""/>'), (62, ''), (63, '### 四、系统初始配置'), (64, '系统已有默认配置，如需更改，请参考 [系统配置说明](../access/config.md)。'), (65, ''), (66, '<a name=""cc5""/>'), (67, ''), (68, '### 五、创建一个用户'), (69, '新用户注册：<http://localhost:8080/user/register> 提交用户注册申请。'), (70, '<img src=""../../img/quickstart/register.png"" width=""60%""/>'), (71, ''), (72, '管理员审核（<http://localhost:8080/manage/app/auditList>）通过后，用户可登录/使用系统。'), (73, ''), (74, ''), (75, '<a name=""cc6""/>'), (76, ''), (77, '### 六、准备资源'), (78, ''), (79, '<a name=""cc61""/>'), (80, ''), (81, '* 1.准备脚本'), (82, ''), (83, '\t下载 [cachecloud-init.sh](http://47.97.112.178/redis-ecs/script)'), (84, ''), (85, '\t\tcachecloud-init.sh脚本作用：'), (86, '\t\ta.初始化环境变量'), (87, '\t\tb.创建用户;'), (88, '\t\tc.创建公钥私钥；'), (89, '\t\td.创建默认redis路径并授权;'), (90, '\t\te.默认安装""redis-3.0.7"" ""redis-4.0.14"" ""redis-5.0.9"";'), (91, '\t\t  注意：Redis6.0及以上版本需要依赖操作系统gcc4.9.0以上版本编译'), (92, '\t\tf.@usage: sh cachecloud-init.sh [username]'), (93, ''), (94, '<a name=""cc62""/>'), (95, ''), (96, '* 2.执行脚本'), (97, ''), (98, '\t采用”用户名/密码“授权方式，请确保机器的用户名/密码与cachecloud后台”系统配置“页面的”机器ssh用户名/机器ssh密码“一致。'), (99, ''), (100, '\t\ta.使用root登录目标服务器;'), (101, '\t\tb.将cachecloud-init.sh脚本拷贝到目标服务器当前用户目录下/opt ;'), (102, '\t\tc.执行 sh cachecloud-init.sh ${username}，默认username=""cachecloud-open""；'), (103, '\t\td.两次确认密码;'), (104, '\t\te.一路安装直到成功。'), (105, ''), (106, '<a name=""cc63""/>'), (107, ''), (108, '* 3.添加机器'), (109, ''), (110, '\t将刚准备好资源的机器添加到cachecloud中台：<http://localhost:8080/manage/machine/list>'), (111, '\t<img src=""../../img/quickstart/addmachine.png"" width=""50%""/>'), (112, ''), (113, '<a name=""cc7""/>'), (114, ''), (115, '### 七、创建一个应用'), (116, ''), (117, '<a name=""cc71""/>'), (118, ''), (119, '* 1.申请应用'), (120, ''), (121, '\t用户申请应用<http://localhost:8080/admin/app/init>。'), (122, ''), (123, '<a name=""cc72""/>'), (124, ''), (125, '* 2.部署应用'), (126, ''), (127, '\ta.管理员审批应用申请：<http://localhost:8080/manage/app/auditList>，点击”审批处理“。'), (128, ''), (129, '\t<img src=""../../img/quickstart/appjob.png"" width=""100%""/>'), (130, ''), (131, '\tb.应用部署：点击”生成部署预览“，确认拓扑无误，点击”开始部署“，跳转到应用部署任务流。'), (132, '\t<img src=""../../img/quickstart/appdeploy.png"" width=""80%""/>'), (133, ''), (134, '\tc.通过：等待应用部署成功后，在审批页点击”通过“，就此应用开通成功。用户接入使用可参考：[客户端接入文档](../access/client.md)。'), (135, ''), (136, '\t(提示：任务流日志是存储在redis中的，即项目启动时配置文件application-open.yml中的cachecloud.redis信息)'), (137, ''), (138, '\t<img src=""../../img/quickstart/apptask.png"" width=""80%""/>')], 'deleted': []}"
441,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/quickstart/index.toc.md,index.toc.md,1,"{'added': [(1, '##### 目录'), (2, '* [一、准备war包](#cc1)'), (3, '* [二、初始化数据](#cc2)'), (4, '* [三、启动工程](#cc3)'), (5, '* [四、系统初始配置](#cc4)'), (6, '* [五、创建一个用户](#cc5)'), (7, '* [六、准备资源](#cc6)'), (8, '    * [1.准备脚本](#cc61)'), (9, '    * [2.执行脚本](#cc62)'), (10, '    * [3.添加机器](#cc63)'), (11, '* [七、创建一个应用](#cc7)'), (12, '    * [1.申请应用](#cc71)'), (13, '    * [2.部署应用](#cc72)')], 'deleted': []}"
442,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/activefrag.md,activefrag.md,1,"{'added': [(1, '## activeDefrag引起redis周期性延迟'), (2, ''), (3, '<a name=""c1""/>'), (4, ''), (5, '### 1.问题描述'), (6, ''), (7, 'redis客户端连接Redis节点会出现周期性超时情况，CC监控排查到cpu使用率异常。'), (8, ''), (9, '<img src=""../../img/troubleshooting/cpu-monitor.png"" width=""100%"" />'), (10, ''), (11, '客户端机器测试redis节点延迟情况:'), (12, ''), (13, '````'), (14, 'redis-cli -h 10.19.122.69 -p 6387 -a 5d948b734065a8f163cb931701b7ade2 --latency-history'), (15, '** min: 0, max: 2894, avg: 3.87 (1077 samples) -- 15.01 seconds range **'), (16, 'min: 0, max: 30, avg: 1.20 (1332 samples) -- 15.02 seconds range'), (17, 'min: 0, max: 218, avg: 1.40 (1308 samples) -- 15.01 seconds range'), (18, 'min: 0, max: 25, avg: 1.23 (1327 samples) -- 15.00 seconds range'), (19, 'min: 0, max: 20, avg: 1.25 (1326 samples) -- 15.01 seconds range'), (20, 'min: 0, max: 21, avg: 1.24 (1326 samples) -- 15.01 seconds range'), (21, 'min: 0, max: 74, avg: 1.33 (1315 samples) -- 15.01 seconds range'), (22, 'min: 0, max: 37, avg: 1.25 (1325 samples) -- 15.00 seconds range'), (23, '** min: 0, max: 2435, avg: 3.65 (1094 samples) -- 15.01 seconds range **'), (24, 'min: 0, max: 18, avg: 1.22 (1329 samples) -- 15.01 seconds range'), (25, '** min: 0, max: 2810, avg: 3.80 (1081 samples) -- 15.00 seconds range **'), (26, 'min: 0, max: 30, avg: 1.23 (1329 samples) -- 15.02 seconds range'), (27, 'min: 0, max: 210, avg: 1.38 (1309 samples) -- 15.00 seconds range'), (28, 'min: 0, max: 28, avg: 1.27 (1323 samples) -- 15.01 seconds range'), (29, 'min: 0, max: 21, avg: 1.24 (1328 samples) -- 15.02 seconds range'), (30, 'min: 0, max: 70, avg: 1.35 (1320 samples) -- 15.08 seconds range'), (31, 'min: 0, max: 28, avg: 1.23 (1328 samples) -- 15.01 seconds range'), (32, 'min: 0, max: 37, avg: 1.26 (1324 samples) -- 15.01 seconds range'), (33, '** min: 0, max: 2456, avg: 3.64 (1094 samples) -- 15.00 seconds range **'), (34, 'min: 0, max: 19, avg: 1.23 (1327 samples) -- 15.00 seconds range'), (35, 'min: 0, max: 2953, avg: 3.90 (1073 samples) -- 15.00 seconds range'), (36, 'min: 0, max: 29, avg: 1.20 (1331 samples) -- 15.01 seconds range'), (37, '....'), (38, '````'), (39, ''), (40, '上面带**的最大耗时均为秒级，redis节点周期性的出现延迟。'), (41, ''), (42, '<a name=""c2""/>'), (43, ''), (44, '### 2. 故障定位'), (45, ''), (46, '排查慢查询，命令分析，IO问题定位 均无法定位问题，集中把异常的节点变为从节点，主节点使用dkmanager机器，延迟问题得到恢复。'), (47, '在延迟的从节点上开启watchdog观察redis本身的慢调用栈。'), (48, ''), (49, '````'), (50, '# 超过100毫秒记录redis调用栈'), (51, 'CONFIG SET watchdog-period 100'), (52, '````'), (53, '跟踪redis日志，发现周期性输出如下调用栈。'), (54, '````'), (55, 'Backtrace:'), (56, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](logStackTrace+0x3c)[0x4673fc]'), (57, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](watchdogSignalHandler+0x1b)[0x4674ab]'), (58, '/lib64/libpthread.so.0(+0xf7e0)[0x7f24bf9c37e0]'), (59, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](dictIterDefragEntry+0x6c)[0x496c3c]'), (60, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](defragKey+0x25a)[0x49703a]'), (61, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](defragScanCallback+0x9)[0x497209]'), (62, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](dictScan+0x23a)[0x426e7a]'), (63, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](activeDefragCycle+0x1da)[0x49666a]'), (64, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](databasesCron+0x7b)[0x42ae3b]'), (65, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](serverCron+0x193)[0x42cae3]'), (66, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](aeProcessEvents+0x32f)[0x424ecf]'), (67, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](aeMain+0x2b)[0x42509b]'), (68, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster](main+0x500)[0x42d750]'), (69, '/lib64/libc.so.6(__libc_start_main+0xfd)[0x7f24bf63ed1d]'), (70, '/opt/cachecloud/redis-4.0.11/src/redis-server 0.0.0.0:6387 [cluster][0x422409]'), (71, '3884:signal-handler (1570711815) --------'), (72, '````'), (73, '堆栈信息定位是 redis内部定时任务触发的在线内存碎片整理逻辑，redis 定时任务和网络IO事件共享单线程架构。'), (74, ''), (75, '慢调用栈输出时间点和客户端延迟时间点吻合，初步定位是该问题导致。'), (76, ''), (77, '关闭在线碎片整理，延迟调用问题恢复。'), (78, ''), (79, '````'), (80, 'min: 0, max: 2488, avg: 3.61 (1098 samples) -- 15.00 seconds range'), (81, 'min: 0, max: 28, avg: 1.17 (1335 samples) -- 15.00 seconds range'), (82, 'min: 0, max: 2972, avg: 3.94 (1072 samples) -- 15.00 seconds range'), (83, 'min: 0, max: 27, avg: 1.14 (1340 samples) -- 15.02 seconds range'), (84, 'min: 0, max: 30, avg: 1.19 (1334 samples) -- 15.01 seconds range'), (85, 'min: 0, max: 223, avg: 1.34 (1316 samples) -- 15.01 seconds range'), (86, 'min: 0, max: 28, avg: 1.15 (1338 samples) -- 15.01 seconds range'), (87, 'min: 0, max: 17, avg: 1.14 (1339 samples) -- 15.01 seconds range'), (88, '# config set activedefrag no 关闭在线碎片整理时间点'), (89, 'min: 0, max: 16, avg: 0.36 (1439 samples) -- 15.01 seconds range'), (90, 'min: 0, max: 1, avg: 0.06 (1482 samples) -- 15.01 seconds range'), (91, 'min: 0, max: 1, avg: 0.05 (1482 samples) -- 15.01 seconds range'), (92, 'min: 0, max: 1, avg: 0.07 (1482 samples) -- 15.01 seconds range'), (93, 'min: 0, max: 7, avg: 0.07 (1481 samples) -- 15.01 seconds range'), (94, '````'), (95, ''), (96, '开启和关闭节点CPU表现:'), (97, ''), (98, '<img src=""../../img/troubleshooting/machine-cpu-monitor.png"" width=""100%"" />'), (99, ''), (100, '<a name=""c3""/>'), (101, ''), (102, '### 3.进一步定位'), (103, ''), (104, '查看redis关于碎片整理的源码，Redis碎片代码整理粒度:'), (105, ''), (106, '<span style=""color:red;font:blod"">当redis_version <= 4.0.xx ，在线内存整理以键作为最小扫描单位，针对非字符串的结构需要迭代所有的元素指针才能返回，复杂度为O(N)。因此对于非字符串bigkeys碎片整理，返回时间不再可控从而造成阻塞。</span>'), (107, ''), (108, 'Redis 4.0.x 源码: redis<= 4.0.x之前的代码碎片整理迭代逻辑，至少扫描16个键或指针整理数超过1000，检查cpu使用超时退出。'), (109, ''), (110, '````'), (111, '//defrag.c'), (112, 'do {'), (113, '    cursor = dictScan(db->dict, cursor, defragScanCallback, defragDictBucketCallback, db);'), (114, '    /* Once in 16 scan iterations, or 1000 pointer reallocations'), (115, '     * (if we have a lot of pointers in one hash bucket), check if we'), (116, '     * reached the tiem limit. */'), (117, '    if (cursor && (++iterations > 16 || server.stat_active_defrag_hits - defragged > 1000)) {'), (118, '        if ((ustime() - start) > timelimit) {'), (119, '            return;'), (120, '        }'), (121, '        iterations = 0;'), (122, '        defragged = server.stat_active_defrag_hits;'), (123, '    }'), (124, '} while(cursor);'), (125, '````'), (126, ''), (127, 'Redis 5.0.x 源码:'), (128, ''), (129, '<span style=""color:red;font:blod"">redis> 5.0.x 升级日志 ""Active defragmentation version 2"",'), (130, ''), (131, '碎片扫描粒度：16次迭代或512次指针移动或64个碎片扫描，检测超时时间。</span>'), (132, ''), (133, '````'), (134, '//degrag.c'), (135, '/* Perform incremental defragmentation work from the serverCron.'), (136, ' * This works in a similar way to activeExpireCycle, in the sense that'), (137, ' * we do incremental work across calls. */'), (138, 'void activeDefragCycle(void) {'), (139, '        // ....'), (140, '        do {'), (141, '            /* before scanning the next bucket, see if we have big keys left from the previous bucket to scan */'), (142, '            //扫描完整个db后，按 bigkeys 的元素进行迭代扫描'), (143, '            if (defragLaterStep(db, endtime)) {'), (144, ""                quit = 1; /* time is up, we didn't finish all the work */""), (145, ""                break; /* this will exit the function and we'll continue on the next cycle */""), (146, '            }'), (147, '            // 按键迭代扫描'), (148, '            cursor = dictScan(db->dict, cursor, defragScanCallback, defragDictBucketCallback, db);'), (149, ''), (150, '            /* Once in 16 scan iterations, 512 pointer reallocations. or 64 keys'), (151, '             * (if we have a lot of pointers in one hash bucket or rehasing),'), (152, '             * check if we reached the time limit.'), (153, ""             * But regardless, don't start a new db in this loop, this is because after""), (154, '             * the last db we call defragOtherGlobals, which must be done in once cycle */'), (155, '            if (!cursor || (++iterations > 16 ||'), (156, '                            server.stat_active_defrag_hits - prev_defragged > 512 ||'), (157, '                            server.stat_active_defrag_scanned - prev_scanned > 64)) {'), (158, '                if (!cursor || ustime() > endtime) {'), (159, '                    quit = 1;'), (160, '                    break;'), (161, '                }'), (162, '                iterations = 0;'), (163, '                prev_defragged = server.stat_active_defrag_hits;'), (164, '                prev_scanned = server.stat_active_defrag_scanned;'), (165, '            }'), (166, '        } while(cursor && !quit);'), (167, '    } while(!quit);'), (168, ''), (169, '    latencyEndMonitor(latency);'), (170, '    latencyAddSampleIfNeeded(""active-defrag-cycle"",latency);'), (171, '}'), (172, '````'), (173, '<img src=""../../img/troubleshooting/activefrag-code.png"" width=""100%"" />'), (174, ''), (175, '<span style=""color:red"">碎片扫描逻辑默认对元素数超过1000的结构放入链表中延迟处理，待整个DB扫描完毕后再单独按元素扫描，解决bigkeys引起的阻塞和时效性问题。</span>'), (176, ''), (177, '<span style=""color:green"">5.0 新增参数配置:</span>'), (178, ''), (179, '````'), (180, '# Maximum number of set/hash/zset/list fields that will be processed from the main dictionary scan'), (181, '# active-defrag-max-scan-fields 1000'), (182, '````'), (183, '<a name=""c4""/>'), (184, ''), (185, '### 4.优化方案'), (186, ''), (187, '- <span style=""color:green"">优化方案:</span>'), (188, '    - redis版本 <= 4.0.x，关闭碎片整理 config set activedefrag no；'), (189, '    - redis版本 <= 4.0.x，扫描bigkey并优化，防止因遍历bigkey导致阻塞；'), (190, '    - 升级到redis版本到4.0.14 或 5.0.x以上版本,新增配置对bigkey遍历键项数 active-defrag-max-scan-fields 1000(默认配置)；')], 'deleted': []}"
443,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/activefrag.toc.md,activefrag.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* 一、[问题描述](#c1)'), (4, '* 二、[故障定位](#c2)'), (5, '* 三、[进一步定位](#c3)'), (6, '* 四、[优化方案](#c4)')], 'deleted': []}"
444,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/bigkey.md,bigkey.md,1,"{'added': [(1, '## bigkey的寻找和优化'), (2, ''), (3, '* [一、什么是bigkey](#cc1)'), (4, '* [二、bigkey的危害](#cc2)'), (5, '* [三、如何发现](#cc3)'), (6, '* [四、如何删除](#cc4)'), (7, '* [五、如何优化](#cc5)'), (8, '* [六、总结](#cc6)'), (9, ''), (10, '### 一、什么是bigkey'), (11, ''), (12, '虽然叫bigkey，但实际上它是指key对应的value所占的内存空间比较大，例如一个字符串类型的value可以最大存到512M，一个列表类型的value最多可以存储2的32次方减1个元素(大约4G)。'), (13, '如果按照数据结构来细分的话，一般分为字符串类型bigkey和非字符串类型bigkey：'), (14, ''), (15, '1. 字符串类型：它的big体现在单个value值很大，一般认为超过100KB就是bigkey。'), (16, '2. 非字符串类型：哈希、列表、集合、有序集合，它们的big体现在元素个数太多。'), (17, ''), (18, '### 二、bigkey的危害'), (19, ''), (20, 'bigkey的危害比较多的，主要体现在以下方面:'), (21, ''), (22, '1. 内存空间不均匀(平衡)：在Redis集群中，bigkey会造成部分节点的内存空间使用不均匀。'), (23, ''), (24, '    <img src=""../../img/troubleshooting/mem-imbalance.png"" width=""100%""/>'), (25, ''), (26, '2. 超时阻塞：由于Redis单线程的特性，操作bigkey的比较耗时，也就意味着阻塞Redis可能性越大，这样会造成客户端阻塞或者引起故障切换。'), (27, ''), (28, '3. 网络拥塞：bigkey也就意味着每次获取要产生的网络流量较大，假设一个bigkey为1M，客户端每秒访问量为1000，那么每秒产生1000M的流量，对于普通的千兆网卡(按照字节算是128MB/s)的服务器来说简直是灭顶之灾，而且一般服务器会采用单机多实例的方式来部署，也就是说一个bigkey可能会对其他实例造成影响，其后果不堪设想。'), (29, ''), (30, '4. 过期删除：如果没有使用Redis 4.0的过期异步删除(lazyfree-lazy-expire yes)，就会存在阻塞Redis的可能性，而且这个过期删除不会从主节点的慢查询发现（因为这个删除不是客户端产生的，是内部循环事件，可以从latency命令中获取或者从slave节点慢查询发现）。'), (31, ''), (32, '5. [内存碎片整理](activefrag.md)：在redis4.0.*版本如果开启碎片整理且存在超大bigkey，可能会导致客户端出现周期性超时问题。'), (33, ''), (34, ''), (35, '### 三、如何发现'), (36, ''), (37, '1. redis-cli --bigkeys'), (38, ''), (39, '    redis-cli提供了--bigkeys来查找bigkey，例如下面就是一次执行结果：'), (40, ''), (41, '    ````'), (42, '    -------- summary -------'), (43, ''), (44, '    Sampled 215036 keys in the keyspace!'), (45, '    Total key length in bytes is 13428208 (avg len 62.45)'), (46, ''), (47, ""    Biggest string found 'v4_firstPageData_*****' has 2549527 bytes""), (48, ""    Biggest    set found 'ASSOCIATE_TRACE_CHILDREN_*******' has 7322 members""), (49, ""    Biggest   zset found 'TEMPLATE_STRATEGY_*****_' has 10 members""), (50, ''), (51, '    159497 strings with 3183765503 bytes (74.17% of keys, avg size 19961.29)'), (52, '    0 lists with 0 items (00.00% of keys, avg size 0.00)'), (53, '    55535 sets with 130291 members (25.83% of keys, avg size 2.35)'), (54, '    0 hashs with 0 fields (00.00% of keys, avg size 0.00)'), (55, '    4 zsets with 25 members (00.00% of keys, avg size 6.25)'), (56, '    0 streams with 0 entries (00.00% of keys, avg size 0.00)'), (57, '    ````'), (58, '    可以看到--bigkeys扫描给出了每种数据结构的top1 bigkey，同时给出了每种数据类型的键值个数以及平均大小。'), (59, ''), (60, '    --bigkeys对问题的排查非常方便，但是在使用它时候也有几点需要注意：'), (61, '    ````'), (62, '    1. 建议对从节点执行，由于--bigkeys是通过scan扫描完成的；'), (63, '    2. 建议在从节点机器上去执行，减少网络开销；'), (64, '    3. 如果没有从节点，可通过-i 参数控制执行频率(-i 0.1 每100ms执行一次)'), (65, '    ````'), (66, ''), (67, '2. debug object'), (68, ''), (69, '    Redis提供了debug object ${key}命令获取键值的相关信息：'), (70, '    ````'), (71, '    127.0.0.1:6379> hlen hash_obj'), (72, '    (integer)500000'), (73, '    127.0.0.1:6379> debug object hash_obj'), (74, '    Value at:0x7fc06c1b1430 refcount:1 encoding:raw serializedlength:87256350 lru:11686193 lru_seconds_idle:20'), (75, '    (1.08s)'), (76, '    ````'), (77, '    其中serializedlength表示key对应的value序列化之后的字节数,这样你就可以用scan + debug object的方式遍历Redis所有的键值.'), (78, '    不过debug object命令执行如果遇到bigkey也可能会阻塞客户端，建议对从节点执行。'), (79, ''), (80, '3. memory usage'), (81, ''), (82, '    memory usage ${key} 用于分析某个key在redis内部实际占用多少内存(单位：字节)，从Redis 4.0开始及以上版本支持。'), (83, '    ````'), (84, '    127.0.0.1:6379> memory usage bighash (bighash占用内存686KB)'), (85, '    (integer) 686755'), (86, '    127.0.0.1:6379> DEBUG OBJECT bighash （bighash序列化大小为227KB）'), (87, '    Value at:0x7f00c8e884b0 refcount:1 encoding:hashtable serializedlength:227790 lru:7578074 lru_seconds_idle:288'), (88, '    127.0.0.1:6379> hlen bighash'), (89, '    (integer) 10000'), (90, '    127.0.0.1:6379> memory usage key:001016520509'), (91, '    (integer) 65'), (92, '    ````'), (93, '    如果你使用Redis 4.0+，你就可以用scan + memory usage替代scan + debug object的方式遍历Redis所有的键值,执行速度也较快。'), (94, ''), (95, '4. 监控报警'), (96, ''), (97, '    bigkey的大操作，通常会引起客户端输入或者输出缓冲区的异常，Redis提供了info clients里面包含的客户端输入缓冲区的字节数以及输出缓冲区的队列长度，可以重点关注下：'), (98, ''), (99, '    ````'), (100, '    instanceId:9427> info clients'), (101, '    # Clients'), (102, '    connected_clients:58'), (103, '    client_longest_output_list:0'), (104, '    client_biggest_input_buf:0'), (105, '    blocked_clients:0'), (106, ''), (107, '    以下为6.0版本，会记录历史最大输入、输出缓冲区队列'), (108, '    127.0.0.1:6379> info clients'), (109, '    # Clients'), (110, '    connected_clients:1'), (111, '    client_recent_max_input_buffer:2'), (112, '    client_recent_max_output_buffer:0'), (113, '    ````'), (114, '    如果想知道具体哪个客户端ip，可以使用client list命令来查找。'), (115, '    ````'), (116, '    127.0.0.1:6379> client list'), (117, '    id=3 addr=127.0.0.1:56040 fd=9 name= age=161 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=26 qbuf-free=32742 obl=0 oll=0 omem=0 events=r cmd=client'), (118, '    ````'), (119, ''), (120, '### 四、如何删除'), (121, ''), (122, '当发现Redis中有bigkey时并且确认要删除时，如何优雅地删除bigkey？下面给出一组测试数据分别对string、hash、list、set、sorted set五种数据结构的bigkey进行删除，bigkey的元素个数和每个元素的大小不尽相同。'), (123, ''), (124, ''), (125, '1. 下图为删除512K~10M的字符串类型数据所花费的时间，总体来说由于字符串类型结构相对简单，删除速度比较快，但是随着value值的不断增大，删除速度也逐渐变慢。'), (126, ''), (127, '    <img src=""../../img/troubleshooting/delstr-cost.png"" width=""60%""/>'), (128, ''), (129, '2. 下图展示了非字符串类型在不同数量级、不同元素大小下对bigkey执行del的时间，总体上看元素个数越多，元素越大删除时间越长，并相对于字符串类型，这种删除速度已经足够可以阻塞掉Redis。'), (130, ''), (131, '    <img src=""../../img/troubleshooting/del-cost.png"" width=""100%""/>'), (132, ''), (133, '    <img src=""../../img/troubleshooting/del-compare.png"" width=""60%""/>'), (134, ''), (135, '看到除了string类型，其他四种数据结构元素数量和每个元素字节数越大删除的速度越慢，这样的删除速度势必会阻塞Redis。既然不能用del，那有没有比较优雅的方式进行删除呢，这时候就需要将第三章介绍的scan命令的若干类似命令拿出来：sscan、hscan、zscan。'), (136, ''), (137, '1. 字符串：'), (138, ''), (139, '  一般来说，对于string类型使用del命令不会产生阻塞。'), (140, ''), (141, '2. hash：'), (142, ''), (143, '  使用hscan命令，每次获取部分(例如100个)field-value，在利用hdel删除每个field(为了快速可以使用pipeline)。'), (144, ''), (145, '    ````'), (146, '    public void delBigHash(String bigKey) {'), (147, '        Jedis jedis = new Jedis(""127.0.0.1"", 6379);'), (148, '        // 游标'), (149, '        String cursor = ""0"";'), (150, '        while (true) {'), (151, '            ScanResult<Map.Entry<String, String>> scanResult = jedis.hscan(bigKey, cursor, new ScanParams().count(100));'), (152, '            // 每次扫描后获取新的游标'), (153, '            cursor = scanResult.getStringCursor();'), (154, '            // 获取扫描结果'), (155, '            List<Entry<String, String>> list = scanResult.getResult();'), (156, '            if (list == null || list.size() == 0) {'), (157, '                continue;'), (158, '            }'), (159, '            String[] fields = getFieldsFrom(list);'), (160, '            // 删除多个field'), (161, '            jedis.hdel(bigKey, fields);'), (162, '            // 游标为0时停止'), (163, '            if (cursor.equals(""0"")) {'), (164, '                break;'), (165, '            }'), (166, '        }'), (167, '        //最终删除key'), (168, '        jedis.del(bigKey);'), (169, '    }'), (170, ''), (171, '    /**'), (172, '     * 获取field数组'), (173, '     * @param list'), (174, '     * @return'), (175, '     */'), (176, '    private String[] getFieldsFrom(List<Entry<String, String>> list) {'), (177, '        List<String> fields = new ArrayList<String>();'), (178, '        for(Entry<String, String> entry : list) {'), (179, '            fields.add(entry.getKey());'), (180, '        }'), (181, '        return fields.toArray(new String[fields.size()]);'), (182, '    }'), (183, '    ````'), (184, ''), (185, '3. list'), (186, ''), (187, '    Redis并没有提供lscan这样的API来遍历列表类型，但是提供了ltrim这样的命令可以渐进式的删除列表元素，直到把列表删除。'), (188, ''), (189, '4. set'), (190, ''), (191, '    使用sscan命令，每次获取部分(例如100个)元素，在利用srem删除每个元素。'), (192, ''), (193, '    ````'), (194, '    public void delBigSet(String bigKey) {'), (195, '        Jedis jedis = new Jedis(""127.0.0.1"", 6379);'), (196, '        // 游标'), (197, '        String cursor = ""0"";'), (198, '        while (true) {'), (199, '            ScanResult<String> scanResult = jedis.sscan(bigKey, cursor, new ScanParams().count(100));'), (200, '            // 每次扫描后获取新的游标'), (201, '            cursor = scanResult.getStringCursor();'), (202, '            // 获取扫描结果'), (203, '            List<String> list = scanResult.getResult();'), (204, '            if (list == null || list.size() == 0) {'), (205, '                continue;'), (206, '            }'), (207, '            jedis.srem(bigKey, list.toArray(new String[list.size()]));'), (208, '            // 游标为0时停止'), (209, '            if (cursor.equals(""0"")) {'), (210, '                break;'), (211, '            }'), (212, '        }'), (213, '        //最终删除key'), (214, '        jedis.del(bigKey);'), (215, '    }'), (216, '    ````'), (217, ''), (218, '5. sorted set'), (219, ''), (220, '    使用zscan命令，每次获取部分(例如100个)元素，在利用zremrangebyrank删除元素。'), (221, ''), (222, '    ````'), (223, '    /**'), (224, '     * 137258ms'), (225, '     * @param bigKey'), (226, '     */'), (227, '    public void delBigSortedSet(String bigKey) {'), (228, '        long startTime = System.currentTimeMillis();'), (229, '        Jedis jedis = new Jedis(HOST, PORT);'), (230, '        // 游标'), (231, '        String cursor = ""0"";'), (232, '        while (true) {'), (233, '            ScanResult<Tuple> scanResult = jedis.zscan(bigKey, cursor, new ScanParams().count(100));'), (234, '            // 每次扫描后获取新的游标'), (235, '            cursor = scanResult.getStringCursor();'), (236, '            // 获取扫描结果'), (237, '            List<Tuple> list = scanResult.getResult();'), (238, '            if (list == null || list.size() == 0) {'), (239, '                continue;'), (240, '            }'), (241, '            String[] members = getMembers(list);'), (242, '            jedis.zrem(bigKey, members);'), (243, '            // 游标为0时停止'), (244, '            if (cursor.equals(""0"")) {'), (245, '                break;'), (246, '            }'), (247, '        }'), (248, '        // 最终删除key'), (249, '        jedis.del(bigKey);'), (250, '    }'), (251, ''), (252, '    /**'), (253, '     * 60529ms'), (254, '     * @param bigKey'), (255, '     */'), (256, '    public void delBigSortedSet2(String bigKey) {'), (257, '        Jedis jedis = new Jedis(HOST, PORT);'), (258, '        long zcard = jedis.zcard(bigKey);'), (259, '        int counter = 0;'), (260, '        int incr = 100;'), (261, '        while (counter < zcard) {'), (262, '            jedis.zremrangeByRank(bigKey, 0, 100);'), (263, '            //每次从左侧截掉100个'), (264, '            counter+=incr;'), (265, '        }'), (266, '        // 最终删除key'), (267, '        jedis.del(bigKey);'), (268, '    }'), (269, '    ````'), (270, ''), (271, '### 五、如何优化'), (272, ''), (273, '1. 拆'), (274, ''), (275, '    - big list： list1、list2、...listN'), (276, ''), (277, '    - big hash：可以做二次的hash，例如hash%100'), (278, ''), (279, '    - 日期类：key20190320、key20190321、key_20190322'), (280, ''), (281, '2. 本地缓存'), (282, ''), (283, '减少访问redis次数，降低危害，但是要注意这里有可能因此本地的一些开销（例如使用堆外内存会涉及序列化，bigkey对序列化的开销也不小）'), (284, ''), (285, '### 六、总结：'), (286, ''), (287, '由于开发人员对Redis的理解程度不同，在实际开发中出现bigkey在所难免，重要的能通过合理的检测机制及时找到它们，进行处理。作为开发人员应该在业务开发时不能将Redis简单暴力的使用，应该在数据结构的选择和设计上更加合理，例如出现了bigkey，要思考一下可不可以做一些优化(例如二级索引)尽量的让这些bigkey消失在业务中，如果bigkey不可避免，也要思考一下要不要每次把所有元素都取出来(例如有时候仅仅需要hmget，而不是hgetall)，删除也是一样，尽量使用优雅的方式来处理。'), (288, ''), (289, '')], 'deleted': []}"
445,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/exception.md,exception.md,1,"{'added': [(1, '# 异常信息目录:'), (2, ''), (3, '* [一、redis.clients.jedis.exceptions.JedisConnectionException: Could not get a resource from the pool](#e1)'), (4, '* [二、redis.clients.jedis.exceptions.JedisConnectionException: Unexpected end of stream](#e2)'), (5, '* [三、redis.clients.jedis.exceptions.JedisDataException: LOADING Redis is loading the dataset in memory](#e3)'), (6, '* [四、redis.clients.jedis.exceptions.JedisDataException: ERR max number of clients reached](#e4)'), (7, '* [五、redis.clients.jedis.exceptions.JedisConnectionException: java.net.SocketTimeoutException: Read timed out](#e5)'), (8, '* [六、redis.clients.jedis.exceptions.JedisDataException: NOAUTH Authentication required](#e6)'), (9, '* [七、redis.clients.jedis.exceptions.JedisDataException: EXECABORT Transaction discarded because of previous errors](#e7)'), (10, '* [八、java.lang.ClassCastException: java.lang.Long cannot be cast to java.util.List](#e8)'), (11, '* [九、redis.clients.jedis.exceptions.JedisDataException: WRONGTYPE Operation against a key holding the wrong kind of value](#e9)'), (12, ""* [十、redis.clients.jedis.exceptions.JedisDataException: OOM command not allowed when used memory > 'maxmemory'](#e10)""), (13, '* [十一、redis.clients.jedis.exceptions.JedisConnectionException: java.net.SocketTimeoutException: connect timed out](#e11)'), (14, ''), (15, '## 一.无法从连接池获取到Jedis连接'), (16, ''), (17, '<a name=""e1""/>'), (18, '### 1.异常堆栈'), (19, ''), (20, '- (1) 连接池参数blockWhenExhausted = true(默认)'), (21, ''), (22, '如果连接池没有可用Jedis连接，会等待maxWaitMillis(毫秒)，依然没有获取到可用Jedis连接，会抛出如下异常:'), (23, '````'), (24, 'redis.clients.jedis.exceptions.JedisConnectionException: Could not get a resource from the pool'), (25, '    …'), (26, 'Caused by: java.util.NoSuchElementException: Timeout waiting for idle object'), (27, '    at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:449)'), (28, '````'), (29, ''), (30, '- (2) 连接池参数blockWhenExhausted = false'), (31, '设置如果连接池没有可用Jedis连接，立即抛出异常：'), (32, '````'), (33, 'redis.clients.jedis.exceptions.JedisConnectionException: Could not get a resource from the pool'), (34, '    …'), (35, 'Caused by: java.util.NoSuchElementException: Pool exhausted'), (36, '    at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:464)'), (37, '````'), (38, ''), (39, '### 异常描述'), (40, ''), (41, '![jedspool](../../img/troubleshooting/jedispool.png)'), (42, ''), (43, '上述异常是客户端没有从连接池(最大maxTotal个)拿到可用Jedis连接造成的，具体可能有如下原因：'), (44, ''), (45, '- (1) 连接泄露 (较为常见)'), (46, ''), (47, 'JedisPool默认的maxTotal=8，下面的代码从JedisPool中借了8次Jedis，但是没有归还，当第9次(jedisPool.getResource().ping())'), (48, ''), (49, '````'), (50, 'GenericObjectPoolConfig poolConfig = new GenericObjectPoolConfig();'), (51, 'JedisPool jedisPool = new JedisPool(poolConfig, ""127.0.0.1"", 6379);'), (52, '//向JedisPool借用8次连接，但是没有执行归还操作。'), (53, 'for (int i = 0; i < 8; i++) {'), (54, '    Jedis jedis = null;'), (55, '    try {'), (56, '        jedis = jedisPool.getResource();'), (57, '        jedis.ping();'), (58, '    } catch (Exception e) {'), (59, '        logger.error(e.getMessage(), e);'), (60, '    }'), (61, '}'), (62, 'jedisPool.getResource().ping();'), (63, '````'), (64, ''), (65, '所以推荐使用的代码规范是：'), (66, '````'), (67, '执行命令如下：'), (68, 'Jedis jedis = null;'), (69, 'try {'), (70, '    jedis = jedisPool.getResource();'), (71, '    //具体的命令'), (72, '    jedis.executeCommand()'), (73, '} catch (Exception e) {'), (74, '    //如果命令有key最好把key也在错误日志打印出来，对于集群版来说通过key可以帮助定位到具体节点。'), (75, '    logger.error(e.getMessage(), e);'), (76, '} finally {'), (77, '    //注意这里不是关闭连接，在JedisPool模式下，Jedis会被归还给资源池。'), (78, '    if (jedis != null)'), (79, '        jedis.close();'), (80, '}'), (81, '````'), (82, ''), (83, '- (2) 业务并发量大，maxTotal确实设置过小。'), (84, ''), (85, '举个例子：'), (86, ''), (87, '一次命令时间（borrow|return resource + Jedis执行命令(含网络) ）的平均耗时约为1ms，一个连接的QPS大约是1000，'), (88, '业务期望的QPS是50000，'), (89, '那么理论上需要的资源池大小是50000 / 1000 = 50个，实际maxTotal可以根据理论值进行微调。'), (90, ''), (91, '- (3) Jedis连接还的太慢'), (92, ''), (93, '例如Redis发生了阻塞(例如慢查询等原因)，所有连接在超时时间范围内等待，并发量较大时，会造成连接池资源不足。'), (94, ''), (95, '- (4) 其他问题'), (96, ''), (97, '例如丢包、DNS、客户端TCP参数配置等.'), (98, ''), (99, '<a name=""e2""/>'), (100, ''), (101, '## 二、客户端缓冲区异常'), (102, ''), (103, '### 1.异常堆栈'), (104, '````'), (105, 'redis.clients.jedis.exceptions.JedisConnectionException: Unexpected end of stream.'), (106, '    at redis.clients.util.RedisInputStream.ensureFill(RedisInputStream.java:199)'), (107, '    at redis.clients.util.RedisInputStream.readByte(RedisInputStream.java:40)'), (108, '    at redis.clients.jedis.Protocol.process(Protocol.java:151)'), (109, '......'), (110, '````'), (111, ''), (112, '### 2.异常描述：'), (113, '这个异常是客户端缓冲区异常，产生这个问题可能有三个原因：'), (114, ''), (115, '(1) 多个线程使用一个Jedis连接，正常的情况是一个线程使用一个Jedis连接，可以使用JedisPool管理Jedis连接，实现线程安全，防止出现这种情况，例如下面代码中两个线程用了一个Jedis连接：'), (116, ''), (117, '````'), (118, 'new Thread(new Runnable() {'), (119, ''), (120, '    public void run() {'), (121, '        for (int i = 0; i < 100; i++) {'), (122, '            jedis.get(""hello"");'), (123, '        }'), (124, '    }'), (125, '}).start();'), (126, ''), (127, 'new Thread(new Runnable() {'), (128, ''), (129, '    public void run() {'), (130, '        for (int i = 0; i < 100; i++) {'), (131, '            jedis.hget(""haskey"", ""f"");'), (132, '        }'), (133, '    }'), (134, '}).start();'), (135, '````'), (136, ''), (137, '(2) 客户端缓冲区满了'), (138, ''), (139, 'Redis有三种客户端缓冲区：'), (140, ''), (141, '普通客户端缓冲区(normal)：用于接受普通的命令，例如get、set、mset、hgetall、zrange等；'), (142, ''), (143, 'slave客户端缓冲区(slave)：用于同步master节点的写命令，完成复制；'), (144, ''), (145, '发布订阅缓冲区(pubsub)：pubsub不是普通的命令，因此有单独的缓冲区。'), (146, ''), (147, '![jedspool](../../img/troubleshooting/clientbuffer.png)'), (148, 'Redis的客户端缓冲区配置具体格式是：'), (149, '````'), (150, 'client-output-buffer-limit <class> <hard limit> <soft limit> <soft seconds>'), (151, '````'), (152, '(a) class: 客户端类型：(a) normal、(b) slave、(c) pubsub'), (153, ''), (154, '(b) hard limit: 如果客户端使用的输出缓冲区大于hard limit，客户端会被立即关闭。'), (155, ''), (156, '(c) soft limit和soft seconds: 如果客户端使用的输出缓冲区超过了soft limit并且持续了soft limit秒，客户端会被立即关闭'), (157, ''), (158, '例如下面是一份Redis缓冲区的配置，所以当条件满足时，客户端连接会被关闭，就会出现Unexpected end of stream。'), (159, ''), (160, '````'), (161, 'redis> config get client-output-buffer-limit'), (162, '1) ""client-output-buffer-limit""'), (163, '2) ""normal 524288000 0 0 slave 2147483648 536870912 480 pubsub 33554432 8388608 60""'), (164, '````'), (165, ''), (166, '(3) 长时间闲置连接被服务端主动断开，可以查询timeout配置的值以及自身连接池配置是否需要做空闲检测。'), (167, ''), (168, '<a name=""e3""/>'), (169, ''), (170, '## 三、Redis正在加载持久化文件'), (171, ''), (172, '### 1.异常堆栈：'), (173, '````'), (174, 'redis.clients.jedis.exceptions.JedisDataException: LOADING Redis is loading the dataset in memory'), (175, '````'), (176, ''), (177, '### 2.异常描述：'), (178, ''), (179, 'Jedis调用Redis时，如果Redis正在加载持久化文件，无法进行正常的读写。'), (180, ''), (181, '<a name=""e4""/>'), (182, ''), (183, '## 四、客户端连接数达到最大值'), (184, ''), (185, '### 1.异常堆栈'), (186, '````'), (187, 'redis.clients.jedis.exceptions.JedisDataException: ERR max number of clients reached'), (188, '````'), (189, ''), (190, '### 2.异常描述：'), (191, '如果客户端连接数超过了Redis实例配置的最大maxclients，会抛出该异常。'), (192, ''), (193, '<a name=""e5""/>'), (194, ''), (195, '## 五、客户端读写超时'), (196, ''), (197, '### 1.异常堆栈'), (198, '````'), (199, 'redis.clients.jedis.exceptions.JedisConnectionException: java.net.SocketTimeoutException: Read timed out'), (200, '````'), (201, ''), (202, '### 2.异常描述：'), (203, '该问题原因可能有如下几种：'), (204, ''), (205, '(1) 读写超时设置的过短。'), (206, ''), (207, '(2) 有慢查询或者Redis发生阻塞。'), (208, ''), (209, '(3) 网络不稳定。'), (210, ''), (211, '<a name=""e6""/>'), (212, ''), (213, '## 六、密码相关的异常'), (214, ''), (215, '### 1.异常堆栈'), (216, ''), (217, '- 1) Redis设置了密码，客户端请求没传密码：'), (218, '````'), (219, 'Exception in thread ""main"" redis.clients.jedis.exceptions.JedisDataException: NOAUTH Authentication required.'), (220, '     at redis.clients.jedis.Protocol.processError(Protocol.java:127)'), (221, '     at redis.clients.jedis.Protocol.process(Protocol.java:161)'), (222, '     at redis.clients.jedis.Protocol.read(Protocol.java:215)'), (223, '````'), (224, ''), (225, '- 2) Redis没有设置密码，客户端传了密码：'), (226, '````'), (227, 'Exception in thread ""main"" redis.clients.jedis.exceptions.JedisDataException: ERR Client sent AUTH, but no password is set'), (228, '     at redis.clients.jedis.Protocol.processError(Protocol.java:127)'), (229, '     at redis.clients.jedis.Protocol.process(Protocol.java:161)'), (230, '     at redis.clients.jedis.Protocol.read(Protocol.java:215)'), (231, '````'), (232, ''), (233, '- 3) 客户端传了错误的密码：'), (234, '````'), (235, 'redis.clients.jedis.exceptions.JedisDataException: ERR invalid password'), (236, '    at redis.clients.jedis.Protocol.processError(Protocol.java:117)'), (237, '    at redis.clients.jedis.Protocol.process(Protocol.java:151)'), (238, '    at redis.clients.jedis.Protocol.read(Protocol.java:205)'), (239, '````'), (240, ''), (241, '<a name=""e7""/>'), (242, ''), (243, '## 七、事务异常'), (244, ''), (245, '### 1.异常堆栈'), (246, '````'), (247, 'redis.clients.jedis.exceptions.JedisDataException: EXECABORT Transaction discarded because of previous errors'), (248, '````'), (249, ''), (250, '### 2.异常描述：'), (251, '这个是Redis的事务异常：事务中包含了错误的命令，例如如下sett是个不存在的命令。'), (252, '````'), (253, '127.0.0.1:6379> multi'), (254, 'OK'), (255, '127.0.0.1:6379> sett key world'), (256, ""(error) ERR unknown command 'sett'""), (257, '127.0.0.1:6379> incr counter'), (258, 'QUEUED'), (259, '127.0.0.1:6379> exec'), (260, '(error) EXECABORT Transaction discarded because of previous errors.'), (261, '````'), (262, ''), (263, '<a name=""e8""/>'), (264, ''), (265, '## 八、类转换错误'), (266, ''), (267, '### 1.异常堆栈'), (268, ''), (269, '````'), (270, 'java.lang.ClassCastException: java.lang.Long cannot be cast to java.util.List'), (271, '         at redis.clients.jedis.Connection.getBinaryMultiBulkReply(Connection.java:199)'), (272, '         at redis.clients.jedis.Jedis.hgetAll(Jedis.java:851)'), (273, '         at redis.clients.jedis.ShardedJedis.hgetAll(ShardedJedis.java:198)'), (274, '````'), (275, ''), (276, '````'), (277, 'java.lang.ClassCastException: java.util.ArrayList cannot be cast to [B'), (278, '         at redis.clients.jedis.Connection.getBinaryBulkReply(Connection.java:182)'), (279, '         at redis.clients.jedis.Connection.getBulkReply(Connection.java:171)'), (280, '         at redis.clients.jedis.Jedis.rpop(Jedis.java:1109)'), (281, '         at redis.clients.jedis.ShardedJedis.rpop(ShardedJedis.java:258)'), (282, '.......'), (283, '````'), (284, ''), (285, '### 2.异常描述：'), (286, 'Jedis正确的使用方法是：一个线程操作一个Jedis，通常来讲产生该错误是由于没有使用JedisPool造成的，例如如下代码在两个线程并发使用了一个Jedis。(get、hgetAll返回类型也是不一样的)'), (287, ''), (288, '````'), (289, 'new Thread(new Runnable() {'), (290, ''), (291, '    public void run() {'), (292, '        for (int i = 0; i < 100; i++) {'), (293, '            jedis.set(""hello"", ""world"");'), (294, '            jedis.get(""hello"");'), (295, '        }'), (296, '    }'), (297, '}).start();'), (298, ''), (299, 'new Thread(new Runnable() {'), (300, ''), (301, '    public void run() {'), (302, '        for (int i = 0; i < 100; i++) {'), (303, '            jedis.hset(""hashkey"", ""f"", ""v"");'), (304, '            jedis.hgetAll(""hashkey"");'), (305, '        }'), (306, '    }'), (307, '}).start();'), (308, '````'), (309, ''), (310, '<a name=""e9""/>'), (311, ''), (312, '## 九、命令使用错误'), (313, ''), (314, '### 1.异常堆栈'), (315, '````'), (316, 'Exception in thread ""main"" redis.clients.jedis.exceptions.JedisDataException: WRONGTYPE Operation against a key holding the wrong kind of value'), (317, '    at redis.clients.jedis.Protocol.processError(Protocol.java:127)'), (318, '    at redis.clients.jedis.Protocol.process(Protocol.java:161)'), (319, '    at redis.clients.jedis.Protocol.read(Protocol.java:215)'), (320, '.....'), (321, '````'), (322, ''), (323, '### 2.异常描述：'), (324, '例如key=""hello""是字符串类型的键，而hgetAll是哈希类型的键，所以出现了错误。'), (325, ''), (326, '````'), (327, 'jedis.set(""hello"",""world"");'), (328, 'jedis.hgetAll(""hello"");'), (329, '````'), (330, ''), (331, '<a name=""e10""/>'), (332, ''), (333, '## 十、Redis使用的内存超过maxmemory配置'), (334, ''), (335, '### 1.异常堆栈'), (336, '````'), (337, ""redis.clients.jedis.exceptions.JedisDataException: OOM command not allowed when used memory > 'maxmemory'.""), (338, '````'), (339, ''), (340, '### 2.异常描述：'), (341, 'Redis节点(如果是集群，则是其中一个节点)使用大于该实例的内存规格(maxmemory配置)。'), (342, ''), (343, '### 3.解决方法：'), (344, '原因可能有以下几个：'), (345, ''), (346, '1).业务数据正常增加;'), (347, ''), (348, '2).客户端缓冲区异常：例如使用了monitor、pub/sub使用不当等等;'), (349, ''), (350, '3).纯缓存使用场景，但是maxmemory-policy配置有误(例如没有过期键的业务配置volatile-lru)。'), (351, ''), (352, '<a name=""e11""/>'), (353, ''), (354, '## 十一、连接超时'), (355, ''), (356, '### 1.异常堆栈'), (357, '````'), (358, 'redis.clients.jedis.exceptions.JedisConnectionException: java.net.SocketTimeoutException: connect timed out'), (359, '````'), (360, ''), (361, '### 2.异常描述：'), (362, ''), (363, '可能产生的原因：'), (364, ''), (365, '1).连接超时设置的过短。'), (366, ''), (367, '2).tcp-backlog满，造成新的连接失败。'), (368, ''), (369, '3).客户端与服务端网络不正常。')], 'deleted': []}"
446,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/hotkey.md,hotkey.md,1,"{'added': [(1, '## 寻找热点key'), (2, ''), (3, '热门新闻事件或商品通常会给系统带来巨大的流量，但对存储这类信息的Redis来说是一个巨大的挑战。以Redis Cluster为例，它会造成整体流量的不均衡，个别节点出现OPS过大的情况，极端情况下热点key甚至会超过Redis本身能够承受的OPS，因此寻找热点key对于开发和运维人员非常重要。'), (4, ''), (5, '### 一、客户端'), (6, '客户端其实是距离key""最近""的地方，因为Redis命令就是从客户端发出的，例如在客户端设置全局字典(key和调用次数)，每次调用Redis命令时，使用这个字典进行记录，如下所示。'), (7, ''), (8, '```'), (9, 'public static final AtomicLongMap<String> ATOMIC_LONG_MAP = AtomicLongMap.create();'), (10, 'String get(String key) {'), (11, '    counterKey(key);'), (12, '    //ignore'), (13, '}'), (14, 'String set(String key, String value) {'), (15, '    counterKey(key);'), (16, '    //ignore'), (17, '}'), (18, 'void counterKey(String key) {'), (19, '    ATOMIC_LONG_MAP.incrementAndGet(key);'), (20, '}'), (21, '```'), (22, '<!--more-->'), (23, ''), (24, '为了减少对客户端代码的侵入，可以在Redis客户端的关键部分进行计数，例如Jedis的Connection类中的sendCommand方法是所有命令执行的枢纽。'), (25, ''), (26, '```'), (27, 'public Connection sendCommand(final ProtocolCommand cmd, final byte[]... args) {'), (28, '    //从参数中获取key'), (29, '    String key = analysis(args);'), (30, '    //计数'), (31, '    counterKey(key);'), (32, '    //ignore'), (33, '}'), (34, '```'), (35, ''), (36, '同时为了防止ATOMIC_LONG_MAP过大，可以对其进行定期清理。'), (37, ''), (38, '```'), (39, 'public void scheduleCleanMap() {'), (40, '    ERROR_NAME_VALUE_MAP.clear();'), (41, '}'), (42, '```'), (43, ''), (44, '使用客户端进行热点key的统计非常容易实现，但是同时问题也非常多：'), (45, ''), (46, '(1). 无法预知key的个数，存在内存泄露的危险。'), (47, ''), (48, '(2). 对于客户端代码有侵入，各个语言的客户端都需要维护此逻辑，维护成本较高。'), (49, ''), (50, '(3). 只能了解当前客户端的热点key，无法实现规模化运维统计。'), (51, ''), (52, '当然除了使用本地字典计数外，还可以使用其他存储来完成异步计数，从而解决本地内存泄露问题。但是同样会存在第(2)(3)个问题。'), (53, ''), (54, '### 二、代理端'), (55, ''), (56, '像Twemproxy、Codis这些基于代理的Redis分布式架构，所有客户端的请求都是通过代理端完成的，如下图所示。此架构是最适合做热点key统计的，因为代理是所有Redis客户端和服务端的桥梁。但并不是所有Redis都是采用此种架构。'), (57, ''), (58, '<img src=""../../img/troubleshooting/hotkey/hotkey-proxy.png"" width=""100%""/>'), (59, ''), (60, ''), (61, '### 三、Redis服务端'), (62, '使用monitor命令统计热点key是很多开发和运维人员首先想到，monitor命令可以监控到Redis执行的所有命令，下面为一次monitor命令执行后部分结果。'), (63, ''), (64, '```'), (65, '1477638175.920489 [0 10.16.xx.183:54465] ""GET"" ""tab:relate:kp:162818""'), (66, '1477638175.925794 [0 10.10.xx.14:35334] ""HGETALL"" ""rf:v1:84083217_83727736""'), (67, '1477638175.938106 [0 10.16.xx.180:60413] ""GET"" ""tab:relate:kp:900""'), (68, '1477638175.939651 [0 10.16.xx.183:54320] ""GET"" ""tab:relate:kp:15907""'), (69, '...'), (70, '1477638175.962519 [0 10.10.xx.14:35334] ""GET"" ""tab:relate:kp:3079""'), (71, '1477638175.963216 [0 10.10.xx.14:35334] ""GET"" ""tab:relate:kp:3079""'), (72, '1477638175.964395 [0 10.10.xx.204:57395] ""HGETALL"" ""rf:v1:80547158_83076533""'), (73, '```'), (74, ''), (75, '<img src=""../../img/troubleshooting/hotkey/hotkey-monitor.png"" width=""100%""/>'), (76, ''), (77, '如上图所示，利用monitor的结果就可以统计出一段时间内的热点key排行榜，命令排行榜，客户端分布等数据，例如下面的伪代码统计了最近10万条命令中的热点key。'), (78, ''), (79, ''), (80, '```'), (81, '//获取10万条命令'), (82, 'List<String> keyList = redis.monitor(100000);'), (83, '//存入到字典中，分别是key和对应的次数'), (84, 'AtomicLongMap<String> ATOMIC_LONG_MAP = AtomicLongMap.create();'), (85, '//统计'), (86, 'for (String command : commandList) {'), (87, '\tATOMIC_LONG_MAP.incrementAndGet(key);'), (88, '}'), (89, '//后续统计和分析热点key'), (90, 'statHotKey(ATOMIC_LONG_MAP);'), (91, '```'), (92, ''), (93, ''), (94, 'Facebook开源的redis-faina 正是利用上述原理使用Python语言实现的，例如下面获取最近10万条命令的热点key、热点命令、耗时分布等数据。为了减少网络开销以及加快输出缓冲区的消费速度，monitor尽可能在本机执行。'), (95, ''), (96, 'redis-cli -p 6380 monitor | head -n 100000 | ./redis-faina.py'), (97, ''), (98, '```'), (99, 'Overall Stats'), (100, '========================================'), (101, 'Lines Processed  \t50000'), (102, 'Commands/Sec     \t900.48'), (103, 'Top Prefixes'), (104, '========================================'), (105, 'tab        \t27565\t(55.13%)'), (106, 'rf         \t15111\t(30.22%)'), (107, 'ugc        \t2051 \t(4.10%)'), (108, '...'), (109, 'Top Keys'), (110, '========================================'), (111, 'tab:relate:kp:9350          \t2110\t(4.22%)'), (112, 'tab:relate:kp:15907         \t1594\t(3.19%)'), (113, '...'), (114, 'Top Commands'), (115, '========================================'), (116, 'GET      \t25700\t(51.40%)'), (117, 'HGETALL  \t15111\t(30.22%)'), (118, '...'), (119, 'Command Time (microsecs)'), (120, '========================================'), (121, 'Median  \t622.75'), (122, '75%     \t1504.0'), (123, '90%     \t2820.0'), (124, '99%     \t6798.0'), (125, '```'), (126, ''), (127, '此种方法会有两个问题：'), (128, ''), (129, '(1) 本书多次强调monitor命令在高并发条件下，会存在内存暴增和影响Redis性能的隐患，所以此种方法适合在短时间内使用。'), (130, ''), (131, '(2) 只能统计一个Redis节点的热点key，对于Redis集群需要进行汇总统计。'), (132, ''), (133, '### 四、机器层面'), (134, ''), (135, '第四章我们介绍过，Redis客户端使用TCP协议与服务端进行交互，通信协议采用的是RESP。如果站在机器的角度，可以通过对机器上所有Redis端口的TCP数据包进行抓取完成热点key的统计，如下图所示。'), (136, ''), (137, '<img src=""../../img/troubleshooting/hotkey/hotkey-tcppacket.png"" width=""100%""/>'), (138, ''), (139, ''), (140, '此种方法对于Redis客户端和服务端来说毫无侵入，是比较完美的方案，但是依然存在两个问题：'), (141, ''), (142, '(1)\t需要一定的开发成本，但是一些开源方案实现了该功能，例如ELK(ElasticSearch Logstash Kibana)体系下的[packetbeat](https://www.elastic.co/guide/en/beats/packetbeat/current/index.html)插件，可以实现对Redis、MySQL等众多主流服务的数据包抓取、分析、报表展示。'), (143, ''), (144, '(2)\t由于是以机器为单位进行统计，要想了解一个集群的热点key，需要进行后期汇总。'), (145, ''), (146, '最后通过下给出上述四种方案的特点。'), (147, ''), (148, '方案 | 优点 | 缺点'), (149, '--- |--- |---'), (150, '客户端 | 实现简单 | 内存泄露隐患<br/>维护成本高<br/>只能统计单个客户端'), (151, '代理 | 代理是客户端和服务端的桥梁，实现最方便最系统 | 增加代理端的开发部署成本'), (152, '服务端 | 实现简单 | monitor本身的使用成本和危害，只能短时间使用<br/>只能统计单个Redis节点'), (153, '机器TCP流量 |对于客户端和服务端无侵入和影响 | 需要专业的运维团队开发，并且增加了机器的部署成本'), (154, ''), (155, '最后我们给出三种解决热点key问题的思路，具体选用那种要根据具体业务场景来决定。'), (156, ''), (157, '(1)\t拆分复杂数据结构： 如果当前key的类型是一个二级数据结构，例如哈希类型。如果该哈希元素个数较多，可以考虑将当前hash进行拆分，这样该热点key可以拆分为若干个新的key分布到不同Redis节点上，从而减轻压力。'), (158, ''), (159, '(2)\t迁移热点key：以Redis Cluster为例，可以将热点key所在的slot单独迁移到一个新的Redis节点上，但此操作会增加运维成本。'), (160, ''), (161, '(3)\t本地缓存加通知机制：可以将热点key放在业务端的本地缓存中，因为是在业务端的本地内存中，处理能力要高出Redis数十倍，但当数据更新时，此种模式会造成各个业务端和Redis数据不一致，通常会使用发布订阅机制来解决类似问题。'), (162, '')], 'deleted': []}"
447,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/index.md,index.md,1,"{'added': [(1, '## 运维常见问题'), (2, ''), (3, '+ 1.[常见jedis异常类](exception.md)'), (4, '+ 2.[JedisPool优化](jedispoolconfig.md)'), (5, '+ 3.[bigkey问题](bigkey.md)'), (6, '+ 4.[hotkey问题](hotkey.md)'), (7, '+ 5.[Redis内存优化](memory.md)'), (8, '+ 6.[activeDefrag引起redis周期性延迟](activefrag.md)'), (9, '')], 'deleted': []}"
448,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/jedispoolconfig.md,jedispoolconfig.md,1,"{'added': [(1, '## JedisPool资源池优化'), (2, ''), (3, '### 背景'), (4, '合理的JedisPool资源池参数设置能为业务使用Redis保驾护航，本文将对JedisPool的使用、资源池的参数进行详细说明，最后给出“最合理”配置。'), (5, ''), (6, '<a name=""c1""/>'), (7, ''), (8, '### 一、使用方法'), (9, ''), (10, '以官方的2.9.0为例子(Jedis Release)，Maven依赖如下：'), (11, ''), (12, '````'), (13, '<dependency>'), (14, '    <groupId>redis.clients</groupId>'), (15, '    <artifactId>jedis</artifactId>'), (16, '    <version>2.9.0</version>'), (17, '    <scope>compile</scope>'), (18, '</dependency>'), (19, '````'), (20, ''), (21, 'Jedis使用apache commons-pool2对Jedis资源池进行管理，所以在定义JedisPool时一个很重要的参数就是资源池GenericObjectPoolConfig，使用方式如下，其中有很多资源管理和使用的参数'), (22, ''), (23, '注意：后面会提到建议用JedisPoolConfig代替GenericObjectPoolConfig'), (24, ''), (25, '````'), (26, 'GenericObjectPoolConfig jedisPoolConfig = new GenericObjectPoolConfig();'), (27, 'jedisPoolConfig.setMaxTotal(..);'), (28, 'jedisPoolConfig.setMaxIdle(..);'), (29, 'jedisPoolConfig.setMinIdle(..);'), (30, 'jedisPoolConfig.setMaxWaitMillis(..);'), (31, '...'), (32, '````'), (33, ''), (34, 'JedisPool的初始化如下:'), (35, ''), (36, '````'), (37, '// redisHost和redisPort是实例的IP和端口'), (38, '// redisPassword是实例的密码'), (39, '// timeout，这里既是连接超时又是读写超时，从Jedis 2.8开始有区分connectionTimeout和soTimeout的构造函数'), (40, ''), (41, 'JedisPool jedisPool = new JedisPool(jedisPoolConfig, redisHost, redisPort, timeout, redisPassword);'), (42, '执行命令如下：'), (43, 'Jedis jedis = null;'), (44, 'try {'), (45, '    jedis = jedisPool.getResource();'), (46, '    //具体的命令'), (47, '    jedis.executeCommand()'), (48, '} catch (Exception e) {'), (49, '    logger.error(e.getMessage(), e);'), (50, '} finally {'), (51, '    //注意这里不是关闭连接，在JedisPool模式下，Jedis会被归还给资源池。'), (52, '    if (jedis != null)'), (53, '        jedis.close();'), (54, '}'), (55, '````'), (56, '<a name=""c2""/>'), (57, ''), (58, '### 二、参数说明'), (59, ''), (60, 'JedisPool保证资源在一个可控范围内，并且提供了线程安全，但是一个合理的GenericObjectPoolConfig配置能为应用使用Redis保驾护航，下面将对它的一些重要参数进行说明和建议：'), (61, '在当前环境下，Jedis连接就是资源，JedisPool管理的就是Jedis连接。'), (62, ''), (63, '1. 资源设置和使用'), (64, ''), (65, '序号 | 参数名 | 含义 | 默认值 | 使用建议'), (66, '---|--- |--- |---|---'), (67, '1 | maxTotal | 资源池中最大连接数 | 8\t| 设置建议见下节'), (68, '2 | maxIdle | 资源池允许最大空闲的连接数 | 8 | 设置建议见下节'), (69, '3 | minIdle | \t资源池确保最少空闲的连接数 | 0 | 设置建议见下节'), (70, '4 | blockWhenExhausted | 当资源池用尽后，调用者是否要等待。只有当为true时，下面的maxWaitMillis才会生效 | true | 建议使用默认值'), (71, '5 | maxWaitMillis | 当资源池连接用尽后，调用者的最大等待时间(单位为毫秒) | -1：表示永不超时 | 不建议使用默认值'), (72, '6 | testOnBorrow | 向资源池借用连接时是否做连接有效性检测(ping)，无效连接会被移除 | false | 业务量很大时候建议设置为false(多一次ping的开销)。'), (73, '7 | testOnReturn | 向资源池归还连接时是否做连接有效性检测(ping)，无效连接会被移除 | false | 业务量很大时候建议设置为false(多一次ping的开销)。'), (74, '8 | jmxEnabled | 是否开启jmx监控，可用于监控 | true | 建议开启，但应用本身也要开启'), (75, ''), (76, '2. 空闲资源监测'), (77, ''), (78, '空闲Jedis对象检测，下面四个参数组合来完成，testWhileIdle是该功能的开关。'), (79, ''), (80, '序号 | 参数名 | 含义 | 默认值 | 使用建议'), (81, '---|--- |--- |---|---'), (82, '1 | testWhileIdle | 是否开启空闲资源监测 | false | true'), (83, '2 | timeBetweenEvictionRunsMillis | 空闲资源的检测周期(单位为毫秒) | -1：不检测 | 建议设置，周期自行选择，也可以默认也可以使用下面JedisPoolConfig中的配置'), (84, '3 | minEvictableIdleTimeMillis | 资源池中资源最小空闲时间(单位为毫秒)，达到此值后空闲资源将被移除 | 1000 60 30 = 30分钟 | 可根据自身业务决定，大部分默认值即可，也可以考虑使用下面JeidsPoolConfig中的配置'), (85, '4 | numTestsPerEvictionRun | 做空闲资源检测时，每次的采样数 | 3 | 可根据自身应用连接数进行微调,如果设置为-1，就是对所有连接做空闲监测'), (86, ''), (87, '为了方便使用，Jedis提供了JedisPoolConfig，它本身继承了GenericObjectPoolConfig设置了一些空闲监测设置'), (88, '````'), (89, 'public class JedisPoolConfig extends GenericObjectPoolConfig {'), (90, '  public JedisPoolConfig() {'), (91, '    // defaults to make your life with connection pool easier :)'), (92, '    setTestWhileIdle(true);'), (93, '    //'), (94, '    setMinEvictableIdleTimeMillis(60000);'), (95, '    //'), (96, '    setTimeBetweenEvictionRunsMillis(30000);'), (97, '    setNumTestsPerEvictionRun(-1);'), (98, '    }'), (99, '}'), (100, '````'), (101, '所有默认值可以从org.apache.commons.pool2.impl.BaseObjectPoolConfig中看到。'), (102, ''), (103, '<a name=""c3""/>'), (104, ''), (105, '### 三、资源池大小(maxTotal)、空闲(maxIdle minIdle)设置建议'), (106, ''), (107, '**1. maxTotal：最大连接数**'), (108, ''), (109, '实际上这个是一个很难回答的问题，考虑的因素比较多：'), (110, ''), (111, '+ 业务希望Redis并发量；'), (112, '+ 客户端执行命令时间；'), (113, '+ Redis资源：例如 nodes(例如应用个数) * maxTotal 是不能超过redis的最大连接数；'), (114, '+ 资源开销：例如虽然希望控制空闲连接，但是不希望因为连接池的频繁释放创建连接造成不必靠开销。'), (115, ''), (116, '以一个例子说明，假设:'), (117, ''), (118, '+ 一次命令时间（borrow|return resource + Jedis执行命令(含网络) ）的平均耗时约为1ms，一个连接的QPS大约是1000'), (119, '+ 业务期望的QPS是50000'), (120, ''), (121, '那么理论上需要的资源池大小是50000 / 1000 = 50个。但事实上这是个理论值，还要考虑到要比理论值预留一些资源，通常来讲maxTotal可以比理论值大一些。'), (122, '但这个值不是越大越好，一方面连接太多占用客户端和服务端资源，另一方面对于Redis这种高QPS的服务器，一个大命令的阻塞即使设置再大资源池仍然会无济于事。'), (123, ''), (124, '**2. maxIdle minIdle**'), (125, ''), (126, 'maxIdle实际上才是业务需要的最大连接数，maxTotal是为了给出余量，所以maxIdle不要设置过小，否则会有new Jedis(新连接)开销，而minIdle是为了控制空闲资源监测。'), (127, ''), (128, '连接池的最佳性能是maxTotal = maxIdle ,这样就避免连接池伸缩带来的性能干扰。但是如果并发量不大或者maxTotal设置过高，会导致不必要的连接资源浪费。'), (129, '可以根据实际总OPS和调用redis客户端的规模整体评估每个节点所使用的连接池。'), (130, ''), (131, '**3.监控**'), (132, ''), (133, '实际上最靠谱的值是通过监控来得到“最佳值”的，可以考虑通过一些手段(例如jmx)实现监控，找到合理值。'), (134, ''), (135, ''), (136, '')], 'deleted': []}"
449,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/jedispoolconfig.toc.md,jedispoolconfig.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* [一、使用方法](#c1)'), (4, '* [二、参数说明](#c2)'), (5, '* [三、资源池配置建议](#c3)')], 'deleted': []}"
450,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/liunx.md,liunx.md,1,"{'added': [(1, '## Redis的Linux系统优化'), (2, ''), (3, '通常来看，Redis开发和运维人员更加关注的是Redis本身的一些配置优化，例如AOF和RDB的配置优化、数据结构的配置优化等，但是对于操作系统是否需要针对Redis做一些配置优化不甚了解或者不太关心，然而事实证明一个良好的系统操作配置能够为Redis服务良好运行保驾护航。'), (4, ''), (5, '众所周知Redis的作者对于Windows操作系统并不感冒，目前大部分公司都会将Web服务器、数据库服务器等部署在Linux操作系统上，Redis也不例外。所以接下来介绍Linux操作系统如何优化Redis，包含如下七个方面。'), (6, ''), (7, ''), (8, ''), (9, '<a name=""chapter1""/>'), (10, ''), (11, '## 一. 内存分配控制'), (12, ''), (13, '### 1. vm.overcommit_memory'), (14, ''), (15, 'Redis在启动时可能会出现这样的日志：'), (16, ''), (17, '```'), (18, ""# WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the""), (19, ""command 'sysctl vm.overcommit_memory=1' for this to take effect.""), (20, '```'), (21, ''), (22, '<!--more-->'), (23, ''), (24, '在分析这个问题之前，首先要弄清楚什么是overcommit？Linux操作系统对大部分申请内存的请求都回复yes，以便能运行更多的程序。因为申请内存后，并不会马上使用内存，这种技术叫做overcommit。如果Redis在启动时有上面的日志，说明vm.overcommit_memory=0，Redis提示把它设置为1。'), (25, ''), (26, 'vm.overcommit_memory用来设置内存分配策略，它有三个可选值，如下表所示。'), (27, ''), (28, 'vm.overcommit_memory | 含义'), (29, '---|---'), (30, '0 | 表示内核将检查是否有足够的可用内存。如果有足够的可用内存，内存申请通过，否则内存申请失败，并把错误返回给应用进程'), (31, '1 | 表示内核允许超量使用内存直到用完为止'), (32, '2 | 表示内核决不过量的(""never overcommit"")使用内存，即系统整个内存地址空间不能超过swap+50%的RAM值，50%是overcommit_ratio默认值，此参数同样支持修改'), (33, ''), (34, '```'), (35, '注意：本文的可用内存代表物理内存与swap之和。'), (36, '```'), (37, ''), (38, '日志中的Background save代表的是bgsave和bgrewriteaof，如果当前可用内存不足，操作系统应该如何处理fork。如果vm.overcommit_memory=0，代表如果没有可用内存，就申请内存失败，对应到Redis就是fork执行失败，在Redis的日志会出现：'), (39, '```'), (40, 'Cannot allocate memory'), (41, '```'), (42, 'Redis建议把这个值设置为1，是为了让fork能够在低内存下也执行成功。'), (43, ''), (44, ''), (45, '### 2. 获取和设置'), (46, ''), (47, '#### 获取：'), (48, ''), (49, '```'), (50, 'cat /proc/sys/vm/overcommit_memory'), (51, '0'), (52, '```'), (53, ''), (54, '#### 设置：'), (55, ''), (56, '```'), (57, 'echo ""vm.overcommit_memory=1"" >> /etc/sysctl.conf'), (58, 'sysctl vm.overcommit_memory=1'), (59, '```'), (60, ''), (61, '### 3. 最佳实践'), (62, ''), (63, '+ Redis设置合理的maxmemory，保证机器有20%~30%的闲置内存。'), (64, '+ 集中化管理aof重写和rdb的bgsave。'), (65, '+ 设置vm.overcommit_memory=1，防止极端情况下，会造成fork失败。'), (66, ''), (67, '<a name=""chapter2""/>'), (68, ''), (69, '## 二. swappiness'), (70, ''), (71, '### 1. 参数说明'), (72, ''), (73, 'swap对于操作系统来比较重要，当物理内存不足时，可以swap out一部分内存页，以解燃眉之急。但世界上没有免费午餐，swap空间由硬盘提供，对于需要高并发、高吞吐的应用来说，磁盘IO通常会成为系统瓶颈。在Linux中，并不是要等到所有物理内存都使用完才会使用到swap，系统参数swppiness会决定操作系统使用swap的倾向程度。swappiness的取值范围是0~100，swappiness的值越大，说明操作系统可能使用swap的概率越高，swappiness值越低，表示操作系统更加倾向于使用物理内存。swap的默认值是60，了解这个值的含义后，有利于Redis的性能优化。下表对swappiness的重要值进行了说明。'), (74, ''), (75, 'swapniess | 策略'), (76, '---|---'), (77, '0 | Linux3.5以及以上：宁愿OOM killer也不用swap<br/>Linux3.4以及更早：宁愿swap也不要OOM killer'), (78, '1 | Linux3.5以及以上：宁愿swap也不要OOM killer'), (79, '60 | 默认值'), (80, '100 | 操作系统会主动地使用swap'), (81, ''), (82, '```'), (83, '运维提示：OOM(Out Of Memory) killer机制是指Linux操作系统发现可用内存不足时，强制杀死一些用户进程（非内核进程），来保证系统有足够的可用内存进行分配。'), (84, '```'), (85, ''), (86, '从下表中可以看出，swappiness参数在Linux 3.5版本前后的表现并不完全相同，Redis运维人员在设置这个值需要关注当前操作系统的内核版本。'), (87, ''), (88, '### 2. 设置方法'), (89, ''), (90, 'swappiness设置方法如下：'), (91, ''), (92, '```'), (93, 'echo {bestvalue} > /proc/sys/vm/swappiness'), (94, '```'), (95, ''), (96, '但是上述方法在系统重启后就会失效，为了让配置在重启Linux操作系统后立即生效，只需要在/etc/sysctl.conf追加 vm.swappiness={bestvalue}即可。'), (97, ''), (98, '```'), (99, 'echo vm.swappiness={bestvalue} >> /etc/sysctl.conf'), (100, '```'), (101, ''), (102, '需要注意/proc/sys/vm/swappiness是设置操作，/etc/sysctl.conf是追加操作。'), (103, ''), (104, ''), (105, '### 3. 如何监控swap'), (106, '#### (1) 查看swap的总体情况'), (107, 'Linux提供了free命令来查询操作系统的内存使用情况，其中也包含了swap的相关使用情况。下面是某台Linux服务器执行free –m(以兆为到位)的结果，其中需要重点关注的是最后一行的swap统计，从执行结果看，swap一共有4095M，使用了0M，空闲了4095M。'), (108, ''), (109, '```'), (110, '             total       used       free     shared    buffers     cached'), (111, 'Mem:         64385      31573      32812          0        505      10026'), (112, '-/+ buffers/cache:      21040      43344'), (113, 'Swap:         4095          0       4095'), (114, '```'), (115, ''), (116, '在另一台Linux服务器同样执行free -m，这台服务器开启了8189M swap，其中使用了5241M。'), (117, ''), (118, '```'), (119, '             total       used       free     shared    buffers     cached'), (120, 'Mem:         24096       8237      15859          0        136       2483'), (121, '-/+ buffers/cache:       5617      18479'), (122, 'Swap:         8189       5241       2947'), (123, '```'), (124, ''), (125, '#### (2) 实时查看swap的使用'), (126, 'Linux提供了vmstat命令查询系统的相关性能指标，其中包含负载、CPU、内存、swap、IO的相关属性。但其中和swap有关的指标是si和so，它们分别代表了操作系统的swap in和swap out。下面是执行vmstat 1（每隔一秒输出）的效果，可以看到si和so都为0，代表当前没有使用swap。'), (127, ''), (128, '```'), (129, '# vmstat  1'), (130, 'procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu-----'), (131, ' r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st'), (132, ' 1  0      0 33593468 517656 10271928    0    0     0     1    0    0  8  0 91  0  0'), (133, ' 4  0      0 33594516 517656 10271928    0    0     0     0 10606 9647 10  1 90  0  0'), (134, ' 1  0      0 33594392 517656 10271928    0    0     0     0 11490 10244 11  1 89  0  0'), (135, ' 6  0      0 33594292 517656 10271928    0    0     0    36 12406 10681 13  1 87  0  0'), (136, '```'), (137, ''), (138, '#### (3) 查看指定进程的swap使用情况'), (139, 'Linux操作系统中，/proc/{pid}目录是存储指定进程的相关信息，其中/proc/{pid}/smaps是记录了当前进程所对应的内存映像信息，这个信息对于查询指定进程的swap使用情况很有帮助。下面以一个Redis实例进行说明'), (140, '通过info server获取Redis的进程号process_id:'), (141, ''), (142, '```'), (143, 'redis-cli -h ip -p port info server | grep process_id'), (144, 'process_id:986'), (145, '```'), (146, ''), (147, '通过cat /proc/986/smaps查询Redis的smaps信息，由于有多个内存块信息，这里只输出一个内存块镜像信息进行观察。'), (148, ''), (149, '```'), (150, '2aab0a400000-2aab35c00000 rw-p 2aab0a400000 00:00 0'), (151, 'Size:            712704 kB'), (152, 'Rss:             617872 kB'), (153, 'Shared_Clean:         0 kB'), (154, 'Shared_Dirty:         0 kB'), (155, 'Private_Clean:    15476 kB'), (156, 'Private_Dirty:   602396 kB'), (157, 'Swap:             58056 kB'), (158, 'Pss:             617872 kB'), (159, '```'), (160, ''), (161, '其中Swap字段代表该内存块存在swap分区的数据大小。通过执行如下命令，就可以找到每个内存块镜像信息中，这个进程使用到的swap量，通过求和就可以算出总的swap用量。'), (162, ''), (163, '```'), (164, 'cat /proc/986/smaps | grep Swap'), (165, 'Swap:                 0 kB'), (166, 'Swap:                 0 kB'), (167, '…'), (168, 'Swap:                 0 kB'), (169, 'Swap:            478320 kB'), (170, '…'), (171, 'Swap:               624 kB'), (172, 'Swap:                 0 kB'), (173, '```'), (174, ''), (175, ''), (176, '### 4. 最佳实践'), (177, ''), (178, '如果Linux>3.5，vm.swapniess=1，否则vm.swapniess=0，从而实现如下两个目标：'), (179, ''), (180, '+ 物理内存充足时候，使Redis足够快。'), (181, '+ 物理内存不足时候，避免Redis死掉(如果当前Redis为高可用，死掉比阻塞更好)。'), (182, ''), (183, '<a name=""chapter3""/>'), (184, ''), (185, '## 三. Transparent Huge Pages'), (186, ''), (187, 'Redis在启动时可能会看到如下日志：'), (188, ''), (189, '```'), (190, ""WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never > /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.""), (191, '```'), (192, ''), (193, '从提示看Redis建议修改Transparent Huge Pages (THP)的相关配置，Linux kernel在2.6.38内核增加了Transparent Huge Pages (THP)特性 ，支持大内存页(2MB)分配，默认开启。当开启时可以降低fork子进程的速度，但fork之后，每个内存页从原来4KB变为2MB，会大幅增加重写期间父进程内存消耗。同时每次写命令引起的复制内存页单位放大了512倍，会拖慢写操作的执行时间，导致大量写操作慢查询。例如简单的incr命令也会出现在慢查询中。因此Redis日志中建议将此特性进行禁用，禁用方法如下：'), (194, ''), (195, '```'), (196, 'echo never >  /sys/kernel/mm/transparent_hugepage/enabled'), (197, '```'), (198, ''), (199, '而且为了使机器重启后THP配置依然生效，可以在/etc/rc.local中追加echo never > /sys/kernel/mm/transparent_hugepage/enabled。'), (200, ''), (201, '在设置THP配置时需要注意：有些Linux的发行版本没有将THP放到/sys/kernel/mm/transparent_hugepage/enabled中，例如Red Hat 6以上的THP配置放到/sys/kernel/mm/redhat_transparent_hugepage/enabled中。而Redis源码中检查THP时，把THP位置写死。'), (202, ''), (203, '```'), (204, 'FILE *fp = fopen(""/sys/kernel/mm/transparent_hugepage/enabled"",""r"");'), (205, 'if (!fp) return 0;'), (206, '```'), (207, ''), (208, '所以在发行版中，虽然没有THP的日志提示，但是依然存在THP所带来的问题。'), (209, ''), (210, '```'), (211, 'echo never >  /sys/kernel/mm/redhat_transparent_hugepage/enabled'), (212, '```'), (213, ''), (214, '<a name=""chapter4""/>'), (215, '## 四. OOM killer'), (216, ''), (217, 'OOM killer会在可用内存不足时选择性的杀掉用户进程，它的运行规则是怎样的，会选择哪些用户进程“下手”呢？OOM killer进程会为每个用户进程设置一个权值，这个权值越高，被“下手”的概率就越高，反之概率越低。每个进程的权值存放在/proc/{progress_id}/oom_score中，这个值是受/proc/{progress_id}/oom_adj的控制，oom_adj在不同的Linux版本的最小值不同，可以参考Linux源码中oom.h(从-15到-17)。当oom_adj设置为最小值时，该进程将不会被OOM killer杀掉，设置方法如下。'), (218, ''), (219, '```'), (220, 'echo {value} > /proc/${process_id}/oom_adj'), (221, '```'), (222, ''), (223, '对于Redis所在的服务器来说，可以将所有Redis的oom_adj设置为最低值或者稍小的值，降低被OOM killer杀掉的概率。'), (224, ''), (225, '```'), (226, 'for redis_pid in $(pgrep -f ""redis-server"")'), (227, 'do'), (228, '  echo -17 > /proc/${redis_pid}/oom_adj'), (229, 'done'), (230, '```'), (231, ''), (232, ''), (233, '### 运维提示：'), (234, '+ 有关OOM killer的详细细节，可以参考Linux源码mm/oom_kill.c中oom_badness函数。'), (235, '+ 笔者认为oom_adj参数只能起到辅助作用，合理的规划内存更为重要。'), (236, '+ 通常在高可用情况下，被杀掉比僵死更好，因此不要过多依赖oom_adj配置'), (237, ''), (238, ''), (239, '<a name=""chapter5""/>'), (240, '## 五. 使用NTP'), (241, ''), (242, 'NTP(Network Time Protocol)网络时间协议，一种保证不同机器时钟一致性的服务。我们知道像Redis Sentinel和Redis Cluster这两种需要多个Redis实例的类型，可能会涉及多台服务器。虽然Redis并没有对多个服务器的时钟有严格的要求，但是假如多个Redis实例所在的服务器时钟不一致，对于一些异常情况的日志排查是非常困难的，例如Redis Cluster的故障转移，如果日志时间不一致，对于我们排查问题带来很大的困扰(注：但不会影响集群功能，集群节点依赖各自时钟)。一般公司里都会有NTP服务用来提供标准时间服务，从而达到纠正时钟的效果(如下图所示)，为此我们可以每天定时去同步一次系统时间，从而使得集群中的时间是统一。'), (243, ''), (244, '<img src=""../../img/troubleshooting/NTP.png"" width=""100%""/>'), (245, ''), (246, ''), (247, '例如每小时的同步1次NTP服务'), (248, '```'), (249, '0 * * * * /usr/sbin/ntpdate ntp.xx.com > /dev/null 2>&1'), (250, '```'), (251, ''), (252, '<a name=""chapter6""/>'), (253, '## 六. ulimit'), (254, ''), (255, '在Linux中，可以通过ulimit查看和设置系统的当前用户进程的资源数。其中ulimit -a命令包含的open files参数，是单个用户同时打开的最大文件个数。'), (256, ''), (257, '```'), (258, '# ulimit –a'), (259, '…'), (260, 'max locked memory       (kbytes, -l) 64'), (261, 'max memory size         (kbytes, -m) unlimited'), (262, 'open files                      (-n) 1024'), (263, 'pipe size            (512 bytes, -p) 8'), (264, '…'), (265, '```'), (266, ''), (267, 'Redis允许同时有多个客户端通过网络进行连接，可以通过配置maxclients来限制最大客户端连接数。对Linux操作系统来说这些网络连接都是文件句柄。假设当前open files是4096，那么启动Redis时会看到如下日志。'), (268, ''), (269, '```'), (270, '# You requested maxclients of 10000 requiring at least 10032 max file descriptors.'), (271, '# Redis can’t set maximum open files to 10032 because of OS error: Operation not permitted.'), (272, '# Current maximum open files is 4096. Maxclients has been reduced to 4064 to compensate for low ulimit. If you need higher maxclients increase ‘ulimit –n’.'), (273, '```'), (274, ''), (275, '上面的日志解释如下：'), (276, ''), (277, '+ 第一行：Redis建议把open files至少设置成10032，那么这个10032是如何来的呢？因为maxclients的默认是10000，这些是用来处理客户端连接的，除此之外，Redis内部会使用最多32个文件描述符，所以这里的10032 = 10000 + 32。'), (278, '+ 第二行：Redis不能将open files设置成10032，因为它没有权限设置。'), (279, '+ 第三行：当前系统的open files是4096，所以maxclients被设置成4096-32=4064个，如果你想设置更高的maxclients，请使用ulimit -n来设置。'), (280, ''), (281, '从上面的三行日志分析可以看出open files的限制优先级比maxclients大。'), (282, 'open files的设置方法如下：'), (283, ''), (284, '```'), (285, 'ulimit –Sn {max-open-files}'), (286, '```'), (287, ''), (288, '<a name=""chapter7""/>'), (289, '## 七. TCP backlog'), (290, ''), (291, 'Redis默认的tcp-backlog为511，可以通过修改配置tcp-backlog进行调整，如果Linux的tcp-backlog小于Redis设置的tcp-backlog，那么在Redis启动时会看到如下日志：'), (292, ''), (293, '```'), (294, '# WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.'), (295, '```'), (296, ''), (297, '查看方法：'), (298, ''), (299, '```'), (300, 'cat /proc/sys/net/core/somaxconn'), (301, '128'), (302, '```'), (303, ''), (304, '修改方法：.'), (305, ''), (306, '```'), (307, 'echo 511 > /proc/sys/net/core/somaxconn'), (308, '```')], 'deleted': []}"
451,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/liunx.toc.md,liunx.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* 一. [内存分配控制](#chapter1)'), (4, '* 二. [swappiness](#chapter2)'), (5, '* 三. [Transparent Huge Pages](#chapter3)'), (6, '* 四. [OOM killer](#chapter4)'), (7, '* 五. [使用NTP](#chapter5)'), (8, '* 六. [ulimit](#chapter6)'), (9, '* 七. [TCP backlog](#chapter7)')], 'deleted': []}"
452,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/memory.md,memory.md,1,"{'added': [(1, 'Redis所有的数据都在内存中，而内存又是非常宝贵的资源。对于如何优化内存使用一直是Redis用户非常关注的问题。本文让我们深入到Redis细节中，学习内存优化的技巧。分为如下几个部分：'), (2, ''), (3, '<a name=""chapter1""/>'), (4, ''), (5, '## 一. redisObject对象'), (6, ''), (7, 'Redis存储的所有值对象在内部定义为redisObject结构体，内部结构如下图所示。'), (8, ''), (9, '<img src=""../../img/troubleshooting/memory/redis-object.png"" width=""100%""/>'), (10, ''), (11, 'Redis存储的数据都使用redisObject来封装，包括string,hash,list,set,zset在内的所有数据类型。理解redisObject对内存优化非常有帮助，下面针对每个字段做详细说明：'), (12, ''), (13, '<!--more-->'), (14, ''), (15, '### 1.type字段:'), (16, ''), (17, '表示当前对象使用的数据类型，Redis主要支持5种数据类型:string,hash,list,set,zset。可以使用type {key}命令查看对象所属类型，type命令返回的是值对象类型，键都是string类型。'), (18, ''), (19, '### 2.encoding字段:'), (20, ''), (21, '表示Redis内部编码类型，encoding在Redis内部使用，代表当前对象内部采用哪种数据结构实现。理解Redis内部编码方式对于优化内存非常重要，同一个对象采用不同的编码实现内存占用存在明显差异，具体细节见之后编码优化部分。'), (22, ''), (23, '### 3.lru字段:'), (24, ''), (25, '记录对象最后一次被访问的时间，当配置了maxmemory和maxmemory-policy=volatile-lru | allkeys-lru 时， 用于辅助LRU算法删除键数据。可以使用object idletime {key}命令在不更新lru字段情况下查看当前键的空闲时间。'), (26, ''), (27, '```'), (28, '开发提示：可以使用scan + object idletime 命令批量查询哪些键长时间未被访问，找出长时间不访问的键进行清理降低内存占用。'), (29, '```'), (30, ''), (31, '### 4.refcount字段:'), (32, ''), (33, '记录当前对象被引用的次数，用于通过引用次数回收内存，当refcount=0时，可以安全回收当前对象空间。使用object refcount {key}获取当前对象引用。当对象为整数且范围在[0-9999]时，Redis可以使用共享对象的方式来节省内存，具体细节见之后共享对象池部分。'), (34, ''), (35, '### 5. *ptr字段:'), (36, ''), (37, '与对象的数据内容相关，如果是整数直接存储数据，否则表示指向数据的指针。Redis在3.0之后对值对象是字符串且长度<=39字节的数据，内部编码采用embstr类型，字符串sds和redisObject一起分配，从而只要一次内存操作。'), (38, ''), (39, '```'), (40, '开发提示：高并发写入场景中，在条件允许的情况下建议字符串长度控制在39字节以内，减少创建redisObject内存分配次数，从而提高性能。'), (41, '```'), (42, '<a name=""chapter2""/>'), (43, ''), (44, '## 二. 缩减键值对象'), (45, ''), (46, '降低Redis内存使用最直接的方式就是缩减键（key）和值（value）的长度。'), (47, ''), (48, '+ key长度：如在设计键时，在完整描述业务情况下，键值越短越好。'), (49, ''), (50, '+ value长度：值对象缩减比较复杂，常见需求是把业务对象序列化成二进制数组放入Redis。首先应该在业务上精简业务对象，去掉不必要的属性避免存储无效数据。其次在序列化工具选择上，应该选择更高效的序列化工具来降低字节数组大小。以JAVA为例，内置的序列化方式无论从速度还是压缩比都不尽如人意，这时可以选择更高效的序列化工具，如: protostuff，kryo等，下图是JAVA常见序列化工具空间压缩对比。'), (51, ''), (52, '<img src=""../../img/troubleshooting/memory/comparison-of-serializaiton-tools.png"" width=""100%""/>'), (53, ''), (54, '其中java-built-in-serializer表示JAVA内置序列化方式，更多数据见jvm-serializers项目:https://github.com/eishay/jvm-serializers/wiki，其它语言也有各自对应的高效序列化工具。'), (55, ''), (56, '值对象除了存储二进制数据之外，通常还会使用通用格式存储数据比如:json，xml等作为字符串存储在Redis中。这种方式优点是方便调试和跨语言，但是同样的数据相比字节数组所需的空间更大，在内存紧张的情况下，可以使用通用压缩算法压缩json,xml后再存入Redis，从而降低内存占用，例如使用GZIP压缩后的json可降低约60%的空间。'), (57, ''), (58, '```'), (59, '开发提示：当频繁压缩解压json等文本数据时，开发人员需要考虑压缩速度和计算开销成本，这里推荐使用google的Snappy压缩工具，在特定的压缩率情况下效率远远高于GZIP等传统压缩工具，且支持所有主流语言环境。'), (60, '```'), (61, '<a name=""chapter3""/>'), (62, ''), (63, '## 三. 共享对象池'), (64, ''), (65, '对象共享池指Redis内部维护[0-9999]的整数对象池。创建大量的整数类型redisObject存在内存开销，每个redisObject内部结构至少占16字节，甚至超过了整数自身空间消耗。所以Redis内存维护一个[0-9999]的整数对象池，用于节约内存。除了整数值对象，其他类型如list,hash,set,zset内部元素也可以使用整数对象池。因此开发中在满足需求的前提下，尽量使用整数对象以节省内存。'), (66, '整数对象池在Redis中通过变量REDIS_SHARED_INTEGERS定义，不能通过配置修改。可以通过object refcount 命令查看对象引用数验证是否启用整数对象池技术，如下:'), (67, ''), (68, '```'), (69, 'redis> set foo 100'), (70, 'OK'), (71, 'redis> object refcount foo'), (72, '(integer) 2'), (73, 'redis> set bar 100'), (74, 'OK'), (75, 'redis> object refcount bar'), (76, '(integer) 3'), (77, '```'), (78, ''), (79, ''), (80, '设置键foo等于100时，直接使用共享池内整数对象，因此引用数是2，再设置键bar等于100时，引用数又变为3，如下图所示。'), (81, ''), (82, '<img src=""../../img/troubleshooting/memory/refcount.png"" width=""100%""/>'), (83, ''), (84, '使用整数对象池究竟能降低多少内存？让我们通过测试来对比对象池的内存优化效果，如下表所示。'), (85, ''), (86, ''), (87, '操作说明 | 是否对象共享 | key大小 | value大小 | used_mem | used_memory_rss'), (88, '--- |--- |--- |--- |--- |---'), (89, '插入200万 | 否 | 20字节 | [0-9999]整数 | 199.91MB | 205.28MB'), (90, '插入200万 | 是 | 20字节 | [0-9999]整数 | 138.87MB | 143.28MB'), (91, ''), (92, '```'), (93, '注意本文所有测试环境都保持一致，信息如下:'), (94, '服务器信息: cpu=Intel-Xeon E5606@2.13GHz memory=32GB'), (95, 'Redis版本:Redis server v=3.0.7 sha=00000000:0 malloc=jemalloc-3.6.0 bits=64'), (96, '```'), (97, ''), (98, '使用共享对象池后，相同的数据内存使用降低30%以上。可见当数据大量使用[0-9999]的整数时，共享对象池可以节约大量内存。需要注意的是对象池并不是只要存储[0-9999]的整数就可以工作。当设置maxmemory并启用LRU相关淘汰策略如:volatile-lru，allkeys-lru时，Redis禁止使用共享对象池，测试命令如下：'), (99, ''), (100, '```'), (101, 'redis> set key:1 99'), (102, 'OK //设置key:1=99'), (103, 'redis> object refcount key:1'), (104, '(integer) 2 //使用了对象共享,引用数为2'), (105, 'redis> config set maxmemory-policy volatile-lru'), (106, 'OK //开启LRU淘汰策略'), (107, 'redis> set key:2 99'), (108, 'OK //设置key:2=99'), (109, 'redis> object refcount key:2'), (110, '(integer) 3 //使用了对象共享,引用数变为3'), (111, 'redis> config set maxmemory 1GB'), (112, 'OK //设置最大可用内存'), (113, 'redis> set key:3 99'), (114, 'OK //设置key:3=99'), (115, 'redis> object refcount key:3'), (116, '(integer) 1 //未使用对象共享,引用数为1'), (117, 'redis> config set maxmemory-policy volatile-ttl'), (118, 'OK //设置非LRU淘汰策略'), (119, 'redis> set key:4 99'), (120, 'OK //设置key:4=99'), (121, 'redis> object refcount key:4'), (122, '(integer) 4 //又可以使用对象共享,引用数变为4'), (123, '```'), (124, ''), (125, ''), (126, '#### 为什么开启maxmemory和LRU淘汰策略后对象池无效?'), (127, ''), (128, 'LRU算法需要获取对象最后被访问时间，以便淘汰最长未访问数据，每个对象最后访问时间存储在redisObject对象的lru字段。对象共享意味着多个引用共享同一个redisObject，这时lru字段也会被共享，导致无法获取每个对象的最后访问时间。如果没有设置maxmemory，直到内存被用尽Redis也不会触发内存回收，所以共享对象池可以正常工作。'), (129, ''), (130, '综上所述，共享对象池与maxmemory+LRU策略冲突，使用时需要注意。 对于ziplist编码的值对象，即使内部数据为整数也无法使用共享对象池，因为ziplist使用压缩且内存连续的结构，对象共享判断成本过高，ziplist编码细节后面内容详细说明。'), (131, ''), (132, '#### 为什么只有整数对象池？'), (133, '首先整数对象池复用的几率最大，其次对象共享的一个关键操作就是判断相等性，Redis之所以只有整数对象池，是因为整数比较算法时间复杂度为O(1)，只保留一万个整数为了防止对象池浪费。如果是字符串判断相等性，时间复杂度变为O(n)，特别是长字符串更消耗性能(浮点数在Redis内部使用字符串存储)。对于更复杂的数据结构如hash,list等，相等性判断需要O(n<sup>2</sup>)。对于单线程的Redis来说，这样的开销显然不合理，因此Redis只保留整数共享对象池。'), (134, ''), (135, '<a name=""chapter4""/>'), (136, ''), (137, '## 四. 字符串优化'), (138, '字符串对象是Redis内部最常用的数据类型。所有的键都是字符串类型， 值对象数据除了整数之外都使用字符串存储。比如执行命令:lpush cache:type ""redis"" ""memcache"" ""tair"" ""levelDB"" ，Redis首先创建""cache:type""键字符串，然后创建链表对象，链表对象内再包含四个字符串对象，排除Redis内部用到的字符串对象之外至少创建5个字符串对象。可见字符串对象在Redis内部使用非常广泛，因此深刻理解Redis字符串对于内存优化非常有帮助。'), (139, ''), (140, '### 1.字符串结构'), (141, ''), (142, 'Redis没有采用原生C语言的字符串类型而是自己实现了字符串结构，内部简单动态字符串(simple dynamic string)，简称SDS。结构下图所示。'), (143, ''), (144, '<img src=""../../img/troubleshooting/memory/SDS.png"" width=""100%""/>'), (145, ''), (146, 'Redis自身实现的字符串结构有如下特点:'), (147, ''), (148, '+ O(1)时间复杂度获取：字符串长度，已用长度，未用长度。'), (149, '+ 可用于保存字节数组，支持安全的二进制数据存储。'), (150, '+ 内部实现空间预分配机制，降低内存再分配次数。'), (151, '+ 惰性删除机制，字符串缩减后的空间不释放，作为预分配空间保留。'), (152, ''), (153, ''), (154, '### 2.预分配机制'), (155, ''), (156, '因为字符串(SDS)存在预分配机制，日常开发中要小心预分配带来的内存浪费，例如下表的测试用例。'), (157, ''), (158, '#### 表：字符串内存预分配测试'), (159, ''), (160, '阶段 | 数据量 | 操作说明 | 命令 | key大小 | value大小 | used_mem | used_memory_rss | mem_fragmentation_ratio'), (161, '--- |--- |--- |--- |--- |--- |--- |--- |---'), (162, '阶段1 | 200w | 新插入200w数据 | set |20字节 |60字节 |321.98MB |331.44MB |1.02'), (163, '阶段2 | 200w | 在阶段1上每个对象追加60字节数据 | append |20字节 |60字节 |657.67MB |752.80MB |1.14'), (164, '阶段3 | 200w | 重新插入200w数据 | set |20字节 |120字节 |474.56MB |482.45MB |1.02'), (165, ''), (166, ''), (167, '从测试数据可以看出，同样的数据追加后内存消耗非常严重，下面我们结合图来分析这一现象。阶段1每个字符串对象空间占用如下图所示。'), (168, ''), (169, '<img src=""../../img/troubleshooting/memory/SDS-example1.png"" width=""100%""/>'), (170, ''), (171, '阶段1插入新的字符串后，free字段保留空间为0，总占用空间=实际占用空间+1字节，最后1字节保存‘\\0’标示结尾，这里忽略int类型len和free字段消耗的8字节。在阶段1原有字符串上追加60字节数据空间占用如下图所示。'), (172, ''), (173, '<img src=""../../img/troubleshooting/memory/SDS-example2.png"" width=""100%""/>'), (174, ''), (175, '追加操作后字符串对象预分配了一倍容量作为预留空间，而且大量追加操作需要内存重新分配，造成内存碎片率(mem_fragmentation_ratio)上升。直接插入与阶段2相同数据的空间占用，如下图所示。'), (176, ''), (177, '<img src=""../../img/troubleshooting/memory/SDS-example3.png"" width=""100%""/>'), (178, ''), (179, ''), (180, '阶段3直接插入同等数据后，相比阶段2节省了每个字符串对象预分配的空间，同时降低了碎片率。'), (181, '字符串之所以采用预分配的方式是防止修改操作需要不断重分配内存和字节数据拷贝。但同样也会造成内存的浪费。字符串预分配每次并不都是翻倍扩容，空间预分配规则如下:'), (182, ''), (183, '1. 第一次创建len属性等于数据实际大小，free等于0，不做预分配。'), (184, '2. 修改后如果已有free空间不够且数据小于1M，每次预分配一倍容量。如原有len=60byte，free=0，再追加60byte，预分配120byte，总占用空间:60byte+60byte+120byte+1byte。'), (185, '3. 修改后如果已有free空间不够且数据大于1MB，每次预分配1MB数据。如原有len=30MB，free=0，当再追加100byte ,预分配1MB，总占用空间:1MB+100byte+1MB+1byte。'), (186, ''), (187, '```'), (188, '开发提示:尽量减少字符串频繁修改操作如append，setrange, 改为直接使用set修改字符串，降低预分配带来的内存浪费和内存碎片化。'), (189, '```'), (190, ''), (191, '### 3.字符串重构'), (192, ''), (193, '字符串重构：指不一定把每份数据作为字符串整体存储，像json这样的数据可以使用hash结构，使用二级结构存储也能帮我们节省内存。同时可以使用hmget,hmset命令支持字段的部分读取修改，而不用每次整体存取。例如下面的json数据：'), (194, '```'), (195, '{'), (196, '    ""vid"": ""4133687xx"",'), (197, '    ""title"": ""搜狐屌丝男士"",'), (198, '    ""videoAlbumPic"": ""http://xxx.sohu.com/60160518/vrsa_ver8400079_ae433_pic26.jpg"",'), (199, '    ""pid"": ""6494271"",'), (200, '    ""type"": ""1024"",'), (201, '    ""playlist"": ""6494271"",'), (202, '    ""playTime"": ""468""'), (203, '}'), (204, '```'), (205, ''), (206, '分别使用字符串和hash结构测试内存表现，如下表所示。'), (207, ''), (208, '#### 表：测试内存表现'), (209, ''), (210, '数据量 | key | 存储类型 | value | 配置 | used_mem'), (211, '--- |--- |--- |--- |--- |---'), (212, '200W | 20字节 | string | json字符串 | 默认 | 612.62M'), (213, '200W | 20字节 | hash | key-value对 | 默认 | 默认\t1.88GB'), (214, '200W | 20字节 | hash | key-value对 | hash-max-ziplist-value:66 | 535.60M'), (215, ''), (216, '根据测试结构，第一次默认配置下使用hash类型，内存消耗不但没有降低反而比字符串存储多出2倍，而调整hash-max-ziplist-value=66之后内存降低为535.60M。因为json的videoAlbumPic属性长度是65，而hash-max-ziplist-value默认值是64，Redis采用hashtable编码方式，反而消耗了大量内存。调整配置后hash类型内部编码方式变为ziplist，相比字符串更省内存且支持属性的部分操作。下一节将具体介绍ziplist编码优化细节。'), (217, ''), (218, '<a name=""chapter5""/>'), (219, ''), (220, '## 五. 编码优化'), (221, ''), (222, '### 1.了解编码'), (223, ''), (224, 'Redis对外提供了string,list,hash,set,zet等类型，但是Redis内部针对不同类型存在编码的概念，所谓编码就是具体使用哪种底层数据结构来实现。编码不同将直接影响数据的内存占用和读写效率。使用object encoding {key}命令获取编码类型。如下:'), (225, ''), (226, '```'), (227, 'redis> set str:1 hello'), (228, 'OK'), (229, 'redis> object encoding str:1'), (230, '""embstr"" // embstr编码字符串'), (231, 'redis> lpush list:1 1 2 3'), (232, '(integer) 3'), (233, 'redis> object encoding list:1'), (234, '""ziplist"" // ziplist编码列表'), (235, '```'), (236, ''), (237, 'Redis针对每种数据类型(type)可以采用至少两种编码方式来实现，下表表示type和encoding的对应关系。'), (238, ''), (239, '#### 表：type和encoding对应关系表'), (240, ''), (241, '类型 | 编码方式 | 数据结构'), (242, '--- |--- |---'), (243, 'string | raw<br/>embstr<br/>int | 动态字符串编码<br/>优化内存分配的字符串编码<br/>整数编码'), (244, 'hash | hashtable<br/>ziplist | 散列表编码<br/>压缩列表编码'), (245, 'list | linkedlist<br/>ziplist<br/>quicklist<br/> | 双向链表编码<br/>压缩列表编码<br/>3.2版本新的列表编码'), (246, 'set | hashtable<br/>intset | 散列表编码<br/>整数集合编码'), (247, 'zset | skiplist<br/>ziplist | 跳跃表编码<br/>压缩列表编码'), (248, ''), (249, '了解编码和类型对应关系之后，我们不禁疑惑Redis为什么需要对一种数据结构实现多种编码方式？'), (250, '主要原因是Redis作者想通过不同编码实现效率和空间的平衡。比如当我们的存储只有10个元素的列表，当使用双向链表数据结构时，必然需要维护大量的内部字段如每个元素需要：前置指针，后置指针，数据指针等，造成空间浪费，如果采用连续内存结构的压缩列表(ziplist)，将会节省大量内存，而由于数据长度较小，存取操作时间复杂度即使为O(n<sup>2</sup>)性能也可满足需求。'), (251, ''), (252, ''), (253, '### 2.控制编码类型'), (254, ''), (255, '编码类型转换在Redis写入数据时自动完成，这个转换过程是不可逆的，转换规则只能从小内存编码向大内存编码转换。例如：'), (256, ''), (257, '```'), (258, 'redis> lpush list:1 a b c d'), (259, '(integer) 4 //存储4个元素'), (260, 'redis> object encoding list:1'), (261, '""ziplist"" //采用ziplist压缩列表编码'), (262, 'redis> config set list-max-ziplist-entries 4'), (263, 'OK //设置列表类型ziplist编码最大允许4个元素'), (264, 'redis> lpush list:1 e'), (265, '(integer) 5 //写入第5个元素e'), (266, 'redis> object encoding list:1'), (267, '""linkedlist"" //编码类型转换为链表'), (268, 'redis> rpop list:1'), (269, '""a"" //弹出元素a'), (270, 'redis> llen list:1'), (271, '(integer) 4 // 列表此时有4个元素'), (272, 'redis> object encoding list:1'), (273, '""linkedlist"" //编码类型依然为链表，未做编码回退'), (274, '```'), (275, ''), (276, '以上命令体现了list类型编码的转换过程，其中Redis之所以不支持编码回退，主要是数据增删频繁时，数据向压缩编码转换非常消耗CPU，得不偿失。以上示例用到了list-max-ziplist-entries参数，这个参数用来决定列表长度在多少范围内使用ziplist编码。当然还有其它参数控制各种数据类型的编码，如下表所示：'), (277, ''), (278, '#### 表：hash,list,set,zset内部编码配置'), (279, ''), (280, ''), (281, '类型 | 编码 | 决定条件'), (282, '--- |--- |---'), (283, 'hash | ziplist | 满足所有条件:<br/>value最大空间(字节)<=hash-max-ziplist-value<br/>field个数<=hash-max-ziplist-entries'), (284, '同上 | hashtable | 满足任意条件:<br/>value最大空间(字节)>hash-max-ziplist-value<br/>field个数>hash-max-ziplist-entries'), (285, 'list | ziplist | ziplist\t满足所有条件:<br/>value最大空间(字节)<=list-max-ziplist-value<br/>链表长度<=list-max-ziplist-entries'), (286, '同上 | linkedlist | 满足任意条件<br/>value最大空间(字节)>list-max-ziplist-value<br/>链表长度>list-max-ziplist-entries'), (287, '同上 | quicklist | 3.2版本新编码:<br/>废弃list-max-ziplist-entries和list-max-ziplist-entries配置<br/>使用新配置: <br/>list-max-ziplist-size:表示最大压缩空间或长度,最大空间使用[-5-1]范围配置，默认-2表示8KB,正整数表示最大压缩长度<br/>list-compress-depth:表示最大压缩深度，默认=0不压缩'), (288, 'set | intset | 满足所有条件:<br/>元素必须为整数<br/>集合长度<=set-max-intset-entries'), (289, '同上 | hashtable | 满足任意条件<br/>元素非整数类型<br/>集合长度>hash-max-ziplist-entries'), (290, 'zset | ziplist | 满足所有条件:<br/>value最大空间(字节)<=zset-max-ziplist-value<br/>有序集合长度<=zset-max-ziplist-entries'), (291, '同上 | skiplist | 满足任意条件:<br/>value最大空间(字节)>zset-max-ziplist-value<br/>有序集合长度>zset-max-ziplist-entries'), (292, ''), (293, '掌握编码转换机制，对我们通过编码来优化内存使用非常有帮助。下面以hash类型为例，介绍编码转换的运行流程，如下图所示。'), (294, ''), (295, '<img src=""../../img/troubleshooting/memory/hash-encoding-transform.png"" width=""100%""/>'), (296, ''), (297, '理解编码转换流程和相关配置之后，可以使用config set命令设置编码相关参数来满足使用压缩编码的条件。对于已经采用非压缩编码类型的数据如hashtable,linkedlist等，设置参数后即使数据满足压缩编码条件，Redis也不会做转换，需要重启Redis重新加载数据才能完成转换。'), (298, ''), (299, '### 3.ziplist编码'), (300, ''), (301, 'ziplist编码主要目的是为了节约内存，因此所有数据都是采用线性连续的内存结构。ziplist编码是应用范围最广的一种，可以分别作为hash、list、zset类型的底层数据结构实现。首先从ziplist编码结构开始分析，它的内部结构类似这样:<zlbytes><zltail><zllen><entry-1><entry-2><....><entry-n><zlend>。一个ziplist可以包含多个entry(元素)，每个entry保存具体的数据(整数或者字节数组)，内部结构如下图所示。'), (302, ''), (303, '<img src=""../../img/troubleshooting/memory/ziplist-structure.png"" width=""100%""/>'), (304, ''), (305, 'ziplist结构字段含义：'), (306, ''), (307, '1. zlbytes:记录整个压缩列表所占字节长度，方便重新调整ziplist空间。类型是int-32，长度为4字节'), (308, '2. zltail:记录距离尾节点的偏移量，方便尾节点弹出操作。类型是int-32，长度为4字节'), (309, '3. zllen:记录压缩链表节点数量，当长度超过216-2时需要遍历整个列表获取长度，一般很少见。类型是int-16，长度为2字节'), (310, '4. entry:记录具体的节点，长度根据实际存储的数据而定。'), (311, '    1. prev_entry_bytes_length:记录前一个节点所占空间，用于快速定位上一个节点，可实现列表反向迭代。'), (312, '    2. encoding:标示当前节点编码和长度，前两位表示编码类型：字符串/整数，其余位表示数据长度。'), (313, '    3. contents:保存节点的值，针对实际数据长度做内存占用优化。'), (314, '5. zlend:记录列表结尾，占用一个字节。'), (315, ''), (316, '根据以上对ziplist字段说明，可以分析出该数据结构特点如下:'), (317, ''), (318, '1. 内部表现为数据紧凑排列的一块连续内存数组。'), (319, '2. 可以模拟双向链表结构，以O(1)时间复杂度入队和出队。'), (320, '3. 新增删除操作涉及内存重新分配或释放，加大了操作的复杂性。'), (321, '4. 读写操作涉及复杂的指针移动，最坏时间复杂度为O(n<sup>2</sup>)。'), (322, '5. 适合存储小对象和长度有限的数据。'), (323, ''), (324, '下面通过测试展示ziplist编码在不同类型中内存和速度的表现，如下表所示。'), (325, ''), (326, '#### 表：ziplist在hash,list,zset内存和速度测试'), (327, ''), (328, '类型 |\t数据量\t| key总数量\t| 长度|\tvalue大小\t|普通编码内存量/平均耗时\t|压缩编码内存量/平均耗时\t|内存降低比例|\t耗时增长倍数'), (329, '--- |--- |--- |--- |--- |--- |---'), (330, 'hash|\t100万|\t1千|\t1千|\t36字节|\t103.37M/0.84微秒|\t43.83M/13.24微秒\t|57.5%|\t15倍'), (331, 'list|\t100万|\t1千|\t1千|\t36字节|\t92.46M/2.04微秒|\t39.92M/5.45微秒|\t56.8%\t|2.5倍|'), (332, 'zset|\t100万|\t1千|\t1千|\t36字节|\t151.84M/1.85微秒|\t43.83M/77.88微秒\t|71%\t|42倍'), (333, ''), (334, ''), (335, '测试数据采用100W个36字节数据，划分为1000个键，每个类型长度统一为1000。从测试结果可以看出：'), (336, ''), (337, '1. 使用ziplist可以分别作为hash,list,zset数据类型实现。'), (338, '2. 使用ziplist编码类型可以大幅降低内存占用。'), (339, '3. ziplist实现的数据类型相比原生结构，命令操作更加耗时，不同类型耗时排序:list < hash < zset。'), (340, ''), (341, 'ziplist压缩编码的性能表现跟值长度和元素个数密切相关，正因为如此Redis提供了{type}-max-ziplist-value和{type}-max-ziplist-entries相关参数来做控制ziplist编码转换。最后再次强调使用ziplist压缩编码的原则：追求空间和时间的平衡。'), (342, ''), (343, '```'), (344, '开发提示：'), (345, '1）针对性能要求较高的场景使用ziplist，建议长度不要超过1000，每个元素大小控制在512字节以内。'), (346, '2）命令平均耗时使用info Commandstats命令获取，包含每个命令调用次数，总耗时，平均耗时，单位微秒。'), (347, '```'), (348, ''), (349, '### 4.intset编码'), (350, ''), (351, 'intset编码是集合(set)类型编码的一种，内部表现为存储有序，不重复的整数集。当集合只包含整数且长度不超过set-max-intset-entries配置时被启用。执行以下命令查看intset表现：'), (352, ''), (353, '```'), (354, '127.0.0.1:6379> sadd set:test 3 4 2 6 8 9 2'), (355, '(integer) 6 //乱序写入6个整数'), (356, '127.0.0.1:6379> object encoding set:test'), (357, '""intset"" //使用intset编码'), (358, '127.0.0.1:6379> smembers set:test'), (359, '""2"" ""3"" ""4"" ""6"" ""8"" ""9"" // 排序输出整数结合'), (360, 'redis> config set set-max-intset-entries 6'), (361, 'OK //设置intset最大允许整数长度'), (362, 'redis> sadd set:test 5'), (363, '(integer) 1 //写入第7个整数 5'), (364, 'redis> object encoding set:test'), (365, '""hashtable"" // 编码变为hashtable'), (366, 'redis> smembers set:test'), (367, '""8"" ""3"" ""5"" ""9"" ""4"" ""2"" ""6"" //乱序输出'), (368, '```'), (369, ''), (370, '以上命令可以看出intset对写入整数进行排序，通过O(log(n))时间复杂度实现查找和去重操作，intset编码结构如下图所示。'), (371, ''), (372, '<img src=""../../img/troubleshooting/memory/intset-structure.png"" width=""100%""/>'), (373, ''), (374, ''), (375, 'intset的字段结构含义：'), (376, ''), (377, '1. encodind:整数表示类型，根据集合内最长整数值确定类型，整数类型划分三种：int-16，int-32，int-64。'), (378, '2. length:表示集合元素个数。'), (379, '3. contents:整数数组，按从小到大顺序保存。'), (380, ''), (381, 'intset保存的整数类型根据长度划分，当保存的整数超出当前类型时，将会触发自动升级操作且升级后不再做回退。升级操作将会导致重新申请内存空间，把原有数据按转换类型后拷贝到新数组。'), (382, ''), (383, '```'), (384, '开发提示：使用intset编码的集合时，尽量保持整数范围一致，如都在int-16范围内。防止个别大整数触发集合升级操作，产生内存浪费。'), (385, '下面通过测试查看ziplist编码的集合内存和速度表现，如下表所示。'), (386, '```'), (387, ''), (388, '#### 表：ziplist编码在set下内存和速度表现'), (389, ''), (390, '数据量|\tkey大小|\tvalue大小|\t编码\t| 集合长度|\t内存量|\t内存降低比例|\t平均耗时'), (391, '--- |--- |--- |--- |--- |--- |---'), (392, '100w|\t20byte|\t7字节|\thashtable|\t1千|\t61.97MB| -- | 0.78毫秒'), (393, '100w|\t20byte|\t7字节|\tintset|\t1千|\t4.77MB|\t92.6%|\t0.51毫秒'), (394, '100w|\t20byte|\t7字节|\tziplist|\t1千|\t8.67MB|\t86.2%|\t13.12毫秒'), (395, ''), (396, '根据以上测试结果发现intset表现非常好，同样的数据内存占用只有不到hashtable编码的十分之一。intset数据结构插入命令复杂度为O(n)，查询命令为O(log(n))，由于整数占用空间非常小，所以在集合长度可控的基础上，写入命令执行速度也会非常快，因此当使用整数集合时尽量使用intset编码。上表测试第三行把ziplist-hash类型也放入其中，主要因为intset编码必须存储整数，当集合内保存非整数数据时，无法使用intset实现内存优化。这时可以使用ziplist-hash类型对象模拟集合类型，hash的field当作集合中的元素，value设置为1字节占位符即可。使用ziplist编码的hash类型依然比使用hashtable编码的集合节省大量内存。'), (397, ''), (398, '<a name=""chapter6""/>'), (399, ''), (400, '## 六 控制key的数量'), (401, ''), (402, '当使用Redis存储大量数据时，通常会存在大量键，过多的键同样会消耗大量内存。Redis本质是一个数据结构服务器，它为我们提供多种数据结构，如hash，list，set，zset 等结构。使用Redis时不要进入一个误区，大量使用get/set这样的API，把Redis当成Memcached使用。对于存储相同的数据内容利用Redis的数据结构降低外层键的数量，也可以节省大量内存。如下图所示，通过在客户端预估键规模，把大量键分组映射到多个hash结构中降低键的数量。'), (403, ''), (404, '<img src=""../../img/troubleshooting/memory/keys-hash.png"" width=""100%""/>'), (405, ''), (406, ''), (407, 'hash结构降低键数量分析：'), (408, ''), (409, '+\t根据键规模在客户端通过分组映射到一组hash对象中，如存在100万个键，可以映射到1000个hash中，每个hash保存1000个元素。'), (410, '+\thash的field可用于记录原始key字符串，方便哈希查找。'), (411, '+\thash的value保存原始值对象，确保不要超过hash-max-ziplist-value限制。'), (412, ''), (413, '下面测试这种优化技巧的内存表现，如下表所示。'), (414, ''), (415, ''), (416, '#### 表：hash分组控制键规模测试'), (417, ''), (418, '数据量|\tkey大小|\tvalue大小|\tstring类型占用内存|\thash-ziplist类型占用内存|\t内存降低比例|\tstring:set平均耗时|\thash:hset平均耗时|'), (419, '--- |--- |--- |--- |--- |--- |--- |---'), (420, '200w|\t20byte|\t512byte|\t1392.64MB|\t1000.97MB|\t28.1%|\t2.13微秒|\t21.28微秒'), (421, '200w|\t20byte|\t200byte|\t596.62MB|\t399.38MB|\t33.1%|\t1.49微秒|\t16.08微秒'), (422, '200w|\t20byte|\t100byte|\t382.99MB|\t211.88MB|\t44.6%|\t1.30微秒|\t14.92微秒'), (423, '200w|\t20byte|\t50byte|\t291.46MB|\t110.32MB|\t62.1%|\t1.28微秒|\t13.48微秒'), (424, '200w|\t20byte|\t20byte|\t246.40MB|\t55.63MB|\t77.4%|\t1.10微秒|\t13.21微秒'), (425, '200w|\t20byte|\t5byte|\t199.93MB|\t24.42MB|\t87.7%|\t1.10微秒|\t13.06微秒'), (426, ''), (427, '通过这个测试数据，可以说明：'), (428, ''), (429, '+ 同样的数据使用ziplist编码的hash类型存储比string类型节约内存'), (430, '+ 节省内存量随着value空间的减少，越来越明显。'), (431, '+ hash-ziplist类型比string类型写入耗时，但随着value空间的减少，耗时逐渐降低。'), (432, ''), (433, '使用hash重构后节省内存量效果非常明显，特变对于存储小对象的场景，内存只有不到原来的1/5。下面分析这种内存优化技巧的关键点：'), (434, ''), (435, '1. hash类型节省内存的原理是使用ziplist编码，如果使用hashtable编码方式反而会增加内存消耗。'), (436, '2. ziplist长度需要控制在1000以内，否则由于存取操作时间复杂度在O(n)到O(n2)之间，长列表会导致CPU消耗严重，得不偿失。'), (437, '3. ziplist适合存储的小对象，对于大对象不但内存优化效果不明显还会增加命令操作耗时。'), (438, '4. 需要预估键的规模，从而确定每个hash结构需要存储的元素数量。'), (439, '5. 根据hash长度和元素大小，调整hash-max-ziplist-entries和hash-max-ziplist-value参数，确保hash类型使用ziplist编码。'), (440, ''), (441, '关于hash键和field键的设计：'), (442, ''), (443, '1. 当键离散度较高时，可以按字符串位截取，把后三位作为哈希的field，之前部分作为哈希的键。如：key=1948480 哈希key=group:hash:1948，哈希field=480。'), (444, '2. 当键离散度较低时，可以使用哈希算法打散键，如:使用crc32(key)&10000函数把所有的键映射到“0-9999”整数范围内，哈希field存储键的原始值。'), (445, '3. 尽量减少hash键和field的长度，如使用部分键内容。'), (446, ''), (447, '使用hash结构控制键的规模虽然可以大幅降低内存，但同样会带来问题，需要提前做好规避处理。如下:'), (448, ''), (449, '1. 客户端需要预估键的规模并设计hash分组规则，加重客户端开发成本。'), (450, '2. hash重构后所有的键无法再使用超时(expire)和LRU淘汰机制自动删除，需要手动维护删除。'), (451, '3. 对于大对象，如1KB以上的对象。使用hash-ziplist结构控制键数量。'), (452, '不过瑕不掩瑜，对于大量小对象的存储场景，非常适合使用ziplist编码的hash类型控制键的规模来降低内存。'), (453, ''), (454, '```'), (455, '开发提示：使用ziplist+hash优化keys后，如果想使用超时删除功能，开发人员可以存储每个对象写入的时间，再通过定时任务使用hscan命令扫描数据，找出hash内超时的数据项删除即可。'), (456, '```'), (457, ''), (458, '本文主要讲解Redis内存优化技巧，Redis的数据特性是""ALL IN MEMORY""，优化内存将变得非常重要。对于内存优化建议读者先要掌握Redis内存存储的特性比如字符串，压缩编码，整数集合等，再根据数据规模和所用命令需求去调整，从而达到空间和效率的最佳平衡。建议使用Redis存储大量数据时，把内存优化环节加入到前期设计阶段，否则数据大幅增长后，开发人员需要面对重新优化内存所带来开发和数据迁移的双重成本。当Redis内存不足时，首先考虑的问题不是加机器做水平扩展，应该先尝试做内存优化。当遇到瓶颈时，再去考虑水平扩展。即使对于集群化方案，垂直层面优化也同样重要，避免不必要的资源浪费和集群化后的管理成本。')], 'deleted': []}"
453,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/static/wiki/troubleshooting/memory.toc.md,memory.toc.md,1,"{'added': [(1, '##### 目录'), (2, ''), (3, '* 一. [redisObject对象](#chapter1)'), (4, '* 二. [缩减键值对象](#chapter2)'), (5, '* 三. [共享对象池](#chapter3)'), (6, '* 四. [字符串优化](#chapter4)'), (7, '* 五. [编码优化](#chapter5)'), (8, '* 六. [控制key的数量](#chapter6)')], 'deleted': []}"
454,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/templates/OperationAlert.vm,OperationAlert.vm,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud运维操作通知</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '            <ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">运维操作机器通知：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        机器ip'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        宿主机ip'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        机器详情'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        操作'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                        Status'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (37, '                        Message'), (38, '                    </td>'), (39, '                </tr>'), (40, '                #foreach($!item in $!operationAlertValueResultList)'), (41, '                    <tr>'), (42, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (43, '                            $!item.ip'), (44, '                        </td>'), (45, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (46, '                            $!item.machineInfo.realIp'), (47, '                        </td>'), (48, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, '                            #if($!item.machineInfo)'), (50, '                                内存：$!item.machineInfo.mem G<br/>'), (51, '                                cpu：$!item.machineInfo.cpu<br/>'), (52, '                                备注说明：$!item.machineInfo.extraDesc'), (53, '                            #end'), (54, '                        </td>'), (55, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (56, '                            $!item.type'), (57, '                        </td>'), (58, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (59, '                            $!item.status'), (60, '                        </td>'), (61, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (62, '                            $!item.message'), (63, '                        </td>'), (64, '                    </tr>'), (65, '                #end'), (66, '            </table>'), (67, '        </td>'), (68, '    </tr>'), (69, ''), (70, '</table>'), (71, '</p>'), (72, '</body>'), (73, '</html>')], 'deleted': []}"
455,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/templates/appAlert.vm,appAlert.vm,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>应用Redis分钟报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用Redis分钟报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        \t负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        \tip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                    \t\tport'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                    \t\t属性值'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                    \t\t说明'), (41, '                    </td>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (43, '                    \t\t其他信息'), (44, '                    </td>'), (45, '                </tr>'), (46, '                #foreach($!item in $!instanceAlertValueResultList)'), (47, '                \t<tr>'), (48, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.appId'>${item.appId}</a>""), (50, '\t                    </td>'), (51, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (52, '\t                        \t$!item.appDesc.name'), (53, '\t                    </td>'), (54, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (55, '\t                        \t$!item.appDesc.officer'), (56, '\t                    </td>'), (57, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (58, '\t                        \t$!item.instanceInfo.ip'), (59, '\t                    </td>'), (60, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (61, '\t                    \t\t$!item.instanceInfo.port'), (62, '\t                    </td>'), (63, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (64, '\t                    \t\t$!item.instanceAlertConfig.alertConfig'), (65, '\t                    </td>'), (66, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (67, '\t                    \t\t$!item.alertMessage'), (68, '\t                    </td>'), (69, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (70, '\t                    \t\t$!item.otherInfo'), (71, '\t                    </td>'), (72, '\t                </tr>'), (73, '                #end'), (74, '            </table>'), (75, '        </td>'), (76, '    </tr>'), (77, ''), (78, '</table>'), (79, '</p>'), (80, '</body>'), (81, '</html>')], 'deleted': []}"
456,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/templates/appAudit.vm,appAudit.vm,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud审核邮件</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td style=""width:5px;""></td>'), (15, '        <td style=""color:#3f3f3f; font-weight: bold;font-size:12px; font-family: \'宋体\'; padding: 5px 0 15px 0"">'), (16, '            $appAudit.userName，您好，欢迎使用CacheCloud平台，您的申请处理进度如下：'), (17, '        </td>'), (18, '    </tr>'), (19, '    <tr>'), (20, '        <td></td>'), (21, '        <td style=""padding-top:20px; padding-left:27px;"">'), (22, '            <ul>'), (23, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">申请处理信息：</span></li>'), (24, '            </ul>'), (25, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (26, '                <tr>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (28, '                        申请类型：'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                        ##1:申请应用,2:应用扩容,3:修改配置'), (32, '                        $appAudit.typeDesc'), (33, '                    </td>'), (34, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (35, '                        申请描述：'), (36, '                    </td>'), (37, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (38, '                        $!appAudit.info'), (39, '                    </td>'), (40, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (41, '                        申请时间：'), (42, '                    </td>'), (43, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (44, '                        $!appAudit.createTimeFormat'), (45, '                    </td>'), (46, ''), (47, '                </tr>'), (48, '##                <tr>'), (49, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (50, '##                        预留参数1：'), (51, '##                    </td>'), (52, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (53, '##                        $!appAudit.param1'), (54, '##                    </td>'), (55, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (56, '##                        预留参数2：'), (57, '##                    </td>'), (58, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (59, '##                        $!appAudit.param2'), (60, '##                    </td>'), (61, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (62, '##                        预留参数3：'), (63, '##                    </td>'), (64, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (65, '##                        $!appAudit.param3'), (66, '##                    </td>'), (67, '##                </tr>'), (68, '                <tr>'), (69, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (70, '                        处理状态：'), (71, '                    </td>'), (72, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (73, '                        $!appAudit.statusDesc'), (74, '                    </td>'), (75, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (76, '                        处理描述：'), (77, '                    </td>'), (78, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (79, '                        $!appAudit.refuseReason'), (80, '                    </td>'), (81, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (82, '                        处理时间：'), (83, '                    </td>'), (84, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (85, '                        $!appAudit.modifyTimeFormat'), (86, '                    </td>'), (87, '                </tr>'), (88, '            </table>'), (89, '            <br/>'), (90, '            <ul>'), (91, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用详细信息：</span></li>'), (92, '            </ul>'), (93, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (94, '                <tr>'), (95, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (96, '                        应用名称：'), (97, '                    </td>'), (98, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (99, '                        $!appDesc.name'), (100, '                    </td>'), (101, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (102, '                        应用类型：'), (103, '                    </td>'), (104, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (105, '                        $!appDesc.typeDesc'), (106, '                    </td>'), (107, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (108, '                        应用状态：'), (109, '                    </td>'), (110, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (111, '                        $!appDesc.statusDesc'), (112, '                    </td>'), (113, '                </tr>'), (114, '                <tr>'), (115, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (116, '                        是否测试：'), (117, '                    </td>'), (118, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (119, '                        #if($appDesc.isTest == 1)'), (120, '                            是'), (121, '                        #else'), (122, '                            否'), (123, '                        #end'), (124, '                    </td>'), (125, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (126, '                        是否持久化：'), (127, '                    </td>'), (128, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (129, '                        #if($appDesc.needPersistence == 1)'), (130, '                            是'), (131, '                        #else'), (132, '                            否'), (133, '                        #end'), (134, '                    </td>'), (135, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (136, '                        是否有后端数据源：'), (137, '                    </td>'), (138, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (139, '                        #if($appDesc.hasBackStore == 1)'), (140, '                            是'), (141, '                        #else'), (142, '                            否'), (143, '                        #end'), (144, '                    </td>'), (145, '                </tr>'), (146, '                <tr>'), (147, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (148, '                        应用描述：'), (149, '                    </td>'), (150, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (151, '                        $!appDesc.intro'), (152, '                    </td>'), (153, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (154, '                        应用负责人：'), (155, '                    </td>'), (156, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (157, '                        $!appDesc.officer'), (158, '                    </td>'), (159, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (160, '                        应用申请时间：'), (161, '                    </td>'), (162, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (163, '                        $!appDesc.createTimeFormat'), (164, '                    </td>'), (165, '                </tr>'), (166, '            </table>'), (167, '        </td>'), (168, '    </tr>'), (169, ''), (170, '</table>'), (171, '</p>'), (172, '</body>'), (173, '</html>')], 'deleted': []}"
457,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/templates/appDaily.vm,appDaily.vm,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud应用日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用详细信息：$!appDesc.appId</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (22, '                        应用名称：'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (25, '                        $!appDesc.name'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (28, '                        应用类型：'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                        $!appDesc.typeDesc'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (34, '                        应用状态：'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                        $!appDesc.statusDesc'), (38, '                    </td>'), (39, '                </tr>'), (40, '                <tr>'), (41, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (42, '                        应用描述：'), (43, '                    </td>'), (44, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (45, '                        $!appDesc.intro'), (46, '                    </td>'), (47, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (48, '                        应用负责人：'), (49, '                    </td>'), (50, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (51, '                        $!appDesc.officer'), (52, '                    </td>'), (53, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (54, '                        应用申请时间：'), (55, '                    </td>'), (56, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (57, '                        $!appDesc.createTime'), (58, '                    </td>'), (59, '                </tr>'), (60, '            </table>'), (61, ''), (62, '            <ul>'), (63, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">客户端相关(确保使用有客户端统计的版本):</span></li>'), (64, '            </ul>'), (65, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (66, '                <tr>'), (67, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (68, '                        客户端值分布(全天):'), (69, '                    </td>'), (70, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (71, '\t\t\t\t\t\t$!appDailyData.valueSizeDistributeCountDesc'), (72, '                    </td>'), (73, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (74, '                        客户端连接数(每分钟)：'), (75, '                    </td>'), (76, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (77, '                        最大值:$!appDailyData.maxMinuteClientCount <br/>'), (78, '                        平均值:$!appDailyData.avgMinuteClientCount'), (79, '                    </td>'), (80, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (81, '                        客户端延迟事件数(全天)：'), (82, '                    </td>'), (83, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (84, '                        $!appDailyData.latencyCount'), (85, '                    </td>'), (86, '                </tr>'), (87, '                <tr>'), (88, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (89, '                        命令调用统计(全天):'), (90, '                    </td>'), (91, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (92, '                        次数:$!appDailyData.clientCmdCount<br/>'), (93, '                        平均耗时(ms):$!appDailyData.clientAvgCmdCost'), (94, '                    </td>'), (95, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (96, '                        连接异常统计(全天)：'), (97, '                    </td>'), (98, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (99, '                        次数:$!appDailyData.clientConnExpCount<br/>'), (100, '                        平均耗时(ms):$!appDailyData.clientAvgConnExpCost'), (101, '                    </td>'), (102, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (103, '                        命令超时统计(全天)：'), (104, '                    </td>'), (105, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (106, '                        次数:$!appDailyData.clientCmdExpCount <br/>'), (107, '                        平均耗时(ms):$!appDailyData.clientAvgCmdExpCost'), (108, '                    </td>'), (109, '                </tr>'), (110, '            </table>'), (111, '            <br/>'), (112, ''), (113, '            <ul>'), (114, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">服务端相关:</span></li>'), (115, '            </ul>'), (116, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (117, '                <tr>'), (118, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (119, '                        慢查询个数(全天)：'), (120, '                    </td>'), (121, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (122, '                        $!appDailyData.slowLogCount'), (123, '                    </td>'), (124, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (125, '                        命令次数(每分钟)：'), (126, '                    </td>'), (127, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (128, '                       \t 最大值:$!appDailyData.maxMinuteCommandCount <br/>'), (129, '                       \t 平均值:$!appDailyData.avgMinuteCommandCount'), (130, '                    </td>'), (131, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (132, '                        命中率(每分钟)：'), (133, '                    </td>'), (134, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (135, '                       \t 最大值:$!appDailyData.maxMinuteHitRatio% <br/>'), (136, '                       \t 最小值:$!appDailyData.minMinuteHitRatio% <br/>'), (137, '                       \t 平均值:$!appDailyData.avgHitRatio%'), (138, '                    </td>'), (139, '                </tr>'), (140, ''), (141, '                <tr>'), (142, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (143, '                        内存使用量(全天)：'), (144, '                    </td>'), (145, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (146, '                        平均使用量:$!appDailyData.avgUsedMemory M<br/>'), (147, '                        最大使用量:$!appDailyData.maxUsedMemory M'), (148, '                    </td>'), (149, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (150, '                        过期键数(全天)：'), (151, '                    </td>'), (152, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (153, '                       \t $!appDailyData.expiredKeysCount'), (154, '                    </td>'), (155, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (156, '                        剔除键数(全天)：'), (157, '                    </td>'), (158, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (159, '                       \t $!appDailyData.evictedKeysCount'), (160, '                    </td>'), (161, '                </tr>'), (162, ''), (163, '                <tr>'), (164, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (165, '                       键个数(全天)：'), (166, '                    </td>'), (167, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (168, '                        平均值:$!appDailyData.avgObjectSize<br/>'), (169, '                        最大值:$!appDailyData.maxObjectSize'), (170, '                    </td>'), (171, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (172, '         input流量(每分钟)：'), (173, '                    </td>'), (174, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (175, '                       \t 平均值:$!appDailyData.avgMinuteNetInputByte M<br/>'), (176, '                       \t 最大值:$!appDailyData.maxMinuteNetInputByte M<br/>'), (177, '                    </td>'), (178, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (179, '        output流量(每分钟)：'), (180, '                    </td>'), (181, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (182, '                       \t 平均:$!appDailyData.avgMinuteNetOutputByte M<br/>'), (183, '                       \t 最大:$!appDailyData.maxMinuteNetOutputByte M<br/>'), (184, '                    </td>'), (185, '                </tr>'), (186, '            </table>'), (187, '            <br/>'), (188, ''), (189, '        </td>'), (190, '    </tr>'), (191, ''), (192, '</table>'), (193, '</p>'), (194, '</body>'), (195, '</html>')], 'deleted': []}"
458,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/templates/expAppsDaily.vm,expAppsDaily.vm,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>应用日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, ''), (10, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (11, '    <colgroup>'), (12, '        <col style=""width: 5px;"">'), (13, '    </colgroup>'), (14, ''), (15, '    <tr>'), (16, '        <td>'), (17, '        </td>'), (18, '        <td style=""padding-top:20px; padding-left:27px;"">'), (19, '            <ul>'), (20, '                <li>'), (21, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (22, '                        应用异常情况'), (23, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list?tabId=0&searchDate=$!searchDate"">【查看更多--后台】</a>'), (24, '                    </span>'), (25, '                </li>'), (26, '            </ul>'), (27, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (28, '                <tr>'), (29, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (30, '                        应用id'), (31, '                    </td>'), (32, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (33, '                        应用名'), (34, '                    </td>'), (35, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (36, '                        应用负责人'), (37, '                    </td>'), (38, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (39, '                        异常总量(全天)'), (40, '                    </td>'), (41, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (42, '                        连接异常(全天)'), (43, '                    </td>'), (44, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (45, '                        命令超时(全天)'), (46, '                    </td>'), (47, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (48, '                        延迟事件(全天)'), (49, '                    </td>'), (50, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (51, '                        慢查询(全天)'), (52, '                    </td>'), (53, '                </tr>'), (54, '                #foreach($!item in $!appClientGatherStatGroup.get(""expAppStats""))'), (55, '                    <tr>'), (56, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (57, '                            <a target=""_blank""'), (58, '                               href=""/admin/app/index?appId=$!item.get(""app_id"")"">'), (59, '                                $!item.get(""app_id"")'), (60, '                            </a>'), (61, '                        </td>'), (62, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (63, '                            $!appDescMap.get($!item.get(""app_id"")).name'), (64, '                        </td>'), (65, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (66, '                            $!appDescMap.get($!item.get(""app_id"")).officer'), (67, '                        </td>'), (68, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (69, '                            <a target=""_blank""'), (70, '                               href=""${ccDomain}/client/show/index?searchDate=$!searchDate&appId=$!item.get('), (71, '                                   ""app_id"")&tabTag=app_client_exception_statistics"">'), (72, '                                $!item.get(""exp_count"")'), (73, '                            </a>'), (74, '                        </td>'), (75, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (76, '                            <a target=""_blank""'), (77, '                               href=""${ccDomain}/client/show/exceptionStatistics/client?searchDate=$!searchDate&appId=$!item.get('), (78, '                                   ""app_id"")&exceptionType=0"">'), (79, '                                次数:$!item.get(""conn_exp_count"")'), (80, '                            </a>'), (81, '                            <br/>'), (82, '                            平均耗时(ms):$!item.get(""avg_conn_exp_cost"")'), (83, '                        </td>'), (84, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (85, '                            <a target=""_blank""'), (86, '                               href=""${ccDomain}/client/show/exceptionStatistics/client?searchDate=$!searchDate&appId=$!item.get('), (87, '                                   ""app_id"")&exceptionType=1"">'), (88, '                                次数:$!item.get(""cmd_exp_count"")'), (89, '                            </a>'), (90, '                            <br/>'), (91, '                            平均耗时(ms):$!item.get(""avg_cmd_exp_cost"")'), (92, '                        </td>'), (93, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (94, '                            <a target=""_blank""'), (95, '                               href=""${ccDomain}/admin/app/index?searchDate=$!searchDate&appId=$!item.get('), (96, '                                   ""app_id"")&tabTag=app_latency"">'), (97, '                                $!item.get(""latency_count"")'), (98, '                            </a>'), (99, '                        </td>'), (100, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (101, '                            <a target=""_blank""'), (102, '                               href=""${ccDomain}/admin/app/index?searchDate=$!searchDate&appId=$!item.get('), (103, '                                   ""app_id"")&tabTag=app_latency"">'), (104, '                                $!item.get(""slow_log_count"")'), (105, '                            </a>'), (106, '                        </td>'), (107, '                    </tr>'), (108, '                #end'), (109, '            </table>'), (110, ''), (111, ''), (112, '            <ul>'), (113, '                <li>'), (114, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (115, '                    应用延迟事件（top 10）'), (116, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list?tabId=0&searchDate=$!searchDate"">【查看更多--后台】</a>'), (117, '                    </span>'), (118, '                </li>'), (119, '            </ul>'), (120, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (121, '                <tr>'), (122, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (123, '                        应用id'), (124, '                    </td>'), (125, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (126, '                        应用名'), (127, '                    </td>'), (128, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (129, '                        应用负责人'), (130, '                    </td>'), (131, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (132, '                        延迟事件(全天)'), (133, '                    </td>'), (134, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (135, '                        慢查询(全天)'), (136, '                    </td>'), (137, '                </tr>'), (138, '                #foreach($!item in $!appClientGatherStatGroup.get(""latencyAppStats""))'), (139, '                    <tr>'), (140, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (141, '                            <a target=""_blank""'), (142, '                               href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")"">'), (143, '                                $!item.get(""app_id"")'), (144, '                            </a>'), (145, '                        </td>'), (146, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (147, '                            $!appDescMap.get($!item.get(""app_id"")).name'), (148, '                        </td>'), (149, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (150, '                            $!appDescMap.get($!item.get(""app_id"")).officer'), (151, '                        </td>'), (152, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (153, '                            <a target=""_blank""'), (154, '                               href=""${ccDomain}/admin/app/index?searchDate=$!searchDate&appId=$!item.get('), (155, '                                   ""app_id"")&tabTag=app_latency"">'), (156, '                                $!item.get(""latency_count"")'), (157, '                            </a>'), (158, '                        </td>'), (159, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (160, '                            <a target=""_blank""'), (161, '                               href=""${ccDomain}/admin/app/index?searchDate=$!searchDate&appId=$!item.get('), (162, '                                   ""app_id"")&tabTag=app_latency"">'), (163, '                                $!item.get(""slow_log_count"")'), (164, '                            </a>'), (165, '                        </td>'), (166, '                    </tr>'), (167, '                #end'), (168, '            </table>'), (169, ''), (170, ''), (171, '            <ul>'), (172, '                <li>'), (173, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (174, '                    应用拓扑诊断'), (175, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list/server?tabId=3&searchDate=$!searchDate"">【查看更多--后台】</a>'), (176, '                    </span>'), (177, '                </li>'), (178, '            </ul>'), (179, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (180, '                <tr>'), (181, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (182, '                        应用id'), (183, '                    </td>'), (184, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (185, '                        应用名'), (186, '                    </td>'), (187, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (188, '                        应用负责人'), (189, '                    </td>'), (190, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (191, '                        redis类型'), (192, '                    </td>'), (193, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (194, '                        redis版本'), (195, '                    </td>'), (196, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (197, '                        拓扑诊断结果'), (198, '                    </td>'), (199, '                </tr>'), (200, '                #foreach($!item in $!appClientGatherStatGroup.get(""topologyAppStats""))'), (201, '                    <tr>'), (202, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (203, '                            <a target=""_blank""'), (204, '                               href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")"">'), (205, '                                $!item.get(""app_id"")'), (206, '                            </a>'), (207, '                        </td>'), (208, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (209, '                            $!appDescMap.get($!item.get(""app_id"")).name'), (210, '                        </td>'), (211, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (212, '                            $!appDescMap.get($!item.get(""app_id"")).officer'), (213, '                        </td>'), (214, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (215, '                            $!appDescMap.get($!item.get(""app_id"")).typeDesc'), (216, '                        </td>'), (217, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (218, '                            $!appDescMap.get($!item.get(""app_id"")).versionName'), (219, '                        </td>'), (220, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (221, '                            <span style=""color:red"">异常</span>'), (222, '                            [<a target=""_blank"" href=""${ccDomain}/manage/app/index.do?appId=$!item.get(""app_id"")&tabTag=app_ops_tool"">查看诊断</a>]'), (223, '                        </td>'), (224, '                    </tr>'), (225, '                #end'), (226, '            </table>'), (227, ''), (228, ''), (229, '            <ul>'), (230, '                <li>'), (231, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (232, '                        应用内存使用情况（bottom 10）'), (233, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list/server?tabId=1&searchDate=$!searchDate"">【查看更多--后台】</a>'), (234, '                </span>'), (235, '                </li>'), (236, '            </ul>'), (237, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (238, '                <tr>'), (239, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (240, '                        应用id'), (241, '                    </td>'), (242, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (243, '                        应用名'), (244, '                    </td>'), (245, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (246, '                        应用负责人'), (247, '                    </td>'), (248, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (249, '                        redis类型'), (250, '                    </td>'), (251, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (252, '                        内存'), (253, '                    </td>'), (254, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (255, '                        使用内存'), (256, '                    </td>'), (257, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (258, '                        内存使用率'), (259, '                    </td>'), (260, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (261, '                        应用客户端连接'), (262, '                    </td>'), (263, '                </tr>'), (264, '                #foreach($!item in $!appClientGatherStatGroup.get(""memAlterAppStats""))'), (265, '                        <tr>'), (266, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (267, '                                <a target=""_blank""'), (268, '                                   href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")"">'), (269, '                                    $!item.get(""app_id"")'), (270, '                                </a>'), (271, '                            </td>'), (272, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (273, '                                $!appDescMap.get($!item.get(""app_id"")).name'), (274, '                            </td>'), (275, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (276, '                                $!appDescMap.get($!item.get(""app_id"")).officer'), (277, '                            </td>'), (278, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (279, '                                $!appDescMap.get($!item.get(""app_id"")).typeDesc'), (280, '                            </td>'), (281, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (282, '                                $!item.get(""format_mem"") G'), (283, '                            </td>'), (284, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (285, '                                $!item.get(""format_used_memory"") G'), (286, '                            </td>'), (287, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (288, '                                $!item.get(""mem_used_ratio"") %'), (289, '                            </td>'), (290, '                            <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (291, '                                <a href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")&tabTag=app_clientList""'), (292, '                                   target=""_blank"">'), (293, '                                    $!item.get(""connected_clients"")'), (294, '                                </a>'), (295, '                            </td>'), (296, '                        </tr>'), (297, '                #end'), (298, '            </table>'), (299, ''), (300, ''), (301, '            <ul>'), (302, '                <li>'), (303, '                    <span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">'), (304, '                        应用碎片率情况（top 10）'), (305, '                        <a target=""_blank"" href=""${ccDomain}/manage/app/stat/list/server?tabId=2&searchDate=$!searchDate"">【查看更多--后台】</a>'), (306, '                </span>'), (307, '                </li>'), (308, '            </ul>'), (309, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (310, '                <tr>'), (311, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (312, '                        应用id'), (313, '                    </td>'), (314, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (315, '                        应用名'), (316, '                    </td>'), (317, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 150px;/"">'), (318, '                        应用负责人'), (319, '                    </td>'), (320, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (321, '                        redis版本'), (322, '                    </td>'), (323, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (324, '                        内存使用'), (325, '                    </td>'), (326, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (327, '                        rss内存使用'), (328, '                    </td>'), (329, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (330, '                        平均碎片率'), (331, '                    </td>'), (332, '                </tr>'), (333, '                #foreach($!item in $!appClientGatherStatGroup.get(""fragRatioAppStats""))'), (334, '                    <tr>'), (335, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (336, '                            <a target=""_blank""'), (337, '                               href=""${ccDomain}/admin/app/index?appId=$!item.get(""app_id"")"">'), (338, '                                $!item.get(""app_id"")'), (339, '                            </a>'), (340, '                        </td>'), (341, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (342, '                            $!appDescMap.get($!item.get(""app_id"")).name'), (343, '                        </td>'), (344, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (345, '                            $!appDescMap.get($!item.get(""app_id"")).officer'), (346, '                        </td>'), (347, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (348, '                            $!appDescMap.get($!item.get(""app_id"")).versionName'), (349, '                        </td>'), (350, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (351, '                            $!item.get(""format_used_memory"") G'), (352, '                        </td>'), (353, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (354, '                            $!item.get(""format_used_memory_rss"") G'), (355, '                        </td>'), (356, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (357, '                            $!item.get(""avg_mem_frag_ratio"")'), (358, '                        </td>'), (359, '                    </tr>'), (360, '                #end'), (361, '            </table>'), (362, ''), (363, '        </td>'), (364, '    </tr>'), (365, ''), (366, '</table>'), (367, '</p>'), (368, '</body>'), (369, '</html>')], 'deleted': []}"
459,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/templates/instanceAlert.vm,instanceAlert.vm,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Redis实例分钟报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例分钟报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        \t负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        \tip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                    \t\tport'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                    \t\t属性值'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                    \t\t说明'), (41, '                    </td>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (43, '                    \t\t其他信息'), (44, '                    </td>'), (45, '                </tr>'), (46, '                #foreach($!item in $!instanceAlertValueResultList)'), (47, '                \t<tr>'), (48, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.appId'>${item.appId}</a>""), (50, '\t                    </td>'), (51, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (52, '\t                        \t$!item.appDesc.name'), (53, '\t                    </td>'), (54, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (55, '\t                        \t$!item.appDesc.officer'), (56, '\t                    </td>'), (57, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (58, '\t                        \t$!item.instanceInfo.ip'), (59, '\t                    </td>'), (60, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (61, '\t                    \t\t$!item.instanceInfo.port'), (62, '\t                    </td>'), (63, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (64, '\t                    \t\t$!item.instanceAlertConfig.alertConfig'), (65, '\t                    </td>'), (66, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (67, '\t                    \t\t$!item.alertMessage'), (68, '\t                    </td>'), (69, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (70, '\t                    \t\t$!item.otherInfo'), (71, '\t                    </td>'), (72, '\t                </tr>'), (73, '                #end'), (74, '            </table>'), (75, '        </td>'), (76, '    </tr>'), (77, ''), (78, '</table>'), (79, '</p>'), (80, '</body>'), (81, '</html>')], 'deleted': []}"
460,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/templates/instanceRecover.vm,instanceRecover.vm,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Pod:$!item.ip Pod重启探测Redis实例</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例自动拉起列表：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t容器ip'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                    \t\tport'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                    \t\t说明'), (32, '                    </td>'), (33, '                </tr>'), (34, '                #foreach($!item in $!instanceAlertValueResultList)'), (35, '                \t<tr>'), (36, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (37, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.instanceInfo.appId'>$!item.instanceInfo.appId</a>""), (38, '\t                    </td>'), (39, '\t\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (40, '\t                        \t$!item.instanceInfo.ip'), (41, '\t                    </td>'), (42, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (43, '\t                    \t\t$!item.instanceInfo.port'), (44, '\t                    </td>'), (45, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (46, '\t                    \t\t实例恢复时间：$!item.otherInfo'), (47, '\t                    </td>'), (48, '\t                </tr>'), (49, '                #end'), (50, '            </table>'), (51, '        </td>'), (52, '    </tr>'), (53, ''), (54, '</table>'), (55, '</p>'), (56, '</body>'), (57, '</html>')], 'deleted': []}"
461,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/templates/instanceState.vm,instanceState.vm,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Redis实例状态监控报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例状态监控报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        \t负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        \tip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                    \t\tport'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                    \t\t状态'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                    \t\t说明'), (41, '                    </td>'), (42, '                </tr>'), (43, '                #foreach($!item in $!instanceAlertValueResultList)'), (44, '                \t<tr>'), (45, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (46, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.appId'>${item.appId}</a>""), (47, '\t                    </td>'), (48, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, '\t                        \t$!item.appDesc.name'), (50, '\t                    </td>'), (51, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (52, '\t                        \t$!item.appDesc.officer'), (53, '\t                    </td>'), (54, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (55, '\t                        \t$!item.instanceInfo.ip'), (56, '\t                    </td>'), (57, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (58, '\t                    \t\t$!item.instanceInfo.port'), (59, '\t                    </td>'), (60, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (61, '\t                    \t\t$!item.instanceInfo.status'), (62, '\t                    </td>'), (63, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (64, '\t                    \t\t$!item.otherInfo'), (65, '\t                    </td>'), (66, '\t                </tr>'), (67, '                #end'), (68, '            </table>'), (69, '        </td>'), (70, '    </tr>'), (71, ''), (72, '</table>'), (73, '</p>'), (74, '</body>'), (75, '</html>')], 'deleted': []}"
462,83c9d4ffe19f72723ea782b76930c0680aa64aff,cachecloud-web/src/main/resources/templates/topologyExam.vm,topologyExam.vm,1,"{'added': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>应用拓扑检查日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">online应用拓扑检查情况：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        appId'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        应用类型'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        问题'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        描述'), (32, '                    </td>'), (33, '                </tr>'), (34, '                #foreach($!item in $!examResult)'), (35, '                    <tr>'), (36, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (37, '                            $!item.get(""appId"")'), (38, '                        </td>'), (39, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (40, '                            $!item.get(""type"")'), (41, '                        </td>'), (42, '                        <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (43, '                            $!item.get(""status"")'), (44, '                        </td>'), (45, '                        <td align=""left"" style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 100px;"">'), (46, '                            #foreach( $str in $!item.get(""desc"").split(""\\n"") )'), (47, '                             $!str'), (48, '                             <br/>'), (49, '                            #end'), (50, '                        </td>'), (51, '                    </tr>'), (52, '                #end'), (53, '            </table>'), (54, ''), (55, '        </td>'), (56, '    </tr>'), (57, ''), (58, '</table>'), (59, '</p>'), (60, '</body>'), (61, '</html>')], 'deleted': []}"
463,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-client/cachecloud-jedis/src/test/resources/MySimpson.png,MySimpson.png,4,"{'added': [], 'deleted': []}"
464,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-client/cachecloud-open-client-basic/src/main/resources/cacheCloudClient.properties,cacheCloudClient.properties,4,"{'added': [], 'deleted': [(1, 'http_conn_timeout = 3000'), (2, 'http_socket_timeout = 5000'), (3, 'client_version = 1.0-SNAPSHOT'), (4, 'domain_url = http://127.0.0.1:9999'), (5, 'redis_cluster_suffix = /cache/client/redis/cluster/%s.json?clientVersion='), (6, 'redis_sentinel_suffix = /cache/client/redis/sentinel/%s.json?clientVersion='), (7, 'redis_standalone_suffix = /cache/client/redis/standalone/%s.json?clientVersion='), (8, 'cachecloud_report_url = /cachecloud/client/reportData.json')]}"
465,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-client/cachecloud-open-jedis-stat/src/test/resources/logback-test.xml,logback-test.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<!--'), (3, '  Example LOGBACK Configuration File'), (4, '  http://logback.qos.ch/manual/configuration.html'), (5, '  -->'), (6, '<!-- 30秒扫描一次 -->'), (7, '<configuration scan=""true"" scanPeriod=""30 seconds"">'), (8, ''), (9, '    <appender name=""STDOUT"" class=""ch.qos.logback.core.ConsoleAppender"">'), (10, '        <encoder>'), (11, '            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>'), (12, '        </encoder>'), (13, '    </appender>'), (14, ''), (15, '    <root level=""DEBUG"">'), (16, '        <appender-ref ref=""STDOUT""/>'), (17, '    </root>'), (18, '</configuration>')]}"
466,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/application.properties,application.properties,4,"{'added': [], 'deleted': [(1, '# sys config'), (2, 'isDebug = ${isDebug}'), (3, 'application.message=CacheCloud'), (4, ''), (5, 'server.port=${web.port}'), (6, 'server.sessionTimeout= 3600'), (7, 'server.contextPath='), (8, ''), (9, '# tomcat config'), (10, 'server.tomcat.compression=2048 # is compression enabled (off, on, or an integer content length limit)'), (11, 'server.tomcat.compressable-mime-types=text/html,text/xml,text/plain,text/javascript,application/json,application/xml'), (12, 'tomcat.accessLogEnabled= false'), (13, 'tomcat.protocolHeader=x-forwarded-proto'), (14, 'tomcat.remoteIpHeader=x-forwarded-for'), (15, 'tomcat.basedir='), (16, 'tomcat.backgroundProcessorDelay=30 # secs'), (17, 'server.tomcat.max-threads = 500'), (18, 'server.tomcat.uri-encoding = UTF-8'), (19, ''), (20, 'cachecloud.db.url = ${cachecloud.db.url}'), (21, 'cachecloud.db.user = ${cachecloud.db.user}'), (22, 'cachecloud.db.password = ${cachecloud.db.password}'), (23, 'cachecloud.maxPoolSize = ${cachecloud.maxPoolSize}'), (24, 'jdbc.driver = com.mysql.jdbc.Driver'), (25, 'jdbc.validationQuery = select 1 from dual'), (26, ''), (27, 'spring.http.encoding.charset=UTF-8'), (28, 'spring.http.encoding.enabled=true'), (29, 'spring.http.encoding.force=true'), (30, ''), (31, '#classpath中存在velocity 忽略spring-boot的VelocityAutoConfiguration'), (32, 'spring.velocity.enabled=false'), (33, 'spring.velocity.checkTemplateLocation=true'), (34, ''), (35, '# maven配置'), (36, 'project.name=${project.build.finalName}'), (37, 'project.package=${project.packaging}'), (38, ''), (39, '# endpoints 配置'), (40, 'endpoints.enabled=true'), (41, 'endpoints.shutdown.id=shutdown'), (42, 'endpoints.shutdown.sensitive=true'), (43, 'endpoints.shutdown.enabled=false'), (44, 'endpoints.trace.id=trace'), (45, 'endpoints.trace.sensitive=true'), (46, 'endpoints.trace.enabled=false'), (47, ''), (48, '# RemoteShell'), (49, '# Authentication type. Auto-detected according to the environment.'), (50, 'shell.auth=simple'), (51, '# JAAS domain.'), (52, 'shell.auth.jaas.domain=my-domain'), (53, '# Path to the authentication key. This should point to a valid "".pem"" file.'), (54, 'shell.auth.key.path='), (55, 'shell.auth.simple.user.name=cachecloud'), (56, 'shell.auth.simple.user.password='), (57, '# Comma-separated list of required roles to login to the CRaSH console.'), (58, 'shell.auth.spring.roles=ADMIN'), (59, '# Patterns to use to look for commands.'), (60, 'shell.command-path-patterns=classpath*:/commands/**,classpath*:/crash/commands/**'), (61, '# Scan for changes and update the command if necessary (in seconds).'), (62, 'shell.command-refresh-interval=-1'), (63, '# Patterns to use to look for configurations.'), (64, 'shell.config-path-patterns=classpath*:/crash/*'), (65, '# Comma-separated list of commands to disable.'), (66, 'shell.disabled-commands=jpa*,jdbc*,jndi*'), (67, 'shell.ssh.enabled=true'), (68, 'shell.ssh.idle-timeout = 300000'), (69, 'shell.ssh.port=2000'), (70, 'shell.telnet.enabled=false'), (71, 'shell.telnet.port=5000')]}"
467,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/cachecloud-web.conf,cachecloud-web.conf,4,"{'added': [], 'deleted': [(1, 'PID_FOLDER=/data/cachecloud-web'), (2, 'LOG_FOLDER=/data/cachecloud-web/logs'), (3, 'LOG_FILENAME=cachecloud-web.log'), (4, 'APP_NAME=cachecloud-web'), (5, 'RUN_ARGS='), (6, 'JAVA_HOME=/usr/local/jdk'), (7, 'JAVA_OPTS=""-server -Xmx4g -Xms4g -Xss256k -XX:MaxDirectMemorySize=1G -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:G1ReservePercent=25 -XX:InitiatingHeapOccupancyPercent=40 -XX:+PrintGCDateStamps -Xloggc:/opt/cachecloud-web/logs/gc.log -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=10 -XX:GCLogFileSize=100M -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/opt/cachecloud-web/logs/java.hprof -XX:+DisableExplicitGC -XX:-OmitStackTraceInFastThrow -XX:+PrintCommandLineFlags -XX:+UnlockCommercialFeatures -XX:+FlightRecorder -Djava.awt.headless=true -Djava.net.preferIPv4Stack=true -Djava.util.Arrays.useLegacyMergeSort=true -Dfile.encoding=UTF-8 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=22099 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false""')]}"
468,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/logback.xml,logback.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<!--'), (3, '  Example LOGBACK Configuration File'), (4, '  http://logback.qos.ch/manual/configuration.html'), (5, '  -->'), (6, '<configuration  scan=""true"" scanPeriod=""30 seconds"">'), (7, '    <property name=""log_base"" value=""${log_base}""/>'), (8, ''), (9, '    <appender name=""console"" class=""ch.qos.logback.core.ConsoleAppender"">'), (10, '        <encoder class=""ch.qos.logback.classic.encoder.PatternLayoutEncoder"">'), (11, '            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} {%thread} %-5level %logger{50} - %msg%n</pattern>'), (12, '        </encoder>'), (13, '    </appender>'), (14, ''), (15, '    <appender name=""stdout"" class=""ch.qos.logback.core.rolling.RollingFileAppender"">'), (16, '        <file>${log_base}/stdout.log</file>'), (17, '        <encoder class=""ch.qos.logback.classic.encoder.PatternLayoutEncoder"">'), (18, '            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} {%thread} %-5level %logger{50} - %msg%n</pattern>'), (19, '        </encoder>'), (20, ''), (21, '        <filter class=""ch.qos.logback.classic.filter.ThresholdFilter"">'), (22, '            <level>${log.level}</level>'), (23, '        </filter>'), (24, ''), (25, '        <rollingPolicy class=""ch.qos.logback.core.rolling.TimeBasedRollingPolicy"">'), (26, '            <FileNamePattern>${log_base}/otherdays/stdout.%d{yyyy-MM-dd}.log</FileNamePattern>'), (27, '            <MaxHistory>30</MaxHistory>'), (28, '        </rollingPolicy>'), (29, '    </appender>'), (30, ''), (31, '    <appender name=""stderr"" class=""ch.qos.logback.core.rolling.RollingFileAppender"">'), (32, '        <file>${log_base}/stderr.log</file>'), (33, '        <encoder class=""ch.qos.logback.classic.encoder.PatternLayoutEncoder"">'), (34, '            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} {%thread} %-5level %logger{50} - %msg%n</pattern>'), (35, '        </encoder>'), (36, ''), (37, '        <filter class=""ch.qos.logback.classic.filter.ThresholdFilter"">'), (38, '            <level>ERROR</level>'), (39, '        </filter>'), (40, ''), (41, '        <rollingPolicy class=""ch.qos.logback.core.rolling.TimeBasedRollingPolicy"">'), (42, '            <FileNamePattern>${log_base}/otherdays/stderr.%d{yyyy-MM-dd}.log</FileNamePattern>'), (43, '            <MaxHistory>30</MaxHistory>'), (44, '        </rollingPolicy>'), (45, '    </appender>'), (46, ''), (47, ''), (48, '    <appender name=""managerAppender"" class=""ch.qos.logback.core.rolling.RollingFileAppender"">'), (49, '        <file>${log_base}/manager/cachecloud_manager.log</file>'), (50, '        <rollingPolicy class=""ch.qos.logback.core.rolling.TimeBasedRollingPolicy"">'), (51, '            <fileNamePattern>${log_base}/manager/cachecloud_manager.log.%d{yyyyMMddHH}'), (52, '            </fileNamePattern>'), (53, '            <maxHistory>365</maxHistory>'), (54, '        </rollingPolicy>'), (55, '        <encoder>'), (56, '            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>'), (57, '        </encoder>'), (58, '    </appender>'), (59, ''), (60, '    <!--<logger name=""org.cache.dao"" level=""DEBUG"">-->'), (61, '        <!--<appender-ref ref=""console""/>-->'), (62, '    <!--</logger>-->'), (63, ''), (64, '    <root level=""${log.level}"">'), (65, '        <appender-ref ref=""console""/>'), (66, '        <appender-ref ref=""stdout""/>'), (67, '        <appender-ref ref=""stderr""/>'), (68, '    </root>'), (69, ''), (70, '    <logger name=""com.sohu.cache.web.controller.AppManageController"" level=""WARN"">'), (71, '        <appender-ref ref=""managerAppender""/>'), (72, '    </logger>'), (73, ''), (74, '    <logger name=""com.sohu.cache.web.controller.InstanceManageController"" level=""WARN"">'), (75, '        <appender-ref ref=""managerAppender""/>'), (76, '    </logger>'), (77, ''), (78, '</configuration>')]}"
469,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppAuditDao.xml,AppAuditDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppAuditDao"">'), (5, '    <sql id=""columns"">'), (6, '    \tapp_id,user_id,user_name,type,param1,param2,param3,info,status,modify_time'), (7, '    </sql>'), (8, ''), (9, '    <select id=""selectWaitAppAudits"" resultType=""com.sohu.cache.entity.AppAudit"">'), (10, '        select id,<include refid=""columns""/>,create_time'), (11, '        from app_audit'), (12, '        <where>'), (13, '            <choose>'), (14, '                <when test=""status != null"">status=#{status}</when>'), (15, '                <otherwise>status in (0,2)</otherwise>'), (16, '            </choose>'), (17, '        </where>'), (18, '        order by id desc'), (19, '    </select>'), (20, ''), (21, '    <select id=""getAppAudit"" resultType=""com.sohu.cache.entity.AppAudit"">'), (22, '        select id,<include refid=""columns""/>,create_time,refuse_reason'), (23, '        from app_audit'), (24, '        where id=#{id}'), (25, '    </select>'), (26, ''), (27, '    <insert id=""insertAppAudit"" parameterType=""com.sohu.cache.entity.AppAudit"" keyProperty=""id"" useGeneratedKeys=""true"">'), (28, '        insert into app_audit(<include refid=""columns""/>)'), (29, '        values(#{appId},#{userId},#{userName},#{type},#{param1},#{param2},#{param3},#{info},#{status},#{modifyTime})'), (30, '    </insert>'), (31, ''), (32, '    <update id=""updateAppAudit"" parameterType=""com.sohu.cache.entity.AppAudit"">'), (33, '        update app_audit'), (34, '        set'), (35, '          status = #{status},'), (36, '         modify_time = current_timestamp()'), (37, '        where id=#{id}'), (38, '    </update>'), (39, ''), (40, '    <update id=""updateRefuseReason"" parameterType=""com.sohu.cache.entity.AppAudit"">'), (41, '        update app_audit'), (42, '        set'), (43, '          refuse_reason = #{refuseReason}, modify_time = current_timestamp()'), (44, '        where id=#{id}'), (45, '    </update>'), (46, ''), (47, '    <select id=""getAppAuditByAppId"" resultType=""com.sohu.cache.entity.AppAudit"">'), (48, '        select id,<include refid=""columns""/>,create_time,refuse_reason'), (49, '        from app_audit'), (50, '        where app_id=#{appId}'), (51, '    </select>'), (52, ''), (53, '</mapper>')]}"
470,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppAuditLogDao.xml,AppAuditLogDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppAuditLogDao"">'), (6, '    <sql id=""app_audit_log_column"">'), (7, '    \tapp_id,user_id,info,create_time,type,app_audit_id'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""save"" parameterType=""AppAuditLog""  keyProperty=""id"" useGeneratedKeys=""true"" >'), (11, '    \tinsert into app_audit_log'), (12, '    \t\t(<include refid=""app_audit_log_column""/>)'), (13, '\t\tvalues'), (14, '\t\t\t(#{appId},#{userId},#{info},#{createTime},#{type},#{appAuditId})'), (15, '    </insert>'), (16, ''), (17, '    <select id=""getAuditByType"" resultType=""AppAuditLog"">'), (18, '        select id,<include refid=""app_audit_log_column""/>'), (19, '        from app_audit_log'), (20, '        where app_audit_id=#{appAuditId} and type=#{type}'), (21, '    </select>'), (22, ''), (23, '</mapper>'), (24, ''), (25, '')]}"
471,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppClientCostTimeStatDao.xml,AppClientCostTimeStatDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientCostTimeStatDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,collect_time,client_ip,report_time,create_time,command,'), (7, '\t\tmedian,mean,ninety_percent_max,ninety_nine_percent_max,hundred_max,'), (8, '\t\tcount,instance_host,instance_port,instance_id'), (9, '\t</sql>'), (10, ''), (11, '\t<insert id=""save"" parameterType=""AppClientCostTimeStat""'), (12, '\t\tkeyProperty=""id"" useGeneratedKeys=""true"">'), (13, '\t\tinsert into app_client_costtime_minute_stat(<include refid=""columns""/>)'), (14, '\t\tvalues(#{appId},#{collectTime},#{clientIp},#{reportTime},#{createTime},#{command},'), (15, '\t\t       #{median},#{mean},#{ninetyPercentMax},#{ninetyNinePercentMax},#{hundredMax},'), (16, '\t\t       #{count},#{instanceHost},#{instancePort},#{instanceId})'), (17, '\t</insert>'), (18, ''), (19, '\t<insert id=""batchSave"">'), (20, '\t\tinsert into app_client_costtime_minute_stat(<include refid=""columns"" />)'), (21, '\t\tvalues'), (22, '\t\t<foreach collection=""appClientCostTimeStatList"" item=""clientCostTime"" separator="","">'), (23, '\t\t\t(#{clientCostTime.appId},#{clientCostTime.collectTime},#{clientCostTime.clientIp},#{clientCostTime.reportTime},#{clientCostTime.createTime},#{clientCostTime.command},'), (24, '\t\t       #{clientCostTime.median},#{clientCostTime.mean},#{clientCostTime.ninetyPercentMax},#{clientCostTime.ninetyNinePercentMax},#{clientCostTime.hundredMax},'), (25, '\t\t       #{clientCostTime.count},#{clientCostTime.instanceHost},#{clientCostTime.instancePort},#{clientCostTime.instanceId})'), (26, '\t    </foreach>'), (27, '\t</insert>'), (28, ''), (29, '    <select id=""getAppCommandClientToInstanceStat"" resultType=""AppClientCostTimeStat"">'), (30, '    \tselect id,<include refid=""columns""/>'), (31, '    \tfrom app_client_costtime_minute_stat'), (32, '    \twhere app_id=#{appId} and instance_id=#{instanceId} and client_ip=#{clientIp} and collect_time between #{startTime} and #{endTime} and command=#{command};'), (33, '    </select>'), (34, ''), (35, '    <select id=""getTableMinimumId"" resultType=""long"">'), (36, '    \tselect id from app_client_costtime_minute_stat order by id limit 1'), (37, '    </select>'), (38, ''), (39, '    <select id=""getMinimumIdByCollectTime"" resultType=""long"">'), (40, '    \tselect id from app_client_costtime_minute_stat where collect_time = #{collectTime} order by id limit 1'), (41, '    </select>'), (42, ''), (43, '    <delete id=""deleteByIds"">'), (44, '    \tdelete from app_client_costtime_minute_stat where id>=#{startId} and id &lt;#{endId}'), (45, '    </delete>'), (46, ''), (47, '</mapper>')]}"
472,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppClientCostTimeTotalStatDao.xml,AppClientCostTimeTotalStatDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientCostTimeTotalStatDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,collect_time,create_time,command,mean,median,ninety_percent_max,ninety_nine_percent_max,'), (7, '\t\thundred_max,total_cost,total_count,max_instance_host,max_instance_port,max_instance_id,max_client_ip,accumulation'), (8, '\t</sql>'), (9, ''), (10, '\t<insert id=""save"" parameterType=""AppClientCostTimeTotalStat"" keyProperty=""id"" useGeneratedKeys=""true"">'), (11, '\t\t insert into app_client_costtime_minute_stat_total'), (12, '\t\t (<include refid=""columns""/>)'), (13, '        values'), (14, '          (#{appId},#{collectTime},#{createTime},#{command},${mean},#{median},'), (15, '          #{ninetyPercentMax},#{ninetyNinePercentMax},#{hundredMax},#{totalCost},#{totalCount},#{maxInstanceHost},#{maxInstancePort},#{maxInstanceId},#{maxClientIp}, 1)'), (16, '        on duplicate key update'), (17, '          total_cost = total_cost + #{totalCost},'), (18, '          total_count = total_count + #{totalCount},'), (19, '          median = if(median>#{median},median,#{median}),'), (20, '          ninety_percent_max = if(ninety_percent_max>#{ninetyPercentMax},ninety_percent_max,#{ninetyPercentMax}),'), (21, '          ninety_nine_percent_max = if(ninety_nine_percent_max>#{ninetyNinePercentMax},ninety_nine_percent_max,#{ninetyNinePercentMax}),'), (22, '          hundred_max = if(hundred_max>#{hundredMax},hundred_max,#{hundredMax}),'), (23, '          max_instance_host = if(hundred_max>#{hundredMax},max_instance_host,#{maxInstanceHost}),'), (24, '          max_instance_port = if(hundred_max>#{hundredMax},max_instance_port,#{maxInstancePort}),'), (25, '          max_instance_id =   if(hundred_max>#{hundredMax},max_instance_id,#{maxInstanceId}),'), (26, '          max_client_ip =     if(hundred_max>#{hundredMax},max_client_ip,#{maxClientIp}),'), (27, '          mean = format(total_cost/total_count,2),'), (28, '          create_time = now(),'), (29, '          accumulation = accumulation + 1;'), (30, '\t</insert>'), (31, ''), (32, '\t<insert id=""batchSave"">'), (33, '\t\tinsert into app_client_costtime_minute_stat_total(<include refid=""columns""/>)'), (34, '\t\tvalues'), (35, '\t\t<foreach collection=""appClientCostTimeTotalStatList"" item=""clientCostTime"" separator="","">'), (36, '\t\t\t (#{clientCostTime.appId},#{clientCostTime.collectTime},#{clientCostTime.createTime},#{clientCostTime.command},${clientCostTime.mean},#{clientCostTime.median},'), (37, '          #{clientCostTime.ninetyPercentMax},#{clientCostTime.ninetyNinePercentMax},#{clientCostTime.hundredMax},#{clientCostTime.totalCost},#{clientCostTime.totalCount},#{clientCostTime.maxInstanceHost},#{clientCostTime.maxInstancePort},#{clientCostTime.maxInstanceId},#{clientCostTime.maxClientIp}, 1)'), (38, '\t    </foreach>'), (39, '\t    on duplicate key update'), (40, '          total_cost = total_cost + #{clientCostTime.totalCost},'), (41, '          total_count = total_count + #{clientCostTime.totalCount},'), (42, '          median = if(median>#{clientCostTime.median},median,#{clientCostTime.median}),'), (43, '          ninety_percent_max = if(ninety_percent_max>#{clientCostTime.ninetyPercentMax},ninety_percent_max,#{clientCostTime.ninetyPercentMax}),'), (44, '          ninety_nine_percent_max = if(ninety_nine_percent_max>#{clientCostTime.ninetyNinePercentMax},ninety_nine_percent_max,#{clientCostTime.ninetyNinePercentMax}),'), (45, '          hundred_max = if(hundred_max>#{clientCostTime.hundredMax},hundred_max,#{clientCostTime.hundredMax}),'), (46, '          max_instance_host = if(hundred_max>#{clientCostTime.hundredMax},max_instance_host,#{clientCostTime.maxInstanceHost}),'), (47, '          max_instance_port = if(hundred_max>#{clientCostTime.hundredMax},max_instance_port,#{clientCostTime.maxInstancePort}),'), (48, '          max_instance_id =   if(hundred_max>#{clientCostTime.hundredMax},max_instance_id,#{clientCostTime.maxInstanceId}),'), (49, '          max_client_ip =     if(hundred_max>#{clientCostTime.hundredMax},max_client_ip,#{clientCostTime.maxClientIp}),'), (50, '          mean = format(total_cost/total_count,2),'), (51, '          create_time = now(),'), (52, '          accumulation = accumulation + 1;'), (53, '\t</insert>'), (54, ''), (55, '    <select id=""getAppDistinctCommand"" resultType=""string"">'), (56, '   \t\tselect command from app_client_costtime_minute_stat_total where app_id=#{appId} and collect_time between #{startTime} and #{endTime} group by command order by sum(total_count) desc;'), (57, '    </select>'), (58, ''), (59, '    <select id=""getAppClientCommandStat"" resultType=""AppClientCostTimeTotalStat"">'), (60, '    \tselect id,<include refid=""columns""/> from app_client_costtime_minute_stat_total'), (61, '    \twhere app_id=#{appId} and collect_time between #{startTime} and #{endTime} and command=#{command}'), (62, '    </select>'), (63, ''), (64, '</mapper>')]}"
473,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppClientExceptionStatDao.xml,AppClientExceptionStatDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientExceptionStatDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,collect_time,client_ip,report_time,create_time,exception_class,exception_count,instance_host,instance_port,instance_id,type'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""save"" parameterType=""AppClientExceptionStat""'), (10, '\t\tkeyProperty=""id"" useGeneratedKeys=""true"">'), (11, '\t\tinsert into app_client_exception_minute_stat(<include refid=""columns"" />)'), (12, '\t\tvalues(#{appId},#{collectTime},#{clientIp},#{reportTime},#{createTime},#{exceptionClass},#{exceptionCount},#{instanceHost},#{instancePort},#{instanceId},#{type})'), (13, '\t</insert>'), (14, ''), (15, '\t<insert id=""batchSave"">'), (16, '\t\tinsert into app_client_exception_minute_stat(<include refid=""columns"" />)'), (17, '\t\tvalues'), (18, '\t\t<foreach collection=""appClientExceptionStatList"" item=""clientException"" separator="","">'), (19, '\t\t\t(#{clientException.appId},#{clientException.collectTime},#{clientException.clientIp},#{clientException.reportTime},#{clientException.createTime},'), (20, '\t\t\t#{clientException.exceptionClass},#{clientException.exceptionCount},#{clientException.instanceHost},#{clientException.instancePort},#{clientException.instanceId},#{clientException.type})'), (21, '\t    </foreach>'), (22, '\t</insert>'), (23, ''), (24, '\t<select id=""getAppExceptionList"" resultType=""AppClientExceptionStat"">'), (25, '    \tselect id,<include refid=""columns"" />'), (26, '    \tfrom app_client_exception_minute_stat'), (27, '    \twhere app_id=#{appId} and collect_time between #{startTime} and #{endTime}'), (28, '    \t<choose>'), (29, '        \t<when test=""type > 0"">'), (30, '        \t \tand type=#{type}'), (31, '        \t</when>'), (32, '        </choose>'), (33, '        <choose>'), (34, '        \t<when test=""clientIp != \'\' and clientIp != null"">'), (35, '        \t \tand client_ip=#{clientIp}'), (36, '        \t</when>'), (37, '        </choose>'), (38, '        order by collect_time desc'), (39, '        <choose>'), (40, '        \t<when test=""page != null"">'), (41, '        \t\t<choose>'), (42, '\t\t        \t<when test=""page.totalCount > page.pageSize"">'), (43, '            \t\t\tlimit #{page.start},#{page.pageSize};'), (44, '\t\t        \t</when>'), (45, '\t\t        \t<otherwise>'), (46, '\t\t        \t    limit #{page.totalCount}'), (47, '\t\t        \t</otherwise>'), (48, '\t\t        </choose>'), (49, '        \t</when>'), (50, '        </choose>'), (51, '    </select>'), (52, ''), (53, '    <select id=""getAppExceptionCount"" resultType=""int"">'), (54, '    \tselect count(*)'), (55, '    \tfrom app_client_exception_minute_stat'), (56, '    \twhere app_id=#{appId} and collect_time between #{startTime} and #{endTime}'), (57, '    \t<choose>'), (58, '        \t<when test=""type > 0"">'), (59, '        \t \tand type=#{type}'), (60, '        \t</when>'), (61, '        </choose>'), (62, '        <choose>'), (63, '        \t<when test=""clientIp != \'\' and clientIp != null"">'), (64, '        \t \tand client_ip=#{clientIp}'), (65, '        \t</when>'), (66, '        </choose>'), (67, '    </select>'), (68, ''), (69, ''), (70, '    <select id=""getInstanceExceptionStat"" resultType=""ClientInstanceException"">'), (71, '    \tselect app_id,instance_id,instance_host,instance_port,count(1) as exceptionCount from app_client_exception_minute_stat'), (72, '    \t<where>'), (73, '\t    \t<choose>'), (74, '\t        \t<when test=""collectTime > 0"">'), (75, '\t        \t \tand collect_time>=#{collectTime}'), (76, '\t        \t</when>'), (77, '\t        </choose>'), (78, '\t        <choose>'), (79, '\t        \t<when test=""ip != \'\' and ip != null"">'), (80, '\t        \t \tand instance_host=#{ip}'), (81, '\t        \t</when>'), (82, '\t        </choose>'), (83, '    \t</where>'), (84, '    \tgroup by instance_id order by exceptionCount desc;'), (85, '    </select>'), (86, ''), (87, ''), (88, ''), (89, '</mapper>')]}"
474,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppClientReportDataSizeDao.xml,AppClientReportDataSizeDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientReportDataSizeDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tcollect_time,client_ip,report_time,create_time,cost_map_size,value_map_size,exception_map_size,collect_map_size'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""save"" parameterType=""AppClientDataSizeStat""'), (10, '\t\tkeyProperty=""id"" useGeneratedKeys=""true"">'), (11, '\t\tinsert into app_client_datasize_minute_stat(<include refid=""columns"" />)'), (12, '\t\tvalues(#{collectTime},#{clientIp},#{reportTime},#{createTime},#{costMapSize},'), (13, '\t\t#{valueMapSize},#{exceptionMapSize},#{collectMapSize})'), (14, '\t</insert>'), (15, ''), (16, '</mapper>')]}"
475,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppClientValueStatDao.xml,AppClientValueStatDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientValueStatDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,collect_time,update_time,command,distribute_type,count'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""batchSave"">'), (10, '\t\tinsert into app_client_value_minute_stats(<include refid=""columns"" />)'), (11, '\t\tvalues'), (12, '\t\t<foreach collection=""appClientValueDistriStatTotalList"" item=""valueDistri"" separator="","">'), (13, '        \t(#{valueDistri.appId},#{valueDistri.collectTime},#{valueDistri.updateTime},#{valueDistri.command},#{valueDistri.distributeType},#{valueDistri.count})'), (14, '\t    </foreach>'), (15, '\t    on duplicate key update'), (16, '\t    count = count + #{valueDistri.count}, update_time=now()'), (17, '\t</insert>'), (18, ''), (19, '\t<insert id=""save"">'), (20, '\t\tinsert into app_client_value_minute_stats(<include refid=""columns"" />)'), (21, '\t\tvalues(#{appId},#{collectTime},#{updateTime},#{command},#{distributeType},#{count})'), (22, '\t    on duplicate key update'), (23, '\t    count = count + #{count}, update_time=now()'), (24, '\t</insert>'), (25, ''), (26, '\t<select id=""getAppValueDistriList"" resultType=""AppClientValueDistriSimple"">'), (27, '    \tselect distribute_type, sum(count) as count'), (28, '    \tfrom app_client_value_minute_stats'), (29, '    \twhere app_id=#{appId} and collect_time between #{startTime} and #{endTime}'), (30, '        group by distribute_type order by distribute_type'), (31, '    </select>'), (32, ''), (33, '    <delete id=""deleteBeforeCollectTime"">'), (34, '    \tdelete from app_client_value_minute_stats where collect_time &lt;#{collectTime}'), (35, '    </delete>'), (36, ''), (37, ''), (38, '</mapper>')]}"
476,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppClientVersionDao.xml,AppClientVersionDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppClientVersionDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,client_ip,client_version,report_time'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""saveOrUpdateClientVersion"" parameterType=""AppClientVersion"" keyProperty=""id""'), (10, '\t\tuseGeneratedKeys=""true"">'), (11, '\t\tinsert into app_client_version_statistic(<include refid=""columns""/>)'), (12, '\t\tvalues(#{appId},#{clientIp},#{clientVersion},#{reportTime})'), (13, '\t\ton duplicate key'), (14, '\t\tupdate client_version=#{clientVersion},report_time=#{reportTime}'), (15, '\t</insert>'), (16, ''), (17, '\t<select id=""getByClientIp"" resultType=""AppClientVersion"">'), (18, '\t\tselect id,<include refid=""columns""/> from app_client_version_statistic where client_ip=#{clientIp}'), (19, '\t</select>'), (20, ''), (21, '\t<select id=""getAppAllClientVersion"" resultType=""AppClientVersion"">'), (22, '\t\tselect id,<include refid=""columns""/> from app_client_version_statistic where app_id=#{appId}'), (23, '\t</select>'), (24, ''), (25, '\t<select id=""getAll"" resultType=""AppClientVersion"">'), (26, '\t\tselect id,<include refid=""columns""/> from app_client_version_statistic where 1=1'), (27, '\t\t<choose>'), (28, '        \t<when test=""appId > 0"">'), (29, '        \t \tand app_id=#{appId}'), (30, '        \t</when>'), (31, '        </choose>'), (32, '\t</select>'), (33, ''), (34, '</mapper>')]}"
477,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppDailyDao.xml,AppDailyDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppDailyDao"">'), (6, '\t<sql id=""app_daily_column"">'), (7, '\t\tapp_id,date,create_time,slow_log_count,client_exception_count,max_minute_client_count,'), (8, '\t\tavg_minute_client_count,max_minute_command_count,avg_minute_command_count,avg_hit_ratio,'), (9, '\t\tmin_minute_hit_ratio,max_minute_hit_ratio,avg_used_memory,max_used_memory,expired_keys_count,'), (10, '\t\tevicted_keys_count,avg_minute_net_input_byte,max_minute_net_input_byte,avg_minute_net_output_byte,'), (11, '\t\tmax_minute_net_output_byte,avg_object_size,max_object_size,big_key_times,big_key_info'), (12, '    </sql>'), (13, ''), (14, '    <insert id=""save"" parameterType=""AppDailyData"" keyProperty=""id"" useGeneratedKeys=""true"">'), (15, '    \tinsert into app_daily'), (16, '    \t\t(<include refid=""app_daily_column""/>)'), (17, '\t\tvalues'), (18, '\t\t(#{appId},#{date},now(),#{slowLogCount},#{clientExceptionCount},#{maxMinuteClientCount},'), (19, '\t\t#{avgMinuteClientCount},#{maxMinuteCommandCount},#{avgMinuteCommandCount},#{avgHitRatio},'), (20, '\t\t#{minMinuteHitRatio},#{maxMinuteHitRatio},#{avgUsedMemory},#{maxUsedMemory},#{expiredKeysCount},'), (21, '\t\t#{evictedKeysCount},#{avgMinuteNetInputByte},#{maxMinuteNetInputByte},#{avgMinuteNetOutputByte}'), (22, '\t\t,#{maxMinuteNetOutputByte},#{avgObjectSize},#{maxObjectSize},#{bigKeyTimes},#{bigKeyInfo})'), (23, '    </insert>'), (24, ''), (25, '    <select id=""getAppDaily"" resultType=""AppDailyData"">'), (26, '\t\tselect id,<include refid=""app_daily_column""/> from app_daily where app_id=#{appId} and date =#{date}'), (27, '\t</select>'), (28, ''), (29, '</mapper>'), (30, ''), (31, '')]}"
478,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppDao.xml,AppDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppDao"">'), (6, '    <sql id=""app_desc_fields"">'), (7, '        app_id,name,user_id,status,intro,create_time,passed_time,type,officer,'), (8, '        ver_id,is_test,has_back_store,need_persistence,need_hot_back_up,forecase_qps,'), (9, '        forecast_obj_num,mem_alert_value,client_machine_room,app_key,client_conn_alert_value,important_level,password'), (10, '    </sql>'), (11, '    <!--通过appId查询app的信息-->'), (12, '    <select id=""getAppDescById"" resultType=""AppDesc"" parameterType=""long"">'), (13, '        SELECT'), (14, '            <include refid=""app_desc_fields""/>'), (15, '        FROM app_desc'), (16, '        WHERE app_id = #{appId};'), (17, '    </select>'), (18, ''), (19, '    <!-- 根据应用名查询app信息 -->'), (20, '    <select id=""getByAppName"" resultType=""AppDesc"" parameterType=""string"">'), (21, '        SELECT'), (22, '            <include refid=""app_desc_fields""/>'), (23, '        FROM app_desc'), (24, '        WHERE name = #{appName};'), (25, '    </select>'), (26, ''), (27, ''), (28, '    <insert id=""save"" parameterType=""AppDesc""  keyProperty=""appId"" useGeneratedKeys=""true"" >'), (29, '    \tinsert into app_desc'), (30, '    \t\t(<include refid=""app_desc_fields""/>)'), (31, '\t\tvalues'), (32, '\t\t\t(#{appId},#{name},#{userId},#{status},#{intro},#{createTime},#{passedTime},'), (33, '\t\t\t#{type},#{officer},#{verId},#{isTest},#{hasBackStore},#{needPersistence},'), (34, '\t\t\t#{needHotBackUp},#{forecaseQps},#{forecastObjNum},#{memAlertValue},#{clientMachineRoom},#{appKey},#{clientConnAlertValue},#{importantLevel},#{password})'), (35, '    </insert>'), (36, ''), (37, '    <update id=""update"" parameterType=""AppDesc"">'), (38, '    \tupdate app_desc'), (39, '    \t\tset name=#{name}, user_id=#{userId}, status=#{status}, intro=#{intro}, create_time=#{createTime},'), (40, '    \t\t\tpassed_time=#{passedTime},type=#{type},'), (41, '    \t\t\tofficer=#{officer},ver_id=#{verId},mem_alert_value=#{memAlertValue},client_conn_alert_value=#{clientConnAlertValue},important_level=#{importantLevel},password=#{password}'), (42, '    \twhere app_id=#{appId}'), (43, '    </update>'), (44, ''), (45, '    <sql id=""app_desc_select_column"">'), (46, '    \tapp_desc.app_id,name,app_desc.user_id,status,intro,create_time,passed_time,type,officer,ver_id,app_key,password'), (47, '    </sql>'), (48, '    <select id=""getAppDescList"" resultType=""AppDesc"" parameterType=""long"">'), (49, '    \tselect'), (50, '        \t<include refid=""app_desc_select_column""/>'), (51, '        from app_desc,app_to_user where app_to_user.user_id=#{userId} and app_to_user.app_id=app_desc.app_id'), (52, '    </select>'), (53, ''), (54, '    <select id=""getUserAppCount"" resultType=""int"" parameterType=""long"">'), (55, '    \tselect count(app_desc.app_id) from app_desc,app_to_user where app_to_user.user_id=#{userId} and app_to_user.app_id=app_desc.app_id'), (56, '    </select>'), (57, ''), (58, '    <select id=""getAllAppCount"" resultType=""int"" parameterType=""AppSearch"">'), (59, '    \tselect count(app_id) from app_desc where 1=1'), (60, '        <choose>'), (61, '            <when test=""appName != null and appName != \'\'"">'), (62, ""            \tand name like '${appName}%'""), (63, '       \t \t</when>'), (64, '        </choose>'), (65, '        <choose>'), (66, '            <when test=""appType != null and appType > 0"">'), (67, '            \tand type = ${appType}'), (68, '       \t \t</when>'), (69, '        </choose>'), (70, '        <choose>'), (71, '            <when test=""appStatus != null and appStatus >= 0"">'), (72, '            \tand status = ${appStatus}'), (73, '       \t \t</when>'), (74, '        </choose>'), (75, '        <choose>'), (76, '            <when test=""appId != null and appId > 0"">'), (77, '            \tand app_id = ${appId}'), (78, '       \t \t</when>'), (79, '        </choose>'), (80, '        <choose>'), (81, '            <when test=""importantLevel != null and importantLevel > 0"">'), (82, '            \tand important_level = ${importantLevel}'), (83, '       \t \t</when>'), (84, '        </choose>'), (85, '    </select>'), (86, ''), (87, '    <select id=""getAllAppDescList"" resultType=""AppDesc"" parameterType=""AppSearch"">'), (88, '    \tselect'), (89, '        \t<include refid=""app_desc_fields""/>'), (90, '        from app_desc where 1=1'), (91, '        <choose>'), (92, '            <when test=""appName != null and appName != \'\'"">'), (93, ""            \tand name like '${appName}%'""), (94, '       \t \t</when>'), (95, '        </choose>'), (96, '        <choose>'), (97, '            <when test=""appType != null and appType > 0"">'), (98, '            \tand type = ${appType}'), (99, '       \t \t</when>'), (100, '        </choose>'), (101, '        <choose>'), (102, '            <when test=""appStatus != null and appStatus >= 0"">'), (103, '            \tand status = ${appStatus}'), (104, '       \t \t</when>'), (105, '        </choose>'), (106, '        <choose>'), (107, '            <when test=""appId != null and appId > 0"">'), (108, '            \tand app_id = ${appId}'), (109, '       \t \t</when>'), (110, '        </choose>'), (111, '        <choose>'), (112, '            <when test=""importantLevel != null and importantLevel > 0"">'), (113, '            \tand important_level = ${importantLevel}'), (114, '       \t \t</when>'), (115, '        </choose>'), (116, '        <choose>'), (117, '        \t<when test=""page != null"">'), (118, '        \t\t<choose>'), (119, '\t\t        \t<when test=""page.totalCount > page.pageSize"">'), (120, '            \t\t\tlimit #{page.start},#{page.pageSize};'), (121, '\t\t        \t</when>'), (122, '\t\t        \t<otherwise>'), (123, '\t\t        \t    limit #{page.totalCount}'), (124, '\t\t        \t</otherwise>'), (125, '\t\t        </choose>'), (126, '        \t</when>'), (127, '        </choose>'), (128, '    </select>'), (129, ''), (130, '    <update id=""updateAppKey"">'), (131, '    \tupdate app_desc set app_key=#{appKey} where app_id=#{appId}'), (132, '    </update>'), (133, ''), (134, '</mapper>'), (135, ''), (136, '')]}"
479,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppDataMigrateStatusDao.xml,AppDataMigrateStatusDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppDataMigrateStatusDao"">'), (6, '    <sql id=""migrate_data_status_fields"">'), (7, '        migrate_machine_ip,migrate_machine_port,source_migrate_type,source_servers,target_migrate_type,target_servers,'), (8, '        source_app_id,target_app_id,user_id,status,start_time,end_time,log_path,config_path'), (9, '    </sql>'), (10, ''), (11, '    <insert id=""save"" parameterType=""AppDataMigrateStatus"" keyProperty=""id"" useGeneratedKeys=""true"" >'), (12, '    \tinsert into app_data_migrate_status'), (13, '    \t\t(<include refid=""migrate_data_status_fields""/>)'), (14, '\t\tvalues'), (15, '\t\t\t(#{migrateMachineIp},#{migrateMachinePort},#{sourceMigrateType},#{sourceServers},#{targetMigrateType},#{targetServers},'), (16, '\t\t\t#{sourceAppId},#{targetAppId},#{userId},#{status},#{startTime},#{endTime},#{logPath},#{configPath})'), (17, '    </insert>'), (18, ''), (19, ''), (20, '    <select id=""search"" resultType=""AppDataMigrateStatus"">'), (21, '    \tselect id,<include refid=""migrate_data_status_fields""/>'), (22, '        from app_data_migrate_status where 1=1'), (23, '        <choose>'), (24, '            <when test=""appDataMigrateSearch.sourceAppId != null and appDataMigrateSearch.sourceAppId > 0"">'), (25, '            \tand source_app_id = #{appDataMigrateSearch.sourceAppId}'), (26, '       \t \t</when>'), (27, '        </choose>'), (28, '        <choose>'), (29, '            <when test=""appDataMigrateSearch.targetAppId != null and appDataMigrateSearch.targetAppId > 0"">'), (30, '            \tand target_app_id = #{appDataMigrateSearch.targetAppId}'), (31, '       \t \t</when>'), (32, '        </choose>'), (33, ''), (34, '        <choose>'), (35, '            <when test=""appDataMigrateSearch.sourceInstanceIp != null and appDataMigrateSearch.sourceInstanceIp != \'\'"">'), (36, ""            \tand source_servers like '%${appDataMigrateSearch.sourceInstanceIp}%'""), (37, '       \t \t</when>'), (38, '        </choose>'), (39, '        <choose>'), (40, '            <when test=""appDataMigrateSearch.targetInstanceIp != null and appDataMigrateSearch.targetInstanceIp != \'\'"">'), (41, ""            \tand target_servers like '%${appDataMigrateSearch.targetInstanceIp}%'""), (42, '       \t \t</when>'), (43, '        </choose>'), (44, ''), (45, '        <choose>'), (46, '            <when test=""appDataMigrateSearch.startDate != null and appDataMigrateSearch.startDate != \'\'"">'), (47, '            \tand start_time > #{appDataMigrateSearch.startDate}'), (48, '       \t \t</when>'), (49, '        </choose>'), (50, '        <choose>'), (51, '            <when test=""appDataMigrateSearch.endDate != null and appDataMigrateSearch.endDate != \'\'"">'), (52, '            \tand end_time &lt;#{appDataMigrateSearch.endDate}'), (53, '       \t \t</when>'), (54, '        </choose>'), (55, '        <choose>'), (56, '            <when test=""appDataMigrateSearch.status >= 0"">'), (57, '            \tand status = #{appDataMigrateSearch.status}'), (58, '       \t \t</when>'), (59, '        </choose>'), (60, '    </select>'), (61, ''), (62, '    <select id=""getMigrateMachineStatCount"" resultType=""int"">'), (63, '    \tselect count(*)'), (64, '        from app_data_migrate_status where migrate_machine_ip=#{migrateMachineIp} and status = #{status}'), (65, '    </select>'), (66, ''), (67, '    <select id=""get"" resultType=""AppDataMigrateStatus"">'), (68, '    \tselect id,<include refid=""migrate_data_status_fields""/>'), (69, '        from app_data_migrate_status where id = #{id}'), (70, '    </select>'), (71, ''), (72, '    <update id=""updateStatus"">'), (73, '    \tupdate app_data_migrate_status set status = #{status}, end_time=now() where id = #{id}'), (74, '    </update>'), (75, ''), (76, '</mapper>'), (77, ''), (78, '')]}"
480,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppInstanceClientRelationDao.xml,AppInstanceClientRelationDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppInstanceClientRelationDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tapp_id,client_ip,instance_host,instance_port,instance_id,day'), (7, '\t</sql>'), (8, ''), (9, '\t<insert id=""save"" parameterType=""AppInstanceClientRelation"" keyProperty=""id"" useGeneratedKeys=""true"">'), (10, '\t\tinsert ignore into app_client_instance(<include refid=""columns""/>)'), (11, '\t\tvalues(#{appId},#{clientIp},#{instanceHost},#{instancePort},#{instanceId},#{day})'), (12, '\t</insert>'), (13, ''), (14, '\t<insert id=""batchSave"">'), (15, '\t\tinsert ignore into app_client_instance(<include refid=""columns"" />)'), (16, '\t\tvalues'), (17, '\t\t<foreach collection=""appInstanceClientRelationList"" item=""appInstanceClientRelation"" separator="","">'), (18, '\t\t\t(#{appInstanceClientRelation.appId},#{appInstanceClientRelation.clientIp},#{appInstanceClientRelation.instanceHost},#{appInstanceClientRelation.instancePort},#{appInstanceClientRelation.instanceId},#{appInstanceClientRelation.day})'), (19, '\t    </foreach>'), (20, '\t</insert>'), (21, ''), (22, '\t<select id=""isExist"" resultType=""int"">'), (23, '\t\tselect count(*) from app_client_instance where app_id=#{appId} and day=#{day} and client_ip=#{clientIp} and instance_id=#{instanceId}'), (24, '\t</select>'), (25, ''), (26, '\t<select id=""getAppInstanceClientRelationList"" resultType=""AppInstanceClientRelation"">'), (27, '\t\tselect <include refid=""columns""/> from app_client_instance where app_id=#{appId} and day=date(#{day})'), (28, '\t</select>'), (29, ''), (30, '</mapper>')]}"
481,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppStatsDao.xml,AppStatsDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.AppStatsDao"">'), (5, '    <!--'), (6, '        字典sql'), (7, ""        set @tn='app_minute_command_statistics';""), (8, '        select'), (9, '            group_concat(column_name)'), (10, '        from'), (11, '            information_schema.columns'), (12, '        where'), (13, ""            table_schema = 'cache-cloud' and table_name = @tn;""), (14, ''), (15, '        select'), (16, ""            group_concat(case when locate('_',column_name)>0 then concat(replace(column_name , concat('_',@shortChar:=substring(column_name,locate('_',column_name)+1,1)),upper(@shortChar))) else column_name end)""), (17, '        from'), (18, '            information_schema.columns'), (19, '        where'), (20, ""            table_schema = 'cache-cloud' and table_name = @tn;""), (21, ''), (22, '        select'), (23, ""            group_concat(concat('#{',replace(column_name , concat('_',@shortChar:=substring(column_name,locate('_',column_name)+1,1)), upper(@shortChar) ),'}'))""), (24, '        from'), (25, '            information_schema.columns'), (26, '        where'), (27, ""            table_schema = 'cache-cloud' and table_name = @tn;""), (28, ''), (29, '    -->'), (30, '    <sql id=""app_minute_statistics_columns"">'), (31, '        app_id,collect_time,hits,misses,command_count,used_memory,'), (32, '        expired_keys,evicted_keys,net_input_byte,net_output_byte,'), (33, '        connected_clients,object_size,modify_time,accumulation'), (34, '    </sql>'), (35, ''), (36, '    <sql id=""select_table"">'), (37, '        <choose>'), (38, '            <when test=""td.dimensionality ==0""> app_minute_command_statistics </when>'), (39, '            <otherwise> app_hour_command_statistics </otherwise>'), (40, '        </choose>'), (41, '    </sql>'), (42, ''), (43, '     <sql id=""select_stat_table"">'), (44, '        <choose>'), (45, '            <when test=""td.dimensionality ==0""> app_minute_statistics </when>'), (46, '            <otherwise> app_hour_statistics </otherwise>'), (47, '        </choose>'), (48, '    </sql>'), (49, ''), (50, '    <sql id=""app_minute_command_statistics_columns"">'), (51, '        app_id,collect_time,command_name,command_count,modify_time'), (52, '    </sql>'), (53, ''), (54, '    <insert id=""mergeMinuteAppStats"" parameterType=""AppStats"">'), (55, '        insert into app_minute_statistics'), (56, '          (<include refid=""app_minute_statistics_columns""/>)'), (57, '        values'), (58, '          (#{appId},#{collectTime},#{hits},#{misses},${commandCount},#{usedMemory},'), (59, '          #{expiredKeys},#{evictedKeys},#{netInputByte},#{netOutputByte},'), (60, '          #{connectedClients},#{objectSize},#{modifyTime},1)'), (61, '        on duplicate key update'), (62, '          hits = hits + #{hits},'), (63, '          misses = misses + #{misses},'), (64, '          command_count = command_count + #{commandCount},'), (65, '          used_memory = used_memory + #{usedMemory},'), (66, '          expired_keys = expired_keys + #{expiredKeys},'), (67, '          evicted_keys = evicted_keys + #{evictedKeys},'), (68, '          net_input_byte = net_input_byte + #{netInputByte},'), (69, '          net_output_byte = net_output_byte + #{netOutputByte},'), (70, '          connected_clients = connected_clients + #{connectedClients},'), (71, '          object_size = object_size + #{objectSize},'), (72, '          modify_time = #{modifyTime},'), (73, '          accumulation = accumulation + 1'), (74, '    </insert>'), (75, ''), (76, '    <insert id=""mergeMinuteCommandStatus"" parameterType=""AppCommandStats"">'), (77, '        insert into app_minute_command_statistics'), (78, '        (<include refid=""app_minute_command_statistics_columns"" />)'), (79, '        values'), (80, '        (#{appId},#{collectTime},#{commandName},#{commandCount},#{modifyTime})'), (81, '        on duplicate key update'), (82, '        command_count = command_count + #{commandCount},'), (83, '        modify_time = #{modifyTime}'), (84, '    </insert>'), (85, ''), (86, '    <insert id=""mergeHourAppStats"" parameterType=""AppStats"">'), (87, '        insert into app_hour_statistics'), (88, '        (<include refid=""app_minute_statistics_columns""/>)'), (89, '        values'), (90, '        (#{appId},substring(#{collectTime}, 1, 10),#{hits},#{misses},${commandCount},#{usedMemory},#{expiredKeys},'), (91, '        #{evictedKeys},#{netInputByte},#{netOutputByte},#{connectedClients},#{objectSize},#{modifyTime},1)'), (92, '        on duplicate key update'), (93, '        hits = hits + #{hits},'), (94, '        misses = misses + #{misses},'), (95, '        command_count = command_count + #{commandCount},'), (96, '        used_memory = used_memory + #{usedMemory},'), (97, '        expired_keys = expired_keys + #{expiredKeys},'), (98, '        evicted_keys = evicted_keys + #{evictedKeys},'), (99, '        net_input_byte = net_input_byte + #{netInputByte},'), (100, '        net_output_byte = net_output_byte + #{netOutputByte},'), (101, '        connected_clients = connected_clients + #{connectedClients},'), (102, '        object_size = object_size + #{objectSize},'), (103, '        modify_time = #{modifyTime},'), (104, '        accumulation = accumulation + 1'), (105, '    </insert>'), (106, ''), (107, '    <insert id=""mergeHourCommandStatus"" parameterType=""AppCommandStats"">'), (108, '        insert into app_hour_command_statistics'), (109, '        (<include refid=""app_minute_command_statistics_columns"" />)'), (110, '        values'), (111, '        (#{appId},substring(#{collectTime}, 1, 10),#{commandName},#{commandCount},#{modifyTime})'), (112, '        on duplicate key update'), (113, '        command_count = command_count + #{commandCount},'), (114, '        modify_time = #{modifyTime}'), (115, '    </insert>'), (116, ''), (117, '     <select id=""getAppStatsList"" resultType=""AppStats"">'), (118, '        select'), (119, '          <include refid=""app_minute_statistics_columns""/> , create_time'), (120, '        from <include refid=""select_stat_table""/>'), (121, '        where'), (122, '          app_id = #{appId} and collect_time between #{td.begin} and #{td.end}'), (123, '    </select>'), (124, ''), (125, '    <select id=""getAppStatsByMinute"" resultType=""AppStats"">'), (126, '        select'), (127, '          <include refid=""app_minute_statistics_columns""/> , create_time'), (128, '        from app_minute_statistics'), (129, '        where'), (130, '          app_id = #{appId} and collect_time between #{beginTime} and #{endTime}'), (131, '    </select>'), (132, ''), (133, ''), (134, '    <select id=""getAppStatsByHour"" resultType=""AppStats"">'), (135, '        select'), (136, '          <include refid=""app_minute_statistics_columns""/> , create_time'), (137, '        from app_hour_statistics'), (138, '        where'), (139, '          app_id = #{appId} and collect_time between #{beginTime} and #{endTime}'), (140, '    </select>'), (141, ''), (142, ''), (143, '    <select id=""getAppCommandStatsList"" resultType=""AppCommandStats"">'), (144, '        select'), (145, '          <include refid=""app_minute_command_statistics_columns""/> , create_time'), (146, '        from <include refid=""select_table""/>'), (147, '        where'), (148, '          app_id = #{appId}'), (149, '          and command_name = #{commandName}'), (150, '          and collect_time between #{td.begin} and #{td.end}'), (151, '    </select>'), (152, ''), (153, '    <select id=""getAppAllCommandStatsListByMinute"" resultType=""AppCommandStats"">'), (154, '        select'), (155, '        app_id,'), (156, '        collect_time,'), (157, ""        'commands' command_name,""), (158, '        command_count,'), (159, '        create_time,'), (160, '        modify_time'), (161, '        from app_minute_statistics'), (162, '        where'), (163, '          app_id = #{appId}'), (164, '          and collect_time between #{beginTime} and #{endTime}'), (165, '    </select>'), (166, ''), (167, ''), (168, '    <select id=""getAppAllCommandStatsListByHour"" resultType=""AppCommandStats"">'), (169, '        select'), (170, '        app_id,'), (171, '        collect_time,'), (172, ""        'commands' command_name,""), (173, '        command_count,'), (174, '        create_time,'), (175, '        modify_time'), (176, '        from app_hour_statistics'), (177, '        where'), (178, '          app_id = #{appId}'), (179, '          and collect_time between #{beginTime} and #{endTime}'), (180, '    </select>'), (181, ''), (182, '    <select id=""getAppCommandStatsListByMinuteWithCommand"" resultType=""AppCommandStats"">'), (183, '        select'), (184, '          <include refid=""app_minute_command_statistics_columns""/> , create_time'), (185, '        from app_minute_command_statistics'), (186, '        where'), (187, '          app_id = #{appId}'), (188, '          and command_name = #{commandName}'), (189, '          and collect_time between #{beginTime} and #{endTime}'), (190, '    </select>'), (191, ''), (192, ''), (193, '    <select id=""getAppCommandStatsListByHourWithCommand"" resultType=""AppCommandStats"">'), (194, '        select'), (195, '          <include refid=""app_minute_command_statistics_columns""/> , create_time'), (196, '        from app_hour_command_statistics'), (197, '        where'), (198, '          app_id = #{appId}'), (199, '          and command_name = #{commandName}'), (200, '          and collect_time between #{beginTime} and #{endTime}'), (201, '    </select>'), (202, ''), (203, ''), (204, '    <select id=""getAppAllCommandStatsList"" resultType=""AppCommandStats"">'), (205, '        select'), (206, '        app_id,'), (207, '        collect_time,'), (208, ""        'commands' command_name,""), (209, '        command_count,'), (210, '        create_time,'), (211, '        modify_time'), (212, '        from <include refid=""select_stat_table""/>'), (213, '        where'), (214, '        app_id = #{appId}'), (215, '        and collect_time between #{td.begin} and #{td.end}'), (216, '    </select>'), (217, ''), (218, '\t<!-- 获取应用命令调用次数分布 -->'), (219, '    <select id=""getAppCommandGroup"" resultType=""AppCommandGroup"">'), (220, '        select'), (221, '          command_name,sum(command_count) as count'), (222, '        from <include refid=""select_table""/>'), (223, '        where'), (224, '          app_id = #{appId}'), (225, '          and collect_time between #{td.begin} and #{td.end}'), (226, '          group by command_name'), (227, '    </select>'), (228, ''), (229, '    <!--查询一天中应用的命令执行次数的top-->'), (230, '    <select id=""getTopAppCommandStatsList"" resultType=""AppCommandStats"">'), (231, '        select'), (232, '          app_id, command_name , max(collect_time) collect_time, sum(command_count) command_count ,'), (233, '          max(modify_time) modify_time, max(create_time) create_time'), (234, '        from <include refid=""select_table""/>'), (235, '        where app_id = #{appId}'), (236, '        and collect_time between #{td.begin} and #{td.end}'), (237, '        group by app_id,command_name'), (238, '        order by command_count desc , modify_time desc'), (239, '        limit #{top};'), (240, '    </select>'), (241, ''), (242, ''), (243, '    <select id=""getTopAppCommandGroupSum"" resultType=""AppCommandStats"">'), (244, '        select'), (245, '          app_id,collect_time,command_name,sum(command_count) as command_count,modify_time, create_time'), (246, '        from <include refid=""select_table""/>'), (247, '        where app_id = #{appId}'), (248, '        and collect_time between #{td.begin} and #{td.end}'), (249, '        group by command_name'), (250, '        order by sum(command_count) desc'), (251, '        limit #{top};'), (252, '    </select>'), (253, ''), (254, '    <select id=""getCommandClimax"" resultType=""AppCommandStats"">'), (255, '        select t2.*'), (256, '        from (select app_id, command_name, max(command_count) command_count'), (257, '            from'), (258, '        <include refid=""select_table""/>'), (259, '            where'), (260, '              app_id = #{appId}'), (261, '              and command_name = #{commandName}'), (262, '              and collect_time between #{td.begin} and #{td.end}'), (263, '              group by app_id,command_name) t1 , <include refid=""select_table""/> t2'), (264, '        where t1.app_id = t2.app_id'), (265, '        and t1.command_name=t2.command_name'), (266, '        and t1.command_count=t2.command_count'), (267, '        and t2.collect_time between #{td.begin} and #{td.end}'), (268, '        limit 1;'), (269, '    </select>'), (270, ''), (271, '    <select id=""getCommandClimaxCount"" resultType=""AppCommandStats"">'), (272, '        select max(command_count) as command_count'), (273, '        from <include refid=""select_table""/>'), (274, '        where app_id = #{appId} and collect_time between #{td.begin} and #{td.end} and command_name = #{commandName}'), (275, '    </select>'), (276, ''), (277, '    <select id=""getCommandClimaxCreateTime"" resultType=""AppCommandStats"">'), (278, '        select create_time'), (279, '        from <include refid=""select_table""/>'), (280, '        where app_id = #{appId} and collect_time between #{td.begin} and #{td.end} and command_name = #{commandName} and command_count=${commandCount} limit 1'), (281, '    </select>'), (282, ''), (283, '    <select id=""getAppMinuteStat"" resultType=""hashmap"">'), (284, '        select'), (285, '        \tavg(connected_clients) as avgClientCount,'), (286, '        \tmax(connected_clients) as maxClientCount,'), (287, '        \tavg(command_count) as avgCommandCount,'), (288, '        \tmax(command_count) as maxCommandCount,'), (289, '            sum(hits)/sum(command_count) as avgHitRatio,'), (290, '\t        max(hits/command_count) as maxHitRatio,'), (291, '\t        min(hits/command_count) as minHitRatio,'), (292, '\t        avg(used_memory) as avgUsedMemory,'), (293, '\t        max(used_memory) as maxUsedMemory,'), (294, '\t        sum(expired_keys) as expiredKeys,'), (295, '\t        sum(evicted_keys) as evictedKeys,'), (296, '\t        avg(net_input_byte) as avgNetInputByte,'), (297, '\t        max(net_input_byte) as maxNetInputByte,'), (298, '\t        avg(net_output_byte) as avgNetOutputByte,'), (299, '\t        max(net_output_byte) as maxNetOutputByte,'), (300, '\t        avg(object_size) as avgObjectSize,'), (301, '\t        max(object_size) as maxObjectSize'), (302, '        from app_minute_statistics'), (303, '        where app_id = #{appId} and collect_time between #{beginTime} and #{endTime}'), (304, '    </select>'), (305, ''), (306, ''), (307, '</mapper>')]}"
482,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppToUserDao.xml,AppToUserDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppToUserDao"">'), (6, '    <sql id=""app_to_user_column"">'), (7, '    \tid,user_id,app_id'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""save"" parameterType=""AppToUser"">'), (11, '    \tinsert into app_to_user'), (12, '    \t\t(<include refid=""app_to_user_column""/>)'), (13, '\t\tvalues'), (14, '\t\t\t(#{id},#{userId},#{appId})'), (15, '    </insert>'), (16, ''), (17, '    <!-- 获取用户的app -->'), (18, '    <select id=""getByUserId"" resultType=""AppToUser"" parameterType=""long"">'), (19, '    \tselect'), (20, '        \t<include refid=""app_to_user_column""/>'), (21, '        from app_to_user where user_id=#{userId}'), (22, '    </select>'), (23, ''), (24, '    <!-- 获取app的用户 -->'), (25, '    <select id=""getByAppId"" resultType=""AppToUser"" parameterType=""long"">'), (26, '    \tselect'), (27, '        \t<include refid=""app_to_user_column""/>'), (28, '        from app_to_user where app_id=#{appId}'), (29, '    </select>'), (30, ''), (31, ''), (32, '    <delete id=""deleteByAppId"" parameterType=""long"">'), (33, '    \tdelete from app_to_user where app_id=#{appId}'), (34, '    </delete>'), (35, ''), (36, '    <select id=""deleteAppToUser"" parameterType=""AppToUser"">'), (37, '        delete from app_to_user where app_id=#{appId} and user_id=#{userId}'), (38, '    </select>'), (39, ''), (40, '</mapper>'), (41, ''), (42, '')]}"
483,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/AppUserDao.xml,AppUserDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppUserDao"">'), (6, '\t<!--'), (7, '\t字典sql'), (8, ""        set @tn='app_user';""), (9, '        select'), (10, '            group_concat(column_name)'), (11, '        from'), (12, '            information_schema.columns'), (13, '        where'), (14, ""            table_schema = 'cache-cloud' and table_name = @tn;""), (15, '\t-->'), (16, '\t<sql id=""user_column"">'), (17, '\t\tid,name,ch_name,email,mobile,type'), (18, '    </sql>'), (19, ''), (20, '    <select id=""get"" resultType=""AppUser"" parameterType=""long"">'), (21, '        select'), (22, '        \t<include refid=""user_column""/>'), (23, '        from app_user'), (24, '        where id = #{id};'), (25, '    </select>'), (26, ''), (27, '    <select id=""getByName"" resultType=""AppUser"" parameterType=""string"">'), (28, '        select'), (29, '        \t<include refid=""user_column""/>'), (30, '        from app_user'), (31, '        where name = #{name};'), (32, '    </select>'), (33, ''), (34, '    <insert id=""save"" parameterType=""AppUser"" keyProperty=""id"" useGeneratedKeys=""true"">'), (35, '    \tinsert into app_user'), (36, '    \t\t(<include refid=""user_column""/>)'), (37, '\t\tvalues'), (38, '\t\t\t(#{id},#{name},#{chName},#{email},#{mobile},#{type})'), (39, '    </insert>'), (40, ''), (41, '    <delete id=""delete"" parameterType=""long"">'), (42, '    \tdelete from app_user where id=#{id}'), (43, '    </delete>'), (44, ''), (45, '    <update id=""update"" parameterType=""AppUser"">'), (46, '    \tupdate app_user'), (47, '    \t\tset name=#{name}, ch_name=#{chName}, email=#{email}, mobile=#{mobile},type=#{type}'), (48, '    \twhere id=#{id}'), (49, '    </update>'), (50, ''), (51, '    <select id=""getUserList"" resultType=""AppUser"" parameterType=""string"">'), (52, '    \tselect'), (53, '        \t<include refid=""user_column""/>'), (54, '        from app_user where 1=1'), (55, '        <choose>'), (56, '        \t<when test=""chName != \'\' and chName != null"">'), (57, '        \t \tand ch_name=#{chName}'), (58, '        \t</when>'), (59, '        </choose>'), (60, '    </select>'), (61, ''), (62, ''), (63, '</mapper>'), (64, ''), (65, '')]}"
484,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/ConfigDao.xml,ConfigDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.ConfigDao"">'), (5, '\t<sql id=""columns"">'), (6, '\t\tconfig_key,config_value ,info,status,order_id'), (7, '\t</sql>'), (8, ''), (9, '\t<select id=""getConfigList"" resultType=""com.sohu.cache.entity.SystemConfig"">'), (10, '\t\tselect'), (11, '\t\t<include refid=""columns"" />'), (12, '\t\tfrom system_config where status=#{status} order by order_id'), (13, '\t</select>'), (14, ''), (15, '\t<update id=""update"">'), (16, '\t\tupdate system_config set config_value = #{configValue} where config_key=#{configKey}'), (17, '\t</update>'), (18, ''), (19, '</mapper>')]}"
485,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/InstanceAlertConfigDao.xml,InstanceAlertConfigDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceAlertConfigDao"">'), (5, ''), (6, '    <sql id=""instance_alert_config_column"">'), (7, '    \talert_config,alert_value,config_info,type,instance_id,status,compare_type,'), (8, '    \tcheck_cycle,update_time,last_check_time'), (9, '    </sql>'), (10, ''), (11, '    <insert id=""save"" parameterType=""InstanceAlertConfig""  keyProperty=""id"" useGeneratedKeys=""true"">'), (12, '\t\tinsert into instance_alert_configs(<include refid=""instance_alert_config_column"" />)'), (13, '\t\tvalues(#{alertConfig},#{alertValue},#{configInfo},#{type},#{instanceId},#{status},#{compareType},'), (14, '\t\t#{checkCycle},#{updateTime},#{lastCheckTime})'), (15, '\t\ton duplicate key update'), (16, '\t\talert_value = #{alertValue},check_cycle = #{checkCycle}, update_time = now(),status = #{status},last_check_time=now()'), (17, '\t</insert>'), (18, ''), (19, '    <select id=""getAll"" resultType=""InstanceAlertConfig"">'), (20, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs'), (21, '    </select>'), (22, ''), (23, '    <select id=""get"" resultType=""InstanceAlertConfig"">'), (24, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs where id = #{id}'), (25, '    </select>'), (26, ''), (27, '\t<delete id=""remove"">'), (28, '\t\tdelete from instance_alert_configs where id = #{id}'), (29, '\t</delete>'), (30, ''), (31, '\t<select id=""getByType"" resultType=""InstanceAlertConfig"">'), (32, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs where type = #{type}'), (33, '    </select>'), (34, ''), (35, '    <select id=""getByAlertConfig"" resultType=""InstanceAlertConfig"">'), (36, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs where alert_config = #{alertConfig}'), (37, '    </select>'), (38, ''), (39, '    <update id=""update"">'), (40, '    \t\tupdate instance_alert_configs set alert_value = #{alertValue}, check_cycle = #{checkCycle} where id = #{id}'), (41, '    </update>'), (42, ''), (43, '    <update id=""updateLastCheckTime"">'), (44, '    \t\tupdate instance_alert_configs set last_check_time = #{lastCheckTime} where id = #{id}'), (45, '    </update>'), (46, ''), (47, '</mapper>')]}"
486,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/InstanceConfigDao.xml,InstanceConfigDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceConfigDao"">'), (5, '    <sql id=""columns"">'), (6, '    \tconfig_key, config_value, info, update_time, type, status'), (7, '    </sql>'), (8, ''), (9, '    <select id=""getByType"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (10, '        select id,<include refid=""columns""/> from instance_config where type = #{type}'), (11, '    </select>'), (12, ''), (13, '    <select id=""getById"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (14, '        select id,<include refid=""columns""/> from instance_config where id = #{id}'), (15, '    </select>'), (16, ''), (17, '    <select id=""getByConfigKeyAndType"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (18, '        select id,<include refid=""columns""/> from instance_config where config_key = #{configKey} and type = #{type}'), (19, '    </select>'), (20, ''), (21, '    <select id=""getAllInstanceConfig"" resultType=""com.sohu.cache.entity.InstanceConfig"">'), (22, '        select id,<include refid=""columns""/> from instance_config'), (23, '    </select>'), (24, ''), (25, ''), (26, '    <insert id=""saveOrUpdate"">'), (27, '\t\tinsert into instance_config(<include refid=""columns"" />)'), (28, '\t\tvalues(#{configKey},#{configValue},#{info},now(),#{type},#{status})'), (29, '\t    on duplicate key update'), (30, '\t    config_value = #{configValue}, info = #{info},'), (31, '\t    update_time = now(),status = #{status}'), (32, '\t</insert>'), (33, ''), (34, '\t<update id=""updateStatus"">'), (35, '\t\tupdate instance_config set status = #{status} where id = #{id}'), (36, '\t</update>'), (37, ''), (38, '\t<delete id=""remove"">'), (39, '\t\tdelete from instance_config where id = #{id}'), (40, '\t</delete>'), (41, ''), (42, '</mapper>')]}"
487,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/InstanceDao.xml,InstanceDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.InstanceDao"">'), (6, '    <sql id=""instance_info_columns"">'), (7, '        id, app_id, host_id, ip, port, status, mem, conn, cmd, type'), (8, '    </sql>'), (9, ''), (10, '    <!--通过type查询实例列表-->'), (11, '    <select id=""getInstListByType"" resultType=""InstanceInfo"" parameterType=""int"">'), (12, '        SELECT'), (13, '        <include refid=""instance_info_columns""/>'), (14, '        FROM instance_info'), (15, '        WHERE type = #{type} and status=1'), (16, '        ORDER BY id;'), (17, '    </select>'), (18, ''), (19, '    <!--通过appId查询实例列表-->'), (20, '    <select id=""getInstListByAppId"" resultType=""InstanceInfo"" parameterType=""long"">'), (21, '        SELECT'), (22, '        <include refid=""instance_info_columns""/>'), (23, '        FROM instance_info'), (24, '        WHERE app_id = #{appId}'), (25, '        ORDER BY id;'), (26, '    </select>'), (27, ''), (28, '    <select id=""getMemoryByHost"" resultType=""int"">'), (29, '        select ifnull(sum(mem),0)'), (30, '        from instance_info'), (31, '        where ip = #{host} and status in (0,1)'), (32, '    </select>'), (33, ''), (34, '    <!--通过host和port查询一个实例信息-->'), (35, '    <select id=""getInstByIpAndPort"" resultType=""InstanceInfo"">'), (36, '        SELECT'), (37, '        <include refid=""instance_info_columns""/>'), (38, '        FROM instance_info'), (39, '        WHERE ip = #{ip} AND port = #{port} AND status = 1'), (40, '    </select>'), (41, ''), (42, '    <select id=""getAllInstByIpAndPort"" resultType=""InstanceInfo"">'), (43, '        SELECT'), (44, '        <include refid=""instance_info_columns""/>'), (45, '        FROM instance_info'), (46, '        WHERE ip = #{ip} AND port = #{port}'), (47, '    </select>'), (48, ''), (49, '    <!--通过host和port查询一个实例信息-->'), (50, '    <select id=""getAllInsts"" resultType=""InstanceInfo"">'), (51, '        SELECT'), (52, '        <include refid=""instance_info_columns""/>'), (53, '        FROM instance_info'), (54, '        WHERE status in (0,1)'), (55, '    </select>'), (56, ''), (57, '    <!--通过host和port查询一个实例数-->'), (58, '    <select id=""getCountByIpAndPort"" resultType=""int"">'), (59, '        SELECT count(*)'), (60, '        FROM instance_info'), (61, '        WHERE ip = #{ip} AND port = #{port}'), (62, '    </select>'), (63, ''), (64, '    <!--通过id查询一个实例信息-->'), (65, '    <select id=""getInstanceInfoById"" resultType=""InstanceInfo"">'), (66, '        SELECT'), (67, '        <include refid=""instance_info_columns""/>'), (68, '        FROM instance_info'), (69, '        WHERE id = #{id}'), (70, '    </select>'), (71, ''), (72, '    <!--保存实例-->'), (73, '    <insert id=""saveInstance"" parameterType=""InstanceInfo"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (74, '        INSERT INTO instance_info (app_id, host_id, ip, port, status, mem, conn, cmd, type)'), (75, '        VALUE(#{appId}, #{hostId}, #{ip}, #{port}, #{status}, #{mem}, #{conn}, #{cmd}, #{type});'), (76, '    </insert>'), (77, ''), (78, '    <update id=""update"" parameterType=""InstanceInfo"">'), (79, '        update instance_info'), (80, '        set'), (81, '        <if test=""appId != null"">app_id=#{appId},</if>'), (82, '        <if test=""hostId != null"">host_id=#{hostId},</if>'), (83, '        <if test=""ip != null"">ip=#{ip},</if>'), (84, '        <if test=""port != null"">port=#{port},</if>'), (85, '        <if test=""mem != null"">mem=#{mem},</if>'), (86, '        <if test=""conn != null"">conn=#{conn},</if>'), (87, '        <if test=""cmd != null"">cmd=#{cmd},</if>'), (88, '        status=#{status}'), (89, '        where'), (90, '        id=#{id}'), (91, '    </update>'), (92, ''), (93, '    <select id=""getAppInstanceInfo"" parameterType=""long"" resultType=""InstanceInfo"">'), (94, '        select'), (95, '        <include refid=""instance_info_columns""/>'), (96, '        from instance_info where app_id=#{appId} and status=1'), (97, '    </select>'), (98, ''), (99, '    <select id=""getInstanceTypeCount"" resultType=""int"">'), (100, '        select count(*)'), (101, '        from instance_info'), (102, '        where ip = #{ip} and type = #{type}'), (103, '    </select>'), (104, ''), (105, '    <!--通过机器ip查询实例列表-->'), (106, '    <select id=""getInstListByIp"" resultType=""InstanceInfo"" parameterType=""string"">'), (107, '        SELECT'), (108, '        <include refid=""instance_info_columns""/>'), (109, '        FROM instance_info'), (110, '        WHERE ip = #{ip} and status != 2'), (111, '        ORDER BY id;'), (112, '    </select>'), (113, ''), (114, '    <select id=""getMachineInstanceCountMap"" resultType=""hashmap"">'), (115, '    \tselect ip, count(*) as count from instance_info where status=1 group by ip;'), (116, '    </select>'), (117, ''), (118, ''), (119, '</mapper>'), (120, ''), (121, '')]}"
488,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/InstanceFaultDao.xml,InstanceFaultDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.InstanceFaultDao"">'), (6, '    <sql id=""instance_fault_column"">'), (7, '\t\tapp_id,inst_id,ip,port,status,create_time,type,reason'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""insert"" parameterType=""InstanceFault"" keyColumn=""id"" keyProperty=""id"" useGeneratedKeys=""true"">'), (11, '        insert into instance_fault(app_id,inst_id,ip,port,status,create_time,type,reason)'), (12, '        VALUE (#{appId},#{instId},#{ip},#{port},#{status},#{createTime},#{type},#{reason})'), (13, '    </insert>'), (14, ''), (15, '    <select id=""getListByInstId"" resultType=""InstanceFault"">'), (16, '        select'), (17, '          id, <include refid=""instance_fault_column""/>'), (18, '        from instance_fault'), (19, '        where inst_id = #{instId}'), (20, '        order by create_time desc'), (21, '    </select>'), (22, ''), (23, '    <select id=""getListByAppId"" resultType=""InstanceFault"">'), (24, '        select'), (25, '        id, <include refid=""instance_fault_column""/>'), (26, '        from instance_fault'), (27, '        where app_id = #{appId}'), (28, '        order by create_time desc'), (29, '    </select>'), (30, ''), (31, ''), (32, '</mapper>'), (33, ''), (34, '')]}"
489,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/InstanceReshardProcessDao.xml,InstanceReshardProcessDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceReshardProcessDao"">'), (5, ''), (6, '    <sql id=""instance_reshard_process_column"">'), (7, '\t    \tapp_id,audit_id,source_instance_id,target_instance_id,start_slot,end_slot,'), (8, '\t    \tmigrating_slot,is_pipeline,finish_slot_num,status,start_time,end_time,create_time,update_time'), (9, '    </sql>'), (10, ''), (11, '    <insert id=""save"" parameterType=""InstanceReshardProcess""  keyProperty=""id"" useGeneratedKeys=""true"">'), (12, '\t\tinsert into instance_reshard_process(<include refid=""instance_reshard_process_column"" />)'), (13, '\t\tvalues(#{appId},#{auditId},#{sourceInstanceId},#{targetInstanceId},#{startSlot},#{endSlot},'), (14, '\t\t#{migratingSlot},#{isPipeline},#{finishSlotNum},#{status},#{startTime},#{endTime},#{createTime},#{updateTime})'), (15, '\t</insert>'), (16, ''), (17, '    <select id=""getByAuditId"" resultType=""InstanceReshardProcess"">'), (18, '        select id,<include refid=""instance_reshard_process_column""/> from instance_reshard_process where audit_id = #{auditId}'), (19, '    </select>'), (20, ''), (21, '    <select id=""get"" resultType=""InstanceReshardProcess"">'), (22, '        select id,<include refid=""instance_reshard_process_column""/> from instance_reshard_process where id = #{id}'), (23, '    </select>'), (24, ''), (25, '    <update id=""updateStatus"">'), (26, '    \t\tupdate instance_reshard_process set status = #{status} where id = #{id}'), (27, '    </update>'), (28, ''), (29, '    <update id=""updateEndTime"">'), (30, '    \t\tupdate instance_reshard_process set end_time = #{endTime} where id = #{id}'), (31, '    </update>'), (32, ''), (33, '    <update id=""increaseFinishSlotNum"">'), (34, '    \t\tupdate instance_reshard_process set finish_slot_num = finish_slot_num + 1 where id = #{id}'), (35, '    </update>'), (36, ''), (37, '    <update id=""updateMigratingSlot"">'), (38, '    \t\tupdate instance_reshard_process set migrating_slot = #{migratingSlot} where id = #{id}'), (39, '    </update>'), (40, ''), (41, '</mapper>')]}"
490,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/InstanceSlowLogDao.xml,InstanceSlowLogDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceSlowLogDao"">'), (5, ''), (6, '    <sql id=""instance_slow_log_columns"">'), (7, '        instance_id,app_id,ip,port,slow_log_id,cost_time,command,execute_time,create_time'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""batchSave"">'), (11, '        insert ignore into instance_slow_log(<include refid=""instance_slow_log_columns""/>)'), (12, '        values'), (13, '        <foreach collection=""instanceSlowLogList"" item=""instanceSlowLog"" separator="","">'), (14, '        \t(#{instanceSlowLog.instanceId},#{instanceSlowLog.appId},#{instanceSlowLog.ip},#{instanceSlowLog.port},#{instanceSlowLog.slowLogId},#{instanceSlowLog.costTime},#{instanceSlowLog.command},#{instanceSlowLog.executeTime},#{instanceSlowLog.createTime})'), (15, '\t    </foreach>'), (16, '    </insert>'), (17, ''), (18, '    <select id=""getByAppId"" resultType=""InstanceSlowLog"">'), (19, '        select id,<include refid=""instance_slow_log_columns""/>'), (20, '        from instance_slow_log where app_id = #{appId}'), (21, '    </select>'), (22, ''), (23, ''), (24, '    <select id=""search"" resultType=""InstanceSlowLog"">'), (25, '        select id,<include refid=""instance_slow_log_columns""/>'), (26, ""        from instance_slow_log where app_id = #{appId} and create_time between DATE_FORMAT(#{startDate}, '%Y-%m-%d') and DATE_FORMAT(#{endDate}, '%Y-%m-%d') order by execute_time desc""), (27, '    </select>'), (28, ''), (29, '    <select id=""getInstanceSlowLogCountMapByAppId"" resultType=""hashmap"">'), (30, '        select concat(ip,"":"",port) as hostPort,count(*) as count'), (31, ""        from instance_slow_log where app_id = #{appId} and create_time between DATE_FORMAT(#{startDate}, '%Y-%m-%d') and DATE_FORMAT(#{endDate}, '%Y-%m-%d') group by hostPort order by count desc""), (32, '    </select>'), (33, ''), (34, '    <select id=""getAppSlowLogCount"" resultType=""int"">'), (35, '        select count(*) as count'), (36, ""        from instance_slow_log where app_id = #{appId} and execute_time between DATE_FORMAT(#{startDate}, '%Y-%m-%d') and DATE_FORMAT(#{endDate}, '%Y-%m-%d')""), (37, '    </select>'), (38, ''), (39, '</mapper>')]}"
491,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/InstanceStatsDao.xml,InstanceStatsDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceStatsDao"">'), (5, ''), (6, '    <sql id=""instance_statistics_columns"">'), (7, '        inst_id,app_id,host_id,ip,port,role,max_memory,used_memory,curr_items,curr_connections,misses,hits,modify_time,mem_fragmentation_ratio,aof_delayed_fsync'), (8, '    </sql>'), (9, ''), (10, '    <insert id=""updateInstanceStats"" parameterType=""InstanceStats"">'), (11, '        INSERT INTO instance_statistics'), (12, '          (<include refid=""instance_statistics_columns""/>)'), (13, '        VALUES (#{instId},#{appId},#{hostId},#{ip},#{port},#{role},#{maxMemory},#{usedMemory},#{currItems},#{currConnections},#{misses},#{hits},'), (14, '                  #{modifyTime},#{memFragmentationRatio},#{aofDelayedFsync})'), (15, '        ON DUPLICATE KEY UPDATE'), (16, '          inst_id = #{instId},'), (17, '          host_id = #{hostId},'), (18, '          role = #{role},'), (19, '          max_memory = #{maxMemory},'), (20, '          used_memory = #{usedMemory},'), (21, '          curr_items = #{currItems},'), (22, '          curr_connections = #{currConnections},'), (23, '          misses = #{misses},'), (24, '          hits = #{hits},'), (25, '          modify_time = #{modifyTime},'), (26, '          mem_fragmentation_ratio = #{memFragmentationRatio},'), (27, '          aof_delayed_fsync = #{aofDelayedFsync}'), (28, '    </insert>'), (29, ''), (30, '    <select id=""getInstanceStatsByHost"" resultType=""InstanceStats"">'), (31, '        select id,<include refid=""instance_statistics_columns""/>'), (32, '        from instance_statistics'), (33, '        where ip = #{ip} and port = #{port}'), (34, '    </select>'), (35, ''), (36, '    <select id=""getInstanceStatsByIp"" resultType=""InstanceStats"">'), (37, '        select id,<include refid=""instance_statistics_columns""/>'), (38, '        from instance_statistics'), (39, '        where ip = #{ip}'), (40, '    </select>'), (41, ''), (42, '    <select id=""getInstanceStatsByInsId"" resultType=""InstanceStats"">'), (43, '        select id,<include refid=""instance_statistics_columns""/>'), (44, '        from instance_statistics'), (45, '        where inst_id = #{id}'), (46, '    </select>'), (47, ''), (48, '    <select id=""getInstanceStatsByAppId"" resultType=""InstanceStats"">'), (49, '        select id,<include refid=""instance_statistics_columns""/>'), (50, '        from instance_statistics'), (51, '        where app_id = #{appId}'), (52, '    </select>'), (53, ''), (54, '    <select id=""getInstanceStats"" resultType=""InstanceStats"">'), (55, '        select id,<include refid=""instance_statistics_columns""/>'), (56, '        from instance_statistics'), (57, '    </select>'), (58, ''), (59, '    <insert id=""mergeStandardStats"" parameterType=""StandardStats"">'), (60, '        replace into standard_statistics(collect_time,ip,port,db_type,info_json,diff_json,cluster_info_json)'), (61, '        values (#{collectTime},#{ip},#{port},#{dbType},#{infoJson},#{diffJson},#{clusterInfoJson})'), (62, '    </insert>'), (63, ''), (64, '    <select id=""getStandardStats"" resultType=""StandardStats"">'), (65, '        select id,collect_time,ip,port,db_type,info_json,diff_json,cluster_info_json,created_time'), (66, '        from standard_statistics'), (67, '        where  ip=#{ip} and port=#{port} and db_type=#{dbType}'), (68, '          and collect_time = #{collectTime}'), (69, '    </select>'), (70, ''), (71, '    <select id=""getDiffJsonList"" resultType=""StandardStats"">'), (72, '        select collect_time,diff_json'), (73, '        from standard_statistics'), (74, '        where  ip=#{ip} and port=#{port} and db_type=#{dbType}'), (75, '        and collect_time between #{beginTime} and #{endTime}'), (76, '    </select>'), (77, ''), (78, '    <delete id=""deleteStandardStatsByCreatedTime"">'), (79, '        delete'), (80, '        from standard_statistics'), (81, '        where <![CDATA[ created_time <=  #{createdTime}]]>'), (82, '    </delete>'), (83, ''), (84, '    <delete id=""deleteStandardStatsByScanTime"">'), (85, '        DELETE FROM standard_statistics'), (86, '        where created_time BETWEEN #{startTime} AND #{endTime}'), (87, '    </delete>'), (88, ''), (89, '    <select id=""getStandardStatsByCreateTime"" resultType=""StandardStats"">'), (90, '        select id,collect_time,ip,port,db_type,info_json,diff_json,cluster_info_json,created_time'), (91, '        from standard_statistics'), (92, '        where created_time between #{beginTime} and #{endTime} and db_type=#{dbType}'), (93, '    </select>'), (94, ''), (95, ''), (96, '</mapper>')]}"
492,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/MachineDao.xml,MachineDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.MachineDao"">'), (5, '    <sql id=""machine_info_columns"">'), (6, '        ssh_user,ssh_passwd,ip,room,mem,cpu,`virtual`,real_ip,service_time,fault_count,warn,available,type,groupId,extra_desc,collect'), (7, '    </sql>'), (8, ''), (9, '    <sql id=""machine_info_fields"">'), (10, '        #{sshUser},#{sshPasswd},#{ip},#{room},#{mem},#{cpu},#{virtual},#{realIp},#{serviceTime},'), (11, '        #{faultCount},#{warn},#{available},#{type},#{groupId},#{extraDesc},#{collect}'), (12, '    </sql>'), (13, ''), (14, '    <!--返回所有可用的机器资源-->'), (15, '    <select id=""getAllMachines"" resultType=""MachineInfo"">'), (16, '        select'), (17, '        id, modify_time, <include refid=""machine_info_columns""/>'), (18, '        from machine_info'), (19, '        where available = 1'), (20, '    </select>'), (21, ''), (22, '    <!--通过ip查找机器-->'), (23, '    <select id=""getMachineInfoByIp"" resultType=""MachineInfo"">'), (24, '        select'), (25, '          id, modify_time, <include refid=""machine_info_columns""/>'), (26, '        from machine_info'), (27, '        where ip = #{ip};'), (28, '    </select>'), (29, ''), (30, '    <!--通过ip查找机器-->'), (31, '    <select id=""getMachineInfoByLikeIp"" resultType=""MachineInfo"">'), (32, '        select'), (33, '          id, modify_time, <include refid=""machine_info_columns""/>'), (34, '        from machine_info where available = 1'), (35, '        <choose>'), (36, '            <when test=""ipLike != \'\' and ipLike != null"">'), (37, ""                and ip like '%${ipLike}%'""), (38, '            </when>'), (39, '        </choose>'), (40, '    </select>'), (41, ''), (42, '    <!--保存机器信息-->'), (43, '    <insert id=""saveMachineInfo"" parameterType=""MachineInfo"">'), (44, '        insert into machine_info'), (45, '          (<include refid=""machine_info_columns""/>)'), (46, '        values'), (47, '          (<include refid=""machine_info_fields""/>)'), (48, '        on duplicate key'), (49, '        update ssh_user=#{sshUser},ssh_passwd=#{sshPasswd},room=#{room},mem=#{mem},cpu=#{cpu},'), (50, '        `virtual`=#{virtual},real_ip=#{realIp},service_time=#{serviceTime},fault_count=#{faultCount},'), (51, '        warn=#{warn},available=#{available},type=#{type},groupId=#{groupId},extra_desc=#{extraDesc},collect=#{collect}'), (52, '    </insert>'), (53, ''), (54, '    <!--根据ip删除一台机器的信息:置无效-->'), (55, '    <update id=""removeMachineInfoByIp"" parameterType=""string"">'), (56, '        update machine_info set available = 0 WHERE ip = #{ip}'), (57, '    </update>'), (58, ''), (59, '    <!--通过type查找机器-->'), (60, '    <select id=""getMachineInfoByType"" resultType=""MachineInfo"">'), (61, '        select'), (62, '          id, modify_time, <include refid=""machine_info_columns""/>'), (63, '        from machine_info where type = #{type} and available = 1'), (64, '    </select>'), (65, ''), (66, '    <!-- 更新机器类型 -->'), (67, '    <update id=""updateMachineType"">'), (68, '    \tupdate machine_info set type = #{type} where id = #{id}'), (69, '    </update>'), (70, ''), (71, '</mapper>')]}"
493,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/MachineStatsDao.xml,MachineStatsDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.MachineStatsDao"">'), (5, ''), (6, '    <sql id=""machine_statistics_columns"">'), (7, '        ip,host_id,cpu_usage,`load`,traffic,memory_usage_ratio,memory_free,memory_total,modify_time'), (8, '    </sql>'), (9, ''), (10, '    <sql id=""instance_info_columns"">'), (11, '        instance.id, instance.parent_id, instance.app_id, instance.host_id, instance.ip, instance.PORT, instance.STATUS, instance.mem, instance.conn, instance.cmd, instance.type'), (12, '    </sql>'), (13, ''), (14, '    <!--保存机器当前最新的统计信息-->'), (15, '    <insert id=""mergeMachineStats"" parameterType=""MachineStats"">'), (16, '        insert into machine_statistics'), (17, '          (<include refid=""machine_statistics_columns""/>)'), (18, '        values'), (19, '          (#{ip},#{hostId},#{cpuUsage},#{load},#{traffic},#{memoryUsageRatio},#{memoryFree},#{memoryTotal},#{modifyTime})'), (20, '        on duplicate key update'), (21, '           host_id = #{hostId},'), (22, '           cpu_usage = #{cpuUsage},'), (23, '           `load` = #{load},'), (24, '           traffic = #{traffic},'), (25, '           memory_usage_ratio = #{memoryUsageRatio},'), (26, '           memory_free = #{memoryFree},'), (27, '           memory_total = #{memoryTotal},'), (28, '           modify_time = #{modifyTime}'), (29, '    </insert>'), (30, ''), (31, '    <!--查询机器下的所有实例的静态信息-->'), (32, '    <select id=""getInstInfoOfMachine"" resultType=""InstanceInfo"">'), (33, '        SELECT'), (34, '           <include refid=""instance_info_columns""/>'), (35, '        FROM'), (36, '            machine_info AS machine,'), (37, '            instance_info AS instance'), (38, '        WHERE'), (39, '            machine.id = instance.host_id'), (40, '        AND machine.ip = instance.ip'), (41, '        AND machine.available = 1'), (42, '        AND machine.ip = #{ip}'), (43, '    </select>'), (44, ''), (45, '    <!--查询机器下的所有实例的最新状态信息-->'), (46, '    <select id=""getInstStatOfMachine"" resultType=""InstanceStats"" parameterType=""long"">'), (47, '        SELECT istat.*'), (48, '        FROM machine_statistics as mstat, instance_statistics AS istat'), (49, '        WHERE mstat.host_id = #{hostId}'), (50, '        AND mstat.host_id = istat.host_id'), (51, '        ORDER BY istat.max_memory DESC;'), (52, '    </select>'), (53, ''), (54, '    <!--查询当前机器资源池中所有有效的机器-->'), (55, '    <!--<select id=""getAllMachines"" resultType=""MachineInfo"">-->'), (56, '        <!--SELECT minfo.*-->'), (57, '        <!--FROM machine_info as minfo-->'), (58, '        <!--WHERE minfo.available = 1;-->'), (59, '    <!--</select>-->'), (60, ''), (61, '    <select id=""getMachineStats"" resultType=""MachineStats"">'), (62, '        select'), (63, '          id,<include refid=""machine_statistics_columns""/>'), (64, '        from machine_statistics'), (65, '        <choose>'), (66, '            <when test=""ipLike != \'\' and ipLike != null"">'), (67, ""                where ip like '%${ipLike}%'""), (68, '            </when>'), (69, '        </choose>'), (70, '    </select>'), (71, ''), (72, '    <select id=""getAllMachineStats"" resultType=""MachineStats"">'), (73, '        select'), (74, '          id,<include refid=""machine_statistics_columns""/>'), (75, '        from machine_statistics'), (76, '    </select>'), (77, ''), (78, '    <!--根据机器的ip查询机器的最新状态信息-->'), (79, '    <select id=""getMachineStatsByIp"" resultType=""MachineStats"">'), (80, '        select'), (81, '          id,<include refid=""machine_statistics_columns""/>'), (82, '        from machine_statistics'), (83, '        where ip = #{ip};'), (84, '    </select>'), (85, ''), (86, '    <!--根据机器的hostId查询机器的最新状态信息-->'), (87, '    <select id=""getMachineStatsByHostId"" resultType=""MachineStats"" parameterType=""long"">'), (88, '        select'), (89, '          id,<include refid=""machine_statistics_columns""/>'), (90, '        from machine_statistics'), (91, '        where host_id = #{hostId};'), (92, '    </select>'), (93, ''), (94, '    <!-- 删除机器统计信息 -->'), (95, '    <delete id=""deleteMachineStatsByIp"" parameterType=""string"">'), (96, '    \tdelete from machine_statistics where ip = #{ip};'), (97, '    </delete>'), (98, ''), (99, ''), (100, '</mapper>')]}"
494,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/QuartzDao.xml,QuartzDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.QuartzDao"">'), (6, '    <sql id=""quartz_triggers_columns"">'), (7, '        t.SCHED_NAME,t.TRIGGER_NAME,t.TRIGGER_GROUP,t.JOB_NAME,t.JOB_GROUP,t.DESCRIPTION,t.NEXT_FIRE_TIME,t.PREV_FIRE_TIME,t.PRIORITY,'), (8, '        t.TRIGGER_STATE,t.TRIGGER_TYPE,t.START_TIME,t.END_TIME,t.CALENDAR_NAME,t.MISFIRE_INSTR'), (9, '    </sql>'), (10, ''), (11, '    <!--查询job分组下的所有trigger-->'), (12, '    <select id=""getTriggersByJobGroup"" resultType=""TriggerInfo"" parameterType=""String"">'), (13, '        SELECT <include refid=""quartz_triggers_columns""/>'), (14, '        FROM QRTZ_TRIGGERS t'), (15, '        WHERE JOB_GROUP = #{jobGroup};'), (16, '    </select>'), (17, ''), (18, '    <!--返回所有trigger-->'), (19, '    <select id=""getAllTriggers"" resultType=""TriggerInfo"">'), (20, '        SELECT <include refid=""quartz_triggers_columns""/>, ifnull(ct.CRON_EXPRESSION,\'\') cron'), (21, '        FROM QRTZ_TRIGGERS t'), (22, '        LEFT JOIN QRTZ_CRON_TRIGGERS ct'), (23, '        on (t.SCHED_NAME = ct.SCHED_NAME and t.TRIGGER_NAME = ct.TRIGGER_NAME and t.TRIGGER_GROUP=ct.TRIGGER_GROUP)'), (24, '    </select>'), (25, ''), (26, '    <!--查询trigger：模糊匹配trigger name或trigger group-->'), (27, '    <select id=""searchTriggerByNameOrGroup"" resultType=""TriggerInfo"" parameterType=""String"">'), (28, '        SELECT <include refid=""quartz_triggers_columns""/>, ifnull(ct.CRON_EXPRESSION,\'\') cron'), (29, '        FROM QRTZ_TRIGGERS t'), (30, '        LEFT JOIN QRTZ_CRON_TRIGGERS ct'), (31, '        on (t.SCHED_NAME = ct.SCHED_NAME and t.TRIGGER_NAME = ct.TRIGGER_NAME and t.TRIGGER_GROUP=ct.TRIGGER_GROUP)'), (32, '        WHERE t.TRIGGER_NAME REGEXP #{queryString}'), (33, '        OR t.TRIGGER_GROUP REGEXP #{queryString};'), (34, '    </select>'), (35, ''), (36, '</mapper>')]}"
495,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mapper/ServerStatusDao.xml,ServerStatusDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.ServerStatusDao"">'), (6, ''), (7, '\t<!-- 获取服务器信息 -->'), (8, '    <select id=""queryServerInfo"" resultType=""ServerInfo"">'), (9, '    \tselect ip,host,nmon,cpus,cpu_model cpuModel,dist,kernel,ulimit'), (10, '        from server where ip=#{ip}'), (11, '    </select>'), (12, ''), (13, '    <!-- 保存服务器发行版信息 -->'), (14, '    <insert id=""saveServerInfo"">'), (15, '    \tinsert ignore into server(ip,dist) values (#{ip},#{dist})'), (16, '    </insert>'), (17, ''), (18, '    <!-- 删除服务器信息 -->'), (19, '    <select id=""deleteServerInfo"">'), (20, '    \tdelete from server where ip=#{ip}'), (21, '    </select>'), (22, ''), (23, '    <!-- 保存/更新服务器信息 -->'), (24, '    <insert id=""saveAndUpdateServerInfo"">'), (25, '    \tinsert into server (ip,host,nmon,cpus,cpu_model,kernel,ulimit)'), (26, '\t\tvalues (#{server.ip},#{server.host},#{server.nmon},#{server.cpus},#{server.cpuModel},#{server.kernel},#{server.ulimit})'), (27, '\t\ton duplicate key update host=values(host), nmon=values(nmon), cpus=values(cpus),'), (28, '\t\tcpu_model=values(cpu_model), kernel=values(kernel), ulimit=values(ulimit)'), (29, '    </insert>'), (30, ''), (31, '    <!-- 获取服务器状态 -->'), (32, '    <select id=""queryServerOverview"" resultType=""ServerStatus"">'), (33, '    \tselect ip,cdate,ctime,cuser,csys,cwio,cload1,cload5,cload15,'), (34, '\t\t\t   mtotal,mfree,mcache,mbuffer,mswap,mswap_free mswapFree,'), (35, '\t\t\t   nin,nout,tuse,torphan,twait,'), (36, '\t\t\t   dread,dwrite,diops,dbusy'), (37, '\t\tfrom server_stat'), (38, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (39, '    </select>'), (40, ''), (41, '    <!-- 获取服务器cpu状态 -->'), (42, '    <select id=""queryServerCpu"" resultType=""ServerStatus"">'), (43, '    \tselect ctime, c_ext cExt'), (44, '\t\tfrom server_stat'), (45, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (46, '    </select>'), (47, ''), (48, '    <!-- 获取服务器net状态 -->'), (49, '    <select id=""queryServerNet"" resultType=""ServerStatus"">'), (50, '    \tselect ctime, nin_ext ninExt,nout_ext noutExt'), (51, '\t\tfrom server_stat'), (52, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (53, '    </select>'), (54, ''), (55, '    <!-- 获取服务器disk状态 -->'), (56, '    <select id=""queryServerDisk"" resultType=""ServerStatus"">'), (57, '    \tselect ctime, d_ext dExt,dspace'), (58, '\t\tfrom server_stat'), (59, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (60, '    </select>'), (61, ''), (62, '    <!-- 获取服务器状态 -->'), (63, '    <select id=""queryServerStat"" resultType=""ServerStatus"">'), (64, '    \tselect ip,cdate,ctime,cuser,csys,cwio,c_ext cExt,cload1,cload5,cload15,'), (65, '\t\t\t   mtotal,mfree,mcache,mbuffer,mswap,mswap_free mswapFree,'), (66, '\t\t\t   nin,nout,nin_ext ninExt,nout_ext noutExt,tuse,torphan,twait,'), (67, '\t\t\t   dread,dwrite,diops,dbusy,d_ext dExt,dspace""'), (68, '\t\tfrom server_stat'), (69, '\t\twhere ip=#{ip} and cdate=#{cdate}'), (70, '    </select>'), (71, ''), (72, '    <!-- 保存服务器状态-->'), (73, '    <insert id=""saveServerStat"">'), (74, '    \tinsert ignore into server_stat(ip,cdate,ctime,cuser,csys,cwio,c_ext,'), (75, '    \t\t   cload1,cload5,cload15,'), (76, '    \t\t   mtotal,mfree,mcache,mbuffer,mswap,mswap_free,'), (77, '    \t\t   nin,nout,nin_ext,nout_ext,'), (78, '    \t\t   tuse,torphan,twait,'), (79, '    \t\t   dread,dwrite,diops,dbusy,d_ext,dspace)'), (80, '     \tvalues(#{server.ip},#{server.collectTime},#{server.time},'), (81, '     \t\t   #{server.cpu.user},#{server.cpu.sys},#{server.cpu.wait},#{server.cpu.ext},'), (82, '     \t\t   #{server.load.load1},#{server.load.load5},#{server.load.load15},'), (83, '     \t\t   #{server.mem.total},#{server.mem.totalFree},#{server.mem.cache},'), (84, '     \t\t   #{server.mem.buffer},#{server.mem.swap},#{server.mem.swapFree},'), (85, '     \t\t   #{server.net.nin},#{server.net.nout},#{server.net.ninDetail},#{server.net.noutDetail},'), (86, '     \t\t   #{server.connection.established},#{server.connection.orphan},#{server.connection.timeWait},'), (87, '     \t\t   #{server.disk.read},#{server.disk.write},#{server.disk.iops},#{server.disk.busy},'), (88, '     \t\t   #{server.disk.ext},#{server.disk.space})'), (89, '    </insert>'), (90, '</mapper>')]}"
496,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/mybatis-config.xml,mybatis-config.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE configuration PUBLIC ""-//mybatis.org//DTD Config 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-config.dtd"">'), (4, ''), (5, '<configuration>'), (6, ''), (7, '    <!--数据库的字段名到pojo类的属性名的自动映射-->'), (8, '    <settings>'), (9, '        <!-- 使用jdbc的getGeneratedKeys自动获取主键主键策略:默认false -->'), (10, '        <setting name=""useGeneratedKeys"" value=""true""/>'), (11, '        <!-- 使用列别名代替列名,默认true -->'), (12, '        <setting name=""useColumnLabel"" value=""true""/>'), (13, '        <!-- 开启自动驼峰-下划线命名规则,默认false: Table(create_time) -> Entity(createTime) -->'), (14, '        <setting name=""mapUnderscoreToCamelCase"" value=""true""/>'), (15, '    </settings>'), (16, ''), (17, '</configuration>')]}"
497,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-alert.xml,spring-alert.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd'), (6, '        "" default-autowire=""byName"">'), (7, ''), (8, '\t<bean id=""baseAlertService"" class=""com.sohu.cache.alert.impl.BaseAlertService""/>'), (9, ''), (10, '\t<!-- 应用报警 -->'), (11, '    <bean id=""appAlertService"" class=""com.sohu.cache.alert.impl.AppAlertServiceImpl"" parent=""baseAlertService""/>'), (12, ''), (13, '\t<!-- 实例报警 -->'), (14, '    <bean id=""instanceAlertService"" class=""com.sohu.cache.alert.impl.InstanceAlertServiceImpl"" parent=""baseAlertService""/>'), (15, ''), (16, '</beans>')]}"
498,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-client-report.xml,spring-client-report.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '\txmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:util=""http://www.springframework.org/schema/util""'), (4, '\txsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '                     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd""'), (6, '\tdefault-autowire=""byName"">'), (7, ''), (8, '\t<!-- 处理上报数据接口 -->'), (9, '\t<bean id=""clientReportDataService""'), (10, '\t\tclass=""com.sohu.cache.client.service.impl.ClientReportDataServiceImpl""'), (11, '\t\tinit-method=""init"" />'), (12, ''), (13, '\t<!-- 耗时分布  -->'), (14, '\t<bean id=""clientReportCostDistriService""'), (15, '\t\tclass=""com.sohu.cache.client.service.impl.ClientReportCostDistriServiceImpl"" />'), (16, '\t<!-- 客户端异常 -->'), (17, '\t<bean id=""clientReportExceptionService""'), (18, '\t\tclass=""com.sohu.cache.client.service.impl.ClientReportExceptionServiceImpl"" />'), (19, '\t<!-- 值分布 -->'), (20, '\t<bean id=""clientReportValueDistriService""'), (21, '\t\tclass=""com.sohu.cache.client.service.impl.ClientReportValueDistriServiceImplV2"" />'), (22, '\t<!-- 客户端统计map大小统计，防止内存泄露 -->'), (23, '\t<bean id=""clientReportDataSizeService""'), (24, '\t\tclass=""com.sohu.cache.client.service.impl.ClientReportDataSizeServiceImpl""/>'), (25, ''), (26, '\t<!-- 客户端版本收集 -->'), (27, '\t<bean id=""clientVersionService"" class=""com.sohu.cache.client.service.impl.ClientVersionServiceImpl""/>'), (28, ''), (29, '\t<!-- 应用下节点和客户端对应关系 -->'), (30, '\t<bean id=""appInstanceClientRelationService"" class=""com.sohu.cache.client.service.impl.AppInstanceClientRelationServiceImpl""/>'), (31, ''), (32, '\t<bean id=""clientReportInstanceService"" class=""com.sohu.cache.client.service.impl.ClientReportInstanceServiceImpl""/>'), (33, ''), (34, '</beans>')]}"
499,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-config.xml,spring-config.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd'), (6, '        "" default-autowire=""byName"">'), (7, ''), (8, '\t<bean id=""configService"" class=""com.sohu.cache.web.service.impl.ConfigServiceImpl"" init-method=""init""/>'), (9, ''), (10, '</beans>')]}"
500,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-data.xml,spring-data.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"" default-autowire=""byName"">'), (6, ''), (7, ''), (8, '    <bean id=""jdbcTemplate"" class=""org.springframework.jdbc.core.JdbcTemplate"">'), (9, '        <property name=""dataSource"" ref=""cacheCloudDB""/>'), (10, '    </bean>'), (11, ''), (12, '    <bean name=""transactionManager"" class=""org.springframework.jdbc.datasource.DataSourceTransactionManager"">'), (13, '        <property name=""dataSource"" ref=""cacheCloudDB""/>'), (14, '    </bean>'), (15, ''), (16, '</beans>')]}"
501,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-inspector.xml,spring-inspector.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"" default-autowire=""byName"">'), (6, ''), (7, '    <bean id=""hostInspectHandler"" class=""com.sohu.cache.inspect.impl.HostInspectHandler"" init-method=""init"">'), (8, '        <property name=""inspectorList"">'), (9, '            <list>'), (10, '                <bean class=""com.sohu.cache.inspect.impl.InstanceRunInspector""/>'), (11, '                <bean class=""com.sohu.cache.inspect.impl.RedisIsolationPersistenceInspector""/>'), (12, '            </list>'), (13, '        </property>'), (14, '    </bean>'), (15, ''), (16, '    <bean id=""appInspectHandler"" class=""com.sohu.cache.inspect.impl.AppInspectHandler"" init-method=""init"">'), (17, '        <property name=""inspectorList"">'), (18, '        \t<list>'), (19, '        \t\t<bean class=""com.sohu.cache.inspect.impl.AppMemInspector""/>'), (20, '            \t<bean class=""com.sohu.cache.inspect.impl.AppClientConnInspector""/>'), (21, '        \t</list>'), (22, '        </property>'), (23, '    </bean>'), (24, ''), (25, '</beans>')]}"
502,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-jmx.xml,spring-jmx.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xmlns:util=""http://www.springframework.org/schema/util""'), (5, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (6, '                     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd'), (7, '                     http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd""'), (8, '       default-autowire=""byName"">'), (9, ''), (10, '\t<!-- mbeanServer用于注册mbean -->'), (11, '    <bean id=""mbeanServer"" class=""org.springframework.jmx.support.MBeanServerFactoryBean"">'), (12, '        <property name=""locateExistingServerIfPossible"" value=""true""/>'), (13, '    </bean>'), (14, ''), (15, '\t<!-- 异常统计 -->'), (16, '    <bean id=""errorLoggerWatcher"" class=""com.sohu.cache.jmx.ErrorLoggerWatcher"" init-method=""init""/>'), (17, ''), (18, '    <!-- cachecloud数据监控 -->'), (19, '    <bean id=""cachecloudDataWatcher"" class=""com.sohu.tv.cache.client.common.jmx.CachecloudDataWatcher""/>'), (20, ''), (21, '    <!-- 客户端上报jmx -->'), (22, '    <bean id=""clientReportAsyncThreadPoolStatistics"" class=""com.sohu.cache.jmx.ThreadPoolStatisticsImpl"">'), (23, '        <constructor-arg index=""0"">'), (24, '            <util:constant static-field=""com.sohu.cache.async.AsyncThreadPoolFactory.CLIENT_REPORT_THREAD_POOL""/>'), (25, '        </constructor-arg>'), (26, '    </bean>'), (27, ''), (28, '    <!-- 实例慢查询jmx -->'), (29, '    <bean id=""redisSlowlogAsyncThreadPoolStatistics"" class=""com.sohu.cache.jmx.ThreadPoolStatisticsImpl"">'), (30, '        <constructor-arg index=""0"">'), (31, '            <util:constant static-field=""com.sohu.cache.async.AsyncThreadPoolFactory.REDIS_SLOWLOG_THREAD_POOL""/>'), (32, '        </constructor-arg>'), (33, '    </bean>'), (34, ''), (35, '\t<!-- mbeanServerExporter -->'), (36, '    <bean id=""mbeanServerExporter"" class=""org.springframework.jmx.export.MBeanExporter"">'), (37, '        <property name=""beans"">'), (38, '            <map>'), (39, '                <entry key=""cacheCloudJMX:myjavaobj=errorLoggerWatcher"" value-ref=""errorLoggerWatcher""/>'), (40, '                <entry key=""cacheCloudJMX:myjavaobj=cachecloudDataWatcher"" value-ref=""cachecloudDataWatcher""/>'), (41, '                <entry key=""cacheCloudJMX:myjavaobj=clientReportAsyncThreadPoolStatistics"" value-ref=""clientReportAsyncThreadPoolStatistics""/>'), (42, '                <entry key=""cacheCloudJMX:myjavaobj=redisSlowlogAsyncThreadPoolStatistics"" value-ref=""redisSlowlogAsyncThreadPoolStatistics""/>'), (43, '            </map>'), (44, '        </property>'), (45, '        <property name=""server"" ref=""mbeanServer""/>'), (46, '        <property name=""assembler"" ref=""assembler""/>'), (47, '    </bean>'), (48, ''), (49, '\t<!-- 接口集合 -->'), (50, '    <bean id=""assembler"" class=""org.springframework.jmx.export.assembler.InterfaceBasedMBeanInfoAssembler"">'), (51, '        <property name=""managedInterfaces"">'), (52, '            <list>'), (53, '                <value>com.sohu.cache.jmx.ErrorLoggerWatcherMBean</value>'), (54, '                <value>com.sohu.tv.cache.client.common.jmx.CachecloudDataWatcherMBean</value>'), (55, '                <value>com.sohu.cache.jmx.ThreadPoolStatisticsMBean</value>'), (56, '            </list>'), (57, '        </property>'), (58, '    </bean>'), (59, ''), (60, '</beans>')]}"
503,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-load.xml,spring-load.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd'), (6, '        "" default-autowire=""byName"">'), (7, ''), (8, '    <!--初始化加载已有实例，测试时禁用-->'), (9, '    <bean class=""com.sohu.cache.init.RedisInitLoad"" init-method=""init"" />'), (10, '    <bean class=""com.sohu.cache.init.MachineInitLoad"" init-method=""init"" />'), (11, '</beans>')]}"
504,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-local.xml,spring-local.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"">'), (6, '    <import resource=""classpath:spring/spring-config.xml""/>'), (7, '    <import resource=""classpath:spring/spring-quartz.xml""/>'), (8, '    <import resource=""classpath:spring/spring-mybatis.xml""/>'), (9, '    <import resource=""classpath:spring/spring-service.xml""/>'), (10, '    <import resource=""classpath:spring/spring-data.xml""/>'), (11, '    <import resource=""classpath:spring/spring-manage.xml""/>'), (12, '    <import resource=""classpath:spring/spring-mvc.xml""/>'), (13, '\t<import resource=""classpath:spring/spring-jmx.xml""/>'), (14, '\t<import resource=""classpath:spring/spring-alert.xml""/>'), (15, '\t<import resource=""classpath:spring/spring-client-report.xml""/>'), (16, '\t<import resource=""classpath:spring/spring-inspector.xml""/>'), (17, '</beans>')]}"
505,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-manage.xml,spring-manage.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xmlns:util=""http://www.springframework.org/schema/util""'), (5, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (6, '                     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd""'), (7, '       default-autowire=""byName"">'), (8, ''), (9, '    <bean id=""appService"" class=""com.sohu.cache.web.service.impl.AppServiceImpl""/>'), (10, ''), (11, '    <bean id=""memFaultService"" class=""com.sohu.cache.web.service.impl.MemFaultServiceImpl""/>'), (12, ''), (13, '    <bean id=""userService"" class=""com.sohu.cache.web.service.impl.UserServiceImpl""/>'), (14, ''), (15, '\t<!-- 邮件报警 -->'), (16, '    <bean id=""emailComponent"" class=""com.sohu.cache.web.component.EmailComponentImpl""/>'), (17, ''), (18, '\t<!-- 短信报警 -->'), (19, '\t<bean id=""mobileAlertComponent"" class=""com.sohu.cache.web.component.MobileAlertComponentImpl""/>'), (20, ''), (21, '\t<!-- 应用相关审核变更通知 -->'), (22, '    <bean id=""appEmailUtil"" class=""com.sohu.cache.web.util.AppEmailUtil""/>'), (23, ''), (24, '    <!-- 登录状态相关cookie和session根据配置切换 -->'), (25, '    <bean id=""userLoginStatusSessionService"" class=""com.sohu.cache.web.service.impl.UserLoginStatusSessionServiceImpl""/>'), (26, '    <bean id=""userLoginStatusCookieService"" class=""com.sohu.cache.web.service.impl.UserLoginStatusCookieServiceImpl""/>'), (27, ''), (28, '    <util:map id=""userloginTypeMap"" key-type=""com.sohu.cache.constant.UserLoginTypeEnum"" value-type=""com.sohu.cache.web.service.UserLoginStatusService"">'), (29, '        <entry key=""SESSION"" value-ref=""userLoginStatusSessionService""/>'), (30, '        <entry key=""COOKIE"" value-ref=""userLoginStatusCookieService""/>'), (31, '    </util:map>'), (32, '    <bean id=""userLoginStatusFactory"" class=""com.sohu.cache.web.factory.UserLoginStatusFactory"">'), (33, '    \t<property name=""userloginTypeMap"" ref=""userloginTypeMap""></property>'), (34, '    </bean>'), (35, '    <bean id=""userLoginStatusService"" factory-bean=""userLoginStatusFactory"" factory-method=""getUserLoginStatusService""/>'), (36, ''), (37, '\t<bean id=""appDailyDataCenter"" class=""com.sohu.cache.stats.app.impl.AppDailyDataCenterImpl""/>'), (38, ''), (39, '</beans>')]}"
506,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-mvc.xml,spring-mvc.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xmlns:context=""http://www.springframework.org/schema/context""'), (5, '       xmlns:mvc=""http://www.springframework.org/schema/mvc""'), (6, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (7, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd'), (8, '        http://www.springframework.org/schema/context'), (9, '        http://www.springframework.org/schema/context/spring-context-3.0.xsd'), (10, '        http://www.springframework.org/schema/mvc'), (11, '        http://www.springframework.org/schema/mvc/spring-mvc.xsd"" default-autowire=""byName"">'), (12, ''), (13, '    <mvc:annotation-driven/>'), (14, ''), (15, '    <mvc:resources mapping=""/resources/**"" location=""/WEB-INF/resources/""/>'), (16, '    <mvc:resources mapping=""/assets/flash/**"" location=""/WEB-INF/resources/assets/flash/""/>'), (17, ''), (18, '    <!--'), (19, '    <mvc:annotation-driven/>'), (20, '    <mvc:default-servlet-handler default-servlet-name=""default""/>'), (21, '    <mvc:resources mapping=""/resources/**"" location=""/resources/""/>'), (22, '    <bean class=""org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter""/>'), (23, '    <mvc:resources mapping=""/assets/flash/**"" location=""/resources/assets/flash/""/>'), (24, '    -->'), (25, ''), (26, '    <mvc:interceptors>'), (27, '        <!-- 前台验证 -->'), (28, '        <mvc:interceptor>'), (29, '            <mvc:mapping path=""/admin/app/*""/>'), (30, '            <mvc:mapping path=""/admin/instance/*""/>'), (31, '            <mvc:mapping path=""/client/show/*""/>'), (32, '            <mvc:mapping path=""/server/*""/>'), (33, '            <bean class=""com.sohu.cache.interceptor.FrontUserLoginInterceptor""/>'), (34, '        </mvc:interceptor>'), (35, '        <!-- 后台管理员验证 -->'), (36, '        <mvc:interceptor>'), (37, '            <mvc:mapping path=""/manage/app/*""/>'), (38, '            <mvc:mapping path=""/manage/instance/*""/>'), (39, '            <mvc:mapping path=""/manage/user/*""/>'), (40, '            <mvc:mapping path=""/manage/quartz/*""/>'), (41, '            <mvc:mapping path=""/manage/total/*""/>'), (42, '            <mvc:mapping path=""/manage/machine/*""/>'), (43, '            <mvc:mapping path=""/manage/notice/*""/>'), (44, '            <mvc:mapping path=""/import/app/*""/>'), (45, '            <mvc:mapping path=""/manage/config/*""/>'), (46, '            <mvc:mapping path=""/data/migrate/*""/>'), (47, '            <mvc:mapping path=""/manage/redisConfig/*""/>'), (48, '            <mvc:mapping path=""/manage/instanceAlert/*""/>'), (49, '            <bean class=""com.sohu.cache.interceptor.ManageUserLoginInterceptor""/>'), (50, '        </mvc:interceptor>'), (51, '        <!-- 应用和实例权限验证 -->'), (52, '        <mvc:interceptor>'), (53, '            <mvc:mapping path=""/admin/app/*""/>'), (54, '            <mvc:mapping path=""/admin/instance/*""/>'), (55, '            <bean class=""com.sohu.cache.interceptor.AppAndInstanceAuthorityInterceptor""/>'), (56, '        </mvc:interceptor>'), (57, '    </mvc:interceptors>'), (58, ''), (59, '    <bean class=""org.springframework.web.servlet.view.ContentNegotiatingViewResolver"">'), (60, '        <property name=""order"" value=""1""/>'), (61, '        <property name=""contentNegotiationManager"">'), (62, '            <bean class=""org.springframework.web.accept.ContentNegotiationManager"">'), (63, '                <constructor-arg>'), (64, '                    <bean class=""org.springframework.web.accept.PathExtensionContentNegotiationStrategy"">'), (65, '                        <constructor-arg>'), (66, '                            <map>'), (67, '                                <entry key=""json"" value=""application/json""/>'), (68, '                            </map>'), (69, '                        </constructor-arg>'), (70, '                    </bean>'), (71, '                </constructor-arg>'), (72, '            </bean>'), (73, '        </property>'), (74, '        <property name=""defaultViews"">'), (75, '            <list>'), (76, '                <bean class=""org.springframework.web.servlet.view.json.MappingJackson2JsonView""/>'), (77, '            </list>'), (78, '        </property>'), (79, '    </bean>'), (80, ''), (81, '    <bean class=""org.springframework.web.servlet.view.InternalResourceViewResolver"">'), (82, '        <property name=""order"" value=""2""/>'), (83, '        <property name=""viewClass"" value=""org.springframework.web.servlet.view.JstlView""/>'), (84, '        <property name=""prefix"" value=""/WEB-INF/jsp/""/>'), (85, '        <property name=""suffix"" value="".jsp""/>'), (86, '    </bean>'), (87, ''), (88, '    <context:component-scan base-package=""com.sohu.cache.client.heartbeat,com.sohu.cache.web.controller""/>'), (89, ''), (90, ''), (91, ''), (92, '</beans>')]}"
507,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-mybatis.xml,spring-mybatis.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xmlns:context=""http://www.springframework.org/schema/context""'), (5, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (6, '                     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd'), (7, '                     http://www.springframework.org/schema/context'), (8, '                     http://www.springframework.org/schema/context/spring-context.xsd"">'), (9, ''), (10, '    <context:property-placeholder location=""classpath:application.properties""/>'), (11, ''), (12, '    <!--cache data source-->'), (13, '    <bean name=""cacheCloudDB"" class=""com.mchange.v2.c3p0.ComboPooledDataSource"">'), (14, '        <property name=""driverClass"" value=""${jdbc.driver}""/>'), (15, '        <property name=""jdbcUrl"" value=""${cachecloud.db.url}""/>'), (16, '        <property name=""user"" value=""${cachecloud.db.user}""/>'), (17, '        <property name=""password"" value=""${cachecloud.db.password}""/>'), (18, '        <property name=""initialPoolSize"" value=""10""/>'), (19, '        <property name=""maxPoolSize"" value=""${cachecloud.maxPoolSize}""/>'), (20, '        <property name=""testConnectionOnCheckin"" value=""false""/>'), (21, '        <property name=""testConnectionOnCheckout"" value=""true""/>'), (22, '        <property name=""preferredTestQuery"" value=""${jdbc.validationQuery}""/>'), (23, '    </bean>'), (24, ''), (25, '    <bean id=""mysqlSessionFactory"" class=""com.sohu.cache.app.AliasesResourceSqlSessionFactoryBean"">'), (26, '        <property name=""dataSource"" ref=""cacheCloudDB""/>'), (27, '        <!-- mybatis配置文件的位置 -->'), (28, '        <property name=""configLocation"" value=""classpath:mybatis-config.xml""/>'), (29, '        <!-- domain的包路径，类似MyBatis的typeAliases配置 -->'), (30, '        <property name=""typeAliasesPackage"" value=""com.sohu.cache.entity""/>'), (31, '        <property name=""typeAliasesClassResources"">'), (32, '            <array>'), (33, '                <value>classpath:com/sohu/cache/entity/*</value>'), (34, '            </array>'), (35, '        </property>'), (36, '        <!-- mapper配置文件的路径，类似MyBatis的mappers配置 -->'), (37, '        <property name=""mapperLocations"" value=""classpath:mapper/*.xml""/>'), (38, '    </bean>'), (39, ''), (40, '    <!-- 扫描接口类的包路径 -->'), (41, '    <bean class=""org.mybatis.spring.mapper.MapperScannerConfigurer"">'), (42, '        <property name=""sqlSessionFactoryBeanName"" value=""mysqlSessionFactory""/>'), (43, '        <property name=""basePackage"" value=""com.sohu.cache.dao""/>'), (44, '    </bean>'), (45, '</beans>')]}"
508,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-online.xml,spring-online.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"">'), (6, '    <import resource=""classpath:spring/spring-config.xml""/>'), (7, '    <import resource=""classpath:spring/spring-quartz.xml""/>'), (8, '\t<import resource=""classpath:spring/spring-load.xml""/>'), (9, '    <import resource=""classpath:spring/spring-mybatis.xml""/>'), (10, '    <import resource=""classpath:spring/spring-service.xml""/>'), (11, '    <import resource=""classpath:spring/spring-data.xml""/>'), (12, '    <import resource=""classpath:spring/spring-manage.xml""/>'), (13, '    <import resource=""classpath:spring/spring-mvc.xml""/>'), (14, '\t<import resource=""classpath:spring/spring-jmx.xml""/>'), (15, '\t<import resource=""classpath:spring/spring-alert.xml""/>'), (16, '\t<import resource=""classpath:spring/spring-client-report.xml""/>'), (17, '\t<import resource=""classpath:spring/spring-inspector.xml""/>'), (18, '</beans>')]}"
509,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-quartz.xml,spring-quartz.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '                     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd""'), (6, '       default-autowire=""byName"">'), (7, ''), (8, '    <!-- 非分布式模式 -->'), (9, '    <bean id=""jvmQuartzScheduler"" name=""jvmQuartzScheduler"" lazy-init=""false"" class=""org.springframework.scheduling.quartz.SchedulerFactoryBean"">'), (10, '        <property name=""quartzProperties"">'), (11, '            <props>'), (12, '                <prop key=""org.quartz.scheduler.instanceName"">cachecloudJvmScheduler</prop>'), (13, '                <prop key=""org.quartz.jobStore.class"">org.quartz.simpl.RAMJobStore</prop>'), (14, '                <prop key=""org.quartz.scheduler.instanceId"">AUTO</prop>'), (15, '                <prop key=""org.quartz.threadPool.class"">org.quartz.simpl.SimpleThreadPool</prop>'), (16, '                <prop key=""org.quartz.threadPool.threadCount"">10</prop>'), (17, '                <prop key=""org.quartz.threadPool.threadPriority"">5</prop>'), (18, '                <prop key=""org.quartz.scheduler.jmx.export"">true</prop>'), (19, '                <prop key=""org.quartz.plugin.shutdownHook.class"">org.quartz.plugins.management.ShutdownHookPlugin</prop>'), (20, '                <prop key=""org.quartz.plugin.shutdownHook.cleanShutdown"">true</prop>'), (21, '                <prop key=""org.quartz.plugin.triggHistory.class"">org.quartz.plugins.history.LoggingJobHistoryPlugin'), (22, '                </prop>'), (23, '            </props>'), (24, '        </property>'), (25, '        <property name=""startupDelay"" value=""10""/>'), (26, '        <property name=""applicationContextSchedulerContextKey"" value=""applicationContext""/>'), (27, '        <property name=""overwriteExistingJobs"" value=""true""/>'), (28, '        <property name=""autoStartup"" value=""true""/>'), (29, ''), (30, '        <property name=""triggers"">'), (31, '            <array>'), (32, '                <ref bean=""errorStatisticsTrigger""/>'), (33, '                <ref bean=""systemConfigRefreshTrigger""/>'), (34, '            </array>'), (35, '        </property>'), (36, ''), (37, '        <property name=""jobDetails"">'), (38, '            <array>'), (39, '                <ref bean=""errorStatisticsJobDetail""/>'), (40, '                <ref bean=""systemConfigRefreshJobDetail""/>'), (41, '            </array>'), (42, '        </property>'), (43, '    </bean>'), (44, ''), (45, ''), (46, '    <!-- quartz线程池 -->'), (47, '    <bean id=""quartzThreadPool"" class=""org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor"">'), (48, '        <!-- 核心线程数  -->'), (49, '        <property name=""corePoolSize"" value=""100""/>'), (50, '        <!-- 最大线程数 -->'), (51, '        <property name=""maxPoolSize"" value=""200""/>'), (52, '        <!-- 队列最大长度 >=mainExecutor.maxSize -->'), (53, '        <property name=""queueCapacity"" value=""10""/>'), (54, '        <!-- 线程池维护线程所允许的空闲时间 -->'), (55, '        <property name=""keepAliveSeconds"" value=""300""/>'), (56, '        <!-- 拒绝任务策略:被拒绝后直接在调用者线程中运行当前被放弃任务 -->'), (57, '        <property name=""rejectedExecutionHandler"">'), (58, '            <bean class=""java.util.concurrent.ThreadPoolExecutor$AbortPolicy""/>'), (59, '        </property>'), (60, '    </bean>'), (61, ''), (62, '    <!-- 分布式QuartzScheduler -->'), (63, '    <bean id=""clusterScheduler"" name=""clusterScheduler"" lazy-init=""false"" class=""org.springframework.scheduling.quartz.SchedulerFactoryBean"">'), (64, '        <property name=""dataSource"" ref=""cacheCloudDB""></property>'), (65, '        <property name=""taskExecutor"" ref=""quartzThreadPool""/>'), (66, '        <!--'), (67, '        <property name=""transactionManager"" ref=""transactionManager""/>'), (68, '        -->'), (69, '        <property name=""quartzProperties"">'), (70, '            <props>'), (71, '                <prop key=""org.quartz.scheduler.instanceName"">CacheCloudScheduler</prop>'), (72, '                <prop key=""org.quartz.scheduler.instanceId"">AUTO</prop>'), (73, '                <prop key=""org.quartz.jobStore.class"">org.quartz.impl.jdbcjobstore.JobStoreTX</prop>'), (74, '                <prop key=""org.quartz.jobStore.driverDelegateClass"">org.quartz.impl.jdbcjobstore.StdJDBCDelegate</prop>'), (75, '                <!-- 表名前缀 -->'), (76, '                <prop key=""org.quartz.jobStore.tablePrefix"">QRTZ_</prop>'), (77, '                <prop key=""org.quartz.jobStore.isClustered"">${isClustered}</prop>'), (78, '                <prop key=""org.quartz.jobStore.clusterCheckinInterval"">15000</prop>'), (79, '                <prop key=""org.quartz.jobStore.maxMisfiresToHandleAtATime"">120</prop>'), (80, '                <prop key=""org.quartz.jobStore.misfireThreshold"">60000</prop>'), (81, '                <!-- 打开JMX 配置 -->'), (82, '                <prop key=""org.quartz.scheduler.jmx.export"">true</prop>'), (83, '                <prop key=""org.quartz.plugin.shutdownHook.class"">org.quartz.plugins.management.ShutdownHookPlugin</prop>'), (84, '                <prop key=""org.quartz.plugin.shutdownHook.cleanShutdown"">true</prop>'), (85, '                <prop key=""org.terracotta.quartz.skipUpdateCheck"">true</prop>'), (86, '                <!--<prop key=""org.quartz.plugin.triggHistory.class"">org.quartz.plugins.history.LoggingJobHistoryPlugin</prop>-->'), (87, ''), (88, '            </props>'), (89, '        </property>'), (90, '        <property name=""schedulerName"" value=""CacheCloudScheduler""/>'), (91, '        <property name=""applicationContextSchedulerContextKey"" value=""applicationContext""/>'), (92, '        <property name=""overwriteExistingJobs"" value=""true""/>'), (93, '        <property name=""waitForJobsToCompleteOnShutdown"" value=""false""/>'), (94, '        <property name=""startupDelay"" value=""10""/>'), (95, '        <property name=""autoStartup"" value=""true""/>'), (96, '        <property name=""triggers"">'), (97, '            <array>'), (98, '                <ref bean=""cleanUpStatisticsTrigger""/>'), (99, '                <ref bean=""hostInspectorTrigger""/>'), (100, '                <ref bean=""appInspectorTrigger""/>'), (101, '                <ref bean=""appDailyTrigger""/>'), (102, '                <ref bean=""instanceAlertValueTrigger""/>'), (103, '            </array>'), (104, '        </property>'), (105, '        <property name=""jobDetails"">'), (106, '            <array>'), (107, '                <ref bean=""redisJobDetail""/>'), (108, '                <ref bean=""machineJobDetail""/>'), (109, '                <ref bean=""serverJobDetail""/>'), (110, '                <ref bean=""machineMonitorJobDetail""/>'), (111, '                <ref bean=""redisSlowLogJobDetail""/>'), (112, '                <ref bean=""cleanUpStatisticsJobDetail""/>'), (113, '                <ref bean=""inspectorJobDetail""/>'), (114, '                <ref bean=""appDailyJobDetail""/>'), (115, '                <ref bean=""instanceAlertValueJobDetail""/>'), (116, '            </array>'), (117, '        </property>'), (118, ''), (119, '    </bean>'), (120, ''), (121, '    <bean id=""redisJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (122, '        <property name=""name"" value=""redisJob""></property>'), (123, '        <property name=""group"" value=""redis""></property>'), (124, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.RedisJob""></property>'), (125, '        <property name=""durability"" value=""true""/>'), (126, '    </bean>'), (127, ''), (128, '    <bean id=""machineJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (129, '        <property name=""name"" value=""machineJob""/>'), (130, '        <property name=""group"" value=""machine""/>'), (131, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.MachineJob""/>'), (132, '        <property name=""durability"" value=""true""/>'), (133, '    </bean>'), (134, '    <bean id=""serverJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (135, '        <property name=""name"" value=""serverJob""/>'), (136, '        <property name=""group"" value=""server""/>'), (137, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.ServerJob""/>'), (138, '        <property name=""durability"" value=""true""/>'), (139, '    </bean>'), (140, ''), (141, '    <bean id=""machineMonitorJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (142, '        <property name=""name"" value=""machineMonitorJob""/>'), (143, '        <property name=""group"" value=""machineMonitor""/>'), (144, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.MachineMonitorJob""/>'), (145, '        <property name=""durability"" value=""true""/>'), (146, '    </bean>'), (147, ''), (148, '    <bean id=""redisSlowLogJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (149, '        <property name=""name"" value=""redisSlowLogJob""/>'), (150, '        <property name=""group"" value=""redisSlowLog""/>'), (151, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.RedisSlowLogJob""/>'), (152, '        <property name=""durability"" value=""true""/>'), (153, '    </bean>'), (154, ''), (155, '    <bean id=""cleanUpStatisticsJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (156, '        <property name=""name"" value=""cleanUpStatisticsJobDetail""></property>'), (157, '        <property name=""group"" value=""cleanUpStatisticsGroup""></property>'), (158, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.CleanUpStatisticsJob""></property>'), (159, '        <property name=""durability"" value=""true"" />'), (160, '    </bean>'), (161, ''), (162, '    <bean id=""errorStatisticsJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (163, '        <property name=""name"" value=""errorStatisticsJobDetail""></property>'), (164, '        <property name=""group"" value=""errorStatisticsGroup""></property>'), (165, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.ErrorStatisticsJob""></property>'), (166, '        <property name=""durability"" value=""true"" />'), (167, '    </bean>'), (168, ''), (169, '    <bean id=""cleanUpStatisticsTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (170, '        <property name=""name"" value=""cleanUpStatisticsTrigger""/>'), (171, '        <property name=""group"" value=""cleanUp""/>'), (172, '        <property name=""jobDetail"" ref=""cleanUpStatisticsJobDetail""/>'), (173, '        <!-- 每天执行一次 -->'), (174, '        <property name=""cronExpression"" value=""0 0 12 * * ?""/>'), (175, '    </bean>'), (176, ''), (177, '    <bean id=""inspectorJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (178, '        <property name=""name"" value=""inspectorJob""></property>'), (179, '        <property name=""group"" value=""inspector""></property>'), (180, '        <property name=""jobClass"" value=""com.sohu.cache.inspect.InspectorJob""></property>'), (181, '        <property name=""durability"" value=""true""/>'), (182, '    </bean>'), (183, ''), (184, '    <bean id=""hostInspectorTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (185, '        <property name=""name"" value=""hostInspectorTrigger""/>'), (186, '        <property name=""group"" value=""inspector""/>'), (187, '        <property name=""jobDetail"" ref=""inspectorJobDetail""/>'), (188, '        <!-- 5分钟执行一次 -->'), (189, '        <property name=""cronExpression"" value=""0 0/5 * ? * *""/>'), (190, '        <property name=""jobDataAsMap"">'), (191, '            <map>'), (192, '                <entry key=""inspectorType"" value=""host""/>'), (193, '            </map>'), (194, '        </property>'), (195, '    </bean>'), (196, ''), (197, '    <bean id=""appInspectorTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (198, '        <property name=""name"" value=""appInspectorTrigger""/>'), (199, '        <property name=""group"" value=""inspector""/>'), (200, '        <property name=""jobDetail"" ref=""inspectorJobDetail""/>'), (201, '        <!-- 20分钟执行一次 -->'), (202, '        <property name=""cronExpression"" value=""0 0/20 * ? * *""/>'), (203, '        <property name=""jobDataAsMap"">'), (204, '            <map>'), (205, '                <entry key=""inspectorType"" value=""app""/>'), (206, '            </map>'), (207, '        </property>'), (208, '    </bean>'), (209, ''), (210, '    <bean id=""errorStatisticsTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (211, '        <property name=""name"" value=""errorStatisticsTrigger""/>'), (212, '        <property name=""group"" value=""errorStatisticsGroup""/>'), (213, '        <property name=""jobDetail"" ref=""errorStatisticsJobDetail""/>'), (214, '        <property name=""cronExpression"" value=""0 0 10 * * ?""/>'), (215, '    </bean>'), (216, ''), (217, '    <bean id=""systemConfigRefreshJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (218, '        <property name=""name"" value=""systemConfigRefreshJobDetail""></property>'), (219, '        <property name=""group"" value=""systemConfigRefreshGroup""></property>'), (220, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.SystemConfigRefreshJob""></property>'), (221, '        <property name=""durability"" value=""true"" />'), (222, '    </bean>'), (223, ''), (224, '    <bean id=""systemConfigRefreshTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (225, '        <property name=""name"" value=""systemConfigRefreshTrigger""/>'), (226, '        <property name=""group"" value=""systemConfigRefreshGroup""/>'), (227, '        <property name=""jobDetail"" ref=""systemConfigRefreshJobDetail""/>'), (228, '        <property name=""cronExpression"" value=""0/30 * * ? * *""/>'), (229, '    </bean>'), (230, ''), (231, ''), (232, '    <bean id=""appDailyJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (233, '        <property name=""name"" value=""appDailyJob""></property>'), (234, '        <property name=""group"" value=""appDaily""></property>'), (235, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.AppDailyJob""></property>'), (236, '        <property name=""durability"" value=""true""/>'), (237, '    </bean>'), (238, ''), (239, '    <bean id=""appDailyTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (240, '        <property name=""name"" value=""appDailyTrigger""/>'), (241, '        <property name=""group"" value=""appDaily""/>'), (242, '        <property name=""jobDetail"" ref=""appDailyJobDetail""/>'), (243, '        <property name=""cronExpression"" value=""0 0 10 * * ?""/>'), (244, '    </bean>'), (245, ''), (246, ''), (247, '    <bean id=""instanceAlertValueJobDetail"" class=""org.springframework.scheduling.quartz.JobDetailFactoryBean"">'), (248, '        <property name=""name"" value=""instanceAlertValueJob""></property>'), (249, '        <property name=""group"" value=""instanceAlertValue""></property>'), (250, '        <property name=""jobClass"" value=""com.sohu.cache.schedule.jobs.InstanceAlertValueJob""></property>'), (251, '        <property name=""durability"" value=""true""/>'), (252, '    </bean>'), (253, ''), (254, '    <bean id=""instanceAlertValueTrigger"" class=""org.springframework.scheduling.quartz.CronTriggerFactoryBean"">'), (255, '        <property name=""name"" value=""instanceAlertValueTrigger""/>'), (256, '        <property name=""group"" value=""instanceAlertValue""/>'), (257, '        <property name=""jobDetail"" ref=""instanceAlertValueJobDetail""/>'), (258, '        <property name=""cronExpression"" value=""0 0/1 * ? * *""/>'), (259, '    </bean>'), (260, ''), (261, ''), (262, '</beans>')]}"
510,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring-service.xml,spring-service.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd'), (6, '        "" default-autowire=""byName"">'), (7, ''), (8, '    <!--redis调度接口-->'), (9, '    <bean id=""redisCenter"" class=""com.sohu.cache.redis.impl.RedisCenterImpl"" init-method=""init"" destroy-method=""destory""/>'), (10, ''), (11, '    <!--machine调度接口-->'), (12, '    <bean id=""machineCenter"" class=""com.sohu.cache.machine.impl.MachineCenterImpl""  init-method=""init""/>'), (13, ''), (14, '    <!--quartz调度接口-->'), (15, '    <bean id=""schedulerCenter"" class=""com.sohu.cache.schedule.impl.SchedulerCenterImpl"" />'), (16, ''), (17, '    <!--trigger管理接口-->'), (18, '    <bean id=""triggerCenter"" class=""com.sohu.cache.schedule.impl.TriggerCenterImpl""/>'), (19, ''), (20, '    <!--异步接口-->'), (21, '    <bean id=""asyncService"" class=""com.sohu.cache.async.impl.AsyncServiceImpl"" destroy-method=""destory""/>'), (22, ''), (23, '    <!--app service接口-->'), (24, '    <bean id=""appStatsCenter"" class=""com.sohu.cache.stats.app.impl.AppStatsCenterImpl""/>'), (25, ''), (26, '    <!--app deloy接口-->'), (27, '    <bean id=""appDeployCenter"" class=""com.sohu.cache.stats.app.impl.AppDeployCenterImpl""/>'), (28, ''), (29, '    <bean id=""redisDeployCenter"" class=""com.sohu.cache.redis.impl.RedisDeployCenterImpl""/>'), (30, ''), (31, '    <bean id=""machineDeployCenter"" class=""com.sohu.cache.machine.impl.MachineDeployCenterImpl""/>'), (32, ''), (33, '    <bean id=""instanceStatsCenter"" class=""com.sohu.cache.stats.instance.impl.InstanceStatsCenterImpl""/>'), (34, ''), (35, '    <bean id=""instanceDeployCenter"" class=""com.sohu.cache.stats.instance.impl.InstanceDeployCenterImpl""/>'), (36, ''), (37, '    <bean id=""importAppCenter"" class=""com.sohu.cache.stats.app.impl.ImportAppCenterImpl""/>'), (38, ''), (39, '    <bean id=""appDataMigrateCenter"" class=""com.sohu.cache.stats.app.impl.AppDataMigrateCenterImpl""/>'), (40, ''), (41, '    <bean id=""redisConfigTemplateService"" class=""com.sohu.cache.redis.impl.RedisConfigTemplateServiceImpl""/>'), (42, ''), (43, '    <!-- 服务器状况服务 -->'), (44, '    <bean id=""nmonService"" class=""com.sohu.cache.server.nmon.NMONService""/>'), (45, ''), (46, '    <bean id=""sshTemplate"" class=""com.sohu.cache.ssh.SSHTemplate""/>'), (47, ''), (48, '    <bean id=""serverStatusCollector"" class=""com.sohu.cache.server.ServerStatusCollector"" init-method=""init""/>'), (49, ''), (50, '    <bean id=""serverDataService"" class=""com.sohu.cache.web.service.impl.ServerDataServiceImpl""/>'), (51, ''), (52, '    <bean id=""instanceAlertConfigService"" class=""com.sohu.cache.stats.instance.impl.InstanceAlertConfigServiceImpl""/>'), (53, ''), (54, '</beans>')]}"
511,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/spring/spring.xml,spring.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"" default-autowire=""byName"">'), (6, '    <import resource=""${spring-file}""/>'), (7, '</beans>')]}"
512,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/templates/appAudit.vm,appAudit.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud审核邮件</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td style=""width:5px;""></td>'), (15, '        <td style=""color:#3f3f3f; font-weight: bold;font-size:12px; font-family: \'宋体\'; padding: 5px 0 15px 0"">'), (16, '            $appAudit.userName，您好，欢迎使用CacheCloud平台，您的申请处理进度如下：'), (17, '        </td>'), (18, '    </tr>'), (19, '    <tr>'), (20, '        <td></td>'), (21, '        <td style=""padding-top:20px; padding-left:27px;"">'), (22, '            <ul>'), (23, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">申请处理信息：</span></li>'), (24, '            </ul>'), (25, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (26, '                <tr>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (28, '                        申请类型：'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                        ##1:申请应用,2:应用扩容,3:修改配置'), (32, '                        $appAudit.typeDesc'), (33, '                    </td>'), (34, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (35, '                        申请描述：'), (36, '                    </td>'), (37, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (38, '                        $!appAudit.info'), (39, '                    </td>'), (40, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (41, '                        申请时间：'), (42, '                    </td>'), (43, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (44, '                        $!appAudit.createTimeFormat'), (45, '                    </td>'), (46, ''), (47, '                </tr>'), (48, '##                <tr>'), (49, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (50, '##                        预留参数1：'), (51, '##                    </td>'), (52, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (53, '##                        $!appAudit.param1'), (54, '##                    </td>'), (55, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (56, '##                        预留参数2：'), (57, '##                    </td>'), (58, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (59, '##                        $!appAudit.param2'), (60, '##                    </td>'), (61, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (62, '##                        预留参数3：'), (63, '##                    </td>'), (64, '##                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (65, '##                        $!appAudit.param3'), (66, '##                    </td>'), (67, '##                </tr>'), (68, '                <tr>'), (69, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (70, '                        处理状态：'), (71, '                    </td>'), (72, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (73, '                        $!appAudit.statusDesc'), (74, '                    </td>'), (75, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (76, '                        处理描述：'), (77, '                    </td>'), (78, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (79, '                        $!appAudit.refuseReason'), (80, '                    </td>'), (81, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (82, '                        处理时间：'), (83, '                    </td>'), (84, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (85, '                        $!appAudit.modifyTimeFormat'), (86, '                    </td>'), (87, '                </tr>'), (88, '            </table>'), (89, '            <br/>'), (90, '            <ul>'), (91, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用详细信息：</span></li>'), (92, '            </ul>'), (93, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (94, '                <tr>'), (95, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (96, '                        应用名称：'), (97, '                    </td>'), (98, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (99, '                        $!appDesc.name'), (100, '                    </td>'), (101, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (102, '                        应用类型：'), (103, '                    </td>'), (104, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (105, '                        $!appDesc.typeDesc'), (106, '                    </td>'), (107, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (108, '                        应用状态：'), (109, '                    </td>'), (110, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px; color: red;"">'), (111, '                        $!appDesc.statusDesc'), (112, '                    </td>'), (113, '                </tr>'), (114, '                <tr>'), (115, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (116, '                        是否测试：'), (117, '                    </td>'), (118, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (119, '                        #if($appDesc.isTest == 1)'), (120, '                            是'), (121, '                        #else'), (122, '                            否'), (123, '                        #end'), (124, '                    </td>'), (125, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (126, '                        是否持久化：'), (127, '                    </td>'), (128, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (129, '                        #if($appDesc.needPersistence == 1)'), (130, '                            是'), (131, '                        #else'), (132, '                            否'), (133, '                        #end'), (134, '                    </td>'), (135, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (136, '                        是否有后端数据源：'), (137, '                    </td>'), (138, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (139, '                        #if($appDesc.hasBackStore == 1)'), (140, '                            是'), (141, '                        #else'), (142, '                            否'), (143, '                        #end'), (144, '                    </td>'), (145, '                </tr>'), (146, '                <tr>'), (147, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (148, '                        应用描述：'), (149, '                    </td>'), (150, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (151, '                        $!appDesc.intro'), (152, '                    </td>'), (153, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (154, '                        应用负责人：'), (155, '                    </td>'), (156, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (157, '                        $!appDesc.officer'), (158, '                    </td>'), (159, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (160, '                        应用申请时间：'), (161, '                    </td>'), (162, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (163, '                        $!appDesc.createTimeFormat'), (164, '                    </td>'), (165, '                </tr>'), (166, '            </table>'), (167, '        </td>'), (168, '    </tr>'), (169, ''), (170, '</table>'), (171, '</p>'), (172, '</body>'), (173, '</html>')]}"
513,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/templates/appDaily.vm,appDaily.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>CacheCloud应用日报</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">应用详细信息：$!appDesc.appId</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (22, '                        应用名称：'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (25, '                        $!appDesc.name'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (28, '                        应用类型：'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (31, '                        $!appDesc.typeDesc'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (34, '                        应用状态：'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                        $!appDesc.statusDesc'), (38, '                    </td>'), (39, '                </tr>'), (40, '                <tr>'), (41, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (42, '                        应用描述：'), (43, '                    </td>'), (44, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (45, '                        $!appDesc.intro'), (46, '                    </td>'), (47, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (48, '                        应用负责人：'), (49, '                    </td>'), (50, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (51, '                        $!appDesc.officer'), (52, '                    </td>'), (53, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (54, '                        应用申请时间：'), (55, '                    </td>'), (56, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (57, '                        $!appDesc.createTimeFormat'), (58, '                    </td>'), (59, '                </tr>'), (60, '            </table>'), (61, ''), (62, '            <ul>'), (63, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">客户端相关(确保使用有客户端统计的版本):</span></li>'), (64, '            </ul>'), (65, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (66, '                <tr>'), (67, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (68, '                        客户端值分布(全天):'), (69, '                    </td>'), (70, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (71, '\t\t\t\t\t\t$!appDailyData.valueSizeDistributeCountDesc'), (72, '                    </td>'), (73, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (74, '                       客户端异常个数(全天)：'), (75, '                    </td>'), (76, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (77, '                        $!appDailyData.clientExceptionCount'), (78, '                    </td>'), (79, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; text-align: left;height:33px; width: 50px;"">'), (80, '                        客户端连接数(每分钟)：'), (81, '                    </td>'), (82, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (83, '                        最大值:$!appDailyData.maxMinuteClientCount <br/>'), (84, '                        平均值:$!appDailyData.avgMinuteClientCount'), (85, '                    </td>'), (86, '                </tr>'), (87, '            </table>'), (88, '            <br/>'), (89, ''), (90, '            <ul>'), (91, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">服务端相关:</span></li>'), (92, '            </ul>'), (93, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (94, '                <tr>'), (95, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (96, '                        慢查询个数(全天)：'), (97, '                    </td>'), (98, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (99, '                        $!appDailyData.slowLogCount'), (100, '                    </td>'), (101, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (102, '                        命令次数(每分钟)：'), (103, '                    </td>'), (104, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (105, '                       \t 最大值:$!appDailyData.maxMinuteCommandCount <br/>'), (106, '                       \t 平均值:$!appDailyData.avgMinuteCommandCount'), (107, '                    </td>'), (108, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (109, '                        命中率(每分钟)：'), (110, '                    </td>'), (111, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (112, '                       \t 最大值:$!appDailyData.maxMinuteHitRatio% <br/>'), (113, '                       \t 最小值:$!appDailyData.minMinuteHitRatio% <br/>'), (114, '                       \t 平均值:$!appDailyData.avgHitRatio%'), (115, '                    </td>'), (116, '                </tr>'), (117, ''), (118, '                <tr>'), (119, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (120, '                        内存使用量(全天)：'), (121, '                    </td>'), (122, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (123, '                        平均使用量:$!appDailyData.avgUsedMemory M<br/>'), (124, '                        最大使用量:$!appDailyData.maxUsedMemory M'), (125, '                    </td>'), (126, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (127, '                        过期键数(全天)：'), (128, '                    </td>'), (129, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (130, '                       \t $!appDailyData.expiredKeysCount'), (131, '                    </td>'), (132, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (133, '                        剔除键数(全天)：'), (134, '                    </td>'), (135, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (136, '                       \t $!appDailyData.evictedKeysCount'), (137, '                    </td>'), (138, '                </tr>'), (139, ''), (140, '                <tr>'), (141, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (142, '                       键个数(全天)：'), (143, '                    </td>'), (144, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (145, '                        平均值:$!appDailyData.avgObjectSize<br/>'), (146, '                        最大值:$!appDailyData.maxObjectSize'), (147, '                    </td>'), (148, '\t\t\t\t\t<td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (149, '         input流量(每分钟)：'), (150, '                    </td>'), (151, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (152, '                       \t 平均值:$!appDailyData.avgMinuteNetInputByte M<br/>'), (153, '                       \t 最大值:$!appDailyData.maxMinuteNetInputByte M<br/>'), (154, '                    </td>'), (155, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767;text-align: left; height:33px; width: 50px;"">'), (156, '        output流量(每分钟)：'), (157, '                    </td>'), (158, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (159, '                       \t 平均:$!appDailyData.avgMinuteNetOutputByte M<br/>'), (160, '                       \t 最大:$!appDailyData.maxMinuteNetOutputByte M<br/>'), (161, '                    </td>'), (162, '                </tr>'), (163, ''), (164, ''), (165, '            </table>'), (166, '            <br/>'), (167, ''), (168, '        </td>'), (169, '    </tr>'), (170, ''), (171, '</table>'), (172, '</p>'), (173, '</body>'), (174, '</html>')]}"
514,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/main/resources/templates/instanceAlert.vm,instanceAlert.vm,4,"{'added': [], 'deleted': [(1, '<!DOCTYPE html>'), (2, '<head>'), (3, '    <meta charset=UTF-8/>'), (4, '    <title>Redis实例分钟报警</title>'), (5, '</head>'), (6, '<body>'), (7, '<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">'), (8, '<p>'), (9, '<table style=""width:100%; font-size:12px;"" width=""100%"" cellpadding=""0"" cellspacing=""0"">'), (10, '    <colgroup>'), (11, '        <col style=""width: 5px;"">'), (12, '    </colgroup>'), (13, '    <tr>'), (14, '        <td></td>'), (15, '        <td style=""padding-top:20px; padding-left:27px;"">'), (16, '        \t<ul>'), (17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例分钟报警：</span></li>'), (18, '            </ul>'), (19, '            <table style=""table-layout:fixed;width: 872px;border-collapse: collapse;word-break: break-all;word-wrap:break-word;border-top: 1px dotted #676767;text-align: center;color: #000; font-family:\'宋体\'; font-size:12px; margin-top:10px; margin-left: 24px"">'), (20, '                <tr>'), (21, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (22, '                        \t应用id'), (23, '                    </td>'), (24, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (25, '                        \t应用名'), (26, '                    </td>'), (27, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (28, '                        \t负责人'), (29, '                    </td>'), (30, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (31, '                        \tip'), (32, '                    </td>'), (33, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (34, '                    \t\tport'), (35, '                    </td>'), (36, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (37, '                    \t\t属性值'), (38, '                    </td>'), (39, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (40, '                    \t\t说明'), (41, '                    </td>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (43, '                    \t\t其他信息'), (44, '                    </td>'), (45, '                </tr>'), (46, '                #foreach($!item in $!instanceAlertValueResultList)'), (47, '                \t<tr>'), (48, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (49, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.appId'>${item.appId}</a>""), (50, '\t                    </td>'), (51, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (52, '\t                        \t$!item.appDesc.name'), (53, '\t                    </td>'), (54, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (55, '\t                        \t$!item.appDesc.officer'), (56, '\t                    </td>'), (57, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (58, '\t                        \t$!item.instanceInfo.ip'), (59, '\t                    </td>'), (60, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 50px;"">'), (61, '\t                    \t\t$!item.instanceInfo.port'), (62, '\t                    </td>'), (63, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (64, '\t                    \t\t$!item.instanceAlertConfig.alertConfig'), (65, '\t                    </td>'), (66, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (67, '\t                    \t\t$!item.alertMessage'), (68, '\t                    </td>'), (69, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (70, '\t                    \t\t$!item.otherInfo'), (71, '\t                    </td>'), (72, '\t                </tr>'), (73, '                #end'), (74, '            </table>'), (75, '        </td>'), (76, '    </tr>'), (77, ''), (78, '</table>'), (79, '</p>'), (80, '</body>'), (81, '</html>')]}"
515,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/test/resources/logback-test.xml,logback-test.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<!--'), (3, '  Example LOGBACK Configuration File'), (4, '  http://logback.qos.ch/manual/configuration.html'), (5, '  -->'), (6, '<configuration scan=""true"" scanPeriod=""30 seconds"">'), (7, ''), (8, '    <appender name=""console"" class=""ch.qos.logback.core.ConsoleAppender"">'), (9, '        <encoder>'), (10, '            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>'), (11, '        </encoder>'), (12, '    </appender>'), (13, ''), (14, '    <root level=""info"">'), (15, '        <appender-ref ref=""console""/>'), (16, '    </root>'), (17, '</configuration>')]}"
516,05c6fe3723c39a7b8a204751b5066d5f355df647,cachecloud-open-web/src/test/resources/spring-test.xml,spring-test.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8""?>'), (2, '<beans xmlns=""http://www.springframework.org/schema/beans""'), (3, '       xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""'), (4, '       xsi:schemaLocation=""http://www.springframework.org/schema/beans'), (5, '                     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd""'), (6, '       default-autowire=""byName"">'), (7, '    <import resource=""classpath:spring/spring-config.xml""/>'), (8, '    <import resource=""classpath:spring/spring-mybatis.xml""/>'), (9, '    <import resource=""classpath:spring/spring-service.xml""/>'), (10, '    <import resource=""classpath:spring/spring-data.xml""/>'), (11, '    <import resource=""classpath:spring/spring-manage.xml""/>'), (12, '    <import resource=""classpath:spring/spring-mvc.xml""/>'), (13, '    <import resource=""classpath:spring/spring-jmx.xml""/>'), (14, '    <import resource=""classpath:spring/spring-alert.xml""/>'), (15, '    <import resource=""classpath:spring/spring-client-report.xml""/>'), (16, '    <import resource=""classpath:spring/spring-inspector.xml""/>'), (17, ''), (18, '</beans>')]}"
517,7e9b5482385597f66e694c227713dbc80f1ff5a3,cachecloud-open-web/src/main/resources/spring/spring-quartz.xml,spring-quartz.xml,5,"{'added': [], 'deleted': [(125, '        <property name=""requestsRecovery"" value=""true""/>'), (133, '        <property name=""requestsRecovery"" value=""true""/>'), (140, '        <property name=""requestsRecovery"" value=""true""/>'), (148, '        <property name=""requestsRecovery"" value=""true""/>'), (156, '        <property name=""requestsRecovery"" value=""true""/>'), (186, '        <property name=""requestsRecovery"" value=""true""/>'), (242, '        <property name=""requestsRecovery"" value=""true""/>'), (258, '        <property name=""requestsRecovery"" value=""true""/>')]}"
518,f460d701f1831eef5ada59790f85608e9b36e30d,cachecloud-open-web/src/main/resources/mapper/InstanceStatsDao.xml,InstanceStatsDao.xml,5,"{'added': [(83, ''), (84, '    <delete id=""deleteStandardStatsByScanTime"">'), (85, '        DELETE FROM standard_statistics'), (86, '        where created_time BETWEEN #{startTime} AND #{endTime}'), (87, '    </delete>')], 'deleted': []}"
519,bcdcb53f2185300be64a2e4c884c160f785af2ce,cachecloud-open-web/src/main/resources/mapper/InstanceReshardProcessDao.xml,InstanceReshardProcessDao.xml,5,"{'added': [(8, '\t    \tmigrating_slot,is_pipeline,finish_slot_num,status,start_time,end_time,create_time,update_time'), (14, '\t\t#{migratingSlot},#{isPipeline},#{finishSlotNum},#{status},#{startTime},#{endTime},#{createTime},#{updateTime})')], 'deleted': [(8, '\t    \tmigrating_slot,finish_slot_num,status,start_time,end_time,create_time,update_time'), (14, '\t\t#{migratingSlot},#{finishSlotNum},#{status},#{startTime},#{endTime},#{createTime},#{updateTime})')]}"
520,b203210d0514946534c193b092050a062f54dfe8,cachecloud-open-web/src/main/resources/mapper/InstanceReshardProcessDao.xml,InstanceReshardProcessDao.xml,5,"{'added': [(20, ''), (21, '    <select id=""get"" resultType=""InstanceReshardProcess"">'), (22, '        select id,<include refid=""instance_reshard_process_column""/> from instance_reshard_process where id = #{id}'), (23, '    </select>')], 'deleted': []}"
521,2352d3c4720ac7ca5e9e5cc27374c85f5380fb55,cachecloud-open-web/src/main/resources/mapper/InstanceAlertValueDao.xml,InstanceAlertValueDao.xml,4,"{'added': [], 'deleted': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceAlertValueDao"">'), (5, '    <sql id=""columns"">'), (6, '    \tconfig_key,alert_value,compare_type,info,status,order_id,value_type'), (7, '    </sql>'), (8, ''), (9, '    <select id=""getAllInstanceAlert"" resultType=""com.sohu.cache.entity.InstanceAlertConfig"">'), (10, '        select <include refid=""columns""/> from instance_alert'), (11, '    </select>'), (12, ''), (13, '    <insert id=""saveOrUpdate"">'), (14, '\t\tinsert into instance_alert(<include refid=""columns"" />)'), (15, '\t\tvalues(#{configKey},#{alertValue},#{compareType},#{info},#{status},#{orderId},#{valueType})'), (16, '\t    on duplicate key update'), (17, '\t    alert_value = #{alertValue}, compare_type = #{compareType}, info = #{info}, status = #{status}, order_id = #{orderId}, value_type = #{valueType}'), (18, '\t</insert>'), (19, ''), (20, '    <select id=""getByConfigKey"" resultType=""com.sohu.cache.entity.InstanceAlertConfig"">'), (21, '        select <include refid=""columns""/> from instance_alert where config_key = #{configKey}'), (22, '    </select>'), (23, ''), (24, '\t<update id=""updateStatus"">'), (25, '\t\tupdate instance_alert set status = #{status} where config_key = #{configKey}'), (26, '\t</update>'), (27, ''), (28, '\t<delete id=""remove"">'), (29, '\t\tdelete from instance_alert where config_key = #{configKey}'), (30, '\t</delete>'), (31, ''), (32, '\t<select id=""getByValueType"" resultType=""com.sohu.cache.entity.InstanceAlertConfig"">'), (33, '        select <include refid=""columns""/> from instance_alert where value_type = #{valueType} and status = #{status}'), (34, '    </select>'), (35, ''), (36, '</mapper>')]}"
522,2352d3c4720ac7ca5e9e5cc27374c85f5380fb55,cachecloud-open-web/src/main/resources/mapper/InstanceReshardProcessDao.xml,InstanceReshardProcessDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceReshardProcessDao"">'), (5, ''), (6, '    <sql id=""instance_reshard_process_column"">'), (7, '\t    \tapp_id,audit_id,source_instance_id,target_instance_id,start_slot,end_slot,'), (8, '\t    \tmigrating_slot,finish_slot_num,status,start_time,end_time,create_time,update_time'), (9, '    </sql>'), (10, ''), (11, '    <insert id=""save"" parameterType=""InstanceReshardProcess""  keyProperty=""id"" useGeneratedKeys=""true"">'), (12, '\t\tinsert into instance_reshard_process(<include refid=""instance_reshard_process_column"" />)'), (13, '\t\tvalues(#{appId},#{auditId},#{sourceInstanceId},#{targetInstanceId},#{startSlot},#{endSlot},'), (14, '\t\t#{migratingSlot},#{finishSlotNum},#{status},#{startTime},#{endTime},#{createTime},#{updateTime})'), (15, '\t</insert>'), (16, ''), (17, '    <select id=""getByAuditId"" resultType=""InstanceReshardProcess"">'), (18, '        select id,<include refid=""instance_reshard_process_column""/> from instance_reshard_process where audit_id = #{auditId}'), (19, '    </select>'), (20, ''), (21, '    <update id=""updateStatus"">'), (22, '    \t\tupdate instance_reshard_process set status = #{status} where id = #{id}'), (23, '    </update>'), (24, ''), (25, '    <update id=""updateEndTime"">'), (26, '    \t\tupdate instance_reshard_process set end_time = #{endTime} where id = #{id}'), (27, '    </update>'), (28, ''), (29, '    <update id=""increaseFinishSlotNum"">'), (30, '    \t\tupdate instance_reshard_process set finish_slot_num = finish_slot_num + 1 where id = #{id}'), (31, '    </update>'), (32, ''), (33, '    <update id=""updateMigratingSlot"">'), (34, '    \t\tupdate instance_reshard_process set migrating_slot = #{migratingSlot} where id = #{id}'), (35, '    </update>'), (36, ''), (37, '</mapper>')], 'deleted': []}"
523,5ba6be99f033f09bcc8cd1ae62864efe836bfead,cachecloud-open-web/src/main/resources/mapper/InstanceAlertConfigDao.xml,InstanceAlertConfigDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, '<mapper namespace=""com.sohu.cache.dao.InstanceAlertConfigDao"">'), (5, ''), (6, '    <sql id=""instance_alert_config_column"">'), (7, '    \talert_config,alert_value,config_info,type,instance_id,status,compare_type,'), (8, '    \tcheck_cycle,update_time,last_check_time'), (9, '    </sql>'), (10, ''), (11, '    <insert id=""save"" parameterType=""InstanceAlertConfig""  keyProperty=""id"" useGeneratedKeys=""true"">'), (12, '\t\tinsert into instance_alert_configs(<include refid=""instance_alert_config_column"" />)'), (13, '\t\tvalues(#{alertConfig},#{alertValue},#{configInfo},#{type},#{instanceId},#{status},#{compareType},'), (14, '\t\t#{checkCycle},#{updateTime},#{lastCheckTime})'), (15, '\t\ton duplicate key update'), (16, '\t\talert_value = #{alertValue},check_cycle = #{checkCycle}, update_time = now(),status = #{status},last_check_time=now()'), (17, '\t</insert>'), (18, ''), (19, '    <select id=""getAll"" resultType=""InstanceAlertConfig"">'), (20, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs'), (21, '    </select>'), (22, ''), (23, '    <select id=""get"" resultType=""InstanceAlertConfig"">'), (24, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs where id = #{id}'), (25, '    </select>'), (26, ''), (27, '\t<delete id=""remove"">'), (28, '\t\tdelete from instance_alert_configs where id = #{id}'), (29, '\t</delete>'), (30, ''), (31, '\t<select id=""getByType"" resultType=""InstanceAlertConfig"">'), (32, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs where type = #{type}'), (33, '    </select>'), (34, ''), (35, '    <select id=""getByAlertConfig"" resultType=""InstanceAlertConfig"">'), (36, '        select id,<include refid=""instance_alert_config_column""/> from instance_alert_configs where alert_config = #{alertConfig}'), (37, '    </select>'), (38, ''), (39, '    <update id=""update"">'), (40, '    \t\tupdate instance_alert_configs set alert_value = #{alertValue}, check_cycle = #{checkCycle} where id = #{id}'), (41, '    </update>'), (42, ''), (43, '    <update id=""updateLastCheckTime"">'), (44, '    \t\tupdate instance_alert_configs set last_check_time = #{lastCheckTime} where id = #{id}'), (45, '    </update>'), (46, ''), (47, '</mapper>')], 'deleted': []}"
524,5ba6be99f033f09bcc8cd1ae62864efe836bfead,cachecloud-open-web/src/main/resources/mapper/InstanceAlertValueDao.xml,InstanceAlertValueDao.xml,5,"{'added': [(9, '    <select id=""getAllInstanceAlert"" resultType=""com.sohu.cache.entity.InstanceAlertConfig"">'), (20, '    <select id=""getByConfigKey"" resultType=""com.sohu.cache.entity.InstanceAlertConfig"">'), (32, '\t<select id=""getByValueType"" resultType=""com.sohu.cache.entity.InstanceAlertConfig"">')], 'deleted': [(9, '    <select id=""getAllInstanceAlert"" resultType=""com.sohu.cache.entity.InstanceAlert"">'), (20, '    <select id=""getByConfigKey"" resultType=""com.sohu.cache.entity.InstanceAlert"">'), (32, '\t<select id=""getByValueType"" resultType=""com.sohu.cache.entity.InstanceAlert"">')]}"
525,5ba6be99f033f09bcc8cd1ae62864efe836bfead,cachecloud-open-web/src/main/resources/mapper/InstanceStatsDao.xml,InstanceStatsDao.xml,5,"{'added': [(60, '        replace into standard_statistics(collect_time,ip,port,db_type,info_json,diff_json,cluster_info_json)'), (61, '        values (#{collectTime},#{ip},#{port},#{dbType},#{infoJson},#{diffJson},#{clusterInfoJson})'), (65, '        select id,collect_time,ip,port,db_type,info_json,diff_json,cluster_info_json,created_time'), (85, '        select id,collect_time,ip,port,db_type,info_json,diff_json,cluster_info_json,created_time')], 'deleted': [(60, '        replace into standard_statistics(collect_time,ip,port,db_type,info_json,diff_json)'), (61, '        values (#{collectTime},#{ip},#{port},#{dbType},#{infoJson},#{diffJson})'), (65, '        select id,collect_time,ip,port,db_type,info_json,diff_json,created_time'), (85, '        select id,collect_time,ip,port,db_type,info_json,diff_json,created_time')]}"
526,74a077118ff111ab49aec7570c5a92d54aa3885b,cachecloud-open-web/src/main/resources/spring/spring-service.xml,spring-service.xml,5,"{'added': [(52, '    <bean id=""instanceAlertConfigService"" class=""com.sohu.cache.stats.instance.impl.InstanceAlertConfigServiceImpl""/>')], 'deleted': [(52, '    <bean id=""instanceAlertValueService"" class=""com.sohu.cache.stats.instance.impl.InstanceAlertValueServiceImpl""/>')]}"
527,74a077118ff111ab49aec7570c5a92d54aa3885b,cachecloud-open-web/src/main/resources/templates/instanceAlert.vm,instanceAlert.vm,5,"{'added': [(17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例分钟报警：</span></li>'), (42, '                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (43, '                    \t\t其他信息'), (44, '                    </td>'), (49, ""\t                    \t\t<a href='${ccDomain}/admin/app/index?appId=$!item.appId'>${item.appId}</a>""), (58, '\t                        \t$!item.instanceInfo.ip'), (61, '\t                    \t\t$!item.instanceInfo.port'), (64, '\t                    \t\t$!item.instanceAlertConfig.alertConfig'), (69, '\t                    <td style=""border-right: 1px dotted #676767; border-bottom: 1px dotted #676767; height:33px; width: 140px;"">'), (70, '\t                    \t\t$!item.otherInfo'), (71, '\t                    </td>')], 'deleted': [(17, '                <li><span style=""font-weight: bold; padding-top:20px; color:#3f3f3f;"">Redis实例分钟报警：$!appDesc.appId</span></li>'), (46, ""\t                    \t\t<a href='${ccDomain}/admin/app/index.do?appId=$!item.appId'>${item.appId}</a>""), (55, '\t                        \t$!item.ip'), (58, '\t                    \t\t$!item.port'), (61, '\t                    \t\t$!item.configKey')]}"
528,538792e398505da04711ffef0cc4bad0700df903,cachecloud-open-web/src/main/resources/mapper/AppDailyDao.xml,AppDailyDao.xml,5,"{'added': [(25, '    <select id=""getAppDaily"" resultType=""AppDailyData"">'), (26, '\t\tselect id,<include refid=""app_daily_column""/> from app_daily where app_id=#{appId} and date =#{date}')], 'deleted': [(25, '    <select id=""getAppDailyList"" resultType=""AppDailyData"">'), (26, '\t\tselect id,<include refid=""app_daily_column""/> from app_daily where app_id=#{appId} and date between #{startDate} and #{endDate}')]}"
529,bdd8a97d33f8fb7ace5266dbe59d04664a794503,cachecloud-open-web/src/main/resources/mapper/InstanceSlowLogDao.xml,InstanceSlowLogDao.xml,5,"{'added': [(36, ""        from instance_slow_log where app_id = #{appId} and execute_time between DATE_FORMAT(#{startDate}, '%Y-%m-%d') and DATE_FORMAT(#{endDate}, '%Y-%m-%d')"")], 'deleted': [(36, ""        from instance_slow_log where app_id = #{appId} and create_time between DATE_FORMAT(#{startDate}, '%Y-%m-%d') and DATE_FORMAT(#{endDate}, '%Y-%m-%d')"")]}"
530,cad3a0d18a41784b15059da4b45f017d6597a5c1,cachecloud-open-web/src/main/resources/mapper/AppDailyDao.xml,AppDailyDao.xml,1,"{'added': [(1, '<?xml version=""1.0"" encoding=""UTF-8"" ?>'), (2, '<!DOCTYPE mapper PUBLIC ""-//mybatis.org//DTD Mapper 3.0//EN""'), (3, '        ""http://mybatis.org/dtd/mybatis-3-mapper.dtd"">'), (4, ''), (5, '<mapper namespace=""com.sohu.cache.dao.AppDailyDao"">'), (6, '\t<sql id=""app_daily_column"">'), (7, '\t\tapp_id,date,create_time,slow_log_count,client_exception_count,max_minute_client_count,'), (8, '\t\tavg_minute_client_count,max_minute_command_count,avg_minute_command_count,avg_hit_ratio,'), (9, '\t\tmin_minute_hit_ratio,max_minute_hit_ratio,avg_used_memory,max_used_memory,expired_keys_count,'), (10, '\t\tevicted_keys_count,avg_minute_net_input_byte,max_minute_net_input_byte,avg_minute_net_output_byte,'), (11, '\t\tmax_minute_net_output_byte,avg_object_size,max_object_size,big_key_times,big_key_info'), (12, '    </sql>'), (13, ''), (14, '    <insert id=""save"" parameterType=""AppDailyData"" keyProperty=""id"" useGeneratedKeys=""true"">'), (15, '    \tinsert into app_daily'), (16, '    \t\t(<include refid=""app_daily_column""/>)'), (17, '\t\tvalues'), (18, '\t\t(#{appId},#{date},now(),#{slowLogCount},#{clientExceptionCount},#{maxMinuteClientCount},'), (19, '\t\t#{avgMinuteClientCount},#{maxMinuteCommandCount},#{avgMinuteCommandCount},#{avgHitRatio},'), (20, '\t\t#{minMinuteHitRatio},#{maxMinuteHitRatio},#{avgUsedMemory},#{maxUsedMemory},#{expiredKeysCount},'), (21, '\t\t#{evictedKeysCount},#{avgMinuteNetInputByte},#{maxMinuteNetInputByte},#{avgMinuteNetOutputByte}'), (22, '\t\t,#{maxMinuteNetOutputByte},#{avgObjectSize},#{maxObjectSize},#{bigKeyTimes},#{bigKeyInfo})'), (23, '    </insert>'), (24, ''), (25, '    <select id=""getAppDailyList"" resultType=""AppDailyData"">'), (26, '\t\tselect id,<include refid=""app_daily_column""/> from app_daily where app_id=#{appId} and date between #{startDate} and #{endDate}'), (27, '\t</select>'), (28, ''), (29, '</mapper>'), (30, ''), (31, '')], 'deleted': []}"
